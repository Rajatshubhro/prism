#INFO: **** input file is /home/mazin.3/Documents/programs/prism/examples/cvs_ee_mr_adc/so_test/01-cvs_ee_mr_adc_2.py ****
#!/usr/bin/env python

'''
CVS-EE-MR-ADC(2) calculations for N2
'''

import pyscf.gto
import pyscf.scf
import pyscf.mcscf
import prism_beta.interface
import prism_beta.mr_adc

mol = pyscf.gto.Mole()
r = 1.098
mol.atom = [
    ['N', ( 0., 0.    , -r/2)],
    ['N', ( 0., 0.    ,  r/2)],]
mol.basis = {'N':'aug-cc-pvdz'}
mol.verbose = 4
mol.build()

# RHF calculation as guess for CASSCF
mf = pyscf.scf.RHF(mol)
mf.kernel()

# CASSCF(6e,6o) calculation
mc = pyscf.mcscf.CASSCF(mf, 6, 6)
emc = mc.mc1step()[0]

# CVS-IP-MR-ADC calculation
interface = prism_beta.interface.PYSCF(mf, mc, opt_einsum = True)
mr_adc = prism_beta.mr_adc.MRADC(interface)
mr_adc.method_type = "cvs-ee"
mr_adc.method = "mr-adc(1)"
mr_adc.ncvs = 2
mr_adc.nroots = 8

e, p = mr_adc.kernel()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='asccbc-01181202.asc.ohio-state.edu', release='4.18.0-425.19.2.el8_7.x86_64', version='#1 SMP Fri Mar 17 01:52:38 EDT 2023', machine='x86_64')  Threads 24
Python 3.9.13 (main, Oct 13 2022, 21:15:33) 
[GCC 11.2.0]
numpy 1.23.3  scipy 1.9.1
Date: Wed May 31 14:47:23 2023
PySCF version 2.2.1
PySCF path  /home/cbc-sokolov-group/python-packages/pyscf-2.2.1/pyscf

[ENV] PYSCF_TMPDIR /scratch/local/mazin.3
[ENV] PYSCF_EXT_PATH /home/cbc-sokolov-group/pyscf/intel/17.1/1.5
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 N      0.000000000000   0.000000000000  -0.549000000000 AA    0.000000000000   0.000000000000  -1.037459642386 Bohr   0.0
[INPUT]  2 N      0.000000000000   0.000000000000   0.549000000000 AA    0.000000000000   0.000000000000   1.037459642386 Bohr   0.0

nuclear repulsion = 23.6153764436066
number of shells = 16
number of NR pGTOs = 70
number of NR cGTOs = 46
basis = {'N': 'aug-cc-pvdz'}
ecp = {}
CPU time:         1.46


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/mazin.3/tmpoonzwb7o
max_memory 4000 MB (current use 302 MB)
Set gradient conv threshold to 3.16228e-05
init E= -108.997365976287
  HOMO = -0.383394863650678  LUMO = 0.0527605148347101
cycle= 1 E= -108.938371912804  delta_E= 0.059  |g|= 0.292  |ddm|= 1.69
  HOMO = -0.667440590652658  LUMO = 0.0959074131140653
cycle= 2 E= -108.959124150663  delta_E= -0.0208  |g|= 0.0773  |ddm|= 0.446
  HOMO = -0.614135902462253  LUMO = 0.103850078544987
cycle= 3 E= -108.96052045917  delta_E= -0.0014  |g|= 0.0147  |ddm|= 0.0743
  HOMO = -0.615371970638072  LUMO = 0.103817157894297
cycle= 4 E= -108.960607977205  delta_E= -8.75e-05  |g|= 0.00121  |ddm|= 0.0563
  HOMO = -0.615311473909281  LUMO = 0.103828098399862
cycle= 5 E= -108.960608490355  delta_E= -5.13e-07  |g|= 0.000172  |ddm|= 0.00327
  HOMO = -0.615315360390591  LUMO = 0.10382213765279
cycle= 6 E= -108.960608506598  delta_E= -1.62e-08  |g|= 3.2e-05  |ddm|= 0.000482
  HOMO = -0.615307686837616  LUMO = 0.103821253143267
cycle= 7 E= -108.960608507242  delta_E= -6.44e-10  |g|= 3.01e-06  |ddm|= 0.000174
  HOMO = -0.615307964143228  LUMO = 0.103821216566111
Extra cycle  E= -108.960608507245  delta_E= -2.84e-12  |g|= 7.72e-07  |ddm|= 1.33e-05
converged SCF energy = -108.960608507245

******** <class 'pyscf.mcscf.mc1step.CASSCF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 36
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/mazin.3/tmpoonzwb7o
max_memory 4000 MB (current use 327 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1.FCISolver'> ********
max. cycles = 50
conv_tol = 1e-08
davidson only = False
linear dependence = 1e-12
level shift = 0.001
max iter space = 12
max_memory 4000 MB
nroots = 1
pspace_size = 400
spin = None
CASCI E = -108.978701814276  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -109.025328415053  dE = -4.66266008e-02  S^2 = 0.0000000
               |grad[o]|=0.0356  |grad[c]|=0.0475  |ddm|=0.0556  |maxRot[o]|=0.312
macro iter   2 ( 21 JK    4 micro), CASSCF E = -109.055267664405  dE = -2.99392494e-02  S^2 = 0.0000000
               |grad[o]|=0.0528  |grad[c]|=0.0387  |ddm|=0.0294  |maxRot[o]|=0.252
macro iter   3 ( 21 JK    4 micro), CASSCF E = -109.067395019207  dE = -1.21273548e-02  S^2 = 0.0000000
               |grad[o]|=0.0273  |grad[c]|=0.0402  |ddm|=0.00545  |maxRot[o]|=0.289
macro iter   4 ( 21 JK    4 micro), CASSCF E = -109.082700042110  dE = -1.53050229e-02  S^2 = 0.0000000
               |grad[o]|=0.0271  |grad[c]|=0.0392  |ddm|=0.00617  |maxRot[o]|=0.286
macro iter   5 ( 21 JK    4 micro), CASSCF E = -109.094608787554  dE = -1.19087454e-02  S^2 = 0.0000000
               |grad[o]|=0.0231  |grad[c]|=0.0315  |ddm|=0.0048  |maxRot[o]|=0.311
macro iter   6 ( 14 JK    4 micro), CASSCF E = -109.096203225402  dE = -1.59443785e-03  S^2 = 0.0000000
               |grad[o]|=0.0119  |grad[c]|=0.00237  |ddm|=0.00202  |maxRot[o]|=0.152
macro iter   7 (  5 JK    2 micro), CASSCF E = -109.096203343896  dE = -1.18493190e-07  S^2 = 0.0000000
               |grad[o]|=0.000521  |grad[c]|=2.95e-05  |ddm|=1.96e-05  |maxRot[o]|=0.000336
macro iter   8 (  1 JK    1 micro), CASSCF E = -109.096203343914  dE = -1.85025328e-11  S^2 = 0.0000000
               |grad[o]|=1.04e-05  |grad[c]|=6.84e-06  |ddm|=1.13e-06  |maxRot[o]|=    0
1-step CASSCF converged in   8 macro (125 JK  27 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.98235422 1.94163504 1.94163504 0.01782617 0.05827477 0.05827477]
CASSCF energy = -109.096203343914
CASCI E = -109.096203343914  E(CI) = -13.6479640279929  S^2 = 0.0000000

--------------------------------------------------------------
    PRISM: Open-Source implementation of ab initio methods
            for excited states and spectroscopy

                       Version 0.1

           Copyright (C) 2019  Alexander Sokolov

    This program is distributed in the hope that it will
    be useful, but WITHOUT ANY WARRANTY; without even the
    implied warranty of MERCHANTABILITY or FITNESS FOR A
    PARTICULAR PURPOSE. See the GNU General Public License
    for more details.
--------------------------------------------------------------

Importing Pyscf objects...

Initializing MR-ADC...

Transforming integrals to spin-orbital basis...

Transforming dipole moments to spin-orbital basis...

Time for transforming integrals:                  0.194647 sec

Computing ground-state RDMs in the spin-orbital basis...

Computing excited-state CASCI wavefunctions...

Requested method type cvs-ee does not require running a CASCI calculation...
Skipping the CASCI calculation...

Final number of excited CASCI states: 0

Time for computing RDMs:                          1.333696 sec

Computing MR-ADC excitation energies...

Method:                                           cvs-ee-mr-adc(1)
Maximum order of T amplitudes:                    1
Number of MR-ADC roots requested:                 8
Ground-state active-space energy:               -13.647964027993
Nuclear repulsion energy:                        23.615376443607
Number of basis functions:                        46
Number of core orbitals:                          4
Number of active orbitals:                        6
Number of external orbitals:                      36
Number of electrons:                              14
Number of active electrons:                       (3, 3)
Number of CVS orbitals:                           2
Number of valence (non-CVS) orbitals:             2
Overlap truncation parameter (singles):           1.000000e-06
Overlap truncation parameter (doubles):           1.000000e-10
Number of CASCI states:                           0

Computing T[0']^(1) amplitudes...
Dimension of the [0'] orthonormalized subspace:   140
Smallest eigenvalue of the [0'] overlap metric:   5.434461e-05
Norm of T[0']^(1):                                0.290087806140
Correlation energy [0']:                         -0.057711053997

Computing T[+1']^(1) amplitudes...
Dimension of the [+1'] orthonormalized subspace:  690
Smallest eigenvalue of the [+1'] overlap metric:  1.055589e-06
Norm of T[+1']^(1):                               0.121010342524
Correlation energy [+1']:                        -0.001966710619

Computing T[-1']^(1) amplitudes...
Dimension of the [-1'] orthonormalized subspace:  692
Smallest eigenvalue of the [-1'] overlap metric:  1.063371e-06
Norm of T[-1']^(1):                               0.584944459746
Correlation energy [-1']:                        -0.007007118263

Computing T[0]^(1) amplitudes...
Norm of T[0]^(1):                                 0.126952202392
Correlation energy [0]:                          -0.018703321954

Computing T[+1]^(1) amplitudes...
Dimension of the [+1] orthonormalized subspace:   12
Smallest eigenvalue of the [+1] overlap metric:   8.822892e-03
Norm of T[+1]^(1):                                0.065844006424
Correlation energy [+1]:                         -0.006871260173

Computing T[-1]^(1) amplitudes...
Dimension of the [-1] orthonormalized subspace:   12
Smallest eigenvalue of the [-1] overlap metric:   8.913086e-03
Norm of T[-1]^(1):                                0.154383160400
Correlation energy [-1]:                         -0.025992067125

Computing T[+2]^(1) amplitudes...
Dimension of the [+2] orthonormalized subspace:   66
Smallest eigenvalue of the [+2] overlap metric:   7.458040e-05
Norm of T[+2]^(1):                                0.123120480218
Correlation energy [+2]:                         -0.005328327740

Computing T[-2]^(1) amplitudes...
Dimension of the [-2] orthonormalized subspace:   66
Smallest eigenvalue of the [-2] overlap metric:   7.635037e-05
Norm of T[-2]^(1):                                0.295599307988
Correlation energy [-2]:                         -0.043298759323

CASSCF reference energy:                        -109.096203343914
PC-NEVPT2 correlation energy:                     -0.166878619193
Total PC-NEVPT2 energy:                         -109.263081963107

Time for computing amplitudes:                    6.836719 sec

Dimension of h0 excitation manifold:              336
Total dimension of the excitation manifold:       336
Dim. of orthogonalized excitation manifold:       336

Computing M(h0-h0) block...

Time for computing M(h0-h0) block:                0.012175 sec

Norm of M:                                        291.236307
Norm of M - M.T:                                  3.42391e-08

Computing pre-conditioner...
Time for computing pre-conditioner:               0.000305 sec

tol 1e-12  toloose 1e-05
max_cycle 80  max_space 228  max_memory 2000  incore True
davidson 0 8  |r|= 0.554  e= [15.20901635 15.20901635 15.20901636 15.20901636 15.2119187  15.2119187
 15.21191871 15.21191871]  max|de|= 15.2  lindep= 0.82
Old state -> New state
    3     ->     2 
    2     ->     3 
    7     ->     5 
    5     ->     7 
davidson 1 16  |r|= 0.0498  e= [14.98018883 14.98018889 14.98018896 14.98018896 14.98342504 14.98342508
 14.98342516 14.98342518]  max|de|= -0.229  lindep= 0.993
Old state -> New state
    3     ->     2 
    2     ->     3 
davidson 2 24  |r|= 0.00811  e= [14.97781762 14.97781766 14.97781769 14.97781772 14.98106136 14.98106137
 14.98106143 14.98106147]  max|de|= -0.00237  lindep= 0.991
davidson 3 32  |r|= 0.000872  e= [14.97776157 14.97776161 14.97776165 14.97776167 14.98100435 14.98100437
 14.98100443 14.98100447]  max|de|= -5.7e-05  lindep= 0.998
davidson 4 40  |r|= 0.000136  e= [14.97776099 14.97776102 14.97776106 14.97776108 14.98100375 14.98100377
 14.98100383 14.98100387]  max|de|= -6.01e-07  lindep= 0.973
davidson 5 48  |r|= 2.32e-05  e= [14.97776098 14.97776101 14.97776105 14.97776108 14.98100375 14.98100376
 14.98100382 14.98100387]  max|de|= -1.1e-08  lindep= 0.915
davidson 6 56  |r|= 2.09e-06  e= [14.97776098 14.97776101 14.97776105 14.97776108 14.98100375 14.98100376
 14.98100382 14.98100387]  max|de|= -2.69e-10  lindep= 0.847
root 7 converged  |r|= 5.02e-07  e= 14.981003865476394  max|de|= -7.14e-13
davidson 7 64  |r|= 1.86e-06  e= [14.97776098 14.97776101 14.97776105 14.97776108 14.98100375 14.98100376
 14.98100382 14.98100387]  max|de|= -6.82e-12  lindep= 0.767
davidson 8 71  |r|= 1.32e-06  e= [14.97776098 14.97776101 14.97776105 14.97776108 14.98100375 14.98100376
 14.98100382 14.98100387]  max|de|= -1.76e-11  lindep= 0.834
Old state -> New state
    0     ->     4 
    1     ->     5 
    4     ->     6 
    5     ->     7 
davidson 9 79  |r|= 0.0366  e= [14.97776098 14.97776101 14.97776105 14.97776108 14.97776802 14.97856956
 14.98100375 14.98100376]  max|de|= 0.000809  lindep= 0.85
Old state -> New state
    3     ->     2 
    2     ->     3 
davidson 10 87  |r|= 0.00335  e= [14.97776089 14.97776101 14.97776104 14.97776105 14.97776116 14.9777702
 14.98100366 14.98100376]  max|de|= -0.000799  lindep= 0.908
Old state -> New state
    5     ->     1 
    5     ->     4 
    4     ->     5 
davidson 11 95  |r|= 0.000184  e= [14.97776088 14.97776095 14.97776103 14.97776104 14.9777611  14.97776118
 14.98100365 14.98100376]  max|de|= -9.25e-06  lindep= 0.902
davidson 12 103  |r|= 0.000174  e= [14.97776088 14.97776092 14.97776103 14.97776104 14.97776109 14.97776117
 14.98100365 14.98100371]  max|de|= -5.14e-08  lindep= 0.733
root 0 converged  |r|= 1.14e-06  e= 14.977760883946825  max|de|= -8.38e-13
root 3 converged  |r|= 6.65e-07  e= 14.977761040007742  max|de|= -3.13e-13
root 4 converged  |r|= 2.7e-07  e= 14.977761086231629  max|de|= -5.92e-13
root 5 converged  |r|= 4.91e-07  e= 14.977761172802897  max|de|= -4.44e-13
davidson 13 111  |r|= 7.48e-06  e= [14.97776088 14.97776092 14.97776103 14.97776104 14.97776109 14.97776117
 14.98100365 14.98100368]  max|de|= -3.14e-08  lindep= 0.164
root 6 converged  |r|= 3.61e-08  e= 14.981003651394003  max|de|= -1.95e-14
davidson 14 115  |r|= 8.37e-06  e= [14.97776088 14.97776092 14.97776103 14.97776104 14.97776109 14.97776117
 14.98100365 14.98100368]  max|de|= -5.69e-11  lindep= 0.0707
root 7 converged  |r|= 8.4e-08  e= 14.981003676017654  max|de|= -4.62e-14
davidson 15 121  |r|= 0.000119  e= [14.97776088 14.97776091 14.97776102 14.97776104 14.97776109 14.97776117
 14.98100365 14.98100368]  max|de|= -1.02e-08  lindep= 0.0433
Old state -> New state
    2     ->     0 
    0     ->     1 
    4     ->     2 
    2     ->     3 
    3     ->     4 
davidson 16 127  |r|= 0.00202  e= [14.97775819 14.97776088 14.9777609  14.97776098 14.97776105 14.97776114
 14.98100365 14.98100368]  max|de|= -2.83e-06  lindep= 0.132
Old state -> New state
    2     ->     1 
    1     ->     2 
davidson 17 133  |r|= 0.0229  e= [14.97743751 14.97775209 14.97775993 14.97776096 14.97776104 14.97776107
 14.98100365 14.98100368]  max|de|= -0.000321  lindep= 0.15
Old state -> New state
    3     ->     4 
davidson 18 140  |r|= 0.133  e= [14.9696942  14.97720681 14.97773122 14.9777601  14.97776101 14.97776105
 14.98100365 14.98100368]  max|de|= -0.00774  lindep= 0.172
davidson 19 148  |r|= 3.24  e= [12.52008422 14.69543031 14.97627532 14.97771733 14.977761   14.97776105
 14.98100365 14.98100368]  max|de|= -2.45  lindep= 0.166
davidson 20 156  |r|= 4.88  e= [ 0.61167358  1.79908992 14.90016101 14.97700776 14.977761   14.97776105
 14.98100365 14.98100368]  max|de|= -12.9  lindep=  0.3
davidson 21 164  |r|= 5.95  e= [6.47577218e-05 1.41017593e-04 8.31844264e+00 1.49571150e+01
 1.49777610e+01 1.49777611e+01 1.49810037e+01 1.49810037e+01]  max|de|= -6.58  lindep= 0.271
davidson 22 172  |r|= 2.37  e= [3.80454258e-09 2.29443077e-08 3.28639824e-03 1.35918751e+01
 1.49777610e+01 1.49777611e+01 1.49810037e+01 1.49810037e+01]  max|de|= -8.32  lindep= 0.139
davidson 23 180  |r|= 2.28  e= [-2.83521704e-09  8.20394930e-09  2.77667041e-07  3.23238793e-01
  1.49777610e+01  1.49777611e+01  1.49810036e+01  1.49810037e+01]  max|de|= -13.3  lindep= 0.0165
Old state -> New state
    2     ->     1 
    1     ->     2 
davidson 24 188  |r|= 0.0211  e= [-4.22779668e-09 -1.07843264e-09  8.67211346e-09  2.67605726e-05
  1.49777610e+01  1.49777610e+01  1.49810036e+01  1.49810037e+01]  max|de|= -0.323  lindep= 0.00775
Old state -> New state
    3     ->     0 
    0     ->     1 
    1     ->     2 
    2     ->     3 
    7     ->     6 
    6     ->     7 
davidson 25 196  |r|= 0.0515  e= [-6.42136385e-09 -3.29949223e-09  1.92655094e-09  1.06147612e-08
  1.49777447e+01  1.49777610e+01  1.49807016e+01  1.49810036e+01]  max|de|= -0.000302  lindep= 0.0014
Old state -> New state
    6     ->     4 
    4     ->     6 
davidson 26 204  |r|= 2.47  e= [-7.60321475e-09 -3.53240074e-09  1.21255456e-09  1.02702896e-08
  1.36628357e+01  1.49777610e+01  1.49778512e+01  1.49810036e+01]  max|de|= -1.32  lindep= 0.00111
root 0 converged  |r|= 6.91e-08  e= -7.603315023698051e-09  max|de|= -1e-13
root 1 converged  |r|= 2.34e-07  e= -3.532412624985077e-09  max|de|= -1.19e-14
root 2 converged  |r|= 2.34e-08  e= 1.2124544512272826e-09  max|de|= -1e-13
root 3 converged  |r|= 5.52e-08  e= 1.0270243958064627e-08  max|de|= -4.56e-14
davidson 27 212  |r|= 0.486  e= [-7.60331502e-09 -3.53241262e-09  1.21245445e-09  1.02702440e-08
  1.44428616e-02  1.49777610e+01  1.49778462e+01  1.49810036e+01]  max|de|= -13.6  lindep= 0.00233
davidson 28 216  |r|= 0.00758  e= [-7.60585192e-09 -3.57055966e-09  1.21244249e-09  1.02692987e-08
  1.21628979e-06  1.49777610e+01  1.49778462e+01  1.49810036e+01]  max|de|= -0.0144  lindep= 0.0061
Old state -> New state
    0     ->     1 
    4     ->     3 
    3     ->     4 
davidson 29 222  |r|= 0.00759  e= [-8.95478676e-09 -6.95161744e-09  1.21205660e-09  6.53298684e-09
  1.04994323e-08  1.49777610e+01  1.49778462e+01  1.49810036e+01]  max|de|= -1.21e-06  lindep= 0.0105

WARN: QR decomposition removed 4 vectors.  The davidson may fail.

Number of roots different from the previous step (4,8)
davidson 30 4  |r|= 0.824  e= [14.97776104 14.97783859 14.98100351 16.32433877]  max|de|= 16.3  lindep= 0.903
Old state -> New state
    3     ->     4 
    3     ->     5 
    3     ->     6 
    3     ->     7 
davidson 31 8  |r|= 0.885  e= [14.97776101 14.97779227 14.98100262 15.6669856  15.79714099 15.92125837
 15.95949431 17.11370625]  max|de|= 0.789  lindep= 0.871
Old state -> New state
    4     ->     3 
    5     ->     4 
    3     ->     6 
    6     ->     7 
davidson 32 16  |r|= 0.574  e= [14.97776101 14.97778478 14.9810025  15.13468952 15.20981013 15.45918449
 15.53325531 15.57882151]  max|de|= -0.711  lindep= 0.817
Old state -> New state
    4     ->     3 
    3     ->     4 
    5     ->     7 
davidson 33 24  |r|= 0.62  e= [14.97776101 14.97777003 14.98100173 14.99219397 15.00999491 15.01833847
 15.10456614 15.40586646]  max|de|= -0.441  lindep= 0.783
Old state -> New state
    3     ->     2 
    2     ->     3 
    5     ->     4 
    6     ->     5 
    4     ->     6 
davidson 34 32  |r|= 0.136  e= [14.97776101 14.97776253 14.97886971 14.98100439 14.99348533 14.99720201
 15.00438827 15.01226783]  max|de|= -0.394  lindep= 0.838
Old state -> New state
    4     ->     3 
    3     ->     4 
davidson 35 40  |r|= 0.0426  e= [14.97776101 14.97776144 14.97786395 14.97937104 14.98100373 14.99176717
 15.00397361 15.00416555]  max|de|= -0.0141  lindep= 0.814
davidson 36 48  |r|= 0.027  e= [14.97776101 14.97776137 14.97778085 14.97794954 14.98100367 14.99021087
 15.00374868 15.00397201]  max|de|= -0.00156  lindep= 0.811
Old state -> New state
    5     ->     4 
    4     ->     5 
    5     ->     6 
    6     ->     7 
davidson 37 56  |r|= 0.117  e= [14.97776101 14.97776122 14.97776355 14.97780449 14.97971872 14.98100366
 14.98732145 15.00103179]  max|de|= -0.0105  lindep= 0.874
Old state -> New state
    4     ->     5 
    5     ->     6 
    6     ->     7 
davidson 38 64  |r|= 0.0336  e= [14.97776098 14.97776106 14.97776127 14.97776593 14.97817646 14.97925442
 14.98100365 14.98194226]  max|de|= -0.00538  lindep= 0.936
davidson 39 72  |r|= 0.0146  e= [14.97776091 14.97776104 14.97776109 14.97776134 14.97778033 14.97801044
 14.98100365 14.98104048]  max|de|= -0.00124  lindep= 0.937
Old state -> New state
    3     ->     1 
    1     ->     2 
    2     ->     3 
davidson 40 80  |r|= 0.00391  e= [14.9777609  14.97776102 14.97776104 14.97776111 14.97776654 14.97778034
 14.98100365 14.98100563]  max|de|= -0.00023  lindep= 0.937
davidson 41 88  |r|= 0.000841  e= [14.9777609  14.97776101 14.97776104 14.9777611  14.97776171 14.97776984
 14.98100365 14.98100387]  max|de|= -1.05e-05  lindep= 0.89
davidson 42 96  |r|= 0.00171  e= [14.9777609  14.97776101 14.97776104 14.9777611  14.97776149 14.97776401
 14.98100365 14.98100374]  max|de|= -5.83e-06  lindep= 0.831
Old state -> New state
    5     ->     4 
    4     ->     5 
davidson 43 104  |r|= 0.000402  e= [14.9777609  14.97776101 14.97776104 14.97776108 14.97776121 14.97776133
 14.98100364 14.98100371]  max|de|= -2.8e-06  lindep= 0.956
Old state -> New state
    5     ->     1 
    1     ->     2 
    2     ->     3 
    3     ->     4 
    4     ->     5 
davidson 44 112  |r|= 0.000105  e= [14.97776088 14.97776095 14.97776102 14.97776104 14.97776109 14.97776116
 14.98100364 14.9810037 ]  max|de|= -3.86e-07  lindep= 0.969
davidson 45 120  |r|= 5.57e-05  e= [14.97776088 14.97776094 14.97776101 14.97776104 14.97776109 14.97776115
 14.98100364 14.9810037 ]  max|de|= -9.69e-09  lindep= 0.962
davidson 46 128  |r|= 3.88e-05  e= [14.97776088 14.97776094 14.97776101 14.97776104 14.97776109 14.97776115
 14.98100364 14.98100369]  max|de|= -7.11e-09  lindep= 0.934
root 2 converged  |r|= 4.25e-07  e= 14.977761014526235  max|de|= -2.43e-13
root 3 converged  |r|= 1.46e-07  e= 14.977761038399448  max|de|= -2.84e-13
root 5 converged  |r|= 4.38e-07  e= 14.97776115423394  max|de|= -3.8e-13
davidson 47 136  |r|= 6.29e-06  e= [14.97776088 14.97776094 14.97776101 14.97776104 14.97776109 14.97776115
 14.98100364 14.98100369]  max|de|= -1.65e-09  lindep= 0.139
davidson 48 141  |r|= 1.01e-05  e= [14.97776088 14.97776094 14.97776101 14.97776104 14.97776109 14.97776115
 14.98100364 14.98100369]  max|de|= -7.11e-11  lindep= 0.0711
davidson 49 148  |r|= 0.000191  e= [14.97776088 14.97776093 14.97776101 14.97776104 14.97776107 14.97776115
 14.98100362 14.98100368]  max|de|= -2.16e-08  lindep= 0.0854
Old state -> New state
    4     ->     0 
    0     ->     1 
    1     ->     2 
    2     ->     3 
    3     ->     4 
davidson 50 156  |r|= 0.00299  e= [14.97775602 14.97776088 14.97776096 14.97776102 14.97776104 14.97776115
 14.98099767 14.98100368]  max|de|= -5.95e-06  lindep= 0.0648
davidson 51 164  |r|= 0.0664  e= [14.9755797  14.97776088 14.97776096 14.97776102 14.97776104 14.97776115
 14.97994287 14.98100368]  max|de|= -0.00218  lindep= 0.0548
root 1 converged  |r|= 5.44e-07  e= 14.977760879591644  max|de|= -4.01e-13
root 4 converged  |r|= 1.48e-07  e= 14.977761039075288  max|de|= -7.82e-14
davidson 52 172  |r|= 3.91  e= [11.66613496 14.97776088 14.97776096 14.97776102 14.97776104 14.97776115
 14.97917899 14.98100368]  max|de|= -3.31  lindep= 0.196
davidson 53 178  |r|= 0.814  e= [ 0.03943319 14.97776088 14.97776096 14.97776102 14.97776104 14.97776115
 14.97917526 14.98100367]  max|de|= -11.6  lindep= 0.106
davidson 54 185  |r|= 0.00604  e= [1.90599518e-06 1.49777609e+01 1.49777610e+01 1.49777610e+01
 1.49777610e+01 1.49777611e+01 1.49791750e+01 1.49810037e+01]  max|de|= -0.0394  lindep= 0.0353
davidson 55 193  |r|= 0.00606  e= [1.08646248e-09 1.49777609e+01 1.49777609e+01 1.49777610e+01
 1.49777610e+01 1.49777611e+01 1.49791748e+01 1.49810028e+01]  max|de|= -1.9e-06  lindep= 0.0207
Old state -> New state
    2     ->     1 
    1     ->     2 
davidson 56 201  |r|= 0.00901  e= [1.02816955e-09 1.49777597e+01 1.49777609e+01 1.49777610e+01
 1.49777610e+01 1.49777611e+01 1.49791702e+01 1.49809591e+01]  max|de|= -4.37e-05  lindep= 0.135
Old state -> New state
    7     ->     1 
    1     ->     6 
    6     ->     7 
root 0 converged  |r|= 3.66e-08  e= 1.0282121820637258e-09  max|de|= 4.26e-14
davidson 57 209  |r|= 0.0974  e= [1.02821218e-09 1.49752161e+01 1.49777609e+01 1.49777610e+01
 1.49777610e+01 1.49777611e+01 1.49779035e+01 1.49794289e+01]  max|de|= -0.00574  lindep= 0.244
davidson 58 216  |r|=  2.3  e= [1.02818376e-09 1.37596263e+01 1.49777609e+01 1.49777610e+01
 1.49777610e+01 1.49777611e+01 1.49778300e+01 1.49793490e+01]  max|de|= -1.22  lindep= 0.0566
davidson 59 223  |r|= 5.04  e= [1.02819087e-09 1.97693521e+00 1.49777605e+01 1.49777609e+01
 1.49777610e+01 1.49777611e+01 1.49778291e+01 1.49793481e+01]  max|de|= -11.8  lindep= 0.034

WARN: QR decomposition removed 1 vectors.  The davidson may fail.

Number of roots different from the previous step (7,8)
davidson 60 7  |r|= 0.859  e= [14.97776093 14.97776103 14.97776111 14.9777615  14.97782994 14.97934283
 16.53475207]  max|de|= 16.5  lindep= 0.915
Old state -> New state
    3     ->     2 
    2     ->     3 
    6     ->     7 
davidson 61 14  |r|= 0.629  e= [14.97776088 14.977761   14.97776105 14.97776113 14.9778275  14.97928874
 15.33945678 15.55602221]  max|de|= -1.2  lindep= 0.877
davidson 62 22  |r|= 0.34  e= [14.97776088 14.977761   14.97776104 14.97776113 14.97781609 14.97925
 14.99831153 15.08188652]  max|de|= -0.474  lindep= 0.854
davidson 63 30  |r|= 0.0559  e= [14.97776088 14.977761   14.97776104 14.97776113 14.9777844  14.97874723
 14.9829584  14.98471478]  max|de|= -0.0972  lindep= 0.884
davidson 64 38  |r|= 0.0231  e= [14.97776088 14.977761   14.97776104 14.97776113 14.9777709  14.97837265
 14.98166531 14.98244938]  max|de|= -0.00227  lindep= 0.836
davidson 65 46  |r|= 0.0142  e= [14.97776088 14.977761   14.97776104 14.97776113 14.97776672 14.97815784
 14.981291   14.98170003]  max|de|= -0.000749  lindep= 0.855
davidson 66 54  |r|= 0.0132  e= [14.97776088 14.977761   14.97776104 14.97776113 14.97776329 14.97799214
 14.98106594 14.98137177]  max|de|= -0.000328  lindep= 0.862
davidson 67 62  |r|= 0.00597  e= [14.97776088 14.977761   14.97776104 14.97776113 14.97776176 14.97779524
 14.98100812 14.98103653]  max|de|= -0.000335  lindep= 0.921
davidson 68 70  |r|= 0.00154  e= [14.97776088 14.97776099 14.97776104 14.9777611  14.97776121 14.97776646
 14.98100406 14.98100521]  max|de|= -3.13e-05  lindep= 0.889
Old state -> New state
    3     ->     2 
    2     ->     3 
davidson 69 78  |r|= 0.00113  e= [14.97776088 14.97776097 14.97776104 14.97776105 14.97776115 14.9777626
 14.98100375 14.9810039 ]  max|de|= -3.86e-06  lindep= 0.931
Old state -> New state
    5     ->     4 
    4     ->     5 
davidson 70 86  |r|= 0.000163  e= [14.97776088 14.97776093 14.97776103 14.97776105 14.97776111 14.97776117
 14.98100369 14.98100377]  max|de|= -1.49e-06  lindep= 0.957
davidson 71 94  |r|= 0.000102  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100367 14.98100371]  max|de|= -6.29e-08  lindep= 0.967
davidson 72 102  |r|= 6.98e-05  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100365 14.98100369]  max|de|= -2.49e-08  lindep= 0.94
root 0 converged  |r|= 1.59e-07  e= 14.977760876129365  max|de|= -8.46e-13
root 3 converged  |r|= 5.94e-08  e= 14.977761045182511  max|de|= -4.09e-14
davidson 73 110  |r|= 2.15e-05  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100364 14.98100369]  max|de|= -6.43e-09  lindep= 0.818
root 1 converged  |r|= 4.55e-07  e= 14.97776092325975  max|de|= -3.62e-13
root 2 converged  |r|= 6.03e-07  e= 14.97776102803543  max|de|= -3.23e-13
root 4 converged  |r|= 3.41e-07  e= 14.977761090096752  max|de|= -4.23e-13
root 5 converged  |r|= 2.04e-07  e= 14.977761164314746  max|de|= -1.23e-13
davidson 74 116  |r|= 2.78e-06  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100364 14.98100369]  max|de|= -3.68e-10  lindep= 0.967
davidson 75 118  |r|= 6.14e-07  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100364 14.98100369]  max|de|= -6.13e-12  lindep= 0.792
root 6 converged  |r|= 4.87e-07  e= 14.981003639616544  max|de|= -3.8e-13
root 7 converged  |r|= 4.32e-07  e= 14.98100369142683  max|de|= -3.18e-13
converged 76 120  |r|= 1.04e-06  e= [14.97776088 14.97776092 14.97776103 14.97776105 14.97776109 14.97776116
 14.98100364 14.98100369]  max|de|= -5.67e-13

cvs-ee-mr-adc(1) excitation energies (a.u.):
[[14.97776088]
 [14.97776092]
 [14.97776103]
 [14.97776105]
 [14.97776109]
 [14.97776116]
 [14.98100364]
 [14.98100369]]

cvs-ee-mr-adc(1) excitation energies (eV):
[[407.5658423 ]
 [407.56584359]
 [407.56584644]
 [407.5658469 ]
 [407.56584813]
 [407.56585015]
 [407.65408244]
 [407.65408385]]

Computing transition moments matrix...

cvs-ee-mr-adc(1) spectroscopic intensity:
[[3.61750248e-14]
 [5.82462791e-14]
 [2.22292215e-13]
 [1.27304916e-13]
 [1.92198263e-15]
 [7.61242339e-16]
 [1.37797138e-15]
 [8.72961352e-17]]

cvs-ee-mr-adc(1) oscillator strength:
[[3.61213914e-13]
 [5.81599229e-13]
 [2.21962645e-12]
 [1.27116174e-12]
 [1.91913311e-14]
 [7.60113729e-15]
 [1.37622628e-14]
 [8.71855816e-16]]
Time for computing transition moments matrix:     0.012897 sec


Total time:                                       7.978084 sec
