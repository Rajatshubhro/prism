# Copyright 2023 Prism Developers. All Rights Reserved.
#
# Licensed under the GNU General Public License v3.0;
# you may not use this file except in compliance with the License.
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
# either express or implied.
#
# See the License file for the specific language governing
# permissions and limitations.
#
# Available at https://github.com/sokolov-group/prism
#
# Authors: Alexander Yu. Sokolov <alexander.y.sokolov@gmail.com>
#          Carlos E. V. de Moura <carlosevmoura@gmail.com>
#                  Ilia M. Mazin <ilia.mazin@gmail.com>
#              Donna H. Odhiambo <odhiambo.donna@gmail.com>
#

import sys
import time
import numpy as np
import prism.mr_adc_overlap as mr_adc_overlap
import prism.mr_adc_integrals as mr_adc_integrals

def compute_excitation_manifolds(mr_adc):

    # MR-ADC(0) and MR-ADC(1)
    mr_adc.h0.n_ce = mr_adc.ncvs * mr_adc.nextern
    mr_adc.h0.n_ca = mr_adc.ncvs * mr_adc.ncas

    ## Zeroth-order manifold
    mr_adc.h0.dim_ce = 2 * mr_adc.h0.n_ce
    mr_adc.h0.dim_ca = 2 * mr_adc.h0.n_ca
    mr_adc.h0.dim = mr_adc.h0.dim_ce + mr_adc.h0.dim_ca

    mr_adc.h0.s_ce_aa = 0
    mr_adc.h0.f_ce_aa = mr_adc.h0.s_ce_aa + mr_adc.h0.n_ce
    mr_adc.h0.s_ce_bb = mr_adc.h0.f_ce_aa
    mr_adc.h0.f_ce_bb = mr_adc.h0.s_ce_bb + mr_adc.h0.n_ce
    mr_adc.h0.s_ca_aa = mr_adc.h0.f_ce_bb
    mr_adc.h0.f_ca_aa = mr_adc.h0.s_ca_aa + mr_adc.h0.n_ca
    mr_adc.h0.s_ca_bb = mr_adc.h0.f_ca_aa
    mr_adc.h0.f_ca_bb = mr_adc.h0.s_ca_bb + mr_adc.h0.n_ca

    print("Dimension of h0 excitation manifold:               %d" % mr_adc.h0.dim)

    # Orthogonalized zeroth-order manifold
    mr_adc.S12.ca = mr_adc_overlap.compute_S12_p1(mr_adc, ignore_print = True)

    mr_adc.h_orth.n_ce_caea = mr_adc.h0.n_ce
    mr_adc.h_orth.n_ca_caaa = mr_adc.ncvs * mr_adc.S12.ca.shape[1]

    mr_adc.h_orth.dim_ce_caea = 2 * mr_adc.h_orth.n_ce_caea  
    mr_adc.h_orth.dim_ca_caaa = 2 * mr_adc.h_orth.n_ca_caaa 
    mr_adc.h_orth.dim = mr_adc.h_orth.dim_ce_caea + mr_adc.h_orth.dim_ca_caaa 

    mr_adc.h_orth.s_ce_caea_aa = 0
    mr_adc.h_orth.f_ce_caea_aa = mr_adc.h_orth.s_ce_caea_aa + mr_adc.h_orth.n_ce_caea
    mr_adc.h_orth.s_ce_caea_bb = mr_adc.h_orth.f_ce_caea_aa
    mr_adc.h_orth.f_ce_caea_bb = mr_adc.h_orth.s_ce_caea_bb + mr_adc.h_orth.n_ce_caea
    mr_adc.h_orth.s_ca_caaa_aa = mr_adc.h_orth.f_ce_caea_bb
    mr_adc.h_orth.f_ca_caaa_aa = mr_adc.h_orth.s_ca_caaa_aa + mr_adc.h_orth.n_ca_caaa
    mr_adc.h_orth.s_ca_caaa_bb = mr_adc.h_orth.f_ca_caaa_aa
    mr_adc.h_orth.f_ca_caaa_bb = mr_adc.h_orth.s_ca_caaa_bb + mr_adc.h_orth.n_ca_caaa

    # MR-ADC(2) and MR-ADC(2)-X
    mr_adc.h1.dim = 0
    mr_adc.h_orth.dim = mr_adc.h0.dim

    if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x"):
        ## First-order manifold
        # double-core excitations
        mr_adc.h1.n_ccaa_tril = (mr_adc.ncvs * (mr_adc.ncvs - 1) // 2) * (mr_adc.ncas * (mr_adc.ncas - 1) // 2)
        mr_adc.h1.n_ccea_tril = (mr_adc.ncvs * (mr_adc.ncvs - 1) // 2) * mr_adc.ncas * mr_adc.nextern
        mr_adc.h1.n_ccee_tril = (mr_adc.ncvs * (mr_adc.ncvs - 1) // 2) * (mr_adc.nextern * (mr_adc.nextern - 1) // 2)
        mr_adc.h1.n_ccaa = mr_adc.ncvs * mr_adc.ncvs * mr_adc.ncas * mr_adc.ncas
        mr_adc.h1.n_ccea = mr_adc.ncvs * mr_adc.ncvs * mr_adc.nextern * mr_adc.ncas
        mr_adc.h1.n_ccee = mr_adc.ncvs * mr_adc.ncvs * mr_adc.nextern * mr_adc.nextern

        mr_adc.h1.dim_ccaa = mr_adc.h1.n_ccaa + 2 * mr_adc.h1.n_ccaa_tril
        mr_adc.h1.dim_ccea = mr_adc.h1.n_ccea + 2 * mr_adc.h1.n_ccea_tril
        mr_adc.h1.dim_ccee = mr_adc.h1.n_ccee + mr_adc.h1.n_ccee_tril

        if mr_adc.nval is not None:
            mr_adc.h1.n_cvaa = mr_adc.ncvs * mr_adc.nval * mr_adc.ncas * mr_adc.ncas
#            mr_adc.h1.n_cvaa_tril = (mr_adc.ncvs * mr_adc.nval) * (mr_adc.ncas * (mr_adc.ncas - 1) // 2)
            mr_adc.h1.n_cvea = (mr_adc.ncvs * mr_adc.nval) * mr_adc.ncas * mr_adc.nextern
            mr_adc.h1.n_cvee_tril = mr_adc.ncvs * mr_adc.nval * (mr_adc.nextern * (mr_adc.nextern - 1) // 2)
            mr_adc.h1.n_cvee = mr_adc.ncvs * mr_adc.nval * mr_adc.nextern * mr_adc.nextern 

            mr_adc.h1.dim_cvaa = 3 * mr_adc.h1.n_cvaa
            mr_adc.h1.dim_cvea = 3 * mr_adc.h1.n_cvea
            mr_adc.h1.dim_cvee = mr_adc.h1.n_cvee + mr_adc.h1.n_cvee_tril

        # single-core excitations
        mr_adc.h1.n_caee_tril = mr_adc.ncvs * mr_adc.ncas * (mr_adc.nextern * (mr_adc.nextern - 1) // 2)
        mr_adc.h1.n_caee = mr_adc.ncvs * mr_adc.ncas * mr_adc.nextern * mr_adc.nextern
        mr_adc.h1.n_caaa = mr_adc.ncvs * mr_adc.ncas * mr_adc.ncas * mr_adc.ncas
        mr_adc.h1.n_caea = mr_adc.ncvs * mr_adc.ncas * mr_adc.nextern * mr_adc.ncas

        mr_adc.h1.dim_caee = mr_adc.h1.n_caee + 2 * mr_adc.h1.n_caee_tril
        mr_adc.h1.dim_caaa = 3 * mr_adc.h1.n_caaa
        mr_adc.h1.dim_caea = 3 * mr_adc.h1.n_caea

        # Total dimension
        mr_adc.h1.dim    = mr_adc.h1.dim_ccaa + mr_adc.h1.dim_ccea + mr_adc.h1.dim_ccee + mr_adc.h1.dim_caee + mr_adc.h1.dim_caaa + mr_adc.h1.dim_caea
        if mr_adc.nval is not None:
            mr_adc.h1.dim    += mr_adc.h1.dim_cvaa + mr_adc.h1.dim_cvea + mr_adc.h1.dim_cvee

        ## Indices
        if mr_adc.nval is None:
            mr_adc.h1.s_ccaa = mr_adc.h0.dim
            mr_adc.h1.f_ccaa = mr_adc.h1.s_ccaa + mr_adc.h1.dim_ccaa
            mr_adc.h1.s_ccea = mr_adc.h1.f_ccaa
            mr_adc.h1.f_ccea = mr_adc.h1.s_ccea + mr_adc.h1.dim_ccea
            mr_adc.h1.s_ccee = mr_adc.h1.f_ccea
            mr_adc.h1.f_ccee = mr_adc.h1.s_ccee + mr_adc.h1.dim_ccee
            mr_adc.h1.s_caee = mr_adc.h1.f_ccee 
            mr_adc.h1.f_caee = mr_adc.h1.s_caee + mr_adc.h1.dim_caee
            mr_adc.h1.s_caaa = mr_adc.h1.f_caee
            mr_adc.h1.f_caaa = mr_adc.h1.s_caaa + mr_adc.h1.dim_caaa
            mr_adc.h1.s_caea = mr_adc.h1.f_caaa
            mr_adc.h1.f_caea = mr_adc.h1.s_caea + mr_adc.h1.dim_caea
        else:
            mr_adc.h1.s_ccaa = mr_adc.h0.dim
            mr_adc.h1.f_ccaa = mr_adc.h1.s_ccaa + mr_adc.h1.dim_ccaa
            mr_adc.h1.s_cvaa = mr_adc.h1.f_ccaa
            mr_adc.h1.f_cvaa = mr_adc.h1.s_cvaa + mr_adc.h1.dim_cvaa
            mr_adc.h1.s_ccea = mr_adc.h1.f_cvaa
            mr_adc.h1.f_ccea = mr_adc.h1.s_ccea + mr_adc.h1.dim_ccea
            mr_adc.h1.s_cvea = mr_adc.h1.f_ccea
            mr_adc.h1.f_cvea = mr_adc.h1.s_cvea + mr_adc.h1.dim_cvea
            mr_adc.h1.s_ccee = mr_adc.h1.f_cvea
            mr_adc.h1.f_ccee = mr_adc.h1.s_ccee + mr_adc.h1.dim_ccee
            mr_adc.h1.s_cvee = mr_adc.h1.f_ccee
            mr_adc.h1.f_cvee = mr_adc.h1.s_cvee + mr_adc.h1.dim_cvee
            mr_adc.h1.s_caee = mr_adc.h1.f_cvee 
            mr_adc.h1.f_caee = mr_adc.h1.s_caee + mr_adc.h1.dim_caee
            mr_adc.h1.s_caaa = mr_adc.h1.f_caee
            mr_adc.h1.f_caaa = mr_adc.h1.s_caaa + mr_adc.h1.dim_caaa
            mr_adc.h1.s_caea = mr_adc.h1.f_caaa
            mr_adc.h1.f_caea = mr_adc.h1.s_caea + mr_adc.h1.dim_caea
                   
        ## Spin-Case Indices
        # CCAA (CVAA)
        mr_adc.h1.s_ccaa__aaaa = mr_adc.h1.s_ccaa
        mr_adc.h1.f_ccaa__aaaa = mr_adc.h1.s_ccaa__aaaa + mr_adc.h1.n_ccaa_tril
        mr_adc.h1.s_ccaa__abab = mr_adc.h1.f_ccaa__aaaa
        mr_adc.h1.f_ccaa__abab = mr_adc.h1.s_ccaa__abab + mr_adc.h1.n_ccaa
        mr_adc.h1.s_ccaa__bbbb = mr_adc.h1.f_ccaa__abab
        mr_adc.h1.f_ccaa__bbbb = mr_adc.h1.s_ccaa__bbbb + mr_adc.h1.n_ccaa_tril
         
        if mr_adc.nval is not None:
            mr_adc.h1.s_cvaa__aaaa = mr_adc.h1.f_ccaa
            mr_adc.h1.f_cvaa__aaaa = mr_adc.h1.s_cvaa__aaaa + mr_adc.h1.n_cvaa
            mr_adc.h1.s_cvaa__abab = mr_adc.h1.f_cvaa__aaaa
            mr_adc.h1.f_cvaa__abab = mr_adc.h1.s_cvaa__abab + mr_adc.h1.n_cvaa
            mr_adc.h1.s_cvaa__bbbb = mr_adc.h1.f_cvaa__abab
            mr_adc.h1.f_cvaa__bbbb = mr_adc.h1.s_cvaa__bbbb + mr_adc.h1.n_cvaa

        # CCEA (CVEA)
        mr_adc.h1.s_ccea__aaaa = mr_adc.h1.s_ccea
        mr_adc.h1.f_ccea__aaaa = mr_adc.h1.s_ccea__aaaa + mr_adc.h1.n_ccea_tril
        mr_adc.h1.s_ccea__abab = mr_adc.h1.f_ccea__aaaa
        mr_adc.h1.f_ccea__abab = mr_adc.h1.s_ccea__abab + mr_adc.h1.n_ccea
        mr_adc.h1.s_ccea__bbbb = mr_adc.h1.s_ccea
        mr_adc.h1.f_ccea__bbbb = mr_adc.h1.s_ccea__bbbb + mr_adc.h1.n_ccea_tril
 
        if mr_adc.nval is not None:
            mr_adc.h1.s_cvea__aaaa = mr_adc.h1.s_cvea
            mr_adc.h1.f_cvea__aaaa = mr_adc.h1.s_cvea__aaaa + mr_adc.h1.n_cvea
            mr_adc.h1.s_cvea__abab = mr_adc.h1.f_cvea__aaaa
            mr_adc.h1.f_cvea__abab = mr_adc.h1.s_cvea__abab + mr_adc.h1.n_cvea
            mr_adc.h1.s_cvea__bbbb = mr_adc.h1.f_cvea__abab
            mr_adc.h1.f_cvea__bbbb = mr_adc.h1.s_cvea__bbbb + mr_adc.h1.n_cvea

        # CCEE (CVEE)
        mr_adc.h1.s_ccee__aaaa = mr_adc.h1.s_ccee
        mr_adc.h1.f_ccee__aaaa = mr_adc.h1.s_ccee__aaaa + mr_adc.h1.n_ccee_tril
        mr_adc.h1.s_ccee__abab = mr_adc.h1.f_ccee__aaaa
        mr_adc.h1.f_ccee__abab = mr_adc.h1.s_ccee__abab + mr_adc.h1.n_ccee

        if mr_adc.nval is not None:
            mr_adc.h1.s_cvee__aaaa = mr_adc.h1.s_cvee
            mr_adc.h1.f_cvee__aaaa = mr_adc.h1.s_cvee__aaaa + mr_adc.h1.n_cvee_tril
            mr_adc.h1.s_cvee__abab = mr_adc.h1.f_cvee__aaaa
            mr_adc.h1.f_cvee__abab = mr_adc.h1.s_cvee__abab + mr_adc.h1.n_cvee

        # CAEE  
        mr_adc.h1.s_caee__aaaa = mr_adc.h1.s_caee
        mr_adc.h1.f_caee__aaaa = mr_adc.h1.s_caee__aaaa + mr_adc.h1.n_caee_tril
        mr_adc.h1.s_caee__abab = mr_adc.h1.f_caee__aaaa
        mr_adc.h1.f_caee__abab = mr_adc.h1.s_caee__abab + mr_adc.h1.n_caee
        mr_adc.h1.s_caee__bbbb = mr_adc.h1.f_caee__abab
        mr_adc.h1.f_caee__bbbb = mr_adc.h1.s_caee__bbbb + mr_adc.h1.n_caee_tril

        # CAAA
        mr_adc.h1.s_caaa__aaaa = mr_adc.h1.f_caaa
        mr_adc.h1.f_caaa__aaaa = mr_adc.h1.s_caaa__aaaa + mr_adc.h1.n_caaa
        mr_adc.h1.s_caaa__abab = mr_adc.h1.f_caaa__aaaa
        mr_adc.h1.f_caaa__abab = mr_adc.h1.s_caaa__abab + mr_adc.h1.n_caaa
        mr_adc.h1.s_caaa__bbbb = mr_adc.h1.f_caaa__abab
        mr_adc.h1.f_caaa__bbbb = mr_adc.h1.s_caaa__bbbb + mr_adc.h1.n_caaa

        # CAEA
        mr_adc.h1.s_caea__aaaa = mr_adc.h1.f_caea
        mr_adc.h1.f_caea__aaaa = mr_adc.h1.s_caea__aaaa + mr_adc.h1.n_caea
        mr_adc.h1.s_caea__abab = mr_adc.h1.f_caea__aaaa
        mr_adc.h1.f_caea__abab = mr_adc.h1.s_caea__abab + mr_adc.h1.n_caea
        mr_adc.h1.s_caea__bbbb = mr_adc.h1.f_caea__abab
        mr_adc.h1.f_caea__bbbb = mr_adc.h1.s_caea__bbbb + mr_adc.h1.n_caea

        print ("Dimension of h1 excitation manifold:               %d\n" %  mr_adc.h1.dim)
        
        ### WIP ###
        # Orthogonalized zeroth- and first-order manifold
        mr_adc.S12.ccaa = mr_adc_overlap.compute_S12_p2(mr_adc)
        mr_adc.S12.ccea = mr_adc_overlap.compute_S12_p1(mr_adc)
        mr_adc.S12.caee = mr_adc_overlap.compute_S12_m1(mr_adc)
        mr_adc.S12.ca_caaa = mr_adc_overlap.compute_S12_p1p_gno_projector(mr_adc)
        mr_adc.S12.ce_caea = mr_adc_overlap.compute_S12_0p_projector(mr_adc)

        # double-core excitations
        mr_adc.h_orth.n_ccaa_tril = (mr_adc.ncvs * (mr_adc.ncvs - 1) // 2) * mr_adc.S12.ccaa.shape[1]
        mr_adc.h_orth.n_ccea_tril = (mr_adc.ncvs * (mr_adc.ncvs - 1) // 2) * mr_adc.nextern * mr_adc.S12.ccea.shape[1]
        mr_adc.h_orth.n_ccee_tril =  mr_adc.h1.n_ccee_tril
        mr_adc.h_orth.n_ccaa = mr_adc.ncvs * mr_adc.ncvs * mr_adc.S12.ccaa.shape[1]
        mr_adc.h_orth.n_ccea = mr_adc.ncvs * mr_adc.ncvs * mr_adc.nextern * mr_adc.S12.ccea.shape[1]
        mr_adc.h_orth.n_ccee = mr_adc.h1.n_ccee
        if mr_adc.nval is not None:
           mr_adc.h_orth.n_cvaa = (mr_adc.ncvs * mr_adc.nval) * mr_adc.S12.ccaa.shape[1]
           mr_adc.h_orth.n_cvea = (mr_adc.ncvs * mr_adc.nval) * mr_adc.nextern * mr_adc.S12.ccea.shape[1]
           mr_adc.h_orth.n_cvee = mr_adc.h1.n_cvee 
           mr_adc.h_orth.n_cvee_tril = mr_adc.h1.n_cvee_tril

        # single-core excitations
        mr_adc.h_orth.n_caee_tril = mr_adc.ncvs * (mr_adc.nextern * (mr_adc.nextern - 1) // 2) * mr_adc.S12.caee.shape[1]
        mr_adc.h_orth.n_caee = mr_adc.ncvs * mr_adc.nextern * mr_adc.nextern * mr_adc.S12.caee.shape[1]
        mr_adc.h_orth.n_ca_caaa = mr_adc.ncvs * mr_adc.S12.ca_caaa.shape[1]
        mr_adc.h_orth.n_ce_caea = mr_adc.ncvs * mr_adc.nextern * mr_adc.S12.ce_caea.shape[1]

        # Total dimension
        mr_adc.h_orth.h0_dim = mr_adc.h_orth.n_ca_caaa + mr_adc.h_orth.n_ce_caea
        mr_adc.h_orth.dim_caee = mr_adc.h_orth.n_caee + 2 * mr_adc.h_orth.n_caee_tril
        mr_adc.h_orth.dim_ccaa = mr_adc.h_orth.n_ccaa + 2 * mr_adc.h_orth.n_ccaa_tril
        mr_adc.h_orth.dim_ccea = mr_adc.h_orth.n_ccea + 2 * mr_adc.h_orth.n_ccea_tril
        mr_adc.h_orth.dim_ccee = mr_adc.h1.dim_ccee

        mr_adc.h_orth.dim = mr_adc.h_orth.h0_dim + mr_adc.h_orth.dim_caee + mr_adc.h_orth.dim_ccaa + mr_adc.h_orth.dim_ccea + mr_adc.h_orth.dim_ccee
        if mr_adc.nval is not None:
            mr_adc.h_orth.dim_cvaa = 3 * mr_adc.h_orth.n_cvaa
            mr_adc.h_orth.dim_cvea = 3 * mr_adc.h_orth.n_cvea
            mr_adc.h_orth.dim_cvee = mr_adc.h1.dim_cvee
            mr_adc.h_orth.dim += mr_adc.h_orth.dim_cvaa + mr_adc.h_orth.dim_cvea + mr_adc.h_orth.dim_cvee

        ## Indices
        if mr_adc.nval is None:
            mr_adc.h_orth.s_ca_caaa = 0
            mr_adc.h_orth.f_ca_caaa = mr_adc.h_orth.s_ca_caaa + mr_adc.h_orth.n_ca_caaa
            mr_adc.h_orth.s_ce_caea = mr_adc.h_orth.f_ca_caaa
            mr_adc.h_orth.f_ce_caea = mr_adc.h_orth.s_ca_caea + mr_adc.h_orth.n_ce_caea
            mr_adc.h_orth.s_ccaa = mr_adc.h_orth.f_ce_caea
            mr_adc.h_orth.f_ccaa = mr_adc.h_orth.s_ccaa + mr_adc.h_orth.dim_ccaa
            mr_adc.h_orth.s_ccea = mr_adc.h_orth.f_ccaa
            mr_adc.h_orth.f_ccea = mr_adc.h_orth.s_ccea + mr_adc.h_orth.dim_ccea
            mr_adc.h_orth.s_ccee = mr_adc.h_orth.f_ccea
            mr_adc.h_orth.f_ccee = mr_adc.h_orth.s_ccee + mr_adc.h_orth.dim_ccee
            mr_adc.h_orth.s_caee = mr_adc.h_orth.f_ccee
            mr_adc.h_orth.f_caee = mr_adc.h_orth.s_caee + mr_adc.h_orth.dim_caee
        else:
            mr_adc.h_orth.s_ca_caaa = 0
            mr_adc.h_orth.f_ca_caaa = mr_adc.h_orth.s_ca_caaa + mr_adc.h_orth.n_ca_caaa
            mr_adc.h_orth.s_ce_caea = mr_adc.h_orth.f_ca_caaa
            mr_adc.h_orth.f_ce_caea = mr_adc.h_orth.s_ce_caea + mr_adc.h_orth.n_ce_caea
            mr_adc.h_orth.s_ccaa = mr_adc.h_orth.f_ce_caea
            mr_adc.h_orth.f_ccaa = mr_adc.h_orth.s_ccaa + mr_adc.h_orth.dim_ccaa
            mr_adc.h_orth.s_cvaa = mr_adc.h_orth.f_ccaa
            mr_adc.h_orth.f_cvaa = mr_adc.h_orth.s_cvaa + mr_adc.h_orth.dim_cvaa
            mr_adc.h_orth.s_ccea = mr_adc.h_orth.f_cvaa
            mr_adc.h_orth.f_ccea = mr_adc.h_orth.s_ccea + mr_adc.h_orth.dim_ccea
            mr_adc.h_orth.s_cvea = mr_adc.h_orth.f_ccea
            mr_adc.h_orth.f_cvea = mr_adc.h_orth.s_cvea + mr_adc.h_orth.dim_cvea 
            mr_adc.h_orth.s_ccee = mr_adc.h_orth.f_cvea
            mr_adc.h_orth.f_ccee = mr_adc.h_orth.s_ccee + mr_adc.h_orth.dim_ccee
            mr_adc.h_orth.s_cvee = mr_adc.h_orth.f_ccee
            mr_adc.h_orth.f_cvee = mr_adc.h_orth.s_cvee + mr_adc.h_orth.dim_cvee
            mr_adc.h_orth.s_caee = mr_adc.h_orth.f_cvee
            mr_adc.h_orth.f_caee = mr_adc.h_orth.s_caee + mr_adc.h_orth.dim_caee

        ## Spin-Case Indices
        # CA - CAAA
        mr_adc.h_orth.s_ca_caaa = 0
        mr_adc.h_orth.f_ca_caaa = mr_adc.h_orth.s_ca_caaa + mr_adc.h_orth.n_ca_caaa

        # CE - CAEA
        mr_adc.h_orth.s_ce_caea = mr_adc.h_orth.s_ce_caea
        mr_adc.h_orth.f_ce_caea = mr_adc.h_orth.s_ce_caea + mr_adc.h_orth.n_ce_caea

        # CCAA (CVAA)
        mr_adc.h_orth.s_ccaa__aaaa = mr_adc.h_orth.s_ccaa
        mr_adc.h_orth.f_ccaa__aaaa = mr_adc.h_orth.s_ccaa__aaaa + mr_adc.h_orth.n_ccaa_tril
        mr_adc.h_orth.s_ccaa__abab = mr_adc.h_orth.f_ccaa__aaaa
        mr_adc.h_orth.f_ccaa__abab = mr_adc.h_orth.s_ccaa__abab + mr_adc.h_orth.n_ccaa
        mr_adc.h_orth.s_ccaa__bbbb = mr_adc.h_orth.f_ccaa__abab
        mr_adc.h_orth.f_ccaa__bbbb = mr_adc.h_orth.s_ccaa__bbbb + mr_adc.h_orth.n_ccaa_tril
 
        if mr_adc.nval is not None:
            mr_adc.h_orth.s_cvaa__aaaa = mr_adc.h_orth.s_cvaa
            mr_adc.h_orth.f_cvaa__aaaa = mr_adc.h_orth.s_cvaa__aaaa + mr_adc.h_orth.n_cvaa
            mr_adc.h_orth.s_cvaa__abab = mr_adc.h_orth.f_cvaa__aaaa
            mr_adc.h_orth.f_cvaa__abab = mr_adc.h_orth.s_cvaa__abab + mr_adc.h_orth.n_cvaa
            mr_adc.h_orth.s_cvaa__bbbb = mr_adc.h_orth.f_cvaa__abab
            mr_adc.h_orth.f_cvaa__bbbb = mr_adc.h_orth.s_cvaa__bbbb + mr_adc.h_orth.n_cvaa

        # CCEA (CVEA)
        mr_adc.h_orth.s_ccea__aaaa = mr_adc.h_orth.s_ccea
        mr_adc.h_orth.f_ccea__aaaa = mr_adc.h_orth.s_ccea__aaaa + mr_adc.h_orth.n_ccea_tril
        mr_adc.h_orth.s_ccea__abab = mr_adc.h_orth.f_ccea__aaaa
        mr_adc.h_orth.f_ccea__abab = mr_adc.h_orth.s_ccea__abab + mr_adc.h_orth.n_ccea
        mr_adc.h_orth.s_ccea__bbbb = mr_adc.h_orth.s_ccea
        mr_adc.h_orth.f_ccea__bbbb = mr_adc.h_orth.s_ccea__bbbb + mr_adc.h_orth.n_ccea_tril
 
        if mr_adc.nval is not None:
            mr_adc.h_orth.s_cvea__aaaa = mr_adc.h_orth.s_cvea
            mr_adc.h_orth.f_cvea__aaaa = mr_adc.h_orth.s_cvea__aaaa + mr_adc.h_orth.n_cvea
            mr_adc.h_orth.s_cvea__abab = mr_adc.h_orth.f_cvea__aaaa
            mr_adc.h_orth.f_cvea__abab = mr_adc.h_orth.s_cvea__abab + mr_adc.h_orth.n_cvea
            mr_adc.h_orth.s_cvea__bbbb = mr_adc.h_orth.f_cvea__abab
            mr_adc.h_orth.f_cvea__bbbb = mr_adc.h_orth.s_cvea__bbbb + mr_adc.h_orth.n_cvea

        # CCEE (CVEE)
        mr_adc.h_orth.s_ccee__aaaa = mr_adc.h_orth.s_ccee
        mr_adc.h_orth.f_ccee__aaaa = mr_adc.h_orth.s_ccee__aaaa + mr_adc.h_orth.n_ccee_tril
        mr_adc.h_orth.s_ccee__abab = mr_adc.h_orth.f_ccee__aaaa
        mr_adc.h_orth.f_ccee__abab = mr_adc.h_orth.s_ccee__abab + mr_adc.h_orth.n_ccee

        if mr_adc.nval is not None:
            mr_adc.h_orth.s_cvee__aaaa = mr_adc.h_orth.s_cvee
            mr_adc.h_orth.f_cvee__aaaa = mr_adc.h_orth.s_cvee__aaaa + mr_adc.h_orth.n_cvee_tril
            mr_adc.h_orth.s_cvee__abab = mr_adc.h_orth.f_cvee__aaaa
            mr_adc.h_orth.f_cvee__abab = mr_adc.h_orth.s_cvee__abab + mr_adc.h_orth.n_cvee

        # CAEE
        mr_adc.h_orth.s_caee__aaaa = mr_adc.h_orth.s_caee
        mr_adc.h_orth.f_caee__aaaa = mr_adc.h_orth.s_caee__aaaa + mr_adc.h_orth.n_caee_tril
        mr_adc.h_orth.s_caee__abab = mr_adc.h_orth.f_caee__aaaa
        mr_adc.h_orth.f_caee__abab = mr_adc.h_orth.s_caee__abab + mr_adc.h_orth.n_caee
        mr_adc.h_orth.s_caee__bbbb = mr_adc.h_orth.f_caee__abab
        mr_adc.h_orth.f_caee__bbbb = mr_adc.h_orth.s_caee__bbbb + mr_adc.h_orth.n_caee_tril

    print ("\nTotal dimension of the excitation manifold:        %d" % (mr_adc.h0.dim + mr_adc.h1.dim))
    print ("Dim. of orthogonalized excitation manifold:        %d\n" % (mr_adc.h_orth.dim))
    sys.stdout.flush()

    if (mr_adc.h_orth.dim < mr_adc.nroots):
        mr_adc.nroots = mr_adc.h_orth.dim

#    ### WIP ###
    return mr_adc


def compute_M_00(mr_adc):

    start_time = time.time()

    print("Computing M(h0-h0) block...\n")
    sys.stdout.flush()

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncvs    = mr_adc.ncvs
    ncas    = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_cvs    = mr_adc.mo_energy.x
    e_val    = mr_adc.mo_energy.v
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_aa = mr_adc.h1eff.aa
        
    ## Two-electron integrals
    v_aaaa = mr_adc.v2e.aaaa

    ## Dimensions
    s_ce_aa = mr_adc.h0.s_ce_aa
    f_ce_aa = mr_adc.h0.f_ce_aa
    s_ce_bb = mr_adc.h0.s_ce_bb
    f_ce_bb = mr_adc.h0.f_ce_bb
    s_ca_aa = mr_adc.h0.s_ca_aa
    f_ca_aa = mr_adc.h0.f_ca_aa
    s_ca_bb = mr_adc.h0.s_ca_bb
    f_ca_bb = mr_adc.h0.f_ca_bb

    n_ce = mr_adc.h0.n_ce
    n_ca = mr_adc.h0.n_ca

    dim = mr_adc.h0.dim

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    M_00 = np.zeros((dim, dim))

    ## Zeroth-order terms
    # CE - CE
    ## aa,aa || bb,bb
    temp  = einsum('B,AB,IJ->IAJB', e_extern, np.identity(nextern), np.identity(ncvs), optimize = einsum_type)
    temp -= einsum('J,AB,IJ->IAJB', e_cvs, np.identity(nextern), np.identity(ncvs), optimize = einsum_type)

    temp.shape = (n_ce, n_ce)
    M_00[s_ce_aa:f_ce_aa, s_ce_aa:f_ce_aa] += temp
    M_00[s_ce_bb:f_ce_bb, s_ce_bb:f_ce_bb] += temp

    print ("Asymmetry of ce - ce (0) sublock:                 %.5e" % np.linalg.norm(temp-temp.T))
    print ("Norm of subblock:                               %f\n" % (np.linalg.norm(temp))) 

    del temp

    # CA - CA
    ## aa,aa || bb,bb
    temp  = einsum('XY,IJ->IXJY', h_aa, np.identity(ncvs), optimize = einsum_type)
    temp -= einsum('J,IJ,XY->IXJY', e_cvs, np.identity(ncvs), np.identity(ncas), optimize = einsum_type)
    temp += 1/2 * einsum('J,IJ,XY->IXJY', e_cvs, np.identity(ncvs), rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Yx,IJ,Xx->IXJY', h_aa, np.identity(ncvs), rdm_ca, optimize = einsum_type)
    temp += einsum('IJ,XYxy,xy->IXJY', np.identity(ncvs), v_aaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('IJ,XxyY,yx->IXJY', np.identity(ncvs), v_aaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('IJ,Yxyz,Xyxz->IXJY', np.identity(ncvs), v_aaaa, rdm_ccaa, optimize = einsum_type)

    temp.shape = (n_ca, n_ca)
    M_00[s_ca_aa:f_ca_aa, s_ca_aa:f_ca_aa] += temp
    M_00[s_ca_bb:f_ca_bb, s_ca_bb:f_ca_bb] += temp

    print ("Asymmetry of ca - ca (0) sublock:                 %.5e" % np.linalg.norm(temp-temp.T))
    print ("Norm of subblock:                                %f\n" % (np.linalg.norm(temp))) 
    
    del temp

    ## First-order terms
    if mr_adc.method in ("mr-adc(1)", "mr-adc(2)", "mr-adc(2)-x"): 
        ## One-electron integrals
        h_ae = mr_adc.h1eff.ae
            
        ## Two-electron integrals
        v_aaae = mr_adc.v2e.aaae
        v_xxaa = mr_adc.v2e.xxaa
        v_xaax = mr_adc.v2e.xaax
        v_xxae = mr_adc.v2e.xxae
        v_xaex = mr_adc.v2e.xaex
        v_xxee = mr_adc.v2e.xxee
        v_xeex = mr_adc.v2e.xeex

        ## Amplitudes
        t1_ae = mr_adc.t1.ae
        t1_aaae = mr_adc.t1.aaae

        # CE - CE
        ## aa,aa || bb,bb
        temp  = einsum('IABJ->IAJB', v_xeex, optimize = einsum_type).copy()
        temp -= einsum('JIAB->IAJB', v_xxee, optimize = einsum_type).copy()

        temp.shape = (n_ce, n_ce)
        M_00[s_ce_aa:f_ce_aa, s_ce_aa:f_ce_aa] += temp
        M_00[s_ce_bb:f_ce_bb, s_ce_bb:f_ce_bb] += temp
        del temp

        ## aa,bb || bb,aa
        temp  = einsum('IABJ->IAJB', v_xeex, optimize = einsum_type).copy()
        
        temp.shape = (n_ce, n_ce)
        M_00[s_ce_aa:f_ce_aa, s_ce_bb:f_ce_bb] += temp
        M_00[s_ce_bb:f_ce_bb, s_ce_aa:f_ce_aa] += temp
        del temp

        # CA - CA
        ## aa,aa || bb,bb
        temp =- einsum('IJYX->IXJY', v_xxaa, optimize = einsum_type).copy()
        temp += einsum('IXYJ->IXJY', v_xaax, optimize = einsum_type).copy()
        temp += 1/2 * einsum('IJYx,Xx->IXJY', v_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJxX,Yx->IXJY', v_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJxy,XxYy->IXJY', v_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxJ,Yx->IXJY', v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxYJ,Xx->IXJY', v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyJ,XyYx->IXJY', v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IxyJ,XyxY->IXJY', v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJxy,xy,XY->IXJY', v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IxyJ,yx,XY->IXJY', v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)

        temp.shape = (n_ca, n_ca)
        M_00[s_ca_aa:f_ca_aa, s_ca_aa:f_ca_aa] += temp
        M_00[s_ca_bb:f_ca_bb, s_ca_bb:f_ca_bb] += temp
        del temp

        ## aa,bb || bb,aa
        temp  = einsum('IXYJ->IXJY', v_xaax, optimize = einsum_type).copy()
        temp -= 1/2 * einsum('IXxJ,Yx->IXJY', v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxYJ,Xx->IXJY', v_xaax, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxyJ,XyYx->IXJY', v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IxyJ,XyxY->IXJY', v_xaax, rdm_ccaa, optimize = einsum_type)

        temp.shape = (n_ca, n_ca)
        M_00[s_ca_aa:f_ca_aa, s_ca_bb:f_ca_bb] += temp
        M_00[s_ca_bb:f_ca_bb, s_ca_aa:f_ca_aa] += temp
        del temp

        # CE - CA
        ## aa,aa || bb,bb
        temp =- einsum('IJXA->IAJX', v_xxae, optimize = einsum_type).copy()
        temp += einsum('JXAI->IAJX', v_xaex, optimize = einsum_type).copy()
        temp += einsum('XA,IJ->IAJX', h_ae, np.identity(ncvs), optimize = einsum_type)
        temp += 1/2 * einsum('IJxA,Xx->IAJX', v_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxAI,Xx->IAJX', v_xaex, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,XA->IAJX', e_extern, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,xA->IAJX', h_aa, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyA,xy->IAJX', np.identity(ncvs), v_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyXA,yx->IAJX', np.identity(ncvs), v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,XxyA,yx->IAJX', e_extern, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,xXyA,yx->IAJX', e_extern, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,xyzA,zy->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,yxzA,zy->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,XxzA,yz->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XzxA,yz->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,xXzA,yz->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,zXxA,yz->IAJX', h_aa, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyA,xzwu,ywzu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyA,yzwu,xwzu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xA,Xxyz,yz->IAJX', np.identity(ncvs), t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xA,Xyzx,zy->IAJX', np.identity(ncvs), t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xXyA,xzwu,ywzu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXyA,yzwu,xwzu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xwux,zwuy->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xwuy,zwxu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzA,Xwzu,yxwu->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xxwu,zuyw->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xxwy,zw->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,Xywu,zuxw->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,Xywx,zw->IAJX', np.identity(ncvs), t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)

        temp.shape = (n_ce, n_ca)
        M_00[s_ce_aa:f_ce_aa, s_ca_aa:f_ca_aa] += temp
        M_00[s_ce_bb:f_ce_bb, s_ca_bb:f_ca_bb] += temp

        # Add temp matrix to bottom triangle
        M_00[s_ca_aa:f_ca_aa, s_ce_aa:f_ce_aa] += temp.T
        M_00[s_ca_bb:f_ca_bb, s_ce_bb:f_ce_bb] += temp.T
        del temp

        ## aa,bb || bb,aa
        temp  = einsum('JXAI->IAJX', v_xaex, optimize = einsum_type).copy()
        temp -= 1/2 * einsum('JxAI,Xx->IAJX', v_xaex, rdm_ca, optimize = einsum_type)

        temp.shape = (n_ce, n_ca)
        M_00[s_ce_aa:f_ce_aa, s_ca_bb:f_ca_bb] += temp
        M_00[s_ce_bb:f_ce_bb, s_ca_aa:f_ca_aa] += temp

        # Add temp matrix to bottom triangle
        M_00[s_ca_bb:f_ca_bb, s_ce_aa:f_ce_aa] += temp.T
        M_00[s_ca_aa:f_ca_aa, s_ce_bb:f_ce_bb] += temp.T
        del temp

    ## Second-order terms
    if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x"):
    
        ## One-electron integrals
        h_xa = mr_adc.h1eff.xa
        h_va = mr_adc.h1eff.va
        h_xe = mr_adc.h1eff.xe
        h_ve = mr_adc.h1eff.ve
    
        ## Two-electron integrals
        v_xxxa = mr_adc.v2e.xxxa
        v_xxva = mr_adc.v2e.xxva
        v_vxxa = mr_adc.v2e.vxxa

        v_xxxe = mr_adc.v2e.xxxe
        v_xxve = mr_adc.v2e.xxve
        v_vxxe = mr_adc.v2e.vxxe

        v_xvee = mr_adc.v2e.xvee

        v_xaxa = mr_adc.v2e.xaxa
        v_xava = mr_adc.v2e.xava
        v_vaxa = mr_adc.v2e.vaxa
        v_vava = mr_adc.v2e.vava

        v_xaxe = mr_adc.v2e.xaxe
        v_xave = mr_adc.v2e.xave
        v_vaxe = mr_adc.v2e.vaxe
        v_vave = mr_adc.v2e.vave

        v_xexe = mr_adc.v2e.xexe
        v_xeve = mr_adc.v2e.xeve
        v_vexe = mr_adc.v2e.vexe
        v_veve = mr_adc.v2e.veve

        v_xaae = mr_adc.v2e.xaae
        v_vaae = mr_adc.v2e.vaae
        
        v_xaea = mr_adc.v2e.xaea
        v_vaea = mr_adc.v2e.vaea

        v_xeaa = mr_adc.v2e.xeaa
        v_veaa = mr_adc.v2e.veaa
        
        v_xeea = mr_adc.v2e.xeea
        v_veea = mr_adc.v2e.veea
        
        v_xaee = mr_adc.v2e.xaee
        v_vaee = mr_adc.v2e.vaee
        
        v_xeae = mr_adc.v2e.xeae
        v_veae = mr_adc.v2e.veae
        
        v_xaaa = mr_adc.v2e.xaaa
        v_vaaa = mr_adc.v2e.vaaa
        
        v_xeee = mr_adc.v2e.xeee
        v_veee = mr_adc.v2e.veee
        
        v_aaee = mr_adc.v2e.aaee
        v_aeae = mr_adc.v2e.aeae
        v_aeea = mr_adc.v2e.aeea
        v_aeee = mr_adc.v2e.aeee

        ## Amplitudes
        t1_xa = mr_adc.t1.xa
        t1_va = mr_adc.t1.va

        t1_xe = mr_adc.t1.xe
        t1_ve = mr_adc.t1.ve

        t2_ae = mr_adc.t2.ae
        t2_aa = mr_adc.t2.aa

        t1_xxaa = mr_adc.t1.xxaa
        t1_xvaa = mr_adc.t1.xvaa
        t1_vxaa = mr_adc.t1.vxaa
        t1_vvaa = mr_adc.t1.vvaa

        t1_xxae = mr_adc.t1.xxae
        t1_xvae = mr_adc.t1.xvae
        t1_vxae = mr_adc.t1.vxae
        t1_vvae = mr_adc.t1.vvae
        
        t1_xxee = mr_adc.t1.xxee
        t1_xvee = mr_adc.t1.xvee
        t1_vxee = mr_adc.t1.vxee
        t1_vvee = mr_adc.t1.vvee

        t1_xaaa = mr_adc.t1.xaaa
        t1_vaaa = mr_adc.t1.vaaa
        
        t1_xaae = mr_adc.t1.xaae
        t1_vaae = mr_adc.t1.vaae
        
        t1_xaea = mr_adc.t1.xaea
        t1_vaea = mr_adc.t1.vaea
        
        t1_xaee = mr_adc.t1.xaee
        t1_vaee = mr_adc.t1.vaee
        
        t1_aaee = mr_adc.t1.aaee

        t2_aaae = mr_adc.t1.aaae
        
        # Reduced Density Matrices
        rdm_cccaaa = mr_adc.rdm.cccaaa
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

        # CE - CE
        ## aa,aa || bb,bb
        temp  = einsum('Ia,JBAa->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp -= einsum('Ia,JaAB->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JBia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('IiAa,iBJa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('IixA,JxiB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('IixA,ixJB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JBia->IAJB', t1_xvee, v_xeve, optimize = einsum_type)
        temp -= einsum('IiAa,iBJa->IAJB', t1_xvee, v_vexe, optimize = einsum_type)
        temp += einsum('IixA,JxiB->IAJB', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('IixA,ixJB->IAJB', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += einsum('Ix,JBAx->IAJB', t1_xa, v_xeea, optimize = einsum_type)
        temp -= einsum('Ix,JxAB->IAJB', t1_xa, v_xaee, optimize = einsum_type)
        temp += einsum('Ja,IABa->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp -= einsum('Ja,IaBA->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('JiBa,IAia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('JiBa,iAIa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('JixB,IxiA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('JixB,ixIA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiBa,IAia->IAJB', t1_xvee, v_xeve, optimize = einsum_type)
        temp -= einsum('JiBa,iAIa->IAJB', t1_xvee, v_vexe, optimize = einsum_type)
        temp += einsum('JixB,IxiA->IAJB', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('JixB,ixIA->IAJB', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += einsum('Jx,IABx->IAJB', t1_xa, v_xeea, optimize = einsum_type)
        temp -= einsum('Jx,IxBA->IAJB', t1_xa, v_xaee, optimize = einsum_type)
        temp += einsum('iA,JIiB->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp -= einsum('iA,iIJB->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp += einsum('iB,IJiA->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp -= einsum('iB,iJIA->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp -= einsum('iIAa,JBia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('iIAa,iBJa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('iIxA,JxiB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iIxA,ixJB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iJBa,IAia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('iJBa,iAIa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('iJxB,IxiA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iJxB,ixIA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('iA,JIiB->IAJB', t1_ve, v_xxve, optimize = einsum_type)
        temp -= einsum('iA,iIJB->IAJB', t1_ve, v_vxxe, optimize = einsum_type)
        temp += einsum('iB,IJiA->IAJB', t1_ve, v_xxve, optimize = einsum_type)
        temp -= einsum('iB,iJIA->IAJB', t1_ve, v_vxxe, optimize = einsum_type)
        temp -= einsum('iIAa,JBia->IAJB', t1_vxee, v_xeve, optimize = einsum_type)
        temp += einsum('iIAa,iBJa->IAJB', t1_vxee, v_vexe, optimize = einsum_type)
        temp -= einsum('iIxA,JxiB->IAJB', t1_vxae, v_xave, optimize = einsum_type)
        temp += 2 * einsum('iIxA,ixJB->IAJB', t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= einsum('iJBa,IAia->IAJB', t1_vxee, v_xeve, optimize = einsum_type)
        temp += einsum('iJBa,iAIa->IAJB', t1_vxee, v_vexe, optimize = einsum_type)
        temp -= einsum('iJxB,IxiA->IAJB', t1_vxae, v_xave, optimize = einsum_type)
        temp += 2 * einsum('iJxB,ixIA->IAJB', t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= einsum('xA,IxBJ->IAJB', t1_ae, v_xaex, optimize = einsum_type)
        temp += einsum('xA,JIxB->IAJB', t1_ae, v_xxae, optimize = einsum_type)
        temp += einsum('xB,IJxA->IAJB', t1_ae, v_xxae, optimize = einsum_type)
        temp -= einsum('xB,JxAI->IAJB', t1_ae, v_xaex, optimize = einsum_type)
        temp += einsum('A,IiAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IixA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('A,IiAa,JiBa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJBa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IixA,JixB->IAJB', e_extern, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,iJxB->IAJB', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('A,iIxA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiBa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,iJBa->IAJB', e_extern, t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixB->IAJB', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('A,iIxA,iJxB->IAJB', e_extern, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('B,IiAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IiAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IixA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IixA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('B,IiAa,JiBa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IiAa,iJBa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IixA,JixB->IAJB', e_extern, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IixA,iJxB->IAJB', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('B,iIAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('B,iIxA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIAa,JiBa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('B,iIAa,iJBa->IAJB', e_extern, t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,JixB->IAJB', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('B,iIxA,iJxB->IAJB', e_extern, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiBa->IAJB', e_cvs, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJBa->IAJB', e_cvs, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixA,JixB->IAJB', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,iJxB->IAJB', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiBa->IAJB', e_cvs, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,iJBa->IAJB', e_cvs, t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixB->IAJB', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('I,iIxA,iJxB->IAJB', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiBa->IAJB', e_cvs, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJBa->IAJB', e_cvs, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixA,JixB->IAJB', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,iJxB->IAJB', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiBa->IAJB', e_cvs, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIAa,iJBa->IAJB', e_cvs, t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixB->IAJB', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('J,iIxA,iJxB->IAJB', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('a,JiBa,IiAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,JiBa,iIAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 2 * einsum('a,JiBa,IiAa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= einsum('a,JiBa,iIAa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= einsum('a,iJBa,IiAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,iJBa,iIAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,iJBa,IiAa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,iJBa,iIAa->IAJB', e_extern, t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiBa,IiAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiBa,iIAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixB,IixA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixB,iIxA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJBa,IiAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJBa,iIAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJxB,IixA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iJxB,iIxA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiBa->IAJB', e_val, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJBa->IAJB', e_val, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JixB->IAJB', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,iJxB->IAJB', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,JiBa,IiAa->IAJB', e_val, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiBa,iIAa->IAJB', e_val, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixB,IixA->IAJB', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixB,iIxA->IAJB', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiBa->IAJB', e_val, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,iJBa->IAJB', e_val, t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixB->IAJB', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,iIxA,iJxB->IAJB', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJBa,IiAa->IAJB', e_val, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJBa,iIAa->IAJB', e_val, t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJxB,IixA->IAJB', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,iJxB,iIxA->IAJB', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('Ia,AB,Ja->IAJB', h_xe, np.identity(nextern), t1_xe, optimize = einsum_type)
        temp -= einsum('Ix,AB,Jx->IAJB', h_xa, np.identity(nextern), t1_xa, optimize = einsum_type)
        temp -= einsum('Ja,AB,Ia->IAJB', h_xe, np.identity(nextern), t1_xe, optimize = einsum_type)
        temp -= einsum('Jx,AB,Ix->IAJB', h_xa, np.identity(nextern), t1_xa, optimize = einsum_type)
        temp -= einsum('iA,IJ,iB->IAJB', h_xe, np.identity(ncvs), t1_xe, optimize = einsum_type)
        temp -= einsum('iB,IJ,iA->IAJB', h_xe, np.identity(ncvs), t1_xe, optimize = einsum_type)
        temp -= einsum('iA,IJ,iB->IAJB', h_ve, np.identity(ncvs), t1_ve, optimize = einsum_type)
        temp -= einsum('iB,IJ,iA->IAJB', h_ve, np.identity(ncvs), t1_ve, optimize = einsum_type)
        temp -= einsum('xA,IJ,xB->IAJB', h_ae, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp -= einsum('xB,IJ,xA->IAJB', h_ae, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp += einsum('xy,IixA,JiyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('xy,IixA,iJyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,IixA,JiyB->IAJB', h_aa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= einsum('xy,IixA,iJyB->IAJB', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,iJyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyB->IAJB', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,iJyB->IAJB', h_aa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iiab,Jaib->IAJB', np.identity(nextern), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('AB,Iiab,Jbia->IAJB', np.identity(nextern), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iixa,Jxia->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('AB,Iixa,ixJa->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iixy,Jxiy->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jyix->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iiab,Jaib->IAJB', np.identity(nextern), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('AB,Iiab,Jbia->IAJB', np.identity(nextern), t1_xvee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iixa,Jxia->IAJB', np.identity(nextern), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('AB,Iixa,ixJa->IAJB', np.identity(nextern), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Iixy,Jxiy->IAJB', np.identity(nextern), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jyix->IAJB', np.identity(nextern), t1_xvaa, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jiab,Iaib->IAJB', np.identity(nextern), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('AB,Jiab,Ibia->IAJB', np.identity(nextern), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jixa,Ixia->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('AB,Jixa,ixIa->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jixy,Ixiy->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('AB,Jixy,Iyix->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jiab,Iaib->IAJB', np.identity(nextern), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('AB,Jiab,Ibia->IAJB', np.identity(nextern), t1_xvee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jixa,Ixia->IAJB', np.identity(nextern), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('AB,Jixa,ixIa->IAJB', np.identity(nextern), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,Jixy,Ixiy->IAJB', np.identity(nextern), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('AB,Jixy,Iyix->IAJB', np.identity(nextern), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('AB,iIxa,Jxia->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,iIxa,ixJa->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('AB,iJxa,Ixia->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,iJxa,ixIa->IAJB', np.identity(nextern), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,ia,IJia->IAJB', np.identity(nextern), t1_xe, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,ia,JIia->IAJB', np.identity(nextern), t1_xe, v_xxxe, optimize = einsum_type)
        temp += einsum('AB,ia,iIJa->IAJB', np.identity(nextern), t1_xe, v_xxxe, optimize = einsum_type)
        temp += einsum('AB,ia,iJIa->IAJB', np.identity(nextern), t1_xe, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,ix,IJix->IAJB', np.identity(nextern), t1_xa, v_xxxa, optimize = einsum_type)
        temp -= 2 * einsum('AB,ix,JIix->IAJB', np.identity(nextern), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('AB,ix,iIJx->IAJB', np.identity(nextern), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('AB,ix,iJIx->IAJB', np.identity(nextern), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('AB,iIxa,Jxia->IAJB', np.identity(nextern), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('AB,iIxa,ixJa->IAJB', np.identity(nextern), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('AB,iJxa,Ixia->IAJB', np.identity(nextern), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('AB,iJxa,ixIa->IAJB', np.identity(nextern), t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,ia,IJia->IAJB', np.identity(nextern), t1_ve, v_xxve, optimize = einsum_type)
        temp -= 2 * einsum('AB,ia,JIia->IAJB', np.identity(nextern), t1_ve, v_xxve, optimize = einsum_type)
        temp += einsum('AB,ia,iIJa->IAJB', np.identity(nextern), t1_ve, v_vxxe, optimize = einsum_type)
        temp += einsum('AB,ia,iJIa->IAJB', np.identity(nextern), t1_ve, v_vxxe, optimize = einsum_type)
        temp -= 2 * einsum('AB,ix,IJix->IAJB', np.identity(nextern), t1_va, v_xxva, optimize = einsum_type)
        temp -= 2 * einsum('AB,ix,JIix->IAJB', np.identity(nextern), t1_va, v_xxva, optimize = einsum_type)
        temp += einsum('AB,ix,iIJx->IAJB', np.identity(nextern), t1_va, v_vxxa, optimize = einsum_type)
        temp += einsum('AB,ix,iJIx->IAJB', np.identity(nextern), t1_va, v_vxxa, optimize = einsum_type)
        temp -= einsum('IJ,ia,iABa->IAJB', np.identity(ncvs), t1_xe, v_xeee, optimize = einsum_type)
        temp -= einsum('IJ,ia,iBAa->IAJB', np.identity(ncvs), t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaAB->IAJB', np.identity(ncvs), t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaBA->IAJB', np.identity(ncvs), t1_xe, v_xeee, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iBja->IAJB', np.identity(ncvs), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jBia->IAJB', np.identity(ncvs), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijBa,iAja->IAJB', np.identity(ncvs), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('IJ,ijBa,jAia->IAJB', np.identity(ncvs), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,ixjB->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jxiB->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxB,ixjA->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxB,jxiA->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iBja->IAJB', np.identity(ncvs), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jBia->IAJB', np.identity(ncvs), t1_xvee, v_vexe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijBa,iAja->IAJB', np.identity(ncvs), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('IJ,ijBa,jAia->IAJB', np.identity(ncvs), t1_xvee, v_vexe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,ixjB->IAJB', np.identity(ncvs), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jxiB->IAJB', np.identity(ncvs), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxB,ixjA->IAJB', np.identity(ncvs), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijxB,jxiA->IAJB', np.identity(ncvs), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= einsum('IJ,ix,iABx->IAJB', np.identity(ncvs), t1_xa, v_xeea, optimize = einsum_type)
        temp -= einsum('IJ,ix,iBAx->IAJB', np.identity(ncvs), t1_xa, v_xeea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixAB->IAJB', np.identity(ncvs), t1_xa, v_xaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixBA->IAJB', np.identity(ncvs), t1_xa, v_xaee, optimize = einsum_type)
        temp -= einsum('IJ,ia,iABa->IAJB', np.identity(ncvs), t1_ve, v_veee, optimize = einsum_type)
        temp -= einsum('IJ,ia,iBAa->IAJB', np.identity(ncvs), t1_ve, v_veee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaAB->IAJB', np.identity(ncvs), t1_ve, v_veee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaBA->IAJB', np.identity(ncvs), t1_ve, v_veee, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iBja->IAJB', np.identity(ncvs), t1_vxee, v_vexe, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jBia->IAJB', np.identity(ncvs), t1_vxee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijBa,iAja->IAJB', np.identity(ncvs), t1_vxee, v_vexe, optimize = einsum_type)
        temp += einsum('IJ,ijBa,jAia->IAJB', np.identity(ncvs), t1_vxee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,ixjB->IAJB', np.identity(ncvs), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jxiB->IAJB', np.identity(ncvs), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxB,ixjA->IAJB', np.identity(ncvs), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxB,jxiA->IAJB', np.identity(ncvs), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iBja->IAJB', np.identity(ncvs), t1_vvee, v_veve, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jBia->IAJB', np.identity(ncvs), t1_vvee, v_veve, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijBa,iAja->IAJB', np.identity(ncvs), t1_vvee, v_veve, optimize = einsum_type)
        temp += einsum('IJ,ijBa,jAia->IAJB', np.identity(ncvs), t1_vvee, v_veve, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,ixjB->IAJB', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jxiB->IAJB', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxB,ixjA->IAJB', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijxB,jxiA->IAJB', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp -= einsum('IJ,ix,iABx->IAJB', np.identity(ncvs), t1_va, v_veea, optimize = einsum_type)
        temp -= einsum('IJ,ix,iBAx->IAJB', np.identity(ncvs), t1_va, v_veea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixAB->IAJB', np.identity(ncvs), t1_va, v_vaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixBA->IAJB', np.identity(ncvs), t1_va, v_vaee, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,JyiB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,iyJB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,JyiB,xy->IAJB', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,iyJB,xy->IAJB', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAa,JBya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,JayB,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IxAy,JBxz,yz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAy,JBzy,xz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,JyzB,xz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,JzxB,yz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaA,JBya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxaA,JayB,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixay,JBAa,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ixay,JaAB,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JBxz,yz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JBzy,xz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JyzB,xz->IAJB', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JzxB,yz->IAJB', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JBAa,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,JaAB,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixyz,JBAy,xz->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JBAz,xy->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ixyz,JyAB,xz->IAJB', t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JzAB,xy->IAJB', t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixB,IyiA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixB,iyIA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixB,IyiA,xy->IAJB', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixB,iyIA,xy->IAJB', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('JxBa,IAya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxBa,IayA,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('JxBy,IAxz,yz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxBy,IAzy,xz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxBy,IyzA,xz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxBy,IzxA,yz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaB,IAya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxaB,IayA,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxay,IABa,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jxay,IaBA,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyB,IAxz,yz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyB,IAzy,xz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyB,IyzA,xz->IAJB', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyB,IzxA,yz->IAJB', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IABa,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxya,IaBA,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxyz,IABy,xz->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IABz,xy->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jxyz,IyBA,xz->IAJB', t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IzBA,xy->IAJB', t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,iyJB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxB,IyiA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iJxB,iyIA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixAy,JIiB,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJB,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixBy,IJiA,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixBy,iJIA,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiB,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJB,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyB,IJiA,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyB,iJIA,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiB,xy->IAJB', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,iyJB,xy->IAJB', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxB,IyiA,xy->IAJB', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('iJxB,iyIA,xy->IAJB', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixAy,JIiB,yx->IAJB', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJB,yx->IAJB', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixBy,IJiA,yx->IAJB', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixBy,iJIA,yx->IAJB', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiB,yx->IAJB', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJB,yx->IAJB', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyB,IJiA,yx->IAJB', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyB,iJIA,yx->IAJB', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IxBJ,zy->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzA,IyBJ,zx->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzA,JIxB,zy->IAJB', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzA,JIyB,zx->IAJB', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzB,IJxA,zy->IAJB', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzB,IJyA,zx->IAJB', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzB,JxAI,zy->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzB,JyAI,zx->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,iB->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xe, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,iB->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_ve, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,xA,xB->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,iA,iB->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xe, optimize = einsum_type)
        temp -= einsum('B,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('B,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('B,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= einsum('B,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,iA,iB->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_ve, optimize = einsum_type)
        temp -= einsum('B,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= einsum('B,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('B,IJ,ijAa,ijBa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijAa,jiBa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= einsum('B,IJ,ijxA,ijxB->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,jixB->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,xA,xB->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ia,Ja->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xe, optimize = einsum_type)
        temp += einsum('I,AB,Iiab,Jiab->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iiab,Jiba->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('I,AB,Iixa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('I,AB,Iixy,Jixy->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jiyx->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('I,AB,Iiab,Jiab->IAJB', e_cvs, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iiab,Jiba->IAJB', e_cvs, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('I,AB,Iixa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('I,AB,Iixy,Jixy->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jiyx->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ix,Jx->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,iIxa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('I,AB,iIxa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,iIxa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('I,AB,iIxa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ia,Ja->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xe, optimize = einsum_type)
        temp += einsum('J,AB,Iiab,Jiab->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iiab,Jiba->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('J,AB,Iixa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('J,AB,Iixy,Jixy->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jiyx->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('J,AB,Iiab,Jiab->IAJB', e_cvs, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iiab,Jiba->IAJB', e_cvs, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('J,AB,Iixa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('J,AB,Iixy,Jixy->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jiyx->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ix,Jx->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,iIxa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('J,AB,iIxa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,iIxa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('J,AB,iIxa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('a,AB,Ja,Ia->IAJB', e_extern, np.identity(nextern), t1_xe, t1_xe, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jiab,Iiab->IAJB', e_extern, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,AB,Jiab,Iiba->IAJB', e_extern, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,AB,Jiba,Iiab->IAJB', e_extern, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jiba,Iiba->IAJB', e_extern, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jixa,Iixa->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,AB,Jixa,iIxa->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jiab,Iiab->IAJB', e_extern, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,AB,Jiab,Iiba->IAJB', e_extern, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,AB,Jiba,Iiab->IAJB', e_extern, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jiba,Iiba->IAJB', e_extern, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,Jixa,Iixa->IAJB', e_extern, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('a,AB,Jixa,iIxa->IAJB', e_extern, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('a,AB,iJxa,Iixa->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,iJxa,iIxa->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,AB,iJxa,Iixa->IAJB', e_extern, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('a,AB,iJxa,iIxa->IAJB', e_extern, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijBa,ijAa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,IJ,ijBa,jiAa->IAJB', e_extern, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijBa,ijAa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,IJ,ijBa,jiAa->IAJB', e_extern, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijBa,ijAa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp += einsum('a,IJ,ijBa,jiAa->IAJB', e_extern, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijBa,ijAa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('a,IJ,ijBa,jiAa->IAJB', e_extern, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('i,AB,Iiab,Jiab->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iiab,Jiba->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,AB,Iixa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,AB,Iixy,Jixy->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jiyx->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,AB,Jiab,Iiab->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jiab,Iiba->IAJB', e_cvs, np.identity(nextern), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,AB,Jixa,Iixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixa,iIxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,AB,Jixy,Iixy->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iiyx->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iIxa,Jixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,AB,iIxa,iJxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iJxa,Iixa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,AB,iJxa,iIxa->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,iA,iB->IAJB', e_cvs, np.identity(ncvs), t1_xe, t1_xe, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijBa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiBa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,ijBa,ijAa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijBa,jiAa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,ijxB->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jixB->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijxB,ijxA->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,jixA->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijBa->IAJB', e_cvs, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiBa->IAJB', e_cvs, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,ijBa,ijAa->IAJB', e_cvs, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijBa,jiAa->IAJB', e_cvs, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,ijxB->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jixB->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijxB,ijxA->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,jixA->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijBa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiBa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiBa,ijAa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiBa,jiAa->IAJB', e_cvs, np.identity(ncvs), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijxB->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,jixB->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,ijxA->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixB,jixA->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijBa->IAJB', e_cvs, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiBa->IAJB', e_cvs, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiBa,ijAa->IAJB', e_cvs, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiBa,jiAa->IAJB', e_cvs, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijxB->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,jixB->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,ijxA->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixB,jixA->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,AB,Iiab,Jiab->IAJB', e_val, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iiab,Jiba->IAJB', e_val, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,AB,Iixa,Jixa->IAJB', e_val, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixa,iJxa->IAJB', e_val, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,AB,Iixy,Jixy->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jiyx->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,AB,Jiab,Iiab->IAJB', e_val, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jiab,Iiba->IAJB', e_val, np.identity(nextern), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,AB,Jixa,Iixa->IAJB', e_val, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixa,iIxa->IAJB', e_val, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,AB,Jixy,Iixy->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iiyx->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iIxa,Jixa->IAJB', e_val, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,AB,iIxa,iJxa->IAJB', e_val, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iJxa,Iixa->IAJB', e_val, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,AB,iJxa,iIxa->IAJB', e_val, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,iA,iB->IAJB', e_val, np.identity(ncvs), t1_ve, t1_ve, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijBa->IAJB', e_val, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiBa->IAJB', e_val, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,ijBa,ijAa->IAJB', e_val, np.identity(ncvs), t1_vxee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijBa,jiAa->IAJB', e_val, np.identity(ncvs), t1_vxee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,ijxB->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jixB->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijxB,ijxA->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,jixA->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijBa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiBa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,ijBa,ijAa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijBa,jiAa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,ijxB->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jixB->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijxB,ijxA->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,jixA->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijBa->IAJB', e_val, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiBa->IAJB', e_val, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiBa,ijAa->IAJB', e_val, np.identity(ncvs), t1_xvee, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiBa,jiAa->IAJB', e_val, np.identity(ncvs), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijxB->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,jixB->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,ijxA->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixB,jixA->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijBa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiBa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiBa,ijAa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiBa,jiAa->IAJB', e_val, np.identity(ncvs), t1_vvee, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijxB->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,jixB->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,ijxA->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixB,jixA->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,JiyB,xy->IAJB', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,iJyB,xy->IAJB', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAa,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IxAy,JxBz,yz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,JxzB,yz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAy,JzBy,xz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,JzyB,xz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxaA,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxaA,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JxBz,yz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JxzB,yz->IAJB', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JzBy,xz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JzyB,xz->IAJB', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyB,xy->IAJB', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,iJyB,xy->IAJB', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IixA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IixA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IixA,JiyB,xy->IAJB', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IixA,iJyB,xy->IAJB', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IxAa,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxAa,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IxAy,JxBz,yz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxAy,JxzB,yz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IxAy,JzBy,xz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxAy,JzyB,xz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxaA,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxaA,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxyA,JxBz,yz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxyA,JxzB,yz->IAJB', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxyA,JzBy,xz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxyA,JzyB,xz->IAJB', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,iIxA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,iIxA,JiyB,xy->IAJB', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,iJyB,xy->IAJB', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,JiyB,xy->IAJB', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,iJyB,xy->IAJB', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAa,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAy,JxBz,yz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,JxzB,yz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAy,JzBy,xz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,JzyB,xz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaA,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JxBz,yz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JxzB,yz->IAJB', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JzBy,xz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JzyB,xz->IAJB', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyB,xy->IAJB', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,iJyB,xy->IAJB', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,JiyB,xy->IAJB', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,iJyB,xy->IAJB', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAa,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxAy,JxBz,yz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,JxzB,yz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAy,JzBy,xz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,JzyB,xz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaA,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaA,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JxBz,yz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JxzB,yz->IAJB', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JzBy,xz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JzyB,xz->IAJB', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyB,xy->IAJB', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,iJyB,xy->IAJB', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxBa,IyAa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxBa,IyaA,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaB,IyAa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JxaB,IyaA,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiyB,xy->IAJB', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,iJyB,xy->IAJB', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyB,xy->IAJB', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,iJyB,xy->IAJB', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ia,AB,Jxay,xy->IAJB', h_xe, np.identity(nextern), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,AB,Jxya,xy->IAJB', h_xe, np.identity(nextern), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ix,AB,Jyxz,yz->IAJB', h_xa, np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,AB,Jyzx,yz->IAJB', h_xa, np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ja,AB,Ixay,xy->IAJB', h_xe, np.identity(nextern), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,AB,Ixya,xy->IAJB', h_xe, np.identity(nextern), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jx,AB,Iyxz,yz->IAJB', h_xa, np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,AB,Iyzx,yz->IAJB', h_xa, np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iA,IJ,ixBy,yx->IAJB', h_xe, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,IJ,ixyB,yx->IAJB', h_xe, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('iB,IJ,ixAy,yx->IAJB', h_xe, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iB,IJ,ixyA,yx->IAJB', h_xe, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('iA,IJ,ixBy,yx->IAJB', h_ve, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,IJ,ixyB,yx->IAJB', h_ve, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('iB,IJ,ixAy,yx->IAJB', h_ve, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iB,IJ,ixyA,yx->IAJB', h_ve, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xA,IJ,xyzB,zy->IAJB', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xA,IJ,yxzB,zy->IAJB', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xB,IJ,xyzA,zy->IAJB', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xB,IJ,yxzA,zy->IAJB', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iixa,Jiya->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,AB,Iixa,iJya->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iixz,Jiyz->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iixz,Jizy->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iizx,Jiyz->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iizx,Jizy->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iixa,Jiya->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('xy,AB,Iixa,iJya->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iixz,Jiyz->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iixz,Jizy->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iizx,Jiyz->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,Iizx,Jizy->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,AB,Ix,Jy->IAJB', h_aa, np.identity(nextern), t1_xa, t1_xa, optimize = einsum_type)
        temp += einsum('xy,AB,iIxa,Jiya->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,iIxa,iJya->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,AB,iIxa,Jiya->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('xy,AB,iIxa,iJya->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,ijyB->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,jiyB->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,ijyB->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,jiyB->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,ijyB->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,jiyB->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,ijyB->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,jiyB->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('xy,IJ,xA,yB->IAJB', h_aa, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixA,JizB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,iJzB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixA,JizB,yz->IAJB', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,iJzB,yz->IAJB', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAa,JzBa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,JzaB,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JwBz,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,JwzB,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IxAz,JyBw,zw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JywB,zw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaA,JzBa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,JzaB,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzA,JwBz,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzA,JwzB,yw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzA,JyBw,zw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IxzA,JywB,zw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IzAx,JwBy,zw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JwyB,zw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JzBw,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,JzwB,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxA,JwBy,zw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxA,JwyB,zw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxA,JzBw,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IzxA,JzwB,yw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixB,IizA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixB,iIzA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixB,IizA,yz->IAJB', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixB,iIzA,yz->IAJB', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxBa,IzAa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxBa,IzaA,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxBz,IwAz,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxBz,IwzA,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaB,IzAa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxaB,IzaA,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzB,IwAz,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxzB,IwzA,yw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzBx,IzAw,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzBx,IzwA,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxB,IzAw,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JzxB,IzwA,yw->IAJB', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,iJzB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxB,IizA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iJxB,iIzA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizB,yz->IAJB', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,iJzB,yz->IAJB', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxB,IizA,yz->IAJB', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iJxB,iIzA,yz->IAJB', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ia,Jaxy,xy->IAJB', np.identity(nextern), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ia,Jxya,yx->IAJB', np.identity(nextern), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixa,Jyia,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixa,iyJa,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jxiz,yz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jyiz,xz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jziw,xyzw->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jzix,yz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jziy,xz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixa,Jyia,xy->IAJB', np.identity(nextern), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixa,iyJa,xy->IAJB', np.identity(nextern), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jxiz,yz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jyiz,xz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jziw,xyzw->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Iixy,Jzix,yz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Iixy,Jziy,xz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ix,Jxyz,yz->IAJB', np.identity(nextern), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ix,Jyzx,zy->IAJB', np.identity(nextern), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ixab,Jayb,xy->IAJB', np.identity(nextern), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixab,Jbya,xy->IAJB', np.identity(nextern), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ixay,Jazw,xwyz->IAJB', np.identity(nextern), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Ixay,Jazy,xz->IAJB', np.identity(nextern), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixay,Jyza,xz->IAJB', np.identity(nextern), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixay,Jzwa,xzyw->IAJB', np.identity(nextern), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixya,Jazw,xwyz->IAJB', np.identity(nextern), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixya,Jazy,xz->IAJB', np.identity(nextern), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ixya,Jyza,xz->IAJB', np.identity(nextern), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixya,Jzwa,xzwy->IAJB', np.identity(nextern), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixyz,Jwuy,xwzu->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixyz,Jwuz,xwuy->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Ixyz,Jwxu,yzwu->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Ixyz,Jywu,xuzw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Ixyz,Jywz,xw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixyz,Jzwu,xuyw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ixyz,Jzwy,xw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Ja,Iaxy,xy->IAJB', np.identity(nextern), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Ja,Ixya,yx->IAJB', np.identity(nextern), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixa,Iyia,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixa,iyIa,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixy,Ixiz,yz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Iyiz,xz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Iziw,xyzw->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Izix,yz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixy,Iziy,xz->IAJB', np.identity(nextern), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixa,Iyia,xy->IAJB', np.identity(nextern), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixa,iyIa,xy->IAJB', np.identity(nextern), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixy,Ixiz,yz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Iyiz,xz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Iziw,xyzw->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jixy,Izix,yz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,Jixy,Iziy,xz->IAJB', np.identity(nextern), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Jx,Ixyz,yz->IAJB', np.identity(nextern), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jx,Iyzx,zy->IAJB', np.identity(nextern), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Jxab,Iayb,xy->IAJB', np.identity(nextern), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxab,Ibya,xy->IAJB', np.identity(nextern), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Jxay,Iazw,xwyz->IAJB', np.identity(nextern), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Jxay,Iazy,xz->IAJB', np.identity(nextern), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxay,Iyza,xz->IAJB', np.identity(nextern), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxay,Izwa,xzyw->IAJB', np.identity(nextern), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxya,Iazw,xwyz->IAJB', np.identity(nextern), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxya,Iazy,xz->IAJB', np.identity(nextern), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,Jxya,Iyza,xz->IAJB', np.identity(nextern), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxya,Izwa,xzwy->IAJB', np.identity(nextern), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxyz,Iwuy,xwzu->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxyz,Iwuz,xwuy->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,Jxyz,Iwxu,yzwu->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Jxyz,Iywu,xuzw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,Jxyz,Iywz,xw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxyz,Izwu,xuyw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,Jxyz,Izwy,xw->IAJB', np.identity(nextern), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,iIxa,Jyia,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,iIxa,iyJa,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,iJxa,Iyia,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,iJxa,iyIa,xy->IAJB', np.identity(nextern), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ix,IJiy,xy->IAJB', np.identity(nextern), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ix,JIiy,xy->IAJB', np.identity(nextern), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ix,iIJy,xy->IAJB', np.identity(nextern), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ix,iJIy,xy->IAJB', np.identity(nextern), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixay,IJia,xy->IAJB', np.identity(nextern), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixay,JIia,yx->IAJB', np.identity(nextern), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixay,iIJa,yx->IAJB', np.identity(nextern), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixay,iJIa,xy->IAJB', np.identity(nextern), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixya,IJia,xy->IAJB', np.identity(nextern), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixya,JIia,yx->IAJB', np.identity(nextern), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixya,iIJa,yx->IAJB', np.identity(nextern), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixya,iJIa,xy->IAJB', np.identity(nextern), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,IJiw,xwzy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixyz,IJiy,xz->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,IJiz,xy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,JIiw,xwzy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixyz,JIiy,zx->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,JIiz,yx->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iIJw,xwzy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,ixyz,iIJy,zx->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iIJz,yx->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iJIw,xwzy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,ixyz,iJIy,xz->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iJIz,xy->IAJB', np.identity(nextern), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,iIxa,Jyia,xy->IAJB', np.identity(nextern), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,iIxa,iyJa,xy->IAJB', np.identity(nextern), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,iJxa,Iyia,xy->IAJB', np.identity(nextern), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,iJxa,iyIa,xy->IAJB', np.identity(nextern), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ix,IJiy,xy->IAJB', np.identity(nextern), t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ix,JIiy,xy->IAJB', np.identity(nextern), t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ix,iIJy,xy->IAJB', np.identity(nextern), t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ix,iJIy,xy->IAJB', np.identity(nextern), t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixay,IJia,xy->IAJB', np.identity(nextern), t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixay,JIia,yx->IAJB', np.identity(nextern), t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixay,iIJa,yx->IAJB', np.identity(nextern), t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixay,iJIa,xy->IAJB', np.identity(nextern), t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixya,IJia,xy->IAJB', np.identity(nextern), t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixya,JIia,yx->IAJB', np.identity(nextern), t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixya,iIJa,yx->IAJB', np.identity(nextern), t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixya,iJIa,xy->IAJB', np.identity(nextern), t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,IJiw,xwzy->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixyz,IJiy,xz->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,IJiz,xy->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,JIiw,xwzy->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,ixyz,JIiy,zx->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,ixyz,JIiz,yx->IAJB', np.identity(nextern), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iIJw,xwzy->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,ixyz,iIJy,zx->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iIJz,yx->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iJIw,xwzy->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,ixyz,iJIy,xz->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,ixyz,iJIz,xy->IAJB', np.identity(nextern), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xa,IJya,xy->IAJB', np.identity(nextern), t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xa,IyaJ,xy->IAJB', np.identity(nextern), t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xa,JIya,xy->IAJB', np.identity(nextern), t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xa,JyaI,xy->IAJB', np.identity(nextern), t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xyza,IJwa,zwxy->IAJB', np.identity(nextern), t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyza,IwaJ,zwxy->IAJB', np.identity(nextern), t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyza,JIwa,zwxy->IAJB', np.identity(nextern), t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyza,JwaI,zwxy->IAJB', np.identity(nextern), t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iA,iBxy,yx->IAJB', np.identity(ncvs), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iA,ixyB,xy->IAJB', np.identity(ncvs), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iB,iAxy,yx->IAJB', np.identity(ncvs), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iB,ixyA,xy->IAJB', np.identity(ncvs), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iyjB,xy->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,jyiB,xy->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxB,iyjA,xy->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxB,jyiA,xy->IAJB', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iyjB,xy->IAJB', np.identity(ncvs), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,jyiB,xy->IAJB', np.identity(ncvs), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxB,iyjA,xy->IAJB', np.identity(ncvs), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxB,jyiA,xy->IAJB', np.identity(ncvs), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iABy,xy->IAJB', np.identity(ncvs), t1_xa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iBAy,xy->IAJB', np.identity(ncvs), t1_xa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyAB,xy->IAJB', np.identity(ncvs), t1_xa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyBA,xy->IAJB', np.identity(ncvs), t1_xa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAa,iBya,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAa,iayB,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iBzw,yzxw->IAJB', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iBzy,xz->IAJB', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,iyzB,xz->IAJB', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,izwB,ywxz->IAJB', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixBa,iAya,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBa,iayA,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixBy,iAzw,yzxw->IAJB', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixBy,iAzy,xz->IAJB', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBy,iyzA,xz->IAJB', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBy,izwA,ywxz->IAJB', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaA,iBya,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaA,iayB,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaB,iAya,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaB,iayA,xy->IAJB', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iABa,yx->IAJB', np.identity(ncvs), t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iBAa,xy->IAJB', np.identity(ncvs), t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaAB,xy->IAJB', np.identity(ncvs), t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaBA,yx->IAJB', np.identity(ncvs), t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iBzw,yzxw->IAJB', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iBzy,xz->IAJB', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyA,iyzB,xz->IAJB', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,izwB,ywzx->IAJB', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,iAzw,yzxw->IAJB', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,iAzy,xz->IAJB', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyB,iyzA,xz->IAJB', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,izwA,ywzx->IAJB', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iABa,yx->IAJB', np.identity(ncvs), t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iBAa,xy->IAJB', np.identity(ncvs), t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaAB,xy->IAJB', np.identity(ncvs), t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaBA,yx->IAJB', np.identity(ncvs), t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iABw,xwzy->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iABy,zx->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iABz,yx->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iBAw,xwzy->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iBAy,xz->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iBAz,xy->IAJB', np.identity(ncvs), t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwAB,xwzy->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwBA,xwzy->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyAB,xz->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyBA,zx->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izAB,xy->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izBA,yx->IAJB', np.identity(ncvs), t1_xaaa, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iA,iBxy,yx->IAJB', np.identity(ncvs), t1_ve, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iA,ixyB,xy->IAJB', np.identity(ncvs), t1_ve, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iB,iAxy,yx->IAJB', np.identity(ncvs), t1_ve, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iB,ixyA,xy->IAJB', np.identity(ncvs), t1_ve, v_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iyjB,xy->IAJB', np.identity(ncvs), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,jyiB,xy->IAJB', np.identity(ncvs), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxB,iyjA,xy->IAJB', np.identity(ncvs), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxB,jyiA,xy->IAJB', np.identity(ncvs), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iyjB,xy->IAJB', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,jyiB,xy->IAJB', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxB,iyjA,xy->IAJB', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxB,jyiA,xy->IAJB', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iABy,xy->IAJB', np.identity(ncvs), t1_va, v_veea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iBAy,xy->IAJB', np.identity(ncvs), t1_va, v_veea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyAB,xy->IAJB', np.identity(ncvs), t1_va, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyBA,xy->IAJB', np.identity(ncvs), t1_va, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAa,iBya,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAa,iayB,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iBzw,yzxw->IAJB', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iBzy,xz->IAJB', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,iyzB,xz->IAJB', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,izwB,ywxz->IAJB', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixBa,iAya,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBa,iayA,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixBy,iAzw,yzxw->IAJB', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixBy,iAzy,xz->IAJB', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBy,iyzA,xz->IAJB', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixBy,izwA,ywxz->IAJB', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaA,iBya,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaA,iayB,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaB,iAya,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaB,iayA,xy->IAJB', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iABa,yx->IAJB', np.identity(ncvs), t1_vaea, v_veee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iBAa,xy->IAJB', np.identity(ncvs), t1_vaea, v_veee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaAB,xy->IAJB', np.identity(ncvs), t1_vaea, v_veee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaBA,yx->IAJB', np.identity(ncvs), t1_vaea, v_veee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iBzw,yzxw->IAJB', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iBzy,xz->IAJB', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyA,iyzB,xz->IAJB', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,izwB,ywzx->IAJB', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,iAzw,yzxw->IAJB', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,iAzy,xz->IAJB', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyB,iyzA,xz->IAJB', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyB,izwA,ywzx->IAJB', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iABa,yx->IAJB', np.identity(ncvs), t1_vaae, v_veee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iBAa,xy->IAJB', np.identity(ncvs), t1_vaae, v_veee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaAB,xy->IAJB', np.identity(ncvs), t1_vaae, v_veee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaBA,yx->IAJB', np.identity(ncvs), t1_vaae, v_veee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iABw,xwzy->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iABy,zx->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iABz,yx->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iBAw,xwzy->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iBAy,xz->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iBAz,xy->IAJB', np.identity(ncvs), t1_vaaa, v_veea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwAB,xwzy->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwBA,xwzy->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyAB,xz->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyBA,zx->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izAB,xy->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izBA,yx->IAJB', np.identity(ncvs), t1_vaaa, v_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xA,xyzB,yz->IAJB', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xA,yzxB,zy->IAJB', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xB,xyzA,yz->IAJB', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xB,yzxA,zy->IAJB', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yABa,xy->IAJB', np.identity(ncvs), t1_ae, v_aeee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yBAa,xy->IAJB', np.identity(ncvs), t1_ae, v_aeee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xa,yaAB,xy->IAJB', np.identity(ncvs), t1_ae, v_aeee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xa,yaBA,xy->IAJB', np.identity(ncvs), t1_ae, v_aeee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyAa,zBwa,xyzw->IAJB', np.identity(ncvs), t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyBa,zAwa,xyzw->IAJB', np.identity(ncvs), t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,wuxB,zwyu->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,wuyB,zwxu->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzA,wzuB,yxuw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,xwuB,zuwy->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,xwyB,zw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,ywuB,zuxw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,ywxB,zw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzB,wuxA,zwyu->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzB,wuyA,zwxu->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzB,wzuA,yxuw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzB,xwuA,zuwy->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzB,xwyA,zw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzB,ywuA,zuxw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzB,ywxA,zw->IAJB', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wABa,zwxy->IAJB', np.identity(ncvs), t1_aaae, v_aeee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wBAa,zwxy->IAJB', np.identity(ncvs), t1_aaae, v_aeee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,waAB,zwxy->IAJB', np.identity(ncvs), t1_aaae, v_aeee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,waBA,zwxy->IAJB', np.identity(ncvs), t1_aaae, v_aeee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixz,Jiyw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixz,Jiyw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixA,JiuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,JiwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixA,JiyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,iJuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,iJwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,iJyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixA,JiuB,zuwy->IAJB', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,JiwB,zy->IAJB', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixA,JiyB,zw->IAJB', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,iJuB,zuwy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,iJwB,zy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,iJyB,zw->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JuBv,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,JuvB,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvBw,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvBy,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvwB,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvyB,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuAx,JzBv,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuAx,JzvB,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxA,JuBv,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IuxA,JuvB,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvBw,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvBy,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JvwB,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JvwB,zuyv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JvyB,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JzBv,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JzvB,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JzvB,ywvu->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAa,JuBa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,JuaB,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JvBu,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxAu,JvBz,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,JvuB,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,JvzB,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JwBv,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JwvB,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JyBv,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JyvB,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaA,JuBa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,JuaB,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuA,JvBu,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JvBz,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuA,JvuB,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JvzB,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JvzB,ywvu->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JwBv,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JwvB,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JwvB,zuyv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JyBv,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JyvB,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixB,IiuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixB,iIuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixB,IiuA,zuwy->IAJB', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixB,iIuA,zuwy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuBx,IuAv,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuBx,IuvA,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxB,IuAv,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JuxB,IuvA,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxBa,IuAa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxBa,IuaA,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxBu,IvAu,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxBu,IvuA,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaB,IuAa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxaB,IuaA,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuB,IvAu,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxuB,IvuA,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,iJuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,iJwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,iJyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxB,IiuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iJxB,iIuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuB,zuwy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwB,zy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyB,zw->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,iJuB,zuwy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,iJwB,zy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,iJyB,zw->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxB,IiuA,zuwy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iJxB,iIuA,zuwy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,ixBy,yx->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iA,ixyB,yx->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAa,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAa,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izwB,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixaA,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixaA,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izwB,yzwx->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixyA,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,ixBy,yx->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iA,ixyB,yx->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAa,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAa,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izwB,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixaA,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixaA,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izwB,yzwx->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixyA,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xA,xyzB,zy->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,xA,yxzB,zy->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,xyAa,zwBa,xyzw->IAJB', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,xyzA,wuzB,yxuw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xyzA,wxuB,zwyu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,xyzA,wyuB,zwxu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xyzA,xB,zy->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xyzA,xwuB,zwuy->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,xyzA,xywB,zw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,xyzA,yB,zx->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xyzA,ywuB,zwxu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,xyzA,yxwB,zw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,iA,ixBy,yx->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,iA,ixyB,yx->IAJB', e_extern, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAa,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAa,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAy,izwB,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAy,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixaA,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixaA,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izwB,yzwx->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixyA,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,iA,ixBy,yx->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,iA,ixyB,yx->IAJB', e_extern, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IJ,ijxA,ijyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,ijxA,jiyB,xy->IAJB', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAa,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAa,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixAy,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAy,izwB,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixAy,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixaA,iyBa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixaA,iyaB,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,iB,yx->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izBw,yzxw->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izBy,xz->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,ixyA,izwB,yzwx->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,ixyA,izyB,xz->IAJB', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xA,xyzB,zy->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,xA,yxzB,zy->IAJB', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,xyAa,zwBa,xyzw->IAJB', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IJ,xyzA,wuzB,yxuw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xyzA,wxuB,zwyu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,xyzA,wyuB,zwxu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xyzA,xB,zy->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xyzA,xwuB,zwuy->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,xyzA,xywB,zw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IJ,xyzA,yB,zx->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xyzA,ywuB,zwxu->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('B,IJ,xyzA,yxwB,zw->IAJB', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ia,Jxay,xy->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ia,Jxya,xy->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jizw,xyzw->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jizw,xyzw->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Iixy,Jizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,Iixy,Jizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ix,Jyxz,yz->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ix,Jyzx,yz->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixab,Jyab,xy->IAJB', e_cvs, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixab,Jyba,xy->IAJB', e_cvs, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixay,Ja,xy->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixay,Jzaw,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixay,Jzay,xz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixay,Jzwa,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixay,Jzya,xz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixya,Ja,xy->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixya,Jzaw,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixya,Jzay,xz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixya,Jzwa,xwzy->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixya,Jzya,xz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixyz,Jwuy,xuzw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixyz,Jwuz,xuwy->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixyz,Jwyu,xuzw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixyz,Jwyz,xw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixyz,Jwzu,xuyw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixyz,Jwzy,xw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,Ixyz,Jxwu,yzwu->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,AB,Ixyz,Jy,xz->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,AB,Ixyz,Jz,xy->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,iIxa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,iIxa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,AB,iIxa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,AB,iIxa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ia,Jxay,xy->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ia,Jxya,xy->IAJB', e_cvs, np.identity(nextern), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jizw,xyzw->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jizw,xyzw->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Iixy,Jizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,Iixy,Jizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ix,Jyxz,yz->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ix,Jyzx,yz->IAJB', e_cvs, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixab,Jyab,xy->IAJB', e_cvs, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixab,Jyba,xy->IAJB', e_cvs, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixay,Ja,xy->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixay,Jzaw,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixay,Jzay,xz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixay,Jzwa,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixay,Jzya,xz->IAJB', e_cvs, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixya,Ja,xy->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixya,Jzaw,xwyz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixya,Jzay,xz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixya,Jzwa,xwzy->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixya,Jzya,xz->IAJB', e_cvs, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixyz,Jwuy,xuzw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixyz,Jwuz,xuwy->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixyz,Jwyu,xuzw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixyz,Jwyz,xw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixyz,Jwzu,xuyw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixyz,Jwzy,xw->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,Ixyz,Jxwu,yzwu->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,AB,Ixyz,Jy,xz->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,AB,Ixyz,Jz,xy->IAJB', e_cvs, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,iIxa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,iIxa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,AB,iIxa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,AB,iIxa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,AB,Ja,Ixay,xy->IAJB', e_extern, np.identity(nextern), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Ja,Ixya,xy->IAJB', e_extern, np.identity(nextern), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,AB,Jixa,Iiya,xy->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,AB,Jixa,iIya,xy->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,AB,Jixa,Iiya,xy->IAJB', e_extern, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,AB,Jixa,iIya,xy->IAJB', e_extern, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,AB,Jxab,Iyab,xy->IAJB', e_extern, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxab,Iyba,xy->IAJB', e_extern, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,AB,Jxay,Ia,xy->IAJB', e_extern, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,AB,Jxay,Izaw,xwyz->IAJB', e_extern, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,AB,Jxay,Izay,xz->IAJB', e_extern, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxay,Izwa,xwyz->IAJB', e_extern, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxay,Izya,xz->IAJB', e_extern, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxba,Iyab,xy->IAJB', e_extern, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,AB,Jxba,Iyba,xy->IAJB', e_extern, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxya,Ia,xy->IAJB', e_extern, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxya,Izaw,xwyz->IAJB', e_extern, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxya,Izay,xz->IAJB', e_extern, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,AB,Jxya,Izwa,xwzy->IAJB', e_extern, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,AB,Jxya,Izya,xz->IAJB', e_extern, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,AB,iJxa,Iiya,xy->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,AB,iJxa,iIya,xy->IAJB', e_extern, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,AB,iJxa,Iiya,xy->IAJB', e_extern, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,AB,iJxa,iIya,xy->IAJB', e_extern, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixBa,iyAa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixBa,iyaA,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaB,iyAa,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaB,iyaA,xy->IAJB', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixBa,iyAa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixBa,iyaA,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaB,iyAa,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaB,iyaA,xy->IAJB', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyBa,zwAa,xyzw->IAJB', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixy,Jiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,AB,Iixy,Jizw,xyzw->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixy,Jizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixa,Iiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixa,iIya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iixz,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixy,Iiyz,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixy,Iizx,yz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iizy,xz->IAJB', e_cvs, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,iIxa,Jiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iIxa,iJya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,iJxa,Iiya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iJxa,iIya,xy->IAJB', e_cvs, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iA,ixBy,yx->IAJB', e_cvs, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iA,ixyB,yx->IAJB', e_cvs, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,jiyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,ijyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxB,jiyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,jiyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,ijyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxB,jiyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAa,iyBa,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAa,iyaB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,iB,yx->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,ixBz,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,ixzB,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,izBw,yzxw->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,izBy,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixAy,izwB,yzxw->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,izyB,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixBa,iyAa,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixBa,iyaA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixBy,ixAz,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixBy,ixzA,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixBy,izAy,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixBy,izyA,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaA,iyBa,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaA,iyaB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaB,iyAa,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaB,iyaA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,iB,yx->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,ixBz,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,ixzB,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izBw,yzxw->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,izBy,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izwB,yzwx->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,izyB,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyB,ixAz,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyB,ixzA,yz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyB,izAy,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyB,izyA,xz->IAJB', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,ijyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixB,ijyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,jiyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,ijyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiyB,xy->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixB,ijyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,jiyA,xy->IAJB', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixa,Jiya,xy->IAJB', e_val, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixa,iJya,xy->IAJB', e_val, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jixz,yz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixy,Jiyz,xz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,AB,Iixy,Jizw,xyzw->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Iixy,Jizx,yz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Iixy,Jizy,xz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixa,Iiya,xy->IAJB', e_val, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixa,iIya,xy->IAJB', e_val, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iixz,yz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixy,Iiyz,xz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,Jixy,Iizx,yz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,Jixy,Iizy,xz->IAJB', e_val, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,iIxa,Jiya,xy->IAJB', e_val, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iIxa,iJya,xy->IAJB', e_val, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,AB,iJxa,Iiya,xy->IAJB', e_val, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,AB,iJxa,iIya,xy->IAJB', e_val, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iA,ixBy,yx->IAJB', e_val, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iA,ixyB,yx->IAJB', e_val, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijyB,xy->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,jiyB,xy->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,ijyA,xy->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxB,jiyA,xy->IAJB', e_val, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijyB,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,jiyB,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxB,ijyA,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxB,jiyA,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAa,iyBa,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAa,iyaB,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,iB,yx->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,ixBz,yz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,ixzB,yz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,izBw,yzxw->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,izBy,xz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixAy,izwB,yzxw->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,izyB,xz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixBa,iyAa,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixBa,iyaA,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixBy,ixAz,yz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixBy,ixzA,yz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixBy,izAy,xz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixBy,izyA,xz->IAJB', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaA,iyBa,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaA,iyaB,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaB,iyAa,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaB,iyaA,xy->IAJB', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,iB,yx->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,ixBz,yz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,ixzB,yz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izBw,yzxw->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,izBy,xz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izwB,yzwx->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,izyB,xz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyB,ixAz,yz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyB,ixzA,yz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyB,izAy,xz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyB,izyA,xz->IAJB', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,ijyB,xy->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiyB,xy->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixB,ijyA,xy->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,jiyA,xy->IAJB', e_val, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,ijyB,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiyB,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixB,ijyA,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixB,jiyA,xy->IAJB', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iixa,Jiza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixa,iJza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixz,Jiwu,yzwu->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Iixz,Jiwy,zw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iixz,Jiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,AB,Iixz,Jiyw,zw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixz,Jizw,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iizx,Jiwu,yzuw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iizx,Jiwy,zw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iizx,Jiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Iizx,Jiyw,zw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iizx,Jizw,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iixa,Jiza,yz->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixa,iJza,yz->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixz,Jiwu,yzwu->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Iixz,Jiwy,zw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iixz,Jiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,AB,Iixz,Jiyw,zw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iixz,Jizw,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iizx,Jiwu,yzuw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,AB,Iizx,Jiwy,zw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Iizx,Jiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Iizx,Jiyw,zw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Iizx,Jizw,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ix,Jzwy,zw->IAJB', h_aa, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,AB,Ix,Jzyw,zw->IAJB', h_aa, np.identity(nextern), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixab,Jzab,yz->IAJB', h_aa, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixab,Jzba,yz->IAJB', h_aa, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixaz,Ja,yz->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixaz,Jwau,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixaz,Jwaz,yw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixaz,Jwua,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixaz,Jwza,yw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixza,Ja,yz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixza,Jwau,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixza,Jwaz,yw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixza,Jwua,yuwz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixza,Jwza,yw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixzw,Juvw,yvuz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixzw,Juvz,yvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixzw,Juwv,yvzu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixzw,Juwz,yu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixzw,Juzv,yvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixzw,Juzw,yu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Ixzw,Jw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixzw,Jyuv,zwuv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Ixzw,Jz,yw->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Izax,Ja,yz->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Izax,Jwau,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,AB,Izax,Jway,zw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izax,Jwua,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izax,Jwya,zw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izwx,Juvw,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izwx,Juvy,zvuw->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Izwx,Juwv,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,AB,Izwx,Juwy,zu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izwx,Juyv,zvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izwx,Juyw,zu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Izwx,Jw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izwx,Jy,zw->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Izwx,Jzuv,ywvu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxa,Ja,yz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxa,Jwau,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izxa,Jway,zw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxa,Jwua,ywuz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,AB,Izxa,Jwya,zw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxw,Juvw,yuvz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izxw,Juvy,zvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxw,Juwv,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Izxw,Juwy,zu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,AB,Izxw,Juyv,zvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,AB,Izxw,Juyw,zu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Izxw,Jw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,AB,Izxw,Jy,zw->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Izxw,Jzuv,ywuv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jixa,Iiza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixa,iIza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixz,Iiwu,yzwu->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jixz,Iiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixz,Iizw,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jizx,Iiwu,yzuw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jizx,Iiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jizx,Iizw,yw->IAJB', h_aa, np.identity(nextern), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jixa,Iiza,yz->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixa,iIza,yz->IAJB', h_aa, np.identity(nextern), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixz,Iiwu,yzwu->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jixz,Iiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jixz,Iizw,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jizx,Iiwu,yzuw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jizx,Iiwz,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jizx,Iizw,yw->IAJB', h_aa, np.identity(nextern), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxab,Izab,yz->IAJB', h_aa, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxab,Izba,yz->IAJB', h_aa, np.identity(nextern), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxaz,Ia,yz->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxaz,Iwau,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxaz,Iwaz,yw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxaz,Iwua,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxaz,Iwza,yw->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxza,Ia,yz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxza,Iwau,yuzw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxza,Iwaz,yw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxza,Iwua,yuwz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxza,Iwza,yw->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxzw,Iuvw,yvuz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxzw,Iuvz,yvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxzw,Iuwv,yvzu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxzw,Iuwz,yu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxzw,Iuzv,yvwu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxzw,Iuzw,yu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jxzw,Iw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,Jxzw,Iz,yw->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Jzax,Ia,yz->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Jzax,Iwau,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzax,Iwua,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzwx,Iuvw,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Jzwx,Iuwv,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,AB,Jzwx,Iw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jzwx,Izuv,ywvu->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxa,Ia,yz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxa,Iwau,ywzu->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxa,Iwua,ywuz->IAJB', h_aa, np.identity(nextern), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxw,Iuvw,yuvz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxw,Iuwv,yuzv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,AB,Jzxw,Iw,yz->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,Jzxw,Izuv,ywuv->IAJB', h_aa, np.identity(nextern), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,iIxa,Jiza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,iIxa,iJza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,iJxa,Iiza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,iJxa,iIza,yz->IAJB', h_aa, np.identity(nextern), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,iIxa,Jiza,yz->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,iIxa,iJza,yz->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,AB,iJxa,Iiza,yz->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,AB,iJxa,iIza,yz->IAJB', h_aa, np.identity(nextern), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,ijzB,yz->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,jizB,yz->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxB,ijzA,yz->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxB,jizA,yz->IAJB', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,ijzB,yz->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,jizB,yz->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxB,ijzA,yz->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxB,jizA,yz->IAJB', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAa,izBa,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAa,izaB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwBu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwBz,yw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwuB,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwzB,yw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBa,izAa,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBa,izaA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iwAu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iwAz,yw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBz,iwuA,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBz,iwzA,yw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaA,izBa,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaA,izaB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaB,izAa,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaB,izaA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwBu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwBz,yw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwuB,yuwz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzA,iwzB,yw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwAu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwAz,yw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwuA,yuwz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzB,iwzA,yw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iwBu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izAx,iwBy,zw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izAx,iwuB,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izAx,iwyB,zw->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izBx,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izBx,iwAu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izBx,iwuA,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwBu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxA,iwBy,zw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwuB,ywuz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxA,iwyB,zw->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iwAu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iwuA,ywuz->IAJB', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,ijzB,yz->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,jizB,yz->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxB,ijzA,yz->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxB,jizA,yz->IAJB', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,ijzB,yz->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,jizB,yz->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxB,ijzA,yz->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxB,jizA,yz->IAJB', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAa,izBa,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAa,izaB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwBu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwBz,yw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwuB,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwzB,yw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBa,izAa,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBa,izaA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iwAu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixBz,iwAz,yw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBz,iwuA,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixBz,iwzA,yw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaA,izBa,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaA,izaB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaB,izAa,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaB,izaA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwBu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwBz,yw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwuB,yuwz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzA,iwzB,yw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwAu,yuzw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwAz,yw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzB,iwuA,yuwz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzB,iwzA,yw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iwBu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izAx,iwBy,zw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izAx,iwuB,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izAx,iwyB,zw->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izBx,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izBx,iwAu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izBx,iwuA,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iB,yz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwBu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxA,iwBy,zw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwuB,ywuz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxA,iwyB,zw->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iA,yz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iwAu,ywzu->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxB,iwuA,ywuz->IAJB', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xA,yzwB,wz->IAJB', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,xA,zywB,wz->IAJB', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzAa,wuBa,yzwu->IAJB', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzBa,wuAa,yzwu->IAJB', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwA,uvwB,yzuv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwA,uyvB,wuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,xzwA,uzvB,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwA,yB,wz->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwA,yuvB,wuvz->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,xzwA,yzuB,wu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,xzwA,zB,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,xzwA,zuvB,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwA,zyuB,wu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwB,uvwA,yzuv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,xzwB,uzvA,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,xzwB,zA,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,xzwB,zuvA,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxA,uvyB,wzvu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxA,uwvB,yuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxA,uzvB,yuwv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxA,wB,yz->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxA,wuvB,yuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxA,wzuB,yu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxA,zB,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxA,zuvB,yuvw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxA,zwuB,yu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxB,uwvA,yuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxB,uzvA,yuwv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxB,wA,yz->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxB,wuvA,yuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxB,wzuA,yu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxB,zA,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zwxB,zuvA,yuvw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zwxB,zwuA,yu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxAa,wuBa,yzuw->IAJB', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxBa,wuAa,yzuw->IAJB', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwA,uvwB,yzvu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,zxwA,uyvB,wuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwA,uzvB,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,zxwA,yB,wz->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zxwA,yuvB,wuzv->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zxwA,yzuB,wu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwA,zB,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwA,zuvB,yvuw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,zxwA,zyuB,wu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwB,uvwA,yzvu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwB,uzvA,yvwu->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwB,zA,yw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zxwB,zuvA,yvuw->IAJB', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iiux,Jiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiuw,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iiux,Jiuy,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iiux,Jivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iiux,Jivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jivw,zvyu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jivy,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiwu,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiwv,zvuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiwy,zu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiyu,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiyv,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiyw,zu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iixa,Jiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixa,Jiwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixa,Jiya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixa,iJua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixa,iJwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixa,iJya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixu,Jiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiuw,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiuy,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsuyw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iixu,Jivs,zvswyu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsyuw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsywu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iixu,Jivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jivw,zvuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jivy,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiwu,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiwv,zvyu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiwy,zu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixu,Jiyu,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiyv,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiyw,zu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixz,Jiuv,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiuw,yu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixz,Jiuy,wu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixz,Jiwu,yu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiyu,wu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iiux,Jiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiuw,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iiux,Jiuy,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iiux,Jivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iiux,Jivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jivw,zvyu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jivy,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiwu,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiwv,zvuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiwy,zu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iiux,Jiyu,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiyv,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iiux,Jiyw,zu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iixa,Jiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixa,Jiwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixa,Jiya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixa,iJua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixa,iJwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixa,iJya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixu,Jiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiuw,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiuy,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsuyw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iixu,Jivs,zvswyu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsyuw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iixu,Jivs,zvsywu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iixu,Jivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jivw,zvuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jivy,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiwu,zy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiwv,zvyu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixu,Jiwy,zu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,Iixu,Jiyu,zw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiyv,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixu,Jiyw,zu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iixz,Jiuv,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiuw,yu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixz,Jiuy,wu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iixz,Jiwu,yu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,Iixz,Jiyu,wu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iuax,Ja,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvas,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvas,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvas,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Iuax,Jvas,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvas,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvas,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuax,Jvaw,zuvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuax,Jvay,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuax,Jvsa,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuax,Jvsa,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuax,Jvsa,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuax,Jvsa,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuax,Jvsa,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuax,Jvsa,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuax,Jvwa,zuvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuax,Jvya,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuax,Jzav,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuax,Jzva,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuvx,Jstv,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuvx,Jstv,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuvx,Jstv,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jstv,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuvx,Jstv,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuvx,Jstv,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jstw,zutsyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jsty,zutsvw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jsty,zutswv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jsty,zutvsw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jsty,zutvws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Iuvx,Jsty,zutwsv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jsty,zutwvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jsvt,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jsvt,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jsvt,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Iuvx,Jsvt,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jsvt,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jsvt,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuvx,Jsvw,zusy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuvx,Jsvy,zuws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jswt,zutsvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jswt,zutsyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jswt,zutvsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Iuvx,Jswt,zutvys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jswt,zutysv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuvx,Jswt,zutyvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jswv,zusy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jswy,zuvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jsyt,zutwvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jsyv,zuws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jsyw,zusv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuvx,Just,zstwvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iuvx,Jv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jw,zuvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jy,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jzst,ywvstu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jzst,ywvsut->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jzst,ywvtsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jzst,ywvtus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuvx,Jzst,ywvust->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Iuvx,Jzst,ywvuts->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuvx,Jzsv,ywus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuvx,Jzvs,ywus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Iuxa,Ja,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxa,Jvas,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxa,Jvas,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxa,Jvas,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuxa,Jvas,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxa,Jvas,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxa,Jvas,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxa,Jvaw,zuvy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxa,Jvay,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Iuxa,Jvsa,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxa,Jvwa,zuyv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxa,Jvya,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuxa,Jzav,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuxa,Jzva,ywvu->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Iuxv,Jstv,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Iuxv,Jstw,zutsvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Jstw,zutsyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Jstw,zutvsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Jstw,zutvys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Jstw,zutysv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Jstw,zutyvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jsty,zutwvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxv,Jsvt,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxv,Jsvt,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxv,Jsvt,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Iuxv,Jsvt,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxv,Jsvt,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Iuxv,Jsvt,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jsvw,zusy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jsvy,zuws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jswt,zutyvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jswv,zuys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jswy,zusv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxv,Jsyt,zutwvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxv,Jsyv,zuws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxv,Jsyw,zusv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iuxv,Just,zstvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iuxv,Just,zstvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iuxv,Just,zstwvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Iuxv,Just,zstwyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iuxv,Just,zstyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Iuxv,Just,zstywv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Iuxv,Jv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxv,Jw,zuyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxv,Jy,zuwv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Iuxv,Jzst,ywvstu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuxv,Jzsv,ywsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuxv,Jzvs,ywus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Iuxz,Juvs,ywvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxz,Jvsw,yvsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxz,Jvsy,wvus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxz,Jvws,yvus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxz,Jvwy,uv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxz,Jvys,wvus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxz,Jvyw,uv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Iuxz,Jw,yu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Iuxz,Jy,wu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ix,Juvw,zvuy->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ix,Juvy,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ix,Juwv,zvyu->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ix,Juwy,zu->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Ix,Juyv,zvwu->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Ix,Juyw,zu->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ix,Jw,zy->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('AB,xyzw,Ix,Jy,zw->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Ix,Jzuv,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixab,Juab,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixab,Juba,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixau,Ja,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvas,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvas,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvas,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Ixau,Jvas,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvas,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvas,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixau,Jvau,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixau,Jvaz,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixau,Jvsa,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixau,Jvsa,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixau,Jvsa,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixau,Jvsa,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixau,Jvsa,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixau,Jvsa,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixau,Jvua,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixau,Jvza,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixua,Ja,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixua,Jvas,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixua,Jvas,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixua,Jvas,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixua,Jvas,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixua,Jvas,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixua,Jvas,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixua,Jvau,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixua,Jvaz,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixua,Jvsa,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixua,Jvua,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixua,Jvza,ywvu->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jstu,zvstwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jstu,zvstyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jstu,zvswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jstu,zvswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jstu,zvsytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jstu,zvsywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jstv,zuswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Ixuv,Jstz,ywtvsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsut,zvstwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsut,zvstyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsut,zvswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Ixuv,Jsut,zvswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsut,zvsytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsut,zvsywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixuv,Jsuv,zswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixuv,Jsuz,ywvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jsvt,zustwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jsvt,zustyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jsvt,zuswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jsvt,zuswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jsvt,zusytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Ixuv,Jsvt,zusywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jsvu,zswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jsvz,ywus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Ixuv,Jszt,ywtsuv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Ixuv,Jszt,ywtsvu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Ixuv,Jszt,ywtusv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Ixuv,Jszt,ywtuvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Ixuv,Jszt,ywtvsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Ixuv,Jszt,ywtvus->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jszu,ywvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jszv,ywsu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixuv,Ju,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Ixuv,Jv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jwst,zuvsty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jwst,zuvsyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Ixuv,Jwst,zuvtsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jwst,zuvtys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jwst,zuvyst->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Ixuv,Jwst,zuvyts->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Ixuv,Jyst,zuvwst->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Ixuv,Jz,ywvu->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jiux,Iiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jiux,Iivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jiux,Iivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jixa,Iiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixa,iIua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixu,Iiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsuyw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jixu,Iivs,zvswyu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsyuw->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsywu->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jixu,Iivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixz,Iiuv,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jiux,Iiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jiux,Iivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jiux,Iivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jixa,Iiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixa,iIua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixu,Iiuv,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsuwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsuyw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvswuy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jixu,Iivs,zvswyu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsyuw->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jixu,Iivs,zvsywu->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jixu,Iivu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jixz,Iiuv,ywuv->IAJB', np.identity(nextern), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Juax,Ia,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivas,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivas,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivas,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Juax,Ivas,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivas,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivas,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juax,Ivsa,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juax,Ivsa,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juax,Ivsa,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juax,Ivsa,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juax,Ivsa,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juax,Ivsa,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juvx,Istv,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juvx,Istv,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juvx,Istv,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Istv,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juvx,Istv,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juvx,Istv,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Isvt,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Isvt,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Isvt,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('AB,xyzw,Juvx,Isvt,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Isvt,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juvx,Isvt,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Juvx,Iust,zstwvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,Juvx,Iv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Juxa,Ia,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxa,Ivas,zusvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxa,Ivas,zusvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxa,Ivas,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juxa,Ivas,zuswyv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxa,Ivas,zusyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxa,Ivas,zusywv->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Juxa,Ivsa,zuswvy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Juxv,Istv,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxv,Isvt,zutswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxv,Isvt,zutsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxv,Isvt,zutwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('AB,xyzw,Juxv,Isvt,zutwys->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxv,Isvt,zutysw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('AB,xyzw,Juxv,Isvt,zutyws->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Juxv,Iust,zstvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Juxv,Iust,zstvyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Juxv,Iust,zstwvy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Juxv,Iust,zstwyv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Juxv,Iust,zstyvw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Juxv,Iust,zstywv->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('AB,xyzw,Juxv,Iv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Juxz,Iuvs,ywvs->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxab,Iuab,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxab,Iuba,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxau,Ia,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivas,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivas,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivas,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Jxau,Ivas,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivas,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivas,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxau,Ivau,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxau,Ivsa,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxau,Ivsa,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxau,Ivsa,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxau,Ivsa,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxau,Ivsa,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxau,Ivsa,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxau,Ivua,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxua,Ia,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxua,Ivas,zuvswy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxua,Ivas,zuvsyw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxua,Ivas,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxua,Ivas,zuvwys->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxua,Ivas,zuvysw->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxua,Ivas,zuvyws->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxua,Ivau,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxua,Ivsa,zuvwsy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxua,Ivua,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Istu,zvstwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Istu,zvstyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Istu,zvswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Istu,zvswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Istu,zvsytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Istu,zvsywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxuv,Istv,zuswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isut,zvstwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isut,zvstyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isut,zvswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('AB,xyzw,Jxuv,Isut,zvswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isut,zvsytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isut,zvsywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxuv,Isuv,zswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Isvt,zustwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Isvt,zustyw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Isvt,zuswty->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('AB,xyzw,Jxuv,Isvt,zuswyt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Isvt,zusytw->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('AB,xyzw,Jxuv,Isvt,zusywt->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxuv,Isvu,zswy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,Jxuv,Iu,zvwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,Jxuv,Iv,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,iIxa,Jiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,iIxa,Jiwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,iIxa,Jiya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,iIxa,iJua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,iIxa,iJwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,iIxa,iJya,zw->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,iJxa,Iiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,iJxa,iIua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,iIxa,Jiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('AB,xyzw,iIxa,Jiwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('AB,xyzw,iIxa,Jiya,zw->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,iIxa,iJua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('AB,xyzw,iIxa,iJwa,zy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('AB,xyzw,iIxa,iJya,zw->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('AB,xyzw,iJxa,Iiua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('AB,xyzw,iJxa,iIua,zuwy->IAJB', np.identity(nextern), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,ijuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,ijyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,jiuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,jiwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxB,ijuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxB,jiuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,ijuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,ijyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,jiuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,jiwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxB,ijuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxB,jiuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuAx,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuAx,ivBs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivBw,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivBy,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivsB,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivwB,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivyB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,izBv,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuAx,izvB,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuBx,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuBx,ivAs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivsA,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxA,ivBs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivBw,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivBy,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,ivsB,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivwB,zuyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxA,ivyB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izBv,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izvB,ywvu->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxB,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxB,ivAs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxB,ivsA,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAa,iuBa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAa,iuaB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixAu,ivBs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivBu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivBz,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivsB,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivuB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivzB,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBa,iuAa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixBa,iuaA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBu,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixBu,ivAs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBu,ivAu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivsA,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixBu,ivuA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaA,iuBa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaA,iuaB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaB,iuAa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaB,iuaA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuA,ivBs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivBu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivBz,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivsB,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuA,ivuB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivzB,ywvu->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuB,ivAs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,ivAu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,ivsA,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuB,ivuA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,ijuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,ijyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,jiuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,jiwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxB,ijuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxB,jiuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,ijuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,ijyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,jiuB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,jiwB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiyB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxB,ijuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxB,jiuA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuAx,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuAx,ivBs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivBs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivBw,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivBy,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivsB,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsB,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivwB,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivyB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,izBv,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuAx,izvB,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuBx,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuBx,ivAs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivAs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuBx,ivsA,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuBx,ivsA,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxA,ivBs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivBs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivBw,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivBy,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,ivsB,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivwB,zuyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxA,ivyB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izBv,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izvB,ywvu->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxB,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusvyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxB,ivAs,zuswyv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusyvw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxB,ivAs,zusywv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxB,ivsA,zuswvy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAa,iuBa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAa,iuaB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixAu,ivBs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivBs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivBu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivBz,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivsB,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsB,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivuB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivzB,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBa,iuAa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixBa,iuaA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBu,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixBu,ivAs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivAs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixBu,ivAu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixBu,ivsA,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixBu,ivsA,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixBu,ivuA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaA,iuBa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaA,iuaB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaB,iuAa,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaB,iuaA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,iB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuA,ivBs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivBs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivBu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivBz,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivsB,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuA,ivuB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivzB,ywvu->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,iA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvswy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvsyw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuB,ivAs,zuvwys->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvysw->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuB,ivAs,zuvyws->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,ivAu,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuB,ivsA,zuvwsy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuB,ivuA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,uvxA,stwB,zvusty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,stwB,zvusyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,stwB,zvutsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,stwB,zvutys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,stwB,zvuyst->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,stwB,zvuyts->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxA,styB,zvuwts->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,sutB,zvtswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,sutB,zvtsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,sutB,zvtwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,sutB,zvtwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,sutB,zvtysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,sutB,zvtyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,svtB,zutswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,svtB,zutsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,svtB,zutwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,uvxA,svtB,zutwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,svtB,zutysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,svtB,zutyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uvxA,sztB,ywsuvt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,uB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,ustB,zvtwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxA,uvsB,zswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,uzsB,ywsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxA,vB,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,vstB,zutswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,vstB,zutsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,vstB,zutwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxA,vstB,zutwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,vstB,zutysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxA,vstB,zutyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,vusB,zswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,vzsB,ywus->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uvxA,zB,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uvxA,zstB,ywstuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uvxA,zstB,ywstvu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,uvxA,zstB,ywsutv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uvxA,zstB,ywsuvt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uvxA,zstB,ywsvtu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uvxA,zstB,ywsvut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxA,zusB,ywvs->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxA,zvsB,ywus->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,sutA,zvtswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,sutA,zvtsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,sutA,zvtwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,sutA,zvtwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,sutA,zvtysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,sutA,zvtyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,svtA,zutswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,svtA,zutsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,svtA,zutwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,uvxB,svtA,zutwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,svtA,zutysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,svtA,zutyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxB,uA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxB,ustA,zvtwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxB,uvsA,zswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uvxB,vA,zuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,vstA,zutswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,vstA,zutsyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,vstA,zutwsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uvxB,vstA,zutwys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,vstA,zutysw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxB,vstA,zutyws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uvxB,vusA,zswy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsBa,zvsuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsBa,zvsuyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxAa,vsBa,zvswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsBa,zvswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsBa,zvsyuw->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsBa,zvsywu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxBa,vsAa,zvsuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxBa,vsAa,zvsuyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxBa,vsAa,zvswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxBa,vsAa,zvswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxBa,vsAa,zvsyuw->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxBa,vsAa,zvsywu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvA,stvB,ztsuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvA,stvB,ztsuyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvA,stvB,ztswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,stvB,ztswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvA,stvB,ztsyuw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvA,stvB,ztsywu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uxvA,stzB,ywutsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvA,sutB,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvA,sutB,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvA,sutB,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uxvA,sutB,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvA,sutB,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvA,sutB,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxvA,suzB,ywvs->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,swtB,zvsyut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uxvA,sytB,zvswut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uxvA,uB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uxvA,ustB,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxvA,uszB,ywsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,uwsB,zvys->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uxvA,uysB,zvws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,wB,zvyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,uxvA,wstB,zvstuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,wstB,zvstyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,wstB,zvsuty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,wstB,zvsuyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,wstB,zvsytu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvA,wstB,zvsyut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,wusB,zvsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uxvA,wysB,zvsu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uxvA,yB,zvwu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,ystB,zvswut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,yusB,zvws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxvA,ywsB,zvsu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvB,stvA,ztsuwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvB,stvA,ztsuyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvB,stvA,ztswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxvB,stvA,ztswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvB,stvA,ztsyuw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxvB,stvA,ztsywu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvB,sutA,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvB,sutA,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvB,sutA,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uxvB,sutA,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvB,sutA,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uxvB,sutA,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uxvB,uA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uxvB,ustA,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,xA,uvzB,ywvu->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xA,uwvB,zuyv->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,xA,uyvB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xA,wB,zy->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xA,wuvB,zuvy->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,xA,wyuB,zu->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,xA,yB,zw->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xA,yuvB,zuwv->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xA,ywuB,zu->IAJB', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuAa,vsBa,zvswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuBa,vsAa,zvswyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuvA,stvB,ztswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,stzB,ywustv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,stzB,ywusvt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,stzB,ywutsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,stzB,ywutvs->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,xuvA,stzB,ywuvst->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,stzB,ywuvts->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,sutB,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,sutB,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,sutB,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,xuvA,sutB,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,sutB,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,sutB,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,suzB,ywvs->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,swtB,zvstuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,swtB,zvstyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,swtB,zvsuty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xuvA,swtB,zvsuyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,swtB,zvsytu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,swtB,zvsyut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,sytB,zvswut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,xuvA,uB,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvA,ustB,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvA,ustB,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvA,ustB,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvA,ustB,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvA,ustB,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvA,ustB,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuvA,uszB,ywvs->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,uwsB,zvsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,uysB,zvws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,wB,zvuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,wstB,zvstyu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,xuvA,wusB,zvsy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,wysB,zvsu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,yB,zvwu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,ystB,zvstuw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,ystB,zvstwu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,ystB,zvsutw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,ystB,zvsuwt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xuvA,ystB,zvswtu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuvA,ystB,zvswut->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,xuvA,yusB,zvws->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xuvA,ywsB,zvus->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuvB,stvA,ztswuy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,sutA,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,sutA,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,sutA,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,xuvB,sutA,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,sutA,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,sutA,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,xuvB,uA,zvwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvB,ustA,zvstwy->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvB,ustA,zvstyw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvB,ustA,zvswty->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,xuvB,ustA,zvswyt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvB,ustA,zvsytw->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuvB,ustA,zvsywt->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzAa,uvBa,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzBa,uvAa,ywuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxuA,vsuB,ywsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxuA,vwsB,ysuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,zxuA,vysB,wsuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxuA,wB,yu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxuA,wvsB,ysvu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,zxuA,wyvB,uv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,zxuA,yB,wu->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxuA,yvsB,wsuv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxuA,ywvB,uv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxuB,vsuA,ywsv->IAJB', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ce, n_ce)
        M_00[s_ce_aa:f_ce_aa, s_ce_bb:f_ce_bb] += temp
        M_00[s_ce_bb:f_ce_bb, s_ce_bb:f_ce_bb] += temp
        del temp

        ## aa,bb || bb,aa
        temp  = einsum('Ia,JBAa->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JBia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('IiAa,iBJa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('IixA,ixJB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JBia->IAJB', t1_xvee, v_xeve, optimize = einsum_type)
        temp -= einsum('IiAa,iBJa->IAJB', t1_xvee, v_vexe, optimize = einsum_type)
        temp -= einsum('IixA,ixJB->IAJB', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += einsum('Ix,JBAx->IAJB', t1_xa, v_xeea, optimize = einsum_type)
        temp += einsum('Ja,IABa->IAJB', t1_xe, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('JiBa,IAia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('JiBa,iAIa->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('JixB,ixIA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiBa,IAia->IAJB', t1_xvee, v_xeve, optimize = einsum_type)
        temp -= einsum('JiBa,iAIa->IAJB', t1_xvee, v_vexe, optimize = einsum_type)
        temp -= einsum('JixB,ixIA->IAJB', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += einsum('Jx,IABx->IAJB', t1_xa, v_xeea, optimize = einsum_type)
        temp -= einsum('iA,iIJB->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp -= einsum('iB,iJIA->IAJB', t1_xe, v_xxxe, optimize = einsum_type)
        temp -= einsum('iIAa,JBia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('iIxA,JxiB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iIxA,ixJB->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iJBa,IAia->IAJB', t1_xxee, v_xexe, optimize = einsum_type)
        temp -= einsum('iJxB,IxiA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iJxB,ixIA->IAJB', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iA,iIJB->IAJB', t1_ve, v_vxxe, optimize = einsum_type)
        temp -= einsum('iB,iJIA->IAJB', t1_ve, v_vxxe, optimize = einsum_type)
        temp -= einsum('iIAa,JBia->IAJB', t1_vxee, v_xeve, optimize = einsum_type)
        temp -= einsum('iIxA,JxiB->IAJB', t1_vxae, v_xave, optimize = einsum_type)
        temp += 2 * einsum('iIxA,ixJB->IAJB', t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= einsum('iJBa,IAia->IAJB', t1_vxee, v_xeve, optimize = einsum_type)
        temp -= einsum('iJxB,IxiA->IAJB', t1_vxae, v_xave, optimize = einsum_type)
        temp += 2 * einsum('iJxB,ixIA->IAJB', t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= einsum('xA,IxBJ->IAJB', t1_ae, v_xaex, optimize = einsum_type)
        temp -= einsum('xB,JxAI->IAJB', t1_ae, v_xaex, optimize = einsum_type)
        temp += einsum('A,IiAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('A,IiAa,JiBa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJBa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,iJxB->IAJB', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('A,iIxA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiBa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixB->IAJB', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('A,iIxA,iJxB->IAJB', e_extern, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('B,IiAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IiAa,iJBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IixA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('B,IiAa,JiBa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IiAa,iJBa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IixA,iJxB->IAJB', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIAa,JiBa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,JixB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('B,iIxA,iJxB->IAJB', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIAa,JiBa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,JixB->IAJB', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('B,iIxA,iJxB->IAJB', e_extern, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiBa->IAJB', e_cvs, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJBa->IAJB', e_cvs, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,iJxB->IAJB', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiBa->IAJB', e_cvs, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixB->IAJB', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('I,iIxA,iJxB->IAJB', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiBa->IAJB', e_cvs, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJBa->IAJB', e_cvs, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,iJxB->IAJB', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiBa->IAJB', e_cvs, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixB->IAJB', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('J,iIxA,iJxB->IAJB', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('a,JiBa,IiAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,JiBa,iIAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 2 * einsum('a,JiBa,IiAa->IAJB', e_extern, t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= einsum('a,JiBa,iIAa->IAJB', e_extern, t1_xvee, t1_vxee, optimize = einsum_type)
        temp -= einsum('a,iJBa,IiAa->IAJB', e_extern, t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,iJBa,IiAa->IAJB', e_extern, t1_vxee, t1_xvee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiBa,IiAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiBa,iIAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixB,iIxA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiBa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iIxA,iJxB->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJBa,IiAa->IAJB', e_cvs, t1_xxee, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJxB,IixA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iJxB,iIxA->IAJB', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiBa->IAJB', e_val, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJBa->IAJB', e_val, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,iJxB->IAJB', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,JiBa,IiAa->IAJB', e_val, t1_xvee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiBa,iIAa->IAJB', e_val, t1_xvee, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixB,iIxA->IAJB', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiBa->IAJB', e_val, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixB->IAJB', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,iIxA,iJxB->IAJB', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJBa,IiAa->IAJB', e_val, t1_vxee, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJxB,IixA->IAJB', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,iJxB,iIxA->IAJB', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('xy,IixA,iJyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('xy,IixA,iJyB->IAJB', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,iJyB->IAJB', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyB->IAJB', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,iJyB->IAJB', h_aa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,iyJB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,iyJB,xy->IAJB', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAa,JBya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,JayB,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IxAy,JBxz,yz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAy,JBzy,xz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,JyzB,xz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,JzxB,yz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaA,JBya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixay,JBAa,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JBxz,yz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JBzy,xz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JBAa,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixyz,JBAy,xz->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JBAz,xy->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixB,iyIA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixB,iyIA,xy->IAJB', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('JxBa,IAya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxBa,IayA,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('JxBy,IAxz,yz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxBy,IAzy,xz->IAJB', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxBy,IyzA,xz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxBy,IzxA,yz->IAJB', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaB,IAya,xy->IAJB', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxay,IABa,xy->IAJB', t1_xaea, v_xeee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyB,IAxz,yz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyB,IAzy,xz->IAJB', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IABa,xy->IAJB', t1_xaae, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxyz,IABy,xz->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IABz,xy->IAJB', t1_xaaa, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,iyJB,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxB,IyiA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iJxB,iyIA,xy->IAJB', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJB,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixBy,iJIA,yx->IAJB', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJB,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyB,iJIA,yx->IAJB', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiB,xy->IAJB', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,iyJB,xy->IAJB', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxB,IyiA,xy->IAJB', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('iJxB,iyIA,xy->IAJB', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJB,yx->IAJB', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixBy,iJIA,yx->IAJB', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJB,yx->IAJB', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyB,iJIA,yx->IAJB', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IxBJ,zy->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzA,IyBJ,zx->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzB,JxAI,zy->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzB,JyAI,zx->IAJB', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,iJyB,xy->IAJB', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAa,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IxAy,JxBz,yz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,JxzB,yz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAy,JzBy,xz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,JzyB,xz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxaA,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JxBz,yz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JzBy,xz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyB,xy->IAJB', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,iJyB,xy->IAJB', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IixA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IixA,iJyB,xy->IAJB', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IxAa,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxAa,JyaB,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,IxAy,JxBz,yz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxAy,JxzB,yz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('B,IxAy,JzBy,xz->IAJB', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxAy,JzyB,xz->IAJB', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxaA,JyBa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,IxyA,JxBz,yz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('B,IxyA,JzBy,xz->IAJB', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,iIxA,JiyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,iJyB,xy->IAJB', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('B,iIxA,JiyB,xy->IAJB', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('B,iIxA,iJyB,xy->IAJB', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,iJyB,xy->IAJB', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAa,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAy,JxBz,yz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,JxzB,yz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAy,JzBy,xz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,JzyB,xz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaA,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JxBz,yz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JzBy,xz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyB,xy->IAJB', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,iJyB,xy->IAJB', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,iJyB,xy->IAJB', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAa,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,JyaB,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxAy,JxBz,yz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,JxzB,yz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAy,JzBy,xz->IAJB', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,JzyB,xz->IAJB', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaA,JyBa,xy->IAJB', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JxBz,yz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JzBy,xz->IAJB', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyB,xy->IAJB', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,iJyB,xy->IAJB', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxBa,IyAa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxBa,IyaA,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaB,IyAa,xy->IAJB', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,iJyB,xy->IAJB', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,iJyB,xy->IAJB', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyB,xy->IAJB', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,iJyB,xy->IAJB', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,iJzB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,iJzB,yz->IAJB', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAa,JzBa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,JzaB,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JwBz,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,JwzB,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IxAz,JyBw,zw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JywB,zw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaA,JzBa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzA,JwBz,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzA,JyBw,zw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IzAx,JwBy,zw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JwyB,zw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JzBw,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,JzwB,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxA,JwBy,zw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxA,JzBw,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixB,iIzA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixB,iIzA,yz->IAJB', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxBa,IzAa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxBa,IzaA,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxBz,IwAz,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxBz,IwzA,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaB,IzAa,yz->IAJB', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzB,IwAz,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzBx,IzAw,yw->IAJB', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzBx,IzwA,yw->IAJB', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxB,IzAw,yw->IAJB', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,iJzB,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxB,IizA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iJxB,iIzA,yz->IAJB', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizB,yz->IAJB', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,iJzB,yz->IAJB', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxB,IizA,yz->IAJB', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iJxB,iIzA,yz->IAJB', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,iJuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,iJwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,iJyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,iJuB,zuwy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,iJwB,zy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,iJyB,zw->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JuBv,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,JuvB,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvBw,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvBy,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvwB,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvyB,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuAx,JzBv,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuAx,JzvB,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxA,JuBv,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvBw,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvBy,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,JvwB,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JvwB,zuyv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JzBv,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuxA,JzvB,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JzvB,ywvu->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAa,JuBa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,JuaB,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JvBu,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxAu,JvBz,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,JvuB,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,JvzB,ywuv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JwBv,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JwvB,zuvy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JyBv,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JyvB,zuwv->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaA,JuBa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuA,JvBu,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JvBz,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuA,JvzB,ywuv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JvzB,ywvu->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JwBv,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxuA,JwvB,zuvy->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JwvB,zuyv->IAJB', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JyBv,zuwv->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixB,iIuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixB,iIuA,zuwy->IAJB', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuBx,IuAv,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuBx,IuvA,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxB,IuAv,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxBa,IuAa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxBa,IuaA,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxBu,IvAu,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxBu,IvuA,zvwy->IAJB', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaB,IuAa,zuwy->IAJB', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuB,IvAu,zvwy->IAJB', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,iJuB,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,iJwB,zy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,iJyB,zw->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxB,IiuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iJxB,iIuA,zuwy->IAJB', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuB,zuwy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwB,zy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyB,zw->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,iJuB,zuwy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,iJwB,zy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,iJyB,zw->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxB,IiuA,zuwy->IAJB', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iJxB,iIuA,zuwy->IAJB', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
     
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ce, n_ce)
        M_00[s_ce_aa:f_ce_aa, s_ce_bb:f_ce_bb] += temp
        M_00[s_ce_bb:f_ce_bb, s_ce_aa:f_ce_aa] += temp
        del temp

        # CA - CA
        ## aa,aa || bb,bb
        temp  = einsum('Ia,JXYa->IXJY', h_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('Ia,JXaY->IXJY', h_xe, t1_xaea, optimize = einsum_type)
        temp += einsum('Ix,JXYx->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('Ix,JXxY->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('Ja,IYXa->IXJY', h_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('Ja,IYaX->IXJY', h_xe, t1_xaea, optimize = einsum_type)
        temp += einsum('Jx,IYXx->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('Jx,IYxX->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('IYab,JaXb->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp += einsum('IYab,JbXa->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp -= einsum('IYax,JaXx->IXJY', t1_xaea, v_xeaa, optimize = einsum_type)
        temp += einsum('IYax,JxXa->IXJY', t1_xaea, v_xaae, optimize = einsum_type)
        temp += einsum('IYxa,JaXx->IXJY', t1_xaae, v_xeaa, optimize = einsum_type)
        temp -= einsum('IYxa,JxXa->IXJY', t1_xaae, v_xaae, optimize = einsum_type)
        temp -= einsum('IYxy,JxXy->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('IYxy,JyXx->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('Ia,JYXa->IXJY', t1_xe, v_xaae, optimize = einsum_type)
        temp -= einsum('Ia,JaXY->IXJY', t1_xe, v_xeaa, optimize = einsum_type)
        temp += 2 * einsum('IiXa,JYia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('IiXa,iYJa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('IiXx,JYix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('IiXx,JxiY->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('IixX,JYix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('IixX,JxiY->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('IiXa,JYia->IXJY', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('IiXa,iYJa->IXJY', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += 2 * einsum('IiXx,JYix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('IiXx,JxiY->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('IixX,JYix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('IixX,JxiY->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('Ix,JYXx->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp -= einsum('Ix,JxXY->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp -= einsum('JXab,IaYb->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp += einsum('JXab,IbYa->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp -= einsum('JXax,IaYx->IXJY', t1_xaea, v_xeaa, optimize = einsum_type)
        temp += einsum('JXax,IxYa->IXJY', t1_xaea, v_xaae, optimize = einsum_type)
        temp += einsum('JXxa,IaYx->IXJY', t1_xaae, v_xeaa, optimize = einsum_type)
        temp -= einsum('JXxa,IxYa->IXJY', t1_xaae, v_xaae, optimize = einsum_type)
        temp -= einsum('JXxy,IxYy->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('JXxy,IyYx->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('Ja,IXYa->IXJY', t1_xe, v_xaae, optimize = einsum_type)
        temp -= einsum('Ja,IaYX->IXJY', t1_xe, v_xeaa, optimize = einsum_type)
        temp += 2 * einsum('JiYa,IXia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('JiYa,iXIa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiYx,IXix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('JiYx,IxiX->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('JixY,IXix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('JixY,IxiX->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('JiYa,IXia->IXJY', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('JiYa,iXIa->IXJY', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += 2 * einsum('JiYx,IXix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('JiYx,IxiX->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('JixY,IXix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('JixY,IxiX->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('Jx,IXYx->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp -= einsum('Jx,IxYX->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp -= einsum('Xa,IJYa->IXJY', t1_ae, v_xxae, optimize = einsum_type)
        temp += einsum('Xa,JYaI->IXJY', t1_ae, v_xaex, optimize = einsum_type)
        temp += einsum('Ya,IXaJ->IXJY', t1_ae, v_xaex, optimize = einsum_type)
        temp -= einsum('Ya,JIXa->IXJY', t1_ae, v_xxae, optimize = einsum_type)
        temp -= einsum('iIXa,JYia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('iIXa,iYJa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iJYa,IXia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('iJYa,iXIa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('iX,JIiY->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iX,iIJY->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('iXYa,IJia->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp -= einsum('iXYa,iJIa->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp += einsum('iXYx,IJix->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iXYx,iJIx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= 2 * einsum('iXaY,IJia->IXJY', t1_xaea, v_xxxe, optimize = einsum_type)
        temp += einsum('iXaY,iJIa->IXJY', t1_xaea, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('iXxY,IJix->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp += einsum('iXxY,iJIx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp += einsum('iY,IJiX->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iY,iJIX->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('iYXa,JIia->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp -= einsum('iYXa,iIJa->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp += einsum('iYXx,JIix->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iYXx,iIJx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= 2 * einsum('iYaX,JIia->IXJY', t1_xaea, v_xxxe, optimize = einsum_type)
        temp += einsum('iYaX,iIJa->IXJY', t1_xaea, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('iYxX,JIix->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp += einsum('iYxX,iIJx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iIXa,JYia->IXJY', t1_vxae, v_xave, optimize = einsum_type)
        temp += einsum('iIXa,iYJa->IXJY', t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= einsum('iJYa,IXia->IXJY', t1_vxae, v_xave, optimize = einsum_type)
        temp += einsum('iJYa,iXIa->IXJY', t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('iX,JIiY->IXJY', t1_va, v_xxva, optimize = einsum_type)
        temp -= einsum('iX,iIJY->IXJY', t1_va, v_vxxa, optimize = einsum_type)
        temp += einsum('iXYa,IJia->IXJY', t1_vaae, v_xxve, optimize = einsum_type)
        temp -= einsum('iXYa,iJIa->IXJY', t1_vaae, v_vxxe, optimize = einsum_type)
        temp += einsum('iXYx,IJix->IXJY', t1_vaaa, v_xxva, optimize = einsum_type)
        temp -= einsum('iXYx,iJIx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp -= 2 * einsum('iXaY,IJia->IXJY', t1_vaea, v_xxve, optimize = einsum_type)
        temp += einsum('iXaY,iJIa->IXJY', t1_vaea, v_vxxe, optimize = einsum_type)
        temp -= 2 * einsum('iXxY,IJix->IXJY', t1_vaaa, v_xxva, optimize = einsum_type)
        temp += einsum('iXxY,iJIx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp += einsum('iY,IJiX->IXJY', t1_va, v_xxva, optimize = einsum_type)
        temp -= einsum('iY,iJIX->IXJY', t1_va, v_vxxa, optimize = einsum_type)
        temp += einsum('iYXa,JIia->IXJY', t1_vaae, v_xxve, optimize = einsum_type)
        temp -= einsum('iYXa,iIJa->IXJY', t1_vaae, v_vxxe, optimize = einsum_type)
        temp += einsum('iYXx,JIix->IXJY', t1_vaaa, v_xxva, optimize = einsum_type)
        temp -= einsum('iYXx,iIJx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp -= 2 * einsum('iYaX,JIia->IXJY', t1_vaea, v_xxve, optimize = einsum_type)
        temp += einsum('iYaX,iIJa->IXJY', t1_vaea, v_vxxe, optimize = einsum_type)
        temp -= 2 * einsum('iYxX,JIix->IXJY', t1_vaaa, v_xxva, optimize = einsum_type)
        temp += einsum('iYxX,iIJx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXa,Ja->IXJY', e_cvs, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXx,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYaX,Ja->IXJY', e_cvs, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYab,JXab->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYab,JXba->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYax,JXax->IXJY', e_cvs, t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYax,JXxa->IXJY', e_cvs, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYxX,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYxa,JXax->IXJY', e_cvs, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYxa,JXxa->IXJY', e_cvs, t1_xaae, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYxy,JXxy->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYxy,JXyx->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ia,JXYa->IXJY', e_cvs, t1_xe, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('I,Ia,JXaY->IXJY', e_cvs, t1_xe, t1_xaea, optimize = einsum_type)
        temp -= einsum('I,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixX,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('I,IiXa,JiYa->IXJY', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,iJYa->IXJY', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('I,IiXx,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixX,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixX,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ix,JXYx->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Ix,JXxY->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIXa,JiYa->IXJY', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIXa,iJYa->IXJY', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXa,Ja->IXJY', e_cvs, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXx,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYaX,Ja->IXJY', e_cvs, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYab,JXab->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYab,JXba->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYax,JXax->IXJY', e_cvs, t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYax,JXxa->IXJY', e_cvs, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYxX,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYxa,JXax->IXJY', e_cvs, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYxa,JXxa->IXJY', e_cvs, t1_xaae, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYxy,JXxy->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYxy,JXyx->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ia,JXYa->IXJY', e_cvs, t1_xe, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('J,Ia,JXaY->IXJY', e_cvs, t1_xe, t1_xaea, optimize = einsum_type)
        temp -= einsum('J,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixX,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('J,IiXa,JiYa->IXJY', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,iJYa->IXJY', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('J,IiXx,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixX,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixX,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ix,JXYx->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Ix,JXxY->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIXa,JiYa->IXJY', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIXa,iJYa->IXJY', e_cvs, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('a,JXYa,Ia->IXJY', e_extern, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= einsum('a,JXaY,Ia->IXJY', e_extern, t1_xaea, t1_xe, optimize = einsum_type)
        temp -= einsum('a,JXab,IYab->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += einsum('a,JXab,IYba->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('a,JXax,IYax->IXJY', e_extern, t1_xaea, t1_xaea, optimize = einsum_type)
        temp += einsum('a,JXax,IYxa->IXJY', e_extern, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += einsum('a,JXba,IYab->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('a,JXba,IYba->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += einsum('a,JXxa,IYax->IXJY', e_extern, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('a,JXxa,IYxa->IXJY', e_extern, t1_xaae, t1_xaae, optimize = einsum_type)
        temp += einsum('a,Ja,IYXa->IXJY', e_extern, t1_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('a,Ja,IYaX->IXJY', e_extern, t1_xe, t1_xaea, optimize = einsum_type)
        temp += 2 * einsum('a,JiYa,IiXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('a,JiYa,iIXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('a,JiYa,IiXa->IXJY', e_extern, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= einsum('a,JiYa,iIXa->IXJY', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('a,iJYa,IiXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,iJYa,iIXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('a,iJYa,IiXa->IXJY', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('a,iJYa,iIXa->IXJY', e_extern, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('i,JiYa,IiXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,iIXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiYx,IiXx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,IixX->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixY,IiXx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixY,IixX->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJYa,IiXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJYa,iIXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiXa,JiYa->IXJY', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,iJYa->IXJY', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,IiXx,JiYx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,JixY->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiYx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JixY->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('i,JiYa,IiXa->IXJY', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,iIXa->IXJY', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,JiYx,IiXx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,IixX->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixY,IiXx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixY,IixX->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIXa,JiYa->IXJY', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIXa,iJYa->IXJY', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJYa,IiXa->IXJY', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJYa,iIXa->IXJY', e_val, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= einsum('Ia,XY,Ja->IXJY', h_xe, np.identity(ncas), t1_xe, optimize = einsum_type)
        temp -= einsum('Ix,XY,Jx->IXJY', h_xa, np.identity(ncas), t1_xa, optimize = einsum_type)
        temp -= einsum('Ja,XY,Ia->IXJY', h_xe, np.identity(ncas), t1_xe, optimize = einsum_type)
        temp -= einsum('Jx,XY,Ix->IXJY', h_xa, np.identity(ncas), t1_xa, optimize = einsum_type)
        temp += einsum('Xa,IJ,Ya->IXJY', h_ae, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp += einsum('Ya,IJ,Xa->IXJY', h_ae, np.identity(ncvs), t1_ae, optimize = einsum_type)
        temp -= einsum('iX,IJ,iY->IXJY', h_xa, np.identity(ncvs), t1_xa, optimize = einsum_type)
        temp -= einsum('iY,IJ,iX->IXJY', h_xa, np.identity(ncvs), t1_xa, optimize = einsum_type)
        temp -= einsum('ia,IJ,iXYa->IXJY', h_xe, np.identity(ncvs), t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iXaY->IXJY', h_xe, np.identity(ncvs), t1_xaea, optimize = einsum_type)
        temp -= einsum('ia,IJ,iYXa->IXJY', h_xe, np.identity(ncvs), t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iYaX->IXJY', h_xe, np.identity(ncvs), t1_xaea, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXYx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iXxY->IXJY', h_xa, np.identity(ncvs), t1_xaaa, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYXx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iYxX->IXJY', h_xa, np.identity(ncvs), t1_xaaa, optimize = einsum_type)
        temp -= einsum('iX,IJ,iY->IXJY', h_va, np.identity(ncvs), t1_va, optimize = einsum_type)
        temp -= einsum('iY,IJ,iX->IXJY', h_va, np.identity(ncvs), t1_va, optimize = einsum_type)
        temp -= einsum('ia,IJ,iXYa->IXJY', h_ve, np.identity(ncvs), t1_vaae, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iXaY->IXJY', h_ve, np.identity(ncvs), t1_vaea, optimize = einsum_type)
        temp -= einsum('ia,IJ,iYXa->IXJY', h_ve, np.identity(ncvs), t1_vaae, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iYaX->IXJY', h_ve, np.identity(ncvs), t1_vaea, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXYx->IXJY', h_va, np.identity(ncvs), t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iXxY->IXJY', h_va, np.identity(ncvs), t1_vaaa, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYXx->IXJY', h_va, np.identity(ncvs), t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iYxX->IXJY', h_va, np.identity(ncvs), t1_vaaa, optimize = einsum_type)
        temp += einsum('Xx,IJ,Yx->IXJY', h_aa, np.identity(ncvs), t2_aa, optimize = einsum_type)
        temp -= einsum('Yx,IJ,Xx->IXJY', h_aa, np.identity(ncvs), t2_aa, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,JXax,Yx->IXJY', h_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JXxa,Yx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,Ja,XY->IXJY', h_xe, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxYa,Xx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,JxaY,Xx->IXJY', h_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,Jxay,XyYx->IXJY', h_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ia,Jxya,XyYx->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ia,Jxya,XyxY->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,JXxy,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JXyx,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,Jx,XY->IXJY', h_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyYx,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,JyxY,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,Jyxz,XzYy->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ix,Jyzx,XzYy->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ix,Jyzx,XzyY->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IYax,Xx->IXJY', h_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IYxa,Xx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,Ia,XY->IXJY', h_xe, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxXa,Yx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IxaX,Yx->IXJY', h_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,Ixay,XxYy->IXJY', h_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ja,Ixya,XxYy->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ja,Ixya,XxyY->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IYxy,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IYyx,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,Ix,XY->IXJY', h_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyXx,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IyxX,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,Iyxz,XyYz->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jx,Iyzx,XyYz->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jx,Iyzx,XyzY->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IYax,Ja->IXJY', h_aa, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxa,Ja->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxy,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IYyx,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Xx,Iixa,JiYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,iJYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Iixy,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iiyx,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iiyx,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Xx,Iixa,JiYa->IXJY', h_aa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,iJYa->IXJY', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('Xx,Iixy,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iiyx,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iiyx,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYa,Ia->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYy,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,JxaY,Ia->IXJY', h_aa, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jxab,IYab->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxab,IYba->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jxay,IYay->IXJY', h_aa, t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxay,IYya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,JxyY,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxya,IYay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jxya,IYya->IXJY', h_aa, t1_xaae, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jxyz,IYyz->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxyz,IYzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iIxa,JiYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,iIxa,iJYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iIxa,JiYa->IXJY', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,iIxa,iJYa->IXJY', h_aa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXa,Ja->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXy,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IxaX,Ja->IXJY', h_aa, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Ixab,JXab->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixab,JXba->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Ixay,JXay->IXJY', h_aa, t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixay,JXya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IxyX,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixya,JXay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Ixya,JXya->IXJY', h_aa, t1_xaae, t1_xaae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Ixyz,JXyz->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixyz,JXzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,JXax,Ia->IXJY', h_aa, t1_xaea, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxa,Ia->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxy,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,JXyx,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Yx,Jixa,IiXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,iIXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('Yx,Jixy,IiXy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiyX->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jiyx,IiXy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jiyx,IiyX->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Yx,Jixa,IiXa->IXJY', h_aa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,iIXa->IXJY', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('Yx,Jixy,IiXy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiyX->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jiyx,IiXy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jiyx,IiyX->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,iJxa,IiXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,iJxa,iIXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,iJxa,IiXa->IXJY', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,iJxa,iIXa->IXJY', h_aa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('xy,IYXx,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('xy,IYax,JXay->IXJY', h_aa, t1_xaea, t1_xaea, optimize = einsum_type)
        temp += einsum('xy,IYax,JXya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('xy,IYxX,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('xy,IYxa,JXay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('xy,IYxa,JXya->IXJY', h_aa, t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('xy,IYxz,JXyz->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += einsum('xy,IYxz,JXzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += einsum('xy,IYzx,JXyz->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xy,IYzx,JXzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IiXx,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IixX,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,IixX,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IiXx,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,IixX,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,IixX,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,Ix,JXYy->IXJY', h_aa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xy,Ix,JXyY->IXJY', h_aa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXab,iaYb->IXJY', np.identity(ncvs), t1_xaee, v_xeae, optimize = einsum_type)
        temp -= einsum('IJ,iXab,ibYa->IXJY', np.identity(ncvs), t1_xaee, v_xeae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXax,iaYx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, optimize = einsum_type)
        temp -= einsum('IJ,iXax,ixYa->IXJY', np.identity(ncvs), t1_xaea, v_xaae, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iaYx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxa,ixYa->IXJY', np.identity(ncvs), t1_xaae, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxy,ixYy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,iyYx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYab,iaXb->IXJY', np.identity(ncvs), t1_xaee, v_xeae, optimize = einsum_type)
        temp -= einsum('IJ,iYab,ibXa->IXJY', np.identity(ncvs), t1_xaee, v_xeae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYax,iaXx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, optimize = einsum_type)
        temp -= einsum('IJ,iYax,ixXa->IXJY', np.identity(ncvs), t1_xaea, v_xaae, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,iaXx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxa,ixXa->IXJY', np.identity(ncvs), t1_xaae, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxy,ixXy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,iyXx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, optimize = einsum_type)
        temp -= einsum('IJ,ia,iXYa->IXJY', np.identity(ncvs), t1_xe, v_xaae, optimize = einsum_type)
        temp -= einsum('IJ,ia,iYXa->IXJY', np.identity(ncvs), t1_xe, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaXY->IXJY', np.identity(ncvs), t1_xe, v_xeaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaYX->IXJY', np.identity(ncvs), t1_xe, v_xeaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iYja->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jYia->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,iYjx->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jYix->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYa,iXja->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijYa,jXia->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYx,iXjx->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jXix->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iYja->IXJY', np.identity(ncvs), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jYia->IXJY', np.identity(ncvs), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,iYjx->IXJY', np.identity(ncvs), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jYix->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYa,iXja->IXJY', np.identity(ncvs), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijYa,jXia->IXJY', np.identity(ncvs), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYx,iXjx->IXJY', np.identity(ncvs), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jXix->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iXYx->IXJY', np.identity(ncvs), t1_xa, v_xaaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iYXx->IXJY', np.identity(ncvs), t1_xa, v_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixXY->IXJY', np.identity(ncvs), t1_xa, v_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixYX->IXJY', np.identity(ncvs), t1_xa, v_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXab,iaYb->IXJY', np.identity(ncvs), t1_vaee, v_veae, optimize = einsum_type)
        temp -= einsum('IJ,iXab,ibYa->IXJY', np.identity(ncvs), t1_vaee, v_veae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXax,iaYx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, optimize = einsum_type)
        temp -= einsum('IJ,iXax,ixYa->IXJY', np.identity(ncvs), t1_vaea, v_vaae, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iaYx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxa,ixYa->IXJY', np.identity(ncvs), t1_vaae, v_vaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxy,ixYy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,iyYx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYab,iaXb->IXJY', np.identity(ncvs), t1_vaee, v_veae, optimize = einsum_type)
        temp -= einsum('IJ,iYab,ibXa->IXJY', np.identity(ncvs), t1_vaee, v_veae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYax,iaXx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, optimize = einsum_type)
        temp -= einsum('IJ,iYax,ixXa->IXJY', np.identity(ncvs), t1_vaea, v_vaae, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,iaXx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxa,ixXa->IXJY', np.identity(ncvs), t1_vaae, v_vaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxy,ixXy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,iyXx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, optimize = einsum_type)
        temp -= einsum('IJ,ia,iXYa->IXJY', np.identity(ncvs), t1_ve, v_vaae, optimize = einsum_type)
        temp -= einsum('IJ,ia,iYXa->IXJY', np.identity(ncvs), t1_ve, v_vaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaXY->IXJY', np.identity(ncvs), t1_ve, v_veaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaYX->IXJY', np.identity(ncvs), t1_ve, v_veaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iYja->IXJY', np.identity(ncvs), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jYia->IXJY', np.identity(ncvs), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,iYjx->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jYix->IXJY', np.identity(ncvs), t1_vxaa, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYa,iXja->IXJY', np.identity(ncvs), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijYa,jXia->IXJY', np.identity(ncvs), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYx,iXjx->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jXix->IXJY', np.identity(ncvs), t1_vxaa, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iYja->IXJY', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jYia->IXJY', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,iYjx->IXJY', np.identity(ncvs), t1_vvaa, v_vava, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jYix->IXJY', np.identity(ncvs), t1_vvaa, v_vava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYa,iXja->IXJY', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijYa,jXia->IXJY', np.identity(ncvs), t1_vvae, v_vave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijYx,iXjx->IXJY', np.identity(ncvs), t1_vvaa, v_vava, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jXix->IXJY', np.identity(ncvs), t1_vvaa, v_vava, optimize = einsum_type)
        temp -= einsum('IJ,ix,iXYx->IXJY', np.identity(ncvs), t1_va, v_vaaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iYXx->IXJY', np.identity(ncvs), t1_va, v_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixXY->IXJY', np.identity(ncvs), t1_va, v_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixYX->IXJY', np.identity(ncvs), t1_va, v_vaaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iiab,Jaib->IXJY', np.identity(ncas), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('XY,Iiab,Jbia->IXJY', np.identity(ncas), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iixa,Jxia->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('XY,Iixa,ixJa->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iixy,Jxiy->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jyix->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iiab,Jaib->IXJY', np.identity(ncas), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('XY,Iiab,Jbia->IXJY', np.identity(ncas), t1_xvee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iixa,Jxia->IXJY', np.identity(ncas), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('XY,Iixa,ixJa->IXJY', np.identity(ncas), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Iixy,Jxiy->IXJY', np.identity(ncas), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jyix->IXJY', np.identity(ncas), t1_xvaa, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jiab,Iaib->IXJY', np.identity(ncas), t1_xxee, v_xexe, optimize = einsum_type)
        temp += einsum('XY,Jiab,Ibia->IXJY', np.identity(ncas), t1_xxee, v_xexe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jixa,Ixia->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('XY,Jixa,ixIa->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jixy,Ixiy->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += einsum('XY,Jixy,Iyix->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jiab,Iaib->IXJY', np.identity(ncas), t1_xvee, v_xeve, optimize = einsum_type)
        temp += einsum('XY,Jiab,Ibia->IXJY', np.identity(ncas), t1_xvee, v_xeve, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jixa,Ixia->IXJY', np.identity(ncas), t1_xvae, v_xave, optimize = einsum_type)
        temp += einsum('XY,Jixa,ixIa->IXJY', np.identity(ncas), t1_xvae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,Jixy,Ixiy->IXJY', np.identity(ncas), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('XY,Jixy,Iyix->IXJY', np.identity(ncas), t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('XY,iIxa,Jxia->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,iIxa,ixJa->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp += einsum('XY,iJxa,Ixia->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,iJxa,ixIa->IXJY', np.identity(ncas), t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,ia,IJia->IXJY', np.identity(ncas), t1_xe, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,ia,JIia->IXJY', np.identity(ncas), t1_xe, v_xxxe, optimize = einsum_type)
        temp += einsum('XY,ia,iIJa->IXJY', np.identity(ncas), t1_xe, v_xxxe, optimize = einsum_type)
        temp += einsum('XY,ia,iJIa->IXJY', np.identity(ncas), t1_xe, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,ix,IJix->IXJY', np.identity(ncas), t1_xa, v_xxxa, optimize = einsum_type)
        temp -= 2 * einsum('XY,ix,JIix->IXJY', np.identity(ncas), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('XY,ix,iIJx->IXJY', np.identity(ncas), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('XY,ix,iJIx->IXJY', np.identity(ncas), t1_xa, v_xxxa, optimize = einsum_type)
        temp += einsum('XY,iIxa,Jxia->IXJY', np.identity(ncas), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('XY,iIxa,ixJa->IXJY', np.identity(ncas), t1_vxae, v_vaxe, optimize = einsum_type)
        temp += einsum('XY,iJxa,Ixia->IXJY', np.identity(ncas), t1_vxae, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('XY,iJxa,ixIa->IXJY', np.identity(ncas), t1_vxae, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,ia,IJia->IXJY', np.identity(ncas), t1_ve, v_xxve, optimize = einsum_type)
        temp -= 2 * einsum('XY,ia,JIia->IXJY', np.identity(ncas), t1_ve, v_xxve, optimize = einsum_type)
        temp += einsum('XY,ia,iIJa->IXJY', np.identity(ncas), t1_ve, v_vxxe, optimize = einsum_type)
        temp += einsum('XY,ia,iJIa->IXJY', np.identity(ncas), t1_ve, v_vxxe, optimize = einsum_type)
        temp -= 2 * einsum('XY,ix,IJix->IXJY', np.identity(ncas), t1_va, v_xxva, optimize = einsum_type)
        temp -= 2 * einsum('XY,ix,JIix->IXJY', np.identity(ncas), t1_va, v_xxva, optimize = einsum_type)
        temp += einsum('XY,ix,iIJx->IXJY', np.identity(ncas), t1_va, v_vxxa, optimize = einsum_type)
        temp += einsum('XY,ix,iJIx->IXJY', np.identity(ncas), t1_va, v_vxxa, optimize = einsum_type)
        temp += einsum('IYXa,Jaxy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYXa,Jxya,yx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IYXx,Jxyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYXx,Jyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IYaX,Jaxy,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYaX,Jxya,yx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYab,Jaxb,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYab,Jbxa,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYax,JaXy,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYax,Jayx,Xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYax,Jayz,Xzxy->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IYax,Jxya,Xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYax,JyXa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IYax,Jyza,Xyxz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IYax,Jyza,Xyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IYxX,Jxyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYxX,Jyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,JaXy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,Jayx,Xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,Jayz,Xzxy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IYxa,Jxya,Xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYxa,JyXa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IYxa,Jyza,Xyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IYxa,Jyza,Xyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IYxy,JxXz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYxy,Jxzw,Xwyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IYxy,Jxzy,Xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,JyXz,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,Jyzw,Xwxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,Jyzx,Xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,JzXx,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IYxy,JzXy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IYxy,Jzwx,Xzwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IYxy,Jzwx,Xzyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IYxy,Jzwy,Xzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IYxy,Jzwy,Xzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JYxa,Xx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,JaXx,Yx->IXJY', t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,JaxY,Xx->IXJY', t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,Jaxy,XyYx->IXJY', t1_xe, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxXa,Yx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ia,Jxya,XxYy->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ia,Jxya,XxyY->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiXa,Jxia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXa,ixJa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,JYiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jxiy,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,JyiY,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,Jyix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jyiz,Yxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Iiab,Jaib,XY->IXJY', t1_xxee, v_xexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iiab,Jbia,XY->IXJY', t1_xxee, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,JYiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixX,Jxiy,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixX,JyiY,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,Jyix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IixX,Jyiz,Yxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IixX,Jyiz,Yxzy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Iixa,JYia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('Iixa,Jxia,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixa,Jyia,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixa,Jyia,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixa,iYJa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixa,ixJa,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Iixa,iyJa,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixa,iyJa,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Iixy,JYiy,Xx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYiz,Xzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,JxiY,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('Iixy,Jxiy,XY->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,Jxiz,XzYy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JyiY,Xx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,Jyix,XY->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jyiz,XzYx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jyiz,XzxY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,JziY,Xzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,JziY,Xzyx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwYxy->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jziw,XzwxYy->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jzix,XzYy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jzix,XzyY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jziy,XzYx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixy,Jziy,XzxY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiXa,Jxia,Yx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXa,ixJa,Yx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,JYiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jxiy,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,JyiY,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,Jyix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jyiz,Yxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Iiab,Jaib,XY->IXJY', t1_xvee, v_xeve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iiab,Jbia,XY->IXJY', t1_xvee, v_xeve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,JYiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixX,Jxiy,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixX,JyiY,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,Jyix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IixX,Jyiz,Yxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IixX,Jyiz,Yxzy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Iixa,JYia,Xx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('Iixa,Jxia,XY->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixa,Jyia,XyYx->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixa,Jyia,XyxY->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixa,iYJa,Xx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixa,ixJa,XY->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Iixa,iyJa,XyYx->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixa,iyJa,XyxY->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('Iixy,JYiy,Xx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYiz,Xzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,JxiY,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('Iixy,Jxiy,XY->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,Jxiz,XzYy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JyiY,Xx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixy,Jyix,XY->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jyiz,XzYx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jyiz,XzxY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,JziY,Xzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,JziY,Xzyx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwYxy->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jziw,XzwxYy->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jzix,XzYy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jzix,XzyY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jziy,XzYx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixy,Jziy,XzxY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JYyx,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,JxXy,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,JxyY,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,Jxyz,XzYy->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyXx,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ix,Jyzx,XyYz->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ix,Jyzx,XyzY->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IxXa,JYya,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,JayY,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,Jayz,Yyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,Jyza,Yzyx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IxXy,JYxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxXy,JYzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,JyzY,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,Jyzw,Yzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,Jzwy,Ywzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxXy,JzxY,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxXy,Jzxw,Yyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaX,JYya,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxaX,JayY,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxaX,Jayz,Yyxz->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxaX,Jyza,Yzxy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IxaX,Jyza,Yzyx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixab,JaXb,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixab,Jayb,XxYy->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixab,JbXa,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixab,Jbya,XxYy->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixab,Jbya,XxyY->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Ixay,JYXa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JYza,Xxzy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Ixay,JaXY,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,JaXy,Yx->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,JaXz,Yyzx->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,JazY,Xxzy->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,Jazw,XxwYyz->IXJY', t1_xaea, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,Jazy,XxYz->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JyXa,Yx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jyza,XxYz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixay,Jyza,XxzY->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JzXa,Yyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jzwa,XxzYyw->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixay,Jzwa,XxzwyY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxyX,JYxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyX,JYzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyX,JyzY,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyX,Jyzw,Yzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyX,Jzwy,Ywxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IxyX,Jzwy,Ywzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyX,JzxY,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxyX,Jzxw,Yywz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyX,Jzxw,Yyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JYXa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JYza,Xxyz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,JaXY,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JaXy,Yx->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JaXz,Yyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,JaXz,Yyzx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JazY,Xxyz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,JazY,Xxzy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazw,XxwYyz->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jazw,XxwyYz->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazy,XxYz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jazy,XxzY->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,JyXa,Yx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,Jyza,XxYz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,JzXa,Yyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JzXa,Yyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jzwa,XxzYwy->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jzwa,XxzywY->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('Ixyz,JYXy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYXz,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYwy,Xxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYwz,Xxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JYxw,Xwyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JwXy,Yzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JwXz,Yywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JwXz,Yyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuy,XxwYzu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwuy,XxwuzY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuz,XxwYuy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwuz,XxwyuY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JwxY,Xwyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JwxY,Xwzy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwxu,XwuYyz->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwxu,XwuyYz->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('Ixyz,JyXY,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JyXw,Yzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JyXz,Yx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JywY,Xxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,Jywu,XxuYzw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,Jywz,XxYw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JzXY,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JzXw,Yywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzXw,Yyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JzXy,Yx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JzwY,Xxwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzwY,Xxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwu,XxuYyw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jzwu,XxuyYw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwy,XxYw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jzwy,XxwY->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('JXYa,Iaxy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXYa,Ixya,yx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('JXYx,Ixyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXYx,Iyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('JXaY,Iaxy,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXaY,Ixya,yx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXab,Iaxb,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXab,Ibxa,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXax,IaYy,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXax,Iayx,Yy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXax,Iayz,Yzxy->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JXax,Ixya,Yy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXax,IyYa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('JXax,Iyza,Yyxz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JXax,Iyza,Yyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JXxY,Ixyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXxY,Iyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,IaYy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,Iayx,Yy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,Iayz,Yzxy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JXxa,Ixya,Yy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXxa,IyYa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JXxa,Iyza,Yyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JXxa,Iyza,Yyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JXxy,IxYz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXxy,Ixzw,Ywyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JXxy,Ixzy,Yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,IyYz,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,Iyzw,Ywxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,Iyzx,Yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,IzYx,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JXxy,IzYy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JXxy,Izwx,Yzwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JXxy,Izwx,Yzyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JXxy,Izwy,Yzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JXxy,Izwy,Yzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IXxa,Yx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IaYx,Xx->IXJY', t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IaxX,Yx->IXJY', t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,Iaxy,XxYy->IXJY', t1_xe, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxYa,Xx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ja,Ixya,XyYx->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ja,Ixya,XyxY->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JiYa,Ixia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYa,ixIa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,IXiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Ixiy,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,IyiX,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,Iyix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Iyiz,Xxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jiab,Iaib,XY->IXJY', t1_xxee, v_xexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jiab,Ibia,XY->IXJY', t1_xxee, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,IXiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixY,Ixiy,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixY,IyiX,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,Iyix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('JixY,Iyiz,Xxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JixY,Iyiz,Xxzy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jixa,IXia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('Jixa,Ixia,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixa,Iyia,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixa,Iyia,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iXIa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixa,ixIa,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jixa,iyIa,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixa,iyIa,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,IXiy,Yx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXiz,Yzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,IxiX,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('Jixy,Ixiy,XY->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,Ixiz,XyYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiX,Yx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,Iyix,XY->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iyiz,XxYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iyiz,XxzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziX,Yzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,IziX,Yzyx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyYzw->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iziw,XxyzYw->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Izix,XyYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Izix,XyzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Iziy,XxYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixy,Iziy,XxzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JiYa,Ixia,Xx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYa,ixIa,Xx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,IXiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Ixiy,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,IyiX,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,Iyix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Iyiz,Xxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jiab,Iaib,XY->IXJY', t1_xvee, v_xeve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jiab,Ibia,XY->IXJY', t1_xvee, v_xeve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,IXiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixY,Ixiy,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixY,IyiX,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,Iyix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('JixY,Iyiz,Xxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JixY,Iyiz,Xxzy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jixa,IXia,Yx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('Jixa,Ixia,XY->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixa,Iyia,XxYy->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixa,Iyia,XxyY->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iXIa,Yx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixa,ixIa,XY->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jixa,iyIa,XxYy->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixa,iyIa,XxyY->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,IXiy,Yx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXiz,Yzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,IxiX,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('Jixy,Ixiy,XY->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,Ixiz,XyYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiX,Yx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,Iyix,XY->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iyiz,XxYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iyiz,XxzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziX,Yzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,IziX,Yzyx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyYzw->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iziw,XxyzYw->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Izix,XyYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Izix,XyzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Iziy,XxYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixy,Iziy,XxzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IXyx,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IxYy,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IxyX,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,Ixyz,XyYz->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyYx,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jx,Iyzx,XzYy->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jx,Iyzx,XzyY->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('JxYa,IXya,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,IayX,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,Iayz,Xyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,Iyza,Xzyx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JxYy,IXxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxYy,IXzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,IyzX,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,Iyzw,Xzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,Izwy,Xwzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxYy,IzxX,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxYy,Izxw,Xyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaY,IXya,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxaY,IayX,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxaY,Iayz,Xyxz->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JxaY,Iyza,Xzxy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JxaY,Iyza,Xzyx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxab,IaYb,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxab,Iayb,XyYx->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxab,IbYa,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxab,Ibya,XyYx->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxab,Ibya,XyxY->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jxay,IXYa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IXza,Yxzy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jxay,IaYX,xy->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,IaYy,Xx->IXJY', t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,IaYz,Xyzx->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,IazX,Yxzy->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,Iazw,XyzYxw->IXJY', t1_xaea, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,Iazy,XzYx->IXJY', t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IyYa,Xx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Iyza,XzYx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxay,Iyza,XzxY->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IzYa,Xyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Izwa,XywYxz->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxay,Izwa,XywzxY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxyY,IXxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyY,IXzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyY,IyzX,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyY,Iyzw,Xzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JxyY,Izwy,Xwxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JxyY,Izwy,Xwzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyY,IzxX,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JxyY,Izxw,Xywz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JxyY,Izxw,Xyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IXYa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IXza,Yxyz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxya,IaYX,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IaYy,Xx->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IaYz,Xyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,IaYz,Xyzx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IazX,Yxyz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,IazX,Yxzy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazw,XyzYxw->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Iazw,XyzxYw->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazy,XzYx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Iazy,XzxY->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxya,IyYa,Xx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxya,Iyza,XzYx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,IzYa,Xyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IzYa,Xyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Izwa,XywYzx->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Izwa,XywzYx->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('Jxyz,IXYy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXYz,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXwy,Yxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXwz,Yxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IXxw,Ywyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IwYy,Xzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IwYz,Xywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IwYz,Xyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuy,XzuYxw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwuy,XzuwxY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuz,XyuYwx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwuz,XyuwYx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IwxX,Ywyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IwxX,Ywzy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwxu,XyzYwu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwxu,XyzwYu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('Jxyz,IyYX,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IyYw,Xzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IyYz,Xx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IywX,Yxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,Iywu,XzwYxu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,Iywz,XwYx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IzYX,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IzYw,Xywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzYw,Xyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IzYy,Xx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IzwX,Yxwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzwX,Yxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwu,XywYxu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Izwu,XywxYu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwy,XwYx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Izwy,XwxY->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xa,IJxa,Yx->IXJY', t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xa,JxaI,Yx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxYa,IJya,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxYa,JyaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxya,IJYa,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxya,IJza,Yxyz->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxya,JYaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxya,JzaI,Yxyz->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxya,JzaI,Yxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ya,IxaJ,Xx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ya,JIxa,Xx->IXJY', t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('YxXa,IyaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('YxXa,JIya,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxya,IXaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxya,IzaJ,Xxyz->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxya,IzaJ,Xxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxya,JIXa,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxya,JIza,Xxyz->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iIXa,Jxia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIXa,ixJa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxa,JYia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,Jxia,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('iIxa,Jyia,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iIxa,Jyia,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,iYJa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iIxa,ixJa,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,iyJa,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJYa,Ixia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJYa,ixIa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IXia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,Ixia,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('iJxa,Iyia,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iJxa,Iyia,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iXIa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iJxa,ixIa,XY->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iyIa,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iX,JIix,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,iIJx,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXYx,IJiy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXYx,iJIy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iXax,IJia,Yx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXax,iJIa,Yx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxY,IJiy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxY,iJIy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxa,IJia,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxa,iJIa,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxy,IJix,Yy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,IJiy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,IJiz,Yzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,iJIx,Yy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxy,iJIy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iXxy,iJIz,Yzxy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('iXxy,iJIz,Yzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iY,IJix,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,iJIx,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYXx,JIiy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYXx,iIJy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iYax,JIia,Xx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYax,iIJa,Xx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iYxX,JIiy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxX,iIJy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxa,JIia,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxa,iIJa,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iYxy,JIix,Xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,JIiy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,JIiz,Xzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,iIJx,Xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxy,iIJy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iYxy,iIJz,Xzxy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('iYxy,iIJz,Xzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ia,IJia,XY->IXJY', t1_xe, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ia,JIia,XY->IXJY', t1_xe, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ia,iIJa,XY->IXJY', t1_xe, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ia,iJIa,XY->IXJY', t1_xe, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiX,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('ix,IJix,XY->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiy,XxYy->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,JIiY,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('ix,JIix,XY->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,JIiy,XyYx->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iIJY,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,iIJx,XY->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ix,iIJy,XyYx->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iIJy,XyxY->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIX,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,iJIx,XY->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ix,iJIy,XxYy->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iJIy,XxyY->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXa,JIia,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXa,iIJa,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixXy,JIiY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXy,JIiy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXy,JIiz,Yyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixXy,iIJY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJz,Yyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYa,IJia,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYa,iJIa,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixYy,IJiX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYy,IJiy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYy,IJiz,Xyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixYy,iJIX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIz,Xyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixaX,JIia,Yx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaX,iIJa,Yx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixaY,IJia,Xx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaY,iJIa,Xx->IXJY', t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixay,IJia,XyYx->IXJY', t1_xaea, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixay,JIia,XxYy->IXJY', t1_xaea, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixay,iIJa,XxYy->IXJY', t1_xaea, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixay,iJIa,XyYx->IXJY', t1_xaea, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,JIiY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyX,JIiy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,JIiz,Yyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iIJY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,iIJy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyX,iIJz,Yyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyX,iIJz,Yyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,IJiX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyY,IJiy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,IJiz,Xyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyY,iJIX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,iJIy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyY,iJIz,Xyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyY,iJIz,Xyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixya,IJia,XyYx->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixya,JIia,XxYy->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixya,iIJa,XxYy->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iIJa,XxyY->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixya,iJIa,XyYx->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iJIa,XyxY->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiX,Yxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,IJiw,XyzYwx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzYxw->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzwYx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzwxY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzxYw->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzxwY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('ixyz,IJiy,XzYx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiz,XyYx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,JIiY,Xxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwYyz->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,JIiw,XxwYzy->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwyYz->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwyzY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwzYy->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwzyY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('ixyz,JIiy,XxYz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,JIiz,XxYy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iIJY,Xxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iIJw,XxwYzy->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJw,XxwyzY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,iIJy,XxYz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iIJz,XxYy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJz,XxyY->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIX,Yxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iJIw,XyzYwx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIw,XyzwYx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,iJIy,XzYx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iJIz,XyYx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIz,XyxY->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iIXa,Jxia,Yx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIXa,ixJa,Yx->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxa,JYia,Xx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,Jxia,XY->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('iIxa,Jyia,XyYx->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iIxa,Jyia,XyxY->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,iYJa,Xx->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iIxa,ixJa,XY->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,iyJa,XyYx->IXJY', t1_vxae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJYa,Ixia,Xx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJYa,ixIa,Xx->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IXia,Yx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,Ixia,XY->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('iJxa,Iyia,XxYy->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iJxa,Iyia,XxyY->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iXIa,Yx->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iJxa,ixIa,XY->IXJY', t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iyIa,XxYy->IXJY', t1_vxae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iX,JIix,Yx->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,iIJx,Yx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXYx,IJiy,xy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXYx,iJIy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iXax,IJia,Yx->IXJY', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXax,iJIa,Yx->IXJY', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxY,IJiy,xy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxY,iJIy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxa,IJia,Yx->IXJY', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxa,iJIa,Yx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxy,IJix,Yy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,IJiy,Yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,IJiz,Yzyx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxy,iJIx,Yy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxy,iJIy,Yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iXxy,iJIz,Yzxy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('iXxy,iJIz,Yzyx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iY,IJix,Xx->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,iJIx,Xx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYXx,JIiy,xy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYXx,iIJy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iYax,JIia,Xx->IXJY', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYax,iIJa,Xx->IXJY', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iYxX,JIiy,xy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxX,iIJy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxa,JIia,Xx->IXJY', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxa,iIJa,Xx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('iYxy,JIix,Xy->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,JIiy,Xx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,JIiz,Xzyx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iYxy,iIJx,Xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxy,iIJy,Xx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iYxy,iIJz,Xzxy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('iYxy,iIJz,Xzyx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ia,IJia,XY->IXJY', t1_ve, v_xxve, rdm_ca, optimize = einsum_type)
        temp += einsum('ia,JIia,XY->IXJY', t1_ve, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ia,iIJa,XY->IXJY', t1_ve, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ia,iJIa,XY->IXJY', t1_ve, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiX,Yx->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('ix,IJix,XY->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiy,XxYy->IXJY', t1_va, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,JIiY,Xx->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('ix,JIix,XY->IXJY', t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,JIiy,XyYx->IXJY', t1_va, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iIJY,Xx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,iIJx,XY->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ix,iIJy,XyYx->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iIJy,XyxY->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIX,Yx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,iJIx,XY->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ix,iJIy,XxYy->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iJIy,XxyY->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXa,JIia,Yx->IXJY', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXa,iIJa,Yx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixXy,JIiY,yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXy,JIiy,Yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixXy,JIiz,Yyzx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixXy,iIJY,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJy,Yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJz,Yyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYa,IJia,Xx->IXJY', t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYa,iJIa,Xx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixYy,IJiX,yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYy,IJiy,Xx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixYy,IJiz,Xyzx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixYy,iJIX,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIy,Xx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIz,Xyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixaX,JIia,Yx->IXJY', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaX,iIJa,Yx->IXJY', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixaY,IJia,Xx->IXJY', t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaY,iJIa,Xx->IXJY', t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixay,IJia,XyYx->IXJY', t1_vaea, v_xxve, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixay,JIia,XxYy->IXJY', t1_vaea, v_xxve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixay,iIJa,XxYy->IXJY', t1_vaea, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixay,iJIa,XyYx->IXJY', t1_vaea, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,JIiY,yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyX,JIiy,Yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,JIiz,Yyxz->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iIJY,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,iIJy,Yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyX,iIJz,Yyxz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyX,iIJz,Yyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,IJiX,yx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyY,IJiy,Xx->IXJY', t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,IJiz,Xyxz->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyY,iJIX,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyY,iJIy,Xx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyY,iJIz,Xyxz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyY,iJIz,Xyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixya,IJia,XyYx->IXJY', t1_vaae, v_xxve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixya,JIia,XxYy->IXJY', t1_vaae, v_xxve, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixya,iIJa,XxYy->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iIJa,XxyY->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixya,iJIa,XyYx->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iJIa,XyxY->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiX,Yxyz->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,IJiw,XyzYwx->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzYxw->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzwYx->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzwxY->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzxYw->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,IJiw,XyzxwY->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('ixyz,IJiy,XzYx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiz,XyYx->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,JIiY,Xxyz->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwYyz->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,JIiw,XxwYzy->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwyYz->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwyzY->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwzYy->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,JIiw,XxwzyY->IXJY', t1_vaaa, v_xxva, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('ixyz,JIiy,XxYz->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,JIiz,XxYy->IXJY', t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iIJY,Xxyz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iIJw,XxwYzy->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJw,XxwyzY->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,iIJy,XxYz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iIJz,XxYy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJz,XxyY->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIX,Yxyz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iJIw,XyzYwx->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIw,XyzwYx->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,iJIy,XzYx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('ixyz,iJIz,XyYx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIz,XyxY->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xXYa,IJya,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXYa,JyaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xXya,IJYa,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xXya,IJza,Yxzy->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xXya,JYaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXya,JzaI,Yxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xYXa,IyaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xYXa,JIya,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xYya,IXaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xYya,IzaJ,Xxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xYya,JIXa,xy->IXJY', t1_aaae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xYya,JIza,Xxzy->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xa,IJYa,Xx->IXJY', t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xa,IJya,XyYx->IXJY', t1_ae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IXaJ,Yx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xa,IyaJ,XxYy->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xa,IyaJ,XxyY->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xa,JIXa,Yx->IXJY', t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xa,JIya,XxYy->IXJY', t1_ae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,JYaI,Xx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xa,JyaI,XyYx->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xa,JyaI,XyxY->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyXa,IzaJ,Yzxy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyXa,IzaJ,Yzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyXa,JIza,Yzxy->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyYa,IJza,Xzxy->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyYa,JzaI,Xzxy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyYa,JzaI,Xzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,IJYa,Xzyx->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyza,IJwa,XzwYxy->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IJwa,XzwYyx->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IJwa,XzwxYy->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IJwa,XzwxyY->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IJwa,XzwyYx->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IJwa,XzwyxY->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,IXaJ,Yzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,IwaJ,XyxYwz->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,IwaJ,XyxwYz->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,JIXa,Yzyx->IXJY', t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyza,JIwa,XyxYwz->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JIwa,XyxYzw->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JIwa,XyxwYz->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JIwa,XyxwzY->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JIwa,XyxzYw->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JIwa,XyxzwY->IXJY', t1_aaae, v_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,JYaI,Xzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyza,JwaI,XzwYxy->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,JwaI,XzwyxY->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jixa,Iiya->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('XYxy,Jixa,iIya->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jixz,Iiyz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('XYxy,Jixz,Iizy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('XYxy,Jizx,Iiyz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jizx,Iizy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jixa,Iiya->IXJY', v_aaaa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('XYxy,Jixa,iIya->IXJY', v_aaaa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jixz,Iiyz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('XYxy,Jixz,Iizy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('XYxy,Jizx,Iiyz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,Jizx,Iizy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('XYxy,Jx,Iy->IXJY', v_aaaa, t1_xa, t1_xa, optimize = einsum_type)
        temp += einsum('XYxy,iJxa,Iiya->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,iJxa,iIya->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('XYxy,iJxa,Iiya->IXJY', v_aaaa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('XYxy,iJxa,iIya->IXJY', v_aaaa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiya,Iixa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('XxyY,Jiya,iIxa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiyz,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jizy,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('XxyY,Jizy,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiya,Iixa->IXJY', v_aaaa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= einsum('XxyY,Jiya,iIxa->IXJY', v_aaaa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiyz,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jizy,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('XxyY,Jizy,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('XxyY,Jy,Ix->IXJY', v_aaaa, t1_xa, t1_xa, optimize = einsum_type)
        temp -= einsum('XxyY,iJya,Iixa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('XxyY,iJya,iIxa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('XxyY,iJya,Iixa->IXJY', v_aaaa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('XxyY,iJya,iIxa->IXJY', v_aaaa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,JiYy,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiyY,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Xxyz,JiyY,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,JiYy,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiyY,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Xxyz,JiyY,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jy,IYxz->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jy,IYzx->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('Yxyz,IiXy,Jixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiyX,Jixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Yxyz,IiyX,Jizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Yxyz,IiXy,Jixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiyX,Jixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Yxyz,IiyX,Jizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iy,JXxz->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iy,JXzx->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('xyzw,IYxz,JXwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xyzw,IYxz,JXyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ia,Ja->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xe, optimize = einsum_type)
        temp += einsum('I,XY,Iiab,Jiab->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iiab,Jiba->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('I,XY,Iixa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('I,XY,Iixy,Jixy->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jiyx->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('I,XY,Iiab,Jiab->IXJY', e_cvs, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iiab,Jiba->IXJY', e_cvs, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('I,XY,Iixa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('I,XY,Iixy,Jixy->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jiyx->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ix,Jx->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,iIxa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('I,XY,iIxa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,iIxa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('I,XY,iIxa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ia,Ja->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xe, optimize = einsum_type)
        temp += einsum('J,XY,Iiab,Jiab->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iiab,Jiba->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('J,XY,Iixa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('J,XY,Iixy,Jixy->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jiyx->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('J,XY,Iiab,Jiab->IXJY', e_cvs, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iiab,Jiba->IXJY', e_cvs, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('J,XY,Iixa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('J,XY,Iixy,Jixy->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jiyx->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ix,Jx->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,iIxa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('J,XY,iIxa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,iIxa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('J,XY,iIxa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('a,IJ,Xa,Ya->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp -= einsum('a,IJ,iXYa,ia->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXaY,ia->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXab,iYab->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('a,IJ,iXab,iYba->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXax,iYax->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= einsum('a,IJ,iXax,iYxa->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('a,IJ,iXba,iYab->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXba,iYba->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('a,IJ,iXxa,iYax->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXxa,iYxa->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iYXa->IXJY', e_extern, np.identity(ncvs), t1_xe, t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ia,iYaX->IXJY', e_extern, np.identity(ncvs), t1_xe, t1_xaea, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,jiXa->IXJY', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,jiXa->IXJY', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('a,IJ,iXYa,ia->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXaY,ia->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXab,iYab->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('a,IJ,iXab,iYba->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXax,iYax->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp -= einsum('a,IJ,iXax,iYxa->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp -= einsum('a,IJ,iXba,iYab->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXba,iYba->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('a,IJ,iXxa,iYax->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXxa,iYxa->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iYXa->IXJY', e_extern, np.identity(ncvs), t1_ve, t1_vaae, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ia,iYaX->IXJY', e_extern, np.identity(ncvs), t1_ve, t1_vaea, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,jiXa->IXJY', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijYa,ijXa->IXJY', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,jiXa->IXJY', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= einsum('a,XY,Ja,Ia->IXJY', e_extern, np.identity(ncas), t1_xe, t1_xe, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jiab,Iiab->IXJY', e_extern, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,XY,Jiab,Iiba->IXJY', e_extern, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('a,XY,Jiba,Iiab->IXJY', e_extern, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jiba,Iiba->IXJY', e_extern, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jixa,Iixa->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,XY,Jixa,iIxa->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jiab,Iiab->IXJY', e_extern, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,XY,Jiab,Iiba->IXJY', e_extern, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('a,XY,Jiba,Iiab->IXJY', e_extern, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jiba,Iiba->IXJY', e_extern, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,Jixa,Iixa->IXJY', e_extern, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('a,XY,Jixa,iIxa->IXJY', e_extern, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('a,XY,iJxa,Iixa->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,iJxa,iIxa->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('a,XY,iJxa,Iixa->IXJY', e_extern, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('a,XY,iJxa,iIxa->IXJY', e_extern, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,iX,iY->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYa,ia->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYx,ix->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaY,ia->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= einsum('i,IJ,iXab,iYab->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXab,iYba->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('i,IJ,iXax,iYax->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXax,iYxa->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxY,ix->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxa,iYax->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxa,iYxa->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxy,iYxy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYyx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXa,ia->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXx,ix->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('i,IJ,iYaX,ia->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= einsum('i,IJ,iYab,iXab->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYab,iXba->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('i,IJ,iYax,iXax->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iXxa->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxX,ix->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iXax->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxa,iXxa->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxy,iXxy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXyx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iXYa->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iXaY->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iYXa->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iYaX->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaea, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijYa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiYa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,ijYx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiYx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijYa,ijXa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,jiXa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijYx,ijXx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,jiXx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijYa->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiYa->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,ijYx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiYx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijYa,ijXa->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,jiXa->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijYx,ijXx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,jiXx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iXYx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iXxY->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iYXx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iYxX->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijYa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiYa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijYx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,jiYx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,ijXa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiYa,jiXa->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijXx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiYx,jiXx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijYa->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiYa->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijYx->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,jiYx->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,ijXa->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiYa,jiXa->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijXx->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiYx,jiXx->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,XY,Iiab,Jiab->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iiab,Jiba->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,XY,Iixa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,XY,Iixy,Jixy->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jiyx->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,XY,Jiab,Iiab->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jiab,Iiba->IXJY', e_cvs, np.identity(ncas), t1_xxee, t1_xxee, optimize = einsum_type)
        temp += einsum('i,XY,Jixa,Iixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixa,iIxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,XY,Jixy,Iixy->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iiyx->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iIxa,Jixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,XY,iIxa,iJxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iJxa,Iixa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,XY,iJxa,iIxa->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,iX,iY->IXJY', e_val, np.identity(ncvs), t1_va, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYa,ia->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYx,ix->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaY,ia->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= einsum('i,IJ,iXab,iYab->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXab,iYba->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('i,IJ,iXax,iYax->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXax,iYxa->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxY,ix->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxa,iYax->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxa,iYxa->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxy,iYxy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYyx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXa,ia->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXx,ix->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('i,IJ,iYaX,ia->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= einsum('i,IJ,iYab,iXab->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYab,iXba->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('i,IJ,iYax,iXax->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iXxa->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxX,ix->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iXax->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxa,iXxa->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxy,iXxy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXyx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iXYa->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iXaY->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaea, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iYXa->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaae, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iYaX->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaea, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijYa->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiYa->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,ijYx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiYx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijYa,ijXa->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,jiXa->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijYx,ijXx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,jiXx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijYa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiYa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,ijYx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiYx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijYa,ijXa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,jiXa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijYx,ijXx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,jiXx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iXYx->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iXxY->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iYXx->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iYxX->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijYa->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiYa->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijYx->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,jiYx->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,ijXa->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiYa,jiXa->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijXx->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiYx,jiXx->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijYa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiYa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijYx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,jiYx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,ijXa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiYa,jiXa->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijXx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('i,IJ,jiYx,jiXx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('i,XY,Iiab,Jiab->IXJY', e_val, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iiab,Jiba->IXJY', e_val, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,XY,Iixa,Jixa->IXJY', e_val, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixa,iJxa->IXJY', e_val, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,XY,Iixy,Jixy->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jiyx->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,XY,Jiab,Iiab->IXJY', e_val, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jiab,Iiba->IXJY', e_val, np.identity(ncas), t1_xvee, t1_xvee, optimize = einsum_type)
        temp += einsum('i,XY,Jixa,Iixa->IXJY', e_val, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixa,iIxa->IXJY', e_val, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('i,XY,Jixy,Iixy->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iiyx->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iIxa,Jixa->IXJY', e_val, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,XY,iIxa,iJxa->IXJY', e_val, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iJxa,Iixa->IXJY', e_val, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('i,XY,iJxa,iIxa->IXJY', e_val, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXa,Jxay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYXa,Jxya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXx,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYXx,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYaX,Jxay,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYaX,Jxya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYab,Jxab,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYab,Jxba,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYax,JXay,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYax,JXya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYax,Ja,Xx->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYax,Jyax,Xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYax,Jyaz,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYax,Jyxa,Xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IYax,Jyza,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYax,Jyza,Xzyx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IYxX,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxX,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,JXay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxa,JXya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Ja,Xx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Jyax,Xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Jyaz,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxa,Jyxa,Xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxa,Jyza,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IYxa,Jyza,Xzyx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxy,JXxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,JXyz,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,JXzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxy,JXzy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxy,Jx,Xy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jy,Xx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IYxy,Jzwx,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxy,Jzwx,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxy,Jzwy,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IYxy,Jzwy,Xwzx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxy,Jzxw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IYxy,Jzxy,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jzyw,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jzyx,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ia,JXax,Yx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ia,JXxa,Yx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ia,Ja,XY->IXJY', e_cvs, t1_xe, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ia,JxYa,Xx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ia,JxaY,Xx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ia,Jxay,XyYx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ia,Jxya,XyYx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ia,Jxya,XyxY->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iiab,Jiab,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iiab,Jiba,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixX,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixX,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iixa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,JixY,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iixy,Jixy,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,Jixz,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,Jiyx,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwYxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iiab,Jiab,XY->IXJY', e_cvs, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iiab,Jiba,XY->IXJY', e_cvs, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixX,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixX,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iixa,Jixa,XY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixa,iJxa,XY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,JixY,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iixy,Jixy,XY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,Jixz,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iixy,Jiyx,XY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwYxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ix,JXxy,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ix,JXyx,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ix,Jx,XY->IXJY', e_cvs, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ix,JyYx,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ix,JyxY,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ix,Jyxz,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ix,Jyzx,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ix,Jyzx,XzyY->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Ja,Yx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxXa,JyYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,JyaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Jyaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Jyza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxXy,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxXy,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxXy,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxXy,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaX,Ja,Yx->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaX,JyYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaX,JyaY,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaX,Jyaz,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxaX,Jyza,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxaX,Jyza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixab,JXab,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixab,JXba,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixab,Jyab,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixab,Jyba,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixab,Jyba,XxyY->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ixay,JXYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,Ixay,JXaY,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,JXay,Yx->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,JXaz,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JXya,Yx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JXza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,Ja,XxYy->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JzYa,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,JzaY,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,Jzaw,XxwYyz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixay,Jzay,XxYz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzwa,XxwYyz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixay,Jzwa,XxwzyY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzya,XxYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixay,Jzya,XxzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyX,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyX,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyX,Jxzw,Yywz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyX,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyX,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyX,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyX,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyX,Jzwy,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyX,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyX,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JXYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixya,JXaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JXay,Yx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JXaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,JXaz,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixya,JXya,Yx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,JXza,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JXza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Ja,XxYy->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Ja,XxyY->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JzYa,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JzaY,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,JzaY,Xxzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzaw,XxwYyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzaw,XxwyYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzay,XxYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzay,XxzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixya,Jzya,XxYz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ixyz,JXYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXYz,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JXwz,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,JXwz,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Ixyz,JXyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JXyw,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JXyz,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JXzY,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,JXzw,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JXzw,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXzy,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JwYy,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JwYz,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuy,XxuYzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwuy,XxuwzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuz,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwuz,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JwyY,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,Jwyu,XxuYzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,Jwyz,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,JwzY,Xxwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JwzY,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzu,XxuYyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwzu,XxuyYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzy,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwzy,XxwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JxYw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,JxwY,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JxwY,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jxwu,XwuYyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jxwu,XwuyYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,Jy,XxYz->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jz,XxYy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jz,XxyY->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIxa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIXa,Jixa,Yx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIXa,iJxa,Yx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxa,JiYa,Xx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,Jixa,XY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,iJYa,Xx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIxa,iJxa,XY->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIxa,iJya,XyYx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXa,Jxay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYXa,Jxya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXx,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYXx,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYaX,Jxay,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYaX,Jxya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYab,Jxab,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYab,Jxba,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYax,JXay,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYax,JXya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYax,Ja,Xx->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYax,Jyax,Xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYax,Jyaz,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYax,Jyxa,Xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IYax,Jyza,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYax,Jyza,Xzyx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IYxX,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxX,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,JXay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxa,JXya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Ja,Xx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Jyax,Xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Jyaz,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxa,Jyxa,Xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxa,Jyza,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IYxa,Jyza,Xzyx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxy,JXxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,JXyz,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,JXzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxy,JXzy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxy,Jx,Xy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jy,Xx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IYxy,Jzwx,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxy,Jzwx,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxy,Jzwy,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IYxy,Jzwy,Xwzx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxy,Jzxw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IYxy,Jzxy,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jzyw,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jzyx,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ia,JXax,Yx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ia,JXxa,Yx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ia,Ja,XY->IXJY', e_cvs, t1_xe, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ia,JxYa,Xx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ia,JxaY,Xx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ia,Jxay,XyYx->IXJY', e_cvs, t1_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ia,Jxya,XyYx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ia,Jxya,XyxY->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iiab,Jiab,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iiab,Jiba,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixX,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixX,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iixa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,JixY,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iixy,Jixy,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,Jixz,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,Jiyx,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwYxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iiab,Jiab,XY->IXJY', e_cvs, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iiab,Jiba,XY->IXJY', e_cvs, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixX,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixX,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iixa,Jixa,XY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixa,iJxa,XY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,JixY,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Iixy,Jixy,XY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,Jixz,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Iixy,Jiyx,XY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwYxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ix,JXxy,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ix,JXyx,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ix,Jx,XY->IXJY', e_cvs, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ix,JyYx,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ix,JyxY,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ix,Jyxz,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ix,Jyzx,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ix,Jyzx,XzyY->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Ja,Yx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxXa,JyYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,JyaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Jyaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Jyza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxXy,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxXy,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxXy,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxXy,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaX,Ja,Yx->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaX,JyYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaX,JyaY,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaX,Jyaz,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxaX,Jyza,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxaX,Jyza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixab,JXab,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixab,JXba,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixab,Jyab,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixab,Jyba,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixab,Jyba,XxyY->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ixay,JXYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,Ixay,JXaY,xy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,JXay,Yx->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,JXaz,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JXya,Yx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JXza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,Ja,XxYy->IXJY', e_cvs, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JzYa,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,JzaY,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,Jzaw,XxwYyz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixay,Jzay,XxYz->IXJY', e_cvs, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzwa,XxwYyz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixay,Jzwa,XxwzyY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzya,XxYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixay,Jzya,XxzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyX,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyX,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyX,Jxzw,Yywz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyX,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyX,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyX,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyX,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyX,Jzwy,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyX,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyX,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JXYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixya,JXaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JXay,Yx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JXaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,JXaz,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixya,JXya,Yx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,JXza,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JXza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Ja,XxYy->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Ja,XxyY->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JzYa,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JzaY,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,JzaY,Xxzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzaw,XxwYyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzaw,XxwyYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzay,XxYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzay,XxzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixya,Jzya,XxYz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ixyz,JXYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXYz,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JXwz,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,JXwz,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Ixyz,JXyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JXyw,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JXyz,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JXzY,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,JXzw,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JXzw,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXzy,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JwYy,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JwYz,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuy,XxuYzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwuy,XxuwzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuz,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwuz,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JwyY,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,Jwyu,XxuYzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,Jwyz,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,JwzY,Xxwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JwzY,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzu,XxuYyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwzu,XxuyYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzy,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwzy,XxwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JxYw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,JxwY,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JxwY,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jxwu,XwuYyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jxwu,XwuyYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,Jy,XxYz->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jz,XxYy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jz,XxyY->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIxa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIXa,Jixa,Yx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIXa,iJxa,Yx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxa,JiYa,Xx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,Jixa,XY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,iJYa,Xx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIxa,iJxa,XY->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIxa,iJya,XyYx->IXJY', e_cvs, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,JXYa,Ixay,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXYa,Ixya,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,JXaY,Ixay,xy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXaY,Ixya,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXab,Ixab,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXab,Ixba,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXax,IYay,xy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXax,IYya,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXax,Ia,Yx->IXJY', e_extern, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXax,Iyax,Yy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXax,Iyaz,Yzxy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXax,Iyxa,Yy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,JXax,Iyza,Yzxy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,JXax,Iyza,Yzyx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXba,Ixab,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXba,Ixba,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,IYay,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXxa,IYya,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Ia,Yx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Iyax,Yy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Iyaz,Yzxy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,JXxa,Iyxa,Yy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,JXxa,Iyza,Yzxy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,JXxa,Iyza,Yzyx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Ja,IYax,Xx->IXJY', e_extern, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IYxa,Xx->IXJY', e_extern, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Ja,Ia,XY->IXJY', e_extern, t1_xe, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IxXa,Yx->IXJY', e_extern, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Ja,IxaX,Yx->IXJY', e_extern, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Ja,Ixay,XxYy->IXJY', e_extern, t1_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Ja,Ixya,XxYy->IXJY', e_extern, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Ja,Ixya,XxyY->IXJY', e_extern, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,JiYa,Iixa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JiYa,iIxa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jiab,Iiab,XY->IXJY', e_extern, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jiab,Iiba,XY->IXJY', e_extern, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jiba,Iiab,XY->IXJY', e_extern, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jiba,Iiba,XY->IXJY', e_extern, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jixa,Iixa,XY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('a,Jixa,Iiya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jixa,Iiya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jixa,iIxa,XY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jixa,iIya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jixa,iIya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,JiYa,Iixa,Xx->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JiYa,iIxa,Xx->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jiab,Iiab,XY->IXJY', e_extern, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jiab,Iiba,XY->IXJY', e_extern, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jiba,Iiab,XY->IXJY', e_extern, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jiba,Iiba,XY->IXJY', e_extern, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jixa,Iixa,XY->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('a,Jixa,Iiya,XxYy->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jixa,Iiya,XxyY->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIXa,Yx->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jixa,iIxa,XY->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jixa,iIya,XxYy->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jixa,iIya,XxyY->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Ia,Xx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxYa,IyXa,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,IyaX,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Iyaz,Xyxz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Iyza,Xyzx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,JxaY,Ia,Xx->IXJY', e_extern, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaY,IyXa,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JxaY,IyaX,xy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JxaY,Iyaz,Xyxz->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,JxaY,Iyza,Xyxz->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,JxaY,Iyza,Xyzx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxab,IYab,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxab,IYba,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxab,Iyab,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxab,Iyba,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxab,Iyba,XyxY->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,Jxay,IYXa,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jxay,IYaX,xy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,IYay,Xx->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,IYaz,Xyzx->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IYya,Xx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IYza,Xyzx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,Ia,XyYx->IXJY', e_extern, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IzXa,Yxzy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,IzaX,Yxzy->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,Izaw,XyzYxw->IXJY', e_extern, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,Izay,XzYx->IXJY', e_extern, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izwa,XyzYxw->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxay,Izwa,XyzwxY->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izya,XzYx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxay,Izya,XzxY->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxba,IYab,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxba,IYba,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxba,Iyab,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxba,Iyab,XyxY->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxba,Iyba,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IYXa,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxya,IYaX,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IYay,Xx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IYaz,Xyxz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,IYaz,Xyzx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxya,IYya,Xx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,IYza,Xyxz->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IYza,Xyzx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Ia,XyYx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Ia,XyxY->IXJY', e_extern, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IzXa,Yxyz->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IzaX,Yxyz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,IzaX,Yxzy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izaw,XyzYxw->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izaw,XyzxYw->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izay,XzYx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izay,XzxY->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izwa,XyzYwx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izwa,XyzwYx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxya,Izya,XzYx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJYa,Iixa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJYa,iIxa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,Iixa,XY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,iJxa,Iiya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,iJxa,Iiya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,iJxa,iIxa,XY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJYa,Iixa,Xx->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJYa,iIxa,Xx->IXJY', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiXa,Yx->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,Iixa,XY->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,iJxa,Iiya,XxYy->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,iJxa,Iiya,XxyY->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIXa,Yx->IXJY', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,iJxa,iIxa,XY->IXJY', e_extern, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIya,XxYy->IXJY', e_extern, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iiab,Jiab,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iiab,Jiba,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IixX,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,JixY,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,Jixy,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,Jixz,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,Jiyx,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwYxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,Iixa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYa,iIxa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYx,Iixy,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,Iiyx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jiab,Iiab,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jiab,Iiba,XY->IXJY', e_cvs, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,JixY,Iixy,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JixY,Iiyx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jixa,Iixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixa,Iiya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixa,Iiya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixa,iIxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixa,iIya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixa,iIya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiXx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,IiXy,Yx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,IixX,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jixy,Iixy,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,Iixz,XyYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyX,Yx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,Iiyx,XY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixy,Iiyz,XxYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iiyz,XxzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixy,Iizx,XyYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iizx,XyzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iizy,XxYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixy,Iizy,XxzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,Jixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxa,iJxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJYa,Iixa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJYa,iIxa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,Iixa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,iJxa,Iiya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,iJxa,Iiya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJxa,iIxa,XY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXa,iJxa,Yx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IiXx,JiYy,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXx,Jixy,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,JiyY,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,Jiyx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iiab,Jiab,XY->IXJY', e_val, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iiab,Jiba,XY->IXJY', e_val, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JiYy,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IixX,Jixy,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiyY,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixX,Jiyx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixX,Jiyz,Yxyz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,IixX,Jiyz,Yxzy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixa,JiYa,Xx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixa,Jixa,XY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixa,Jiya,XyYx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixa,Jiya,XyxY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixa,iJYa,Xx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixa,iJxa,XY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixa,iJya,XyYx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixa,iJya,XyxY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiYx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixy,JiYy,Xx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,JiYz,Xzxy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,JixY,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,Jixy,XY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,Jixz,XzYy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiyY,Xx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iixy,Jiyx,XY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixy,Jiyz,XzYx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jiyz,XzxY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,JizY,Xzxy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,JizY,Xzyx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwYxy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizw,XzwxYy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Iixy,Jizx,XzYy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jizx,XzyY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizy,XzYx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizy,XzxY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,Iixa,Xx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYa,iIxa,Xx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYx,Iixy,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,Iiyx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jiab,Iiab,XY->IXJY', e_val, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jiab,Iiba,XY->IXJY', e_val, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,JixY,Iixy,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JixY,Iiyx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jixa,Iixa,XY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixa,Iiya,XxYy->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixa,Iiya,XxyY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIXa,Yx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixa,iIxa,XY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixa,iIya,XxYy->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixa,iIya,XxyY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiXx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,IiXy,Yx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,IixX,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Jixy,Iixy,XY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,Iixz,XyYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyX,Yx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,Iiyx,XY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixy,Iiyz,XxYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iiyz,XxzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('i,Jixy,Iizx,XyYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iizx,XyzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iizy,XxYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixy,Iizy,XxzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIXa,Jixa,Yx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIXa,iJxa,Yx->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxa,JiYa,Xx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,Jixa,XY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,iIxa,Jiya,XyYx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,iIxa,Jiya,XyxY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,iJYa,Xx->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxa,iJxa,XY->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIxa,iJya,XyYx->IXJY', e_val, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJYa,Iixa,Xx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJYa,iIxa,Xx->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiXa,Yx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,Iixa,XY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('i,iJxa,Iiya,XxYy->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,iJxa,Iiya,XxyY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIXa,Yx->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJxa,iIxa,XY->IXJY', e_val, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIya,XxYy->IXJY', e_val, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Ia,XY,Jxay,xy->IXJY', h_xe, np.identity(ncas), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,XY,Jxya,xy->IXJY', h_xe, np.identity(ncas), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ix,XY,Jyxz,yz->IXJY', h_xa, np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,XY,Jyzx,yz->IXJY', h_xa, np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ja,XY,Ixay,xy->IXJY', h_xe, np.identity(ncas), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,XY,Ixya,xy->IXJY', h_xe, np.identity(ncas), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jx,XY,Iyxz,yz->IXJY', h_xa, np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,XY,Iyzx,yz->IXJY', h_xa, np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xa,IJ,Yxya,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xa,IJ,xYya,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ya,IJ,Xxya,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('Ya,IJ,xXya,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ya,IJ,xa,Xx->IXJY', h_ae, np.identity(ncvs), t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ya,IJ,xyza,Xzyx->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('iX,IJ,ixYy,yx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,IJ,ixyY,yx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ix,Xx->IXJY', h_xa, np.identity(ncvs), t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iY,IJ,ixXy,yx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ixyX,yx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ixyz,Xxyz->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ia,IJ,iYax,Xx->IXJY', h_xe, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ia,IJ,iYxa,Xx->IXJY', h_xe, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ia,IJ,ixYa,Xx->IXJY', h_xe, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('ia,IJ,ixaY,Xx->IXJY', h_xe, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iXYy,xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXyY,xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iY,Xx->IXJY', h_xa, np.identity(ncvs), t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYXy,xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYxy,Xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYyX,xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYyx,Xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYyz,Xxzy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyYx,Xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyYz,Xzxy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ix,IJ,iyxY,Xy->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyzY,Xzyx->IXJY', h_xa, np.identity(ncvs), t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('iX,IJ,ixYy,yx->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,IJ,ixyY,yx->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ix,Xx->IXJY', h_va, np.identity(ncvs), t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('iY,IJ,ixXy,yx->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ixyX,yx->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iY,IJ,ixyz,Xxyz->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ia,IJ,iYax,Xx->IXJY', h_ve, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ia,IJ,iYxa,Xx->IXJY', h_ve, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ia,IJ,ixYa,Xx->IXJY', h_ve, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('ia,IJ,ixaY,Xx->IXJY', h_ve, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iXYy,xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXyY,xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iY,Xx->IXJY', h_va, np.identity(ncvs), t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYXy,xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYxy,Xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iYyX,xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYyx,Xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iYyz,Xxzy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyYx,Xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyYz,Xzxy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ix,IJ,iyxY,Xy->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iyzY,Xzyx->IXJY', h_va, np.identity(ncvs), t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xa,IJ,XyYa,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,Ya,Xx->IXJY', h_ae, np.identity(ncvs), t1_ae, rdm_ca, optimize = einsum_type)
        temp += einsum('xa,IJ,YyXa,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,Yyza,Xyzx->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,yXYa,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,yYXa,xy->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,yYza,Xyxz->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,yzYa,Xxyz->IXJY', h_ae, np.identity(ncvs), t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYax,ia->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxa,ia->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxy,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYyx,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiYa->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jiYy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiYa->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jiYy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iY->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYa,ia->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYy,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaY,ia->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixab,iYab->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixab,iYba->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixay,iYay->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixay,iYya->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyY,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixya,iYay->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixya,iYya->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyz,iYyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYax,ia->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxa,ia->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxy,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYyx,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiYa->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jiYy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijYa->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiYa->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,ijYy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jiYy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iY->IXJY', h_aa, np.identity(ncvs), t1_va, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYa,ia->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYy,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaY,ia->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixab,iYab->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixab,iYba->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixay,iYay->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixay,iYya->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyY,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixya,iYay->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixya,iYya->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyz,iYyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xa,Ya->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXax,ia->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxa,ia->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxy,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXyx,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,jiXa->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiXy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,jiXa->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiXy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,ix,iX->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXa,ia->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXy,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixaX,ia->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixab,iXab->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixab,iXba->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixay,iXay->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,iXya->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyX,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,iXay->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixya,iXya->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyz,iXyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXax,ia->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxa,ia->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxy,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXyx,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,jiXa->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiXy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxa,ijXa->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,jiXa->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ijxy,ijXy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiXy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,ix,iX->IXJY', h_aa, np.identity(ncvs), t1_va, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXa,ia->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXy,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixaX,ia->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixab,iXab->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixab,iXba->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixay,iXay->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,iXya->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyX,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,iXay->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixya,iXya->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyz,iXyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xa,Xa->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_ae, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXYx,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXax,iYay->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXax,iYya->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxY,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxa,iYay->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxa,iYya->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxz,iYyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxz,iYzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXzx,iYyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXzx,iYzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYXx,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iYxX,iy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijXx,jiYy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijXx,jiYy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXYx,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXax,iYay->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXax,iYya->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxY,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxa,iYay->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxa,iYya->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxz,iYyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxz,iYzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXzx,iYyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXzx,iYzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYXx,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iYxX,iy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijXx,jiYy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijXx,ijYy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijXx,jiYy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iixa,Jiya->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,XY,Iixa,iJya->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iixz,Jiyz->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iixz,Jizy->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iizx,Jiyz->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iizx,Jizy->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iixa,Jiya->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('xy,XY,Iixa,iJya->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iixz,Jiyz->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iixz,Jizy->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iizx,Jiyz->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,Iizx,Jizy->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,XY,Ix,Jy->IXJY', h_aa, np.identity(ncas), t1_xa, t1_xa, optimize = einsum_type)
        temp += einsum('xy,XY,iIxa,Jiya->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,iIxa,iJya->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('xy,XY,iIxa,Jiya->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('xy,XY,iIxa,iJya->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,xy,Xy->IXJY', h_aa, np.identity(ncvs), t2_aa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Yx,Xy->IXJY', h_aa, np.identity(ncvs), t2_aa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IYax,Jyaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IYax,Jyza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxa,Jyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IYxa,Jyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IYxy,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxy,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IYyx,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IYyx,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixa,iJya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iiyx,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iiyx,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iiyx,Jizw,Yywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iiyx,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixa,iJya,Yy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iiyx,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iiyx,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iiyx,Jizw,Yywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iiyx,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyax,Ja,Yy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyax,JzYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyax,JzaY,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyax,Jzaw,Yzyw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iyax,Jzwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iyax,Jzwa,Yzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Ja,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iyxa,JzYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,JzaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Jzaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Jzwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iyxz,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iyxz,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyxz,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyxz,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyzx,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iyzx,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iyzx,Jwuz,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyzx,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyzx,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyzx,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyzx,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iyzx,Jywu,Yzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iyzx,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyzx,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYa,Iyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,JxYa,Iyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,JxYy,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYy,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,JxaY,Iyaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,JxaY,Iyza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxab,Iyab,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxab,Iyba,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxay,IYaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxay,IYza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxay,Ia,Yy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxay,Izaw,Ywyz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxay,Izay,Yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Jxay,Izwa,Ywyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxay,Izwa,Ywzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxay,Izya,Yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,JxyY,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,JxyY,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,IYaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxya,IYza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Ia,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Izaw,Ywyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Izay,Yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxya,Izwa,Ywyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Jxya,Izwa,Ywzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxya,Izya,Yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,IYwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxyz,IYwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxyz,IYyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,IYzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxyz,Iwuy,Yuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Jxyz,Iwuy,Yuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Jxyz,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxyz,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxyz,Iwyu,Yuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxyz,Iwyz,Yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iwzu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iwzy,Yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jxyz,Iy,Yz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,iIxa,Jiya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,iIxa,iJya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,iIxa,Jiya,Yy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,iIxa,iJya,Yy->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXa,Jyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IxXa,Jyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IxXy,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXy,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IxaX,Jyaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IxaX,Jyza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixab,Jyab,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixab,Jyba,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixay,JXaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixay,JXza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixay,Ja,Xy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixay,Jzaw,Xwyz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixay,Jzay,Xz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Ixay,Jzwa,Xwyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixay,Jzwa,Xwzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixay,Jzya,Xz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IxyX,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IxyX,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,JXaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixya,JXza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Ja,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Jzaw,Xwyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Jzay,Xz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixya,Jzwa,Xwyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Ixya,Jzwa,Xwzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixya,Jzya,Xz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,JXwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixyz,JXwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixyz,JXyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,JXzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixyz,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Ixyz,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Ixyz,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixyz,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixyz,Jwyu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixyz,Jwyz,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jwzu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jwzy,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Ixyz,Jy,Xz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,JXax,Iyaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,JXax,Iyza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxa,Iyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,JXxa,Iyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,JXxy,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxy,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,JXyx,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,JXyx,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,Iiya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixa,iIya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iiyz,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,Iizy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jiyx,Iiyz,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jiyx,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jiyx,Iizw,Xywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jiyx,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,Iizy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,Iiya,Xy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixa,iIya,Xy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iiyz,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,Iizy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jiyx,Iiyz,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jiyx,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jiyx,Iizw,Xywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jiyx,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,Iizy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyax,Ia,Xy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyax,IzXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyax,IzaX,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyax,Izaw,Xzyw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jyax,Izwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jyax,Izwa,Xzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Ia,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jyxa,IzXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,IzaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Izaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Izwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jyxz,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jyxz,IyXw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyxz,IywX,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyxz,Iywu,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyzx,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jyzx,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jyzx,Iwuz,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyzx,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyzx,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyzx,IyXw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyzx,IywX,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jyzx,Iywu,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jyzx,Iywu,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyzx,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,iJxa,Iiya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,iJxa,iIya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,iJxa,Iiya,Xy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,iJxa,iIya,Xy->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYXx,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IYXx,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYax,JXaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYax,JXza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYax,Ja,Xy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYax,Jzaw,Xwyz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYax,Jzay,Xz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IYax,Jzwa,Xwyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYax,Jzwa,Xwzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYax,Jzya,Xz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxX,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IYxX,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,JXaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYxa,JXza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,Ja,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,Jzaw,Xwyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxa,Jzay,Xz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYxa,Jzwa,Xwyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IYxa,Jzwa,Xwzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxa,Jzya,Xz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxz,JXwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYxz,JXwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxz,JXyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,JXzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYxz,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IYxz,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IYxz,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYxz,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxz,Jwyu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxz,Jwyz,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,Jwzu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxz,Jwzy,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYxz,Jy,Xz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,Jz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYzx,JXwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYzx,JXwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,JXyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYzx,JXzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IYzx,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYzx,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYzx,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IYzx,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jwyu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jwyz,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYzx,Jwzu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IYzx,Jwzy,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jy,Xz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IYzx,Jz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixX,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IixX,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixX,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IixX,Jizw,Yywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixX,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixX,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,JiYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,Iixa,Jiya,XY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixa,Jiza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixa,Jiza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixa,iJYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,iJya,XY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixa,iJza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixa,iJza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JiYw,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iixz,JiYy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiYz,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,JiwY,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,JiwY,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuYyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jiwu,XwuyYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwy,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwy,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwz,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwz,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiyY,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,Jiyw,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,Iixz,Jiyz,XY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JizY,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jizw,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jizw,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,Jizy,XY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYw,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,Iizx,JiYy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYz,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,JiwY,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,JiwY,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,Jiwu,XwuYzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwu,XwuzYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iizx,Jiwy,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iizx,Jiwy,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,Jiwz,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwz,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iizx,JiyY,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iizx,Jiyw,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiyw,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iizx,Jiyz,XY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Iizx,JizY,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Iizx,Jizw,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,Iizx,Jizy,XY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixX,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IixX,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixX,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IixX,Jizw,Yywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixX,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixX,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,JiYa,Xy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,Iixa,Jiya,XY->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixa,Jiza,XzYy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixa,Jiza,XzyY->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixa,iJYa,Xy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,iJya,XY->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixa,iJza,XzYy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixa,iJza,XzyY->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JiYw,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iixz,JiYy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiYz,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,JiwY,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,JiwY,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuYyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jiwu,XwuyYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwy,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwy,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwz,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwz,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiyY,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,Jiyw,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,Iixz,Jiyz,XY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JizY,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jizw,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jizw,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,Jizy,XY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYw,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,Iizx,JiYy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYz,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,JiwY,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,JiwY,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,Jiwu,XwuYzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwu,XwuzYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iizx,Jiwy,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iizx,Jiwy,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iizx,Jiwz,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwz,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iizx,JiyY,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iizx,Jiyw,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiyw,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iizx,Jiyz,XY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Iizx,JizY,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Iizx,Jizw,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,Iizx,Jizy,XY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ix,JXyz,Yz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ix,JXzy,Yz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ix,Jy,XY->IXJY', h_aa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ix,JzYy,Xz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ix,Jzwy,XwYz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ix,Jzwy,XwzY->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ix,JzyY,Xz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ix,Jzyw,XwYz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Ja,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXa,JzYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,JzaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Jzaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Jzwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IxXz,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaX,Ja,Yy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaX,JzYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaX,JzaY,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaX,Jzaw,Yzyw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxaX,Jzwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IxaX,Jzwa,Yzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixab,JXab,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixab,JXba,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixab,Jzab,XyYz->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixab,Jzba,XyYz->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixab,Jzba,XyzY->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixaz,JXYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ixaz,JXaY,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,JXaw,Yzwy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,JXaz,Yy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JXwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JXza,Yy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,Ja,XyYz->IXJY', h_aa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JwYa,Xywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,JwaY,Xywz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,Jwau,XyuYzw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixaz,Jwaz,XyYw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwua,XyuYzw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixaz,Jwua,XyuwzY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwza,XyYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixaz,Jwza,XywY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzX,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxzX,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IxzX,Jwuz,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzX,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzX,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzX,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IxzX,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxzX,Jywu,Yzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IxzX,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzX,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JXYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixza,JXaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,JXaw,Yzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JXaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JXaz,Yy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JXwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,JXwa,Yzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixza,JXza,Yy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Ja,XyYz->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Ja,XyzY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JwYa,Xyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,JwaY,Xywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JwaY,Xyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwau,XyuYzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwau,XyuzYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwaz,XyYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwaz,XywY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwua,XyuYwz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwua,XyuzwY->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixza,Jwza,XyYw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixzw,JXYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JXuw,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,JXuw,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,JXwY,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,JXwu,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JXwu,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXwz,Yy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ixzw,JXzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,JXzu,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,JXzw,Yy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JuYw,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JuYz,Xyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvw,XyvYuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juvw,XyvzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvz,XyvYwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juvz,XyvuwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,JuwY,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JuwY,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwv,XyvYzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juwv,XyvzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwz,XyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juwz,XyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,JuzY,Xyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,Juzv,XyvYwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,Juzw,XyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Jw,XyYz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Jw,XyzY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixzw,JyYu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,JyuY,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ixzw,JyuY,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jyuv,XuvYzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ixzw,Jyuv,XuvzYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixzw,Jz,XyYw->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IzXx,JwYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jwuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,JwyY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jwyu,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jy,Yz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,JzYw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzXx,JzwY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzXx,Jzwu,Yywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izax,JXYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izax,JXaY,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izax,JXaw,Yywz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izax,JXay,Yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izax,JXwa,Yywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izax,JXya,Yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izax,Ja,XzYy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izax,JwYa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izax,JwaY,Xzwy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izax,Jwau,XzuYyw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izax,Jway,XzYw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izax,Jwua,XzuYyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izax,Jwua,XzuwyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izax,Jwya,XzYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izax,Jwya,XzwY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izwx,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JXYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izwx,JXuw,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JXuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,JXuy,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JXwY,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,JXwu,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izwx,JXwy,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izwx,JXyY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,JXyu,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JXyu,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JXyw,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izwx,JuYw,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JuYy,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Juvw,XzvYyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izwx,Juvw,XzvuyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juvy,XzvYuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juvy,XzvwuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,JuwY,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,Juwv,XzvYyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izwx,Juwy,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,JuyY,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JuyY,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyv,XzvYwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juyv,XzvwYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyw,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juyw,XzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,Jw,XzYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Jy,XzYw->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Jy,XzwY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,JzYu,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,JzuY,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izwx,JzuY,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izwx,Jzuv,XuvYwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Jzuv,XuvwYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxX,JwYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IzxX,Jwuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IzxX,Jwuy,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxX,JwyY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxX,Jwyu,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxX,Jy,Yz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxX,JzYw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IzxX,JzwY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IzxX,Jzwu,Yyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IzxX,Jzwu,Yywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxa,JXYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izxa,JXaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,JXaw,Yywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JXaw,Yyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxa,JXay,Yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JXwa,Yywz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,JXwa,Yyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxa,JXya,Yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Ja,XzYy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Ja,XzyY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxa,JwYa,Xzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,JwaY,Xzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JwaY,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwau,XzuYyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Jwau,XzuyYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxa,Jway,XzYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,Jway,XzwY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwua,XzuYwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Jwua,XzuywY->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxa,Jwya,XzYw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxw,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,Izxw,JXYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JXuw,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,JXuw,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JXuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izxw,JXwY,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,JXwu,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JXwu,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JXwy,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,Izxw,JXyY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,JXyu,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,JXyw,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxw,JuYw,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JuYy,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juvw,XzvYuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Juvw,XzvyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juvy,XzvYwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Juvy,XzvuwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,JuwY,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JuwY,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juwv,XzvYyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Juwv,XzvyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juwy,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Juwy,XzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,JuyY,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,Juyv,XzvYwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,Juyw,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Jw,XzYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jw,XzyY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izxw,Jy,XzYw->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izxw,JzYu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JzuY,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,JzuY,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jzuv,XuvYyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Jzuv,XuvyYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXax,IYaz,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXax,IYza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXax,Ia,Yy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXax,Izaw,Ywyz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JXax,Izwa,Ywyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXax,Izwa,Ywzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,IYaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXxa,IYza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,Ia,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,Izaw,Ywyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXxa,Izwa,Ywyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JXxa,Izwa,Ywzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXxz,IYwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,IYzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JXxz,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXxz,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,Iwzu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,Iz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXzx,IYwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXzx,IYzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXzx,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JXzx,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXzx,Iwzu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JXzx,Iz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiYx,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixY,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixY,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JixY,Iizw,Xywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JixY,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixa,Iiza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixa,Iiza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixa,iIza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixa,iIza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwX,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,IiwX,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzYwu->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iiwu,XyzwYu->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,Iiwz,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixz,Iiwz,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizX,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iizw,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iizw,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXw,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXz,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,IiwX,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwX,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,Iiwu,XyzYuw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwu,XyzwuY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,Iiwz,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwz,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,IizX,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,Iizw,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiYx,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixY,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixY,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JixY,Iizw,Xywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JixY,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixa,Iiza,XyYz->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixa,Iiza,XyzY->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIXa,Yy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixa,iIza,XyYz->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixa,iIza,XyzY->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwX,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,IiwX,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzYwu->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iiwu,XyzwYu->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,Iiwz,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixz,Iiwz,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizX,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iizw,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iizw,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXw,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXz,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,IiwX,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwX,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,Iiwu,XyzYuw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwu,XyzwuY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,Iiwz,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwz,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,IizX,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,Iizw,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Ia,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxYa,IzXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,IzaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Izaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Izwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxYz,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxaY,Ia,Xy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaY,IzXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxaY,IzaX,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxaY,Izaw,Xzyw->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JxaY,Izwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JxaY,Izwa,Xzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxab,IYab,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxab,IYba,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxab,Izab,XzYy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxab,Izba,XzYy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxab,Izba,XzyY->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxaz,IYXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jxaz,IYaX,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,IYaw,Xzwy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,IYaz,Xy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IYwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IYza,Xy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,Ia,XzYy->IXJY', h_aa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IwXa,Yywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,IwaX,Yywz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,Iwau,XzwYyu->IXJY', h_aa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,Iwaz,XwYy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwua,XzwYyu->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxaz,Iwua,XzwuyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwza,XwYy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxaz,Iwza,XwyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzY,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JxzY,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JxzY,Iwuz,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxzY,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxzY,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxzY,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IYXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxza,IYaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,IYaw,Xzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IYaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IYaz,Xy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IYwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,IYwa,Xzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxza,IYza,Xy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Ia,XzYy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Ia,XzyY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IwXa,Yyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,IwaX,Yywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IwaX,Yyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwau,XzwYyu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwau,XzwyYu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwaz,XwYy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwaz,XwyY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwua,XzwYuy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwua,XzwuYy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxza,Iwza,XwYy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxzw,IYXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IYuw,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,IYuw,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IYwX,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,IYwu,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IYwu,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYwz,Xy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jxzw,IYzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IYzu,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IYzw,Xy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuXw,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuXz,Yyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvw,XzuYvy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuvw,XzuvYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvz,XwuYyv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuvz,XwuvyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,IuwX,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IuwX,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwv,XzuYyv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuwv,XzuyYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwz,XuYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuwz,XuyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IuzX,Yyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,Iuzv,XwuYyv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,Iuzw,XuYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iw,XzYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iw,XzyY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,Iz,XwYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzYx,IzXw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzYx,IzwX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzYx,Izwu,Xywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzax,IYXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jzax,IYaX,yz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzax,IYaw,Xywz->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IYwa,Xywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzax,Ia,XyYz->IXJY', h_aa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IwXa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzax,IwaX,Yzwy->IXJY', h_aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzax,Iwau,XywYzu->IXJY', h_aa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzax,Iwua,XywYzu->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzax,Iwua,XywuzY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzwx,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IYuw,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jzwx,IYwX,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IYwu,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IuXw,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Iuvw,XyuYzv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzwx,Iuvw,XyuvzY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IuwX,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,Iuwv,XyuYzv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,Iw,XyYz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IzXu,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,IzuX,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzwx,IzuX,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzwx,Izuv,XywYvu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Izuv,XywuvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxY,IzXw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JzxY,IzwX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JzxY,Izwu,Xyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JzxY,Izwu,Xywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IYXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxa,IYaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,IYaw,Xywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IYaw,Xyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IYwa,Xywz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,IYwa,Xyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Ia,XyYz->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Ia,XyzY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IwXa,Yzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,IwaX,Yzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IwaX,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwau,XywYzu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Iwau,XywzYu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwua,XywYuz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Iwua,XywuYz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IYuw,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IYuw,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IYwX,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IYwu,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IYwu,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IuXw,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuvw,XyuYvz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iuvw,XyuvYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IuwX,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IuwX,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuwv,XyuYzv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iuwv,XyuzYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iw,XyYz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iw,XyzY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IzXu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IzuX,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IzuX,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Izuv,XywYuv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Izuv,XywuYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxa,JiYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxa,Jiya,XY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,iIxa,Jiza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iIxa,Jiza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iIxa,iJYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,iIxa,iJya,XY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iIxa,iJza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,iJxa,Iiza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iJxa,Iiza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxa,JiYa,Xy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxa,Jiya,XY->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,iIxa,Jiza,XzYy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iIxa,Jiza,XzyY->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iIxa,iJYa,Xy->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,iIxa,iJya,XY->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iIxa,iJza,XzYy->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiXa,Yy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,iJxa,Iiza,XyYz->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iJxa,Iiza,XyzY->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIXa,Yy->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIza,XyYz->IXJY', h_aa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xa,Yxya,yx->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xa,xyYa,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XxYa,yzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxab,Yayb,xy->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxab,Ybya,xy->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxya,Yyza,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,Yzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,zwYa,xwyz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,zyYa,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Ya,Xxya,yx->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Ya,xyXa,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Ya,xyza,Xyzx->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,YxXa,yzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxab,Xayb,xy->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxab,Xbya,xy->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxab,yazb,Xxyz->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxya,Xyza,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxya,Xzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxya,zwXa,xwyz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxya,zwua,Xxwyuz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxya,zyXa,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxya,zywa,Xxzw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iX,iYxy,yx->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iX,ixyY,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXYa,iaxy,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYa,ixya,yx->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXYx,ixyz,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYx,iyzw,xzyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYx,iyzx,zy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXaY,iaxy,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXaY,ixya,yx->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXax,iaYy,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXax,iyYa,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxY,ixyz,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxY,iyzw,xzyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxY,iyzx,zy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxa,iaYy,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iyYa,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,ixYz,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,iyYz,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izYw,yxwz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izYx,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,izYy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iY,iXxy,yx->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iY,ixyX,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iY,ixyz,Xyxz->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYXa,iaxy,yx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXa,ixya,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYXx,ixyz,zy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXx,iyzw,xzyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXx,iyzx,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYaX,iaxy,yx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYaX,ixya,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYab,iaxb,Xx->IXJY', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYab,ibxa,Xx->IXJY', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iaXy,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iayx,Xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iayz,Xzxy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,ixya,Xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,iyXa,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,iyza,Xyxz->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxX,ixyz,zy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxX,iyzw,xzyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxX,iyzx,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iaXy,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iayx,Xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iayz,Xzxy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,ixya,Xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,iyXa,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iyza,Xyzx->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixXz,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixzw,Xwyz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixzy,Xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyXz,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyzw,Xwxz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyzx,Xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izXw,yxwz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izXx,yz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,izXy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuwxy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuwyx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuxwy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuxyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuywx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,iYxy,izwu,Xzuyxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izwx,Xzyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izwy,Xzwx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ia,iYxa,Xx->IXJY', np.identity(ncvs), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ia,iaYx,Xx->IXJY', np.identity(ncvs), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ia,iaxY,Xx->IXJY', np.identity(ncvs), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ia,ixYa,Xx->IXJY', np.identity(ncvs), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,iYjy,xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,jYiy,xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYa,ixja,Xx->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYa,jxia,Xx->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,iXjy,xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,ixjy,Xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,iyjz,Xxyz->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,jXiy,xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jxiy,Xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxa,iYja,Xx->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxa,jYia,Xx->IXJY', np.identity(ncvs), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjx,Xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjz,Xzxy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,ijxy,jYix,Xy->IXJY', np.identity(ncvs), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,iYjy,xy->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,jYiy,xy->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYa,ixja,Xx->IXJY', np.identity(ncvs), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYa,jxia,Xx->IXJY', np.identity(ncvs), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,iXjy,xy->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,ixjy,Xy->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,iyjz,Xxyz->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,jXiy,xy->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jxiy,Xy->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxa,iYja,Xx->IXJY', np.identity(ncvs), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxa,jYia,Xx->IXJY', np.identity(ncvs), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjx,Xy->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjz,Xzxy->IXJY', np.identity(ncvs), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,ijxy,jYix,Xy->IXJY', np.identity(ncvs), t1_xvaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iXYy,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYXy,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYyx,Xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYyz,Xzxy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,ixYy,Xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,ixyY,Xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyXY,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyYX,xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyYx,Xy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyYz,Xxzy->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyzY,Xyzx->IXJY', np.identity(ncvs), t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXa,iYya,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXa,iayY,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iYzw,yzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iYzy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,iyzY,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,izwY,ywxz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYa,iXya,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iayX,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iayz,Xyxz->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iyza,Xzyx->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYy,iXzw,yzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYy,iXzy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,iyzX,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,iyzw,Xzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,izwX,ywxz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywuxz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywuzx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywxuz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywxzu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywzux->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixYy,izwu,Xywzxu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,izwy,Xwzx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaX,iYya,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaX,iayY,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaY,iXya,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaY,iayX,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaY,iayz,Xyxz->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaY,iyza,Xzxy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixab,iaYb,Xx->IXJY', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixab,ibYa,Xx->IXJY', np.identity(ncvs), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iXYa,yx->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iYXa,xy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,iYza,Xxzy->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaXY,xy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaYX,yx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iaYy,Xx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iaYz,Xyzx->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iazY,Xxzy->IXJY', np.identity(ncvs), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,iyYa,Xx->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,izYa,Xyzx->IXJY', np.identity(ncvs), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iYzw,yzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iYzy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyX,iyzY,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,izwY,ywzx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,iXzw,yzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,iXzy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyY,iyzX,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyY,iyzw,Xzxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwX,ywzx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwu,Xywxzu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwy,Xwxz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iXYa,yx->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iYXa,xy->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iYza,Xxyz->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaXY,xy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaYX,yx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iaYy,Xx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iaYz,Xyzx->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iazY,Xxzy->IXJY', np.identity(ncvs), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iyYa,Xx->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,izYa,Xyxz->IXJY', np.identity(ncvs), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXYw,xwzy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iXYy,zx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXYz,yx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYXw,xwzy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iYXy,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYXz,xy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwu,Xxuyzw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwy,Xxwz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwz,Xxyw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwXY,xwzy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwYX,xwzy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixyz,iwYu,Xyzuwx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzuxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzwux->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzwxu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzxuw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzxwu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iwYy,Xzwx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iwYz,Xyxw->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwuyz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixyz,iwuY,Xxwuzy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwyuz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwyzu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwzuy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwzyu->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyXY,xz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyYX,zx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iyYw,Xzwx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iyYz,Xx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iywY,Xxwz->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izXY,xy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izYX,yx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izYw,Xywx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izYy,Xx->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izwY,Xxwy->IXJY', np.identity(ncvs), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iX,iYxy,yx->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iX,ixyY,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXYa,iaxy,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYa,ixya,yx->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXYx,ixyz,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYx,iyzw,xzyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXYx,iyzx,zy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXaY,iaxy,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXaY,ixya,yx->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXax,iaYy,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXax,iyYa,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxY,ixyz,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxY,iyzw,xzyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxY,iyzx,zy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxa,iaYy,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iyYa,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,ixYz,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,iyYz,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izYw,yxwz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izYx,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,izYy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iY,iXxy,yx->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iY,ixyX,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iY,ixyz,Xyxz->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYXa,iaxy,yx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXa,ixya,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYXx,ixyz,zy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXx,iyzw,xzyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYXx,iyzx,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYaX,iaxy,yx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYaX,ixya,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYab,iaxb,Xx->IXJY', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYab,ibxa,Xx->IXJY', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iaXy,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iayx,Xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYax,iayz,Xzxy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,ixya,Xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,iyXa,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYax,iyza,Xyxz->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iYxX,ixyz,zy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxX,iyzw,xzyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxX,iyzx,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iaXy,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iayx,Xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iayz,Xzxy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,ixya,Xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxa,iyXa,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxa,iyza,Xyzx->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixXz,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixzw,Xwyz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,ixzy,Xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyXz,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyzw,Xwxz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,iyzx,Xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izXw,yxwz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izXx,yz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iYxy,izXy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuwxy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuwyx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuxwy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuxyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,iYxy,izwu,Xzuywx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,iYxy,izwu,Xzuyxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izwx,Xzyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iYxy,izwy,Xzwx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ia,iYxa,Xx->IXJY', np.identity(ncvs), t1_ve, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ia,iaYx,Xx->IXJY', np.identity(ncvs), t1_ve, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ia,iaxY,Xx->IXJY', np.identity(ncvs), t1_ve, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ia,ixYa,Xx->IXJY', np.identity(ncvs), t1_ve, v_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,iYjy,xy->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,jYiy,xy->IXJY', np.identity(ncvs), t1_vxaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYa,ixja,Xx->IXJY', np.identity(ncvs), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYa,jxia,Xx->IXJY', np.identity(ncvs), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,iXjy,xy->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,ixjy,Xy->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,iyjz,Xxyz->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,jXiy,xy->IXJY', np.identity(ncvs), t1_vxaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jxiy,Xy->IXJY', np.identity(ncvs), t1_vxaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxa,iYja,Xx->IXJY', np.identity(ncvs), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxa,jYia,Xx->IXJY', np.identity(ncvs), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjx,Xy->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjz,Xzxy->IXJY', np.identity(ncvs), t1_vxaa, v_vaxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,ijxy,jYix,Xy->IXJY', np.identity(ncvs), t1_vxaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,iYjy,xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,jYiy,xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYa,ixja,Xx->IXJY', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYa,jxia,Xx->IXJY', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,iXjy,xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,ixjy,Xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,iyjz,Xxyz->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijYx,jXiy,xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijYx,jxiy,Xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxa,iYja,Xx->IXJY', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxa,jYia,Xx->IXJY', np.identity(ncvs), t1_vvae, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjx,Xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxy,iYjz,Xzxy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,ijxy,jYix,Xy->IXJY', np.identity(ncvs), t1_vvaa, v_vava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iXYy,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYXy,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYyx,Xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iYyz,Xzxy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,ixYy,Xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,ixyY,Xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyXY,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyYX,xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyYx,Xy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyYz,Xxzy->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iyzY,Xyzx->IXJY', np.identity(ncvs), t1_va, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXa,iYya,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXa,iayY,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iYzw,yzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iYzy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,iyzY,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,izwY,ywxz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYa,iXya,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iayX,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iayz,Xyxz->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYa,iyza,Xzyx->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYy,iXzw,yzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixYy,iXzy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,iyzX,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,iyzw,Xzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,izwX,ywxz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywuxz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywuzx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywxuz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywxzu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixYy,izwu,Xywzux->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixYy,izwu,Xywzxu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixYy,izwy,Xwzx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaX,iYya,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaX,iayY,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaY,iXya,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaY,iayX,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaY,iayz,Xyxz->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaY,iyza,Xzxy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixab,iaYb,Xx->IXJY', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixab,ibYa,Xx->IXJY', np.identity(ncvs), t1_vaee, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iXYa,yx->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iYXa,xy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,iYza,Xxzy->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaXY,xy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaYX,yx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iaYy,Xx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iaYz,Xyzx->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iazY,Xxzy->IXJY', np.identity(ncvs), t1_vaea, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,iyYa,Xx->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixay,izYa,Xyzx->IXJY', np.identity(ncvs), t1_vaea, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iYzw,yzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iYzy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyX,iyzY,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,izwY,ywzx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,iXzw,yzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,iXzy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyY,iyzX,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyY,iyzw,Xzxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwX,ywzx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwu,Xywxzu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyY,izwy,Xwxz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iXYa,yx->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iYXa,xy->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iYza,Xxyz->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaXY,xy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaYX,yx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iaYy,Xx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iaYz,Xyzx->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iazY,Xxzy->IXJY', np.identity(ncvs), t1_vaae, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iyYa,Xx->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,izYa,Xyxz->IXJY', np.identity(ncvs), t1_vaae, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXYw,xwzy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iXYy,zx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXYz,yx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYXw,xwzy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iYXy,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYXz,xy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwu,Xxuyzw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwy,Xxwz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iYwz,Xxyw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwXY,xwzy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwYX,xwzy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixyz,iwYu,Xyzuwx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzuxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzwux->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzwxu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzxuw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwYu,Xyzxwu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iwYy,Xzwx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iwYz,Xyxw->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwuyz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,ixyz,iwuY,Xxwuzy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwyuz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwyzu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwzuy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,ixyz,iwuY,Xxwzyu->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyXY,xz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyYX,zx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iyYw,Xzwx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iyYz,Xx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iywY,Xxwz->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izXY,xy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izYX,yx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izYw,Xywx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izYy,Xx->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,izwY,Xxwy->IXJY', np.identity(ncvs), t1_vaaa, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXYa,yzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXya,Yyza,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXya,Yzwa,xzyw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXya,zwYa,xwyz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXya,zyYa,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xYXa,yzwa,xzwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xYya,Xyza,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xYya,Xzwa,xzyw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xYya,zwXa,xwyz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xYya,zwua,Xxwuyz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xYya,zwua,Xxwuzy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xYya,zwua,Xxwyuz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xYya,zwua,Xxwyzu->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xYya,zwua,Xxwzuy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xYya,zwua,Xxwzyu->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xYya,zyXa,xz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xYya,zywa,Xxwz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xa,XYya,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xa,YXya,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,Yyza,Xzyx->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yXYa,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yYXa,xy->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yYza,Xxyz->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yzYa,Xyxz->IXJY', np.identity(ncvs), t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyXa,zYwa,xyzw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyYa,zXwa,xyzw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyYa,zwua,Xuzwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyYa,zwua,Xuzwyx->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyYa,zwua,Xuzxwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyYa,zwua,Xuzxyw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyYa,zwua,Xuzywx->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyYa,zwua,Xuzyxw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyab,Yazb,Xzxy->IXJY', np.identity(ncvs), t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,XYwa,zwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,YXwa,zwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyza,Ywua,Xzuwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,Ywua,Xzuwyx->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,Ywua,Xzuxwy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,Ywua,Xzuxyw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,Ywua,Xzuywx->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,Ywua,Xzuyxw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,Yzwa,Xwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wXYa,zwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wYXa,zwxy->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,wYua,Xyxuwz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,wYua,Xyxuzw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyza,wYua,Xyxwuz->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,wYua,Xyxwzu->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,wYua,Xyxzuw->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyza,wYua,Xyxzwu->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wuYa,Xzwyxu->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wzYa,Xwyx->IXJY', np.identity(ncvs), t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Ia,Jaxy,xy->IXJY', np.identity(ncas), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ia,Jxya,yx->IXJY', np.identity(ncas), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixa,Jyia,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixa,iyJa,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jxiz,yz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jyiz,xz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jziw,xyzw->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jzix,yz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jziy,xz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixa,Jyia,xy->IXJY', np.identity(ncas), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixa,iyJa,xy->IXJY', np.identity(ncas), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jxiz,yz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jyiz,xz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jziw,xyzw->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Iixy,Jzix,yz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Iixy,Jziy,xz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Ix,Jxyz,yz->IXJY', np.identity(ncas), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ix,Jyzx,zy->IXJY', np.identity(ncas), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Ixab,Jayb,xy->IXJY', np.identity(ncas), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixab,Jbya,xy->IXJY', np.identity(ncas), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Ixay,Jazw,xwyz->IXJY', np.identity(ncas), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Ixay,Jazy,xz->IXJY', np.identity(ncas), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixay,Jyza,xz->IXJY', np.identity(ncas), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixay,Jzwa,xzyw->IXJY', np.identity(ncas), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixya,Jazw,xwyz->IXJY', np.identity(ncas), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixya,Jazy,xz->IXJY', np.identity(ncas), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Ixya,Jyza,xz->IXJY', np.identity(ncas), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixya,Jzwa,xzwy->IXJY', np.identity(ncas), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixyz,Jwuy,xwzu->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixyz,Jwuz,xwuy->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Ixyz,Jwxu,yzwu->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Ixyz,Jywu,xuzw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Ixyz,Jywz,xw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixyz,Jzwu,xuyw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ixyz,Jzwy,xw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Ja,Iaxy,xy->IXJY', np.identity(ncas), t1_xe, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Ja,Ixya,yx->IXJY', np.identity(ncas), t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixa,Iyia,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixa,iyIa,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixy,Ixiz,yz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Iyiz,xz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Iziw,xyzw->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Izix,yz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixy,Iziy,xz->IXJY', np.identity(ncas), t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixa,Iyia,xy->IXJY', np.identity(ncas), t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixa,iyIa,xy->IXJY', np.identity(ncas), t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixy,Ixiz,yz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Iyiz,xz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Iziw,xyzw->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jixy,Izix,yz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,Jixy,Iziy,xz->IXJY', np.identity(ncas), t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Jx,Ixyz,yz->IXJY', np.identity(ncas), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jx,Iyzx,zy->IXJY', np.identity(ncas), t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Jxab,Iayb,xy->IXJY', np.identity(ncas), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxab,Ibya,xy->IXJY', np.identity(ncas), t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Jxay,Iazw,xwyz->IXJY', np.identity(ncas), t1_xaea, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Jxay,Iazy,xz->IXJY', np.identity(ncas), t1_xaea, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxay,Iyza,xz->IXJY', np.identity(ncas), t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxay,Izwa,xzyw->IXJY', np.identity(ncas), t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxya,Iazw,xwyz->IXJY', np.identity(ncas), t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxya,Iazy,xz->IXJY', np.identity(ncas), t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,Jxya,Iyza,xz->IXJY', np.identity(ncas), t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxya,Izwa,xzwy->IXJY', np.identity(ncas), t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxyz,Iwuy,xwzu->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxyz,Iwuz,xwuy->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,Jxyz,Iwxu,yzwu->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Jxyz,Iywu,xuzw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,Jxyz,Iywz,xw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxyz,Izwu,xuyw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,Jxyz,Izwy,xw->IXJY', np.identity(ncas), t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,iIxa,Jyia,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,iIxa,iyJa,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,iJxa,Iyia,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,iJxa,iyIa,xy->IXJY', np.identity(ncas), t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ix,IJiy,xy->IXJY', np.identity(ncas), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ix,JIiy,xy->IXJY', np.identity(ncas), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ix,iIJy,xy->IXJY', np.identity(ncas), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ix,iJIy,xy->IXJY', np.identity(ncas), t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixay,IJia,xy->IXJY', np.identity(ncas), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixay,JIia,yx->IXJY', np.identity(ncas), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixay,iIJa,yx->IXJY', np.identity(ncas), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixay,iJIa,xy->IXJY', np.identity(ncas), t1_xaea, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixya,IJia,xy->IXJY', np.identity(ncas), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixya,JIia,yx->IXJY', np.identity(ncas), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixya,iIJa,yx->IXJY', np.identity(ncas), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixya,iJIa,xy->IXJY', np.identity(ncas), t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,IJiw,xwzy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixyz,IJiy,xz->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,IJiz,xy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,JIiw,xwzy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixyz,JIiy,zx->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,JIiz,yx->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iIJw,xwzy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,ixyz,iIJy,zx->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iIJz,yx->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iJIw,xwzy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,ixyz,iJIy,xz->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iJIz,xy->IXJY', np.identity(ncas), t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,iIxa,Jyia,xy->IXJY', np.identity(ncas), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,iIxa,iyJa,xy->IXJY', np.identity(ncas), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,iJxa,Iyia,xy->IXJY', np.identity(ncas), t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,iJxa,iyIa,xy->IXJY', np.identity(ncas), t1_vxae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ix,IJiy,xy->IXJY', np.identity(ncas), t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ix,JIiy,xy->IXJY', np.identity(ncas), t1_va, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ix,iIJy,xy->IXJY', np.identity(ncas), t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ix,iJIy,xy->IXJY', np.identity(ncas), t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixay,IJia,xy->IXJY', np.identity(ncas), t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixay,JIia,yx->IXJY', np.identity(ncas), t1_vaea, v_xxve, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixay,iIJa,yx->IXJY', np.identity(ncas), t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixay,iJIa,xy->IXJY', np.identity(ncas), t1_vaea, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixya,IJia,xy->IXJY', np.identity(ncas), t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixya,JIia,yx->IXJY', np.identity(ncas), t1_vaae, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixya,iIJa,yx->IXJY', np.identity(ncas), t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixya,iJIa,xy->IXJY', np.identity(ncas), t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,IJiw,xwzy->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixyz,IJiy,xz->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,IJiz,xy->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,JIiw,xwzy->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,ixyz,JIiy,zx->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,ixyz,JIiz,yx->IXJY', np.identity(ncas), t1_vaaa, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iIJw,xwzy->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,ixyz,iIJy,zx->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iIJz,yx->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iJIw,xwzy->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,ixyz,iJIy,xz->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,ixyz,iJIz,xy->IXJY', np.identity(ncas), t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xa,IJya,xy->IXJY', np.identity(ncas), t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xa,IyaJ,xy->IXJY', np.identity(ncas), t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xa,JIya,xy->IXJY', np.identity(ncas), t1_ae, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xa,JyaI,xy->IXJY', np.identity(ncas), t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xyza,IJwa,zwxy->IXJY', np.identity(ncas), t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyza,IwaJ,zwxy->IXJY', np.identity(ncas), t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyza,JIwa,zwxy->IXJY', np.identity(ncas), t1_aaae, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyza,JwaI,zwxy->IXJY', np.identity(ncas), t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xx,Yxyz,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xx,Yyzx,zy->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yx,Xxyz,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yx,Xyzx,zy->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yx,xyzw,Xzyw->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xy,XYxz,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xy,XYzx,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xy,XxzY,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xy,XzxY,yz->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xy,Yxzw,Xzyw->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xy,Yzwx,Xwzy->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xy,Yzxw,Xyzw->IXJY', np.identity(ncvs), t2_aa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxa,ijya->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxa,jiya->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxz,ijyz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,jiyz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxa,ijya->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxa,jiya->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxz,ijyz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,jiyz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,ix,iy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxa,ijya->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxa,jiya->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxz,ijyz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,jiyz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxa,ijya->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxa,jiya->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, optimize = einsum_type)
        temp += 4 * einsum('IJ,XYxy,ijxz,ijyz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,jiyz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,ix,iy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijya,ijxa->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijya,jixa->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijyz,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijya,ijxa->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijya,jixa->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijyz,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,iy,ix->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijya,ijxa->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijya,jixa->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijyz,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijya,ijxa->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijya,jixa->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XxyY,ijyz,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,iy,ix->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijYy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijYy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYxz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iy,iYzx->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijYy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijYy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYxz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iy,iYzx->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijXy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijXy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXxz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iy,iXzx->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijXy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijXy,ijxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jixz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXxz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iy,iXzx->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXzx,iYwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXzx,iYwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixz,Jiyw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixz,Jiyw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iiya,Jiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiya,iJza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiyz,Jiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iiyz,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiyz,Jizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iizy,Jiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iizy,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iizy,Jizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iiya,Jiza,xz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiya,iJza,xz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiyz,Jiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iiyz,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iiyz,Jizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iizy,Jiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Iizy,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Iizy,Jizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixab,Jzab,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixab,Jzba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixaz,Ja,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixaz,Jwau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixaz,Jwaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixaz,Jwua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixaz,Jwza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixza,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixza,Jwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixza,Jwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixza,Jwua,yuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixza,Jwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixzw,Juvw,yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixzw,Juvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixzw,Juwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixzw,Juwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixzw,Juzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixzw,Juzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Ixzw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixzw,Jyuv,zwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Ixzw,Jz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Izay,Ja,xz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Izay,Jwau,xwzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izay,Jwua,xwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izwy,Juvw,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Izwy,Juwv,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Izwy,Jw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Izwy,Jzuv,xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izya,Ja,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izya,Jwau,xwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izya,Jwua,xwuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izyw,Juvw,xuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izyw,Juwv,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Izyw,Jw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Izyw,Jzuv,xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jixa,Iiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixa,iIza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixz,Iiwu,yzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jixz,Iiwy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jixz,Iiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XYxy,Jixz,Iiyw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixz,Iizw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jizx,Iiwu,yzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XYxy,Jizx,Iiwy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jizx,Iiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jizx,Iiyw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jizx,Iizw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jixa,Iiza,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixa,iIza,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixz,Iiwu,yzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jixz,Iiwy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jixz,Iiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XYxy,Jixz,Iiyw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jixz,Iizw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jizx,Iiwu,yzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XYxy,Jizx,Iiwy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jizx,Iiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jizx,Iiyw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jizx,Iizw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jx,Izwy,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XYxy,Jx,Izyw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyab,Izab,xz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyab,Izba,xz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyaz,Ia,xz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyaz,Iwau,xuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyaz,Iwaz,xw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyaz,Iwua,xuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyaz,Iwza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyza,Ia,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyza,Iwau,xuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyza,Iwaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyza,Iwua,xuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyza,Iwza,xw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyzw,Iuvw,xvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyzw,Iuvz,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyzw,Iuwv,xvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyzw,Iuwz,xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyzw,Iuzv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyzw,Iuzw,xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jyzw,Iw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jyzw,Iz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jzax,Ia,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jzax,Iwau,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XYxy,Jzax,Iway,zw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzax,Iwua,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzax,Iwya,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzwx,Iuvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzwx,Iuvy,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jzwx,Iuwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XYxy,Jzwx,Iuwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzwx,Iuyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzwx,Iuyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XYxy,Jzwx,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzwx,Iy,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jzwx,Izuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxa,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxa,Iwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzxa,Iway,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxa,Iwua,ywuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XYxy,Jzxa,Iwya,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxw,Iuvw,yuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzxw,Iuvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxw,Iuwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,Jzxw,Iuwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XYxy,Jzxw,Iuyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XYxy,Jzxw,Iuyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XYxy,Jzxw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XYxy,Jzxw,Iy,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,Jzxw,Izuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,iIya,Jiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,iIya,iJza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,iJxa,Iiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,iJxa,iIza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,iIya,Jiza,xz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,iIya,iJza,xz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XYxy,iJxa,Iiza,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XYxy,iJxa,iIza,yz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixa,Jiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixa,iJza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jiwu,yzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixz,Jiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jizw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iizx,Jiwu,yzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iizx,Jiwu,yzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iizx,Jiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iizx,Jizw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixa,Jiza,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixa,iJza,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jiwu,yzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixz,Jiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jizw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iizx,Jiwu,yzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iizx,Jiwu,yzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iizx,Jiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iizx,Jizw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyab,Jzab,xz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyab,Jzba,xz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyaz,Ja,xz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyaz,Jwau,xuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyaz,Jwaz,xw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyaz,Jwua,xuwz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iyaz,Jwua,xuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyaz,Jwza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Ja,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Jwau,xuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Jwaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iyza,Jwua,xuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyza,Jwua,xuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyza,Jwza,xw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iyzw,Juvw,xvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyzw,Juvw,xvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyzw,Juvz,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Iyzw,Juvz,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Juwv,xvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Juwz,xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyzw,Juzv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyzw,Juzw,xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Jw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iyzw,Jxuv,zwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Iyzw,Jxuv,zwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Iyzw,Jz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izax,Ja,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izax,Jwau,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Izax,Jwua,ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Izax,Jwua,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Izwx,Juvw,yuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Izwx,Juvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izwx,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izwx,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Izwx,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Izwx,Jzuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Jwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Jwua,ywuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Juvw,yuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izxw,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiya,Iiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiya,iIza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jiyz,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiyz,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jizy,Iiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jizy,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jizy,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jizy,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jizy,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jizy,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiya,Iiza,xz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiya,iIza,xz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jiyz,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiyz,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jizy,Iiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jizy,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jizy,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jizy,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jizy,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jizy,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxab,Izab,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxab,Izba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxaz,Ia,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxaz,Iwau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxaz,Iwaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxaz,Iwua,yuwz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jxaz,Iwua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxaz,Iwza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Iwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Iwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jxza,Iwua,yuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxza,Iwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxza,Iwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jxzw,Iuvw,yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxzw,Iuvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxzw,Iuvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jxzw,Iuvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iuwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iuwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxzw,Iuzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxzw,Iuzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jxzw,Iz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jy,Izwx,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jy,Izxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzay,Ia,xz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzay,Iwau,xwzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jzay,Iwax,zw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jzay,Iwua,xwuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jzay,Iwua,xwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzay,Iwxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jzwy,Iuvw,xuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jzwy,Iuvw,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jzwy,Iuvx,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Jzwy,Iuvx,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzwy,Iuwv,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jzwy,Iuwx,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Iuxv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Iuxw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzwy,Iw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jzwy,Izuv,xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jzwy,Izuv,xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Ia,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Iwau,xwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzya,Iwax,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Iwua,xwuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XxyY,Jzya,Iwxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iuvw,xuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzyw,Iuvx,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iuwv,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzyw,Iuwx,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Iuxv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Iuxw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzyw,Izuv,xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iIxa,Jiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,iIxa,iJza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iJya,Iiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,iJya,iIza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iIxa,Jiza,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,iIxa,iJza,yz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iJya,Iiza,xz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,iJya,iIza,xz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYax,Ja,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYax,Jwau,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYax,Jwua,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYax,Jzaw,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYax,Jzwa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYaz,Ja,yx->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYaz,Jwau,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYaz,Jwua,ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IYaz,Jwua,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYwx,Juvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYwx,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYwx,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYwx,Jzuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYwx,Jzuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYwx,Jzwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYwz,Juvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IYwz,Juvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYwz,Juwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYwz,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxa,Jwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYxa,Jwua,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYxa,Jzaw,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYxa,Jzwa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYxw,Juvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Jzuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYxw,Jzuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYxw,Jzwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYza,Ja,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYza,Jwau,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IYza,Jwua,ywux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYza,Jwua,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IYzw,Juvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYzw,Juvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYzw,Juwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYzw,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,JiYu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiwx,JiYw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwx,JiuY,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iiwx,JiwY,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwx,Jiwu,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYu,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,JiuY,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,JiuY,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwz,JiwY,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwz,Jiwu,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixa,JiYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,Jiwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,iJYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixa,iJwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiYu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixw,JiYw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,JiuY,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iixw,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiwY,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,Jiwu,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixz,JiYw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,JiwY,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,Jiwu,Yywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiza,JiYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iiza,Jiwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiza,iJYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiza,iJwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiza,iJwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiYu,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iizw,JiYw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,JiuY,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,JiuY,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuxv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywxuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiwY,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizx,JiYw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iizx,JiwY,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizx,Jiwu,Yyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizx,Jiwu,Yywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,JiYu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiwx,JiYw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwx,JiuY,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iiwx,JiwY,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwx,Jiwu,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYu,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,JiuY,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,JiuY,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwz,JiwY,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iiwz,Jiwu,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixa,JiYa,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,Jiwa,Yywz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,iJYa,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixa,iJwa,Yywz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiYu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixw,JiYw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,JiuY,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iixw,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiwY,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,Jiwu,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixz,JiYw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,JiwY,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,Jiwu,Yywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiza,JiYa,yx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iiza,Jiwa,Yywx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiza,iJYa,yx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiza,iJwa,Yywx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiza,iJwa,Yyxw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiYu,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iizw,JiYw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,JiuY,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,JiuY,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuxv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywxuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiwY,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizx,JiYw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iizx,JiwY,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizx,Jiwu,Yyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizx,Jiwu,Yywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwax,Ja,Yywz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwax,JuYa,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwax,JuaY,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juav,Yyuvwz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juav,Yyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juav,Yyuwvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwax,Juav,Yyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juav,Yyuzvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juav,Yyuzwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwax,Juva,Yyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Juva,Yyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwax,JzYa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwax,JzaY,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwax,Jzau,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Jzua,Yyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwax,Jzua,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwaz,Ja,Yyxw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwaz,JuYa,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwaz,JuaY,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwaz,Juav,Yyuxwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuvwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuxwv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,Ju,Yywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwux,JvYu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jvsu,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvsu,Yyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,JvuY,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvus,Yyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvus,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvus,Yyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwux,Jvus,Yyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvus,Yyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jvus,Yyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,JwYv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwux,JwvY,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,JzYu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwux,JzYv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwux,JzuY,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwux,Jzuv,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwux,JzvY,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwux,JzvY,yuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwux,Jzvs,Yyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwux,Jzvs,Yyuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jzvu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jzvu,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwuz,Ju,Yyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwuz,JvYu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwuz,JvuY,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwuz,Jvus,Yyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwuz,JwYv,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,JwvY,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwuz,JwvY,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jwvs,Yyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwuz,Jwvs,Yyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,Ja,Yywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxa,JuYa,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,JuaY,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuvwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuwvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwxa,Juav,Yyuwzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuzvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuzwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,Juva,Yyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxa,JzYa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,JzaY,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,Jzau,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,Jzua,Yyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,Ju,Yywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,JvYu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,Jvsu,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,JvuY,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwxu,Jvus,Yyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxu,JwYv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,JwvY,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwxu,Jwvs,Yyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxu,JzYu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Iwxu,JzYv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,JzuY,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,Jzuv,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,JzvY,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,Jzvs,Yyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,Jzvu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxz,JwYu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxz,JwuY,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxz,Jwuv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Ja,Yywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Ja,Yyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwza,JuYa,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,JuaY,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,JuaY,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Juav,Yyuwxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juav,Yyuxwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Juva,Yyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juva,Yyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Ju,Yywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Ju,Yyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwzu,JvYu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jvsu,Yyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvsu,Yyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,JvuY,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,JvuY,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwzu,JwYv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,JwvY,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,JwvY,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyuxvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwzx,JwYu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwzx,JwuY,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzx,Jwuv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzx,Jwuv,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Ix,JzYw,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Ix,JzwY,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Ix,Jzwu,Yywu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyab,Jwab,Ywxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyab,Jwba,Ywxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyab,Jwba,Ywzx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyaw,Ja,Ywxz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iyaw,JuYa,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyaw,JuaY,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyaw,Juav,Ywuxzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyaw,Juaw,Yuxz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuvzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuxzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juwa,Yuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyaw,Juwa,Yuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Ja,Ywxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Ja,Ywzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywa,JuYa,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,JuaY,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,JuaY,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juav,Ywuxzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juav,Ywuzxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juaw,Yuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juaw,Yuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juva,Ywuvxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juva,Ywuxvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iywa,Juwa,Yuxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Ju,Ywxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Ju,Ywzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywu,JvYu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywu,JvYw,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvsu,Ywvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsu,Ywvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,JvuY,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,JvuY,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvuw,Yvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvuw,Yvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iywu,JvwY,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iywu,Jvws,Yuvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iywu,Jvwu,Yvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iywu,Jw,Yuxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iywu,JxYv,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iywu,JxvY,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jxvs,Ywusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,Jxvs,Ywuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iywu,JzYv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,JzvY,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,JzvY,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywuxvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JiYy,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwy,Iiwu,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwy,Iiwx,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jiwy,Iiwz,Yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixu,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiwy,Iixz,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwy,Iizw,Yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iizx,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,JiyY,Iiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JiyY,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JiyY,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JiyY,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiya,Iixa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jiya,Iiza,Yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiya,iIwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiya,iIwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiya,iIxa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiya,iIza,Yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvxzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iiwx,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iiwz,Yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixu,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiyw,Iixw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixz,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iizu,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jiyw,Iizw,Yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iizx,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JiYy,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwy,Iiwu,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwy,Iiwx,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jiwy,Iiwz,Yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixu,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiwy,Iixz,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwy,Iizw,Yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iizx,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,JiyY,Iiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JiyY,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JiyY,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JiyY,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiya,Iixa,Yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jiya,Iiza,Yx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiya,iIwa,Ywxz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiya,iIwa,Ywzx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiya,iIxa,Yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiya,iIza,Yx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvxzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iiwx,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iiwz,Yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixu,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiyw,Iixw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixz,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iizu,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jiyw,Iizw,Yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiyw,Iizx,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Iuxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Iuxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JwYy,Iwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jway,IYau,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jway,IYax,zw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jway,IYaz,xw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jway,IYua,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jway,IYxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jway,IYza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jway,Ia,Ywxz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jway,Iuav,Ywvxzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jway,Iuax,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jway,Iuaz,Ywxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jway,Iuva,Ywvuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jway,Iuva,Ywvxzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jway,Iuxa,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jway,Iuza,Ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jway,Iuza,Ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuy,IYuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jwuy,IYux,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwuy,IYuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwuy,IYvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwuy,IYvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,IYvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,IYvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jwuy,IYxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,IYzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,IYzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwuy,IYzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuy,Iu,Ywxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivsz,Ywsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsz,Ywsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuy,Ivus,Ywsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwuy,Ivux,Ywvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwuy,Ivuz,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jwuy,Ivxs,Ywsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ivxu,Ywvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ivxz,Ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzu,Ywvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzu,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzx,Ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzx,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Iwvs,Yvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwuy,Iwvs,Yvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ix,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Iz,Ywux->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Iz,Ywxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JwyY,Iuvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,JwyY,Iuvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,JwyY,Iuvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JwyY,Iuvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Iuxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Iuxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JwyY,Iuzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JwyY,Iuzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JwyY,Iwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,JwyY,Iwuv,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JwyY,Iz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,IYau,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,IYau,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwya,IYax,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,IYaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,IYua,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,IYua,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,IYxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwya,IYza,xw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Ia,Ywxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Ia,Ywzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvxzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvzxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwya,Iuax,Ywuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Iuax,Ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Iuaz,Ywux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwya,Iuaz,Ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuva,Ywvxuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Iuva,Ywvzux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,Iuxa,Ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwya,Iuza,Ywxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,IYuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,IYuv,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,IYux,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,IYvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,IYvu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,IYvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYxv,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jwyu,IYxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,IYzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,IYzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jwyu,IYzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Iu,Ywxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iu,Ywzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivsu,Ywsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Ivsu,Ywszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsx,Ywsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivsx,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivux,Ywvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivux,Ywzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivuz,Ywvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivuz,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxs,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxu,Ywzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxz,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,Ivzs,Ywsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,Ivzu,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,Ivzx,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvsxzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvszxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ix,Ywzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwyu,Iz,Ywxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Iwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Iwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYa,Iwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYa,Iwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYw,Iuvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iuvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iuwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iuwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iuzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYw,Iuzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxaY,Ia,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxaY,Iwau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxaY,Iwaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JxaY,Iwua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JxaY,Iwza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jxab,IYab,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxab,IYba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxab,Iwab,Yywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxab,Iwba,Yywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxaw,IYau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jxaw,IYaw,yz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxaw,IYaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,IYua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxaw,IYwa,yz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,IYza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxaw,Ia,Yywz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuav,Yyvuwz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuav,Yyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuav,Yyvwuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxaw,Iuav,Yyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuav,Yyvzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuav,Yyvzwu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxaw,Iuaw,Yyuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxaw,Iuaz,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxaw,Iuva,Yyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuva,Yyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,Iuwa,Yyuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxaw,Iuza,Yyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxaw,Iuza,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JxwY,Iuvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxwY,Iuvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxwY,Iuwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxwY,Iuwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxwY,Iuzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JxwY,Iuzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxwY,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxwY,Iz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,IYau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxwa,IYaw,yz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,IYaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwa,IYua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jxwa,IYwa,yz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwa,IYza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Ia,Yywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwa,Iuav,Yyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Iuaw,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Iuaz,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwa,Iuwa,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuza,Yyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuza,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYuv,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxwu,IYuw,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYuz,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,IYvu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,IYvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,IYvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jxwu,IYwu,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,IYwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,IYwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,IYzu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,IYzv,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,IYzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Iu,Yywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsw,Yysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivsw,Yysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yysuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yyswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivus,Yyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Ivuw,Yyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Ivuz,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivws,Yysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivws,Yysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivws,Yysvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivws,Yysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivws,Yyszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivws,Yyszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,Ivwu,Yyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,Ivwz,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivzs,Yysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivzs,Yyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivzu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivzu,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivzw,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivzw,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jxwu,Iw,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Iz,Yyuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Iz,Yywu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jy,IYwx,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,IYwz,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,IYxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jy,IYzw,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jy,Iwux,Yuwz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jy,Iwux,Yuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jy,Iwuz,Yuwx->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jy,Iwuz,Yuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Iwxu,Yuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Iwxz,Yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jy,Iwzu,Yuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jy,Iwzx,Yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Ix,Yz->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jy,Iz,Yx->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Ia,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Iwau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Iwua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iuvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iuwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JzaY,Ia,yx->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JzaY,Iwau,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JzaY,Iwua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,JzaY,Iwua,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzab,IYab,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzab,IYba,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzab,Iwab,Yyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzab,Iwba,Yywx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzab,Iwba,Yyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzaw,IYau,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzaw,IYaw,yx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzaw,IYua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzaw,IYwa,yx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzaw,Ia,Yyxw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzaw,Iuav,Yyvxwu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzaw,Iuaw,Yyxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvxwu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzaw,Iuwa,Yyux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuwa,Yyxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JzwY,Iuvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,JzwY,Iuvw,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JzwY,Iuwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,JzwY,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,IYau,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,IYau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwa,IYaw,yx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,IYua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,IYua,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwa,IYwa,yx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Ia,Yywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Ia,Yyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvxwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuaw,Yyux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuaw,Yyxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuva,Yyvwux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuva,Yyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwa,Iuwa,Yyxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,IYuv,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,IYuv,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwu,IYuw,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,IYvu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,IYvu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwu,IYvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwu,IYwu,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwu,IYwv,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Iu,Yywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Iu,Yyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivsu,Yyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsu,Yysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivus,Yyswxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivus,Yysxwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivuw,Yyvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivuw,Yyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwu,Ivws,Yysxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwu,Ivwu,Yyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jzwu,Iw,Yyxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iIxa,JiYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIxa,Jiwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIxa,iJYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIxa,iJwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIza,JiYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iIza,Jiwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,iIza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIza,iJYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIza,iJwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,iJya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iJya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJya,Iixa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJya,Iiza,Yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iJya,iIwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJya,iIxa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,iJya,iIza,Yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iIxa,JiYa,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIxa,Jiwa,Yywz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIxa,iJYa,yz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIxa,iJwa,Yywz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIza,JiYa,yx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iIza,Jiwa,Yywx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,iIza,Jiwa,Yyxw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIza,iJYa,yx->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iIza,iJwa,Yyxw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,iJya,Iiwa,Ywxz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iJya,Iiwa,Ywzx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJya,Iixa,Yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJya,Iiza,Yx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iJya,iIwa,Ywxz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJya,iIxa,Yz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,iJya,iIza,Yx->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IiXy,Jiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iiwy,Jiwu,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiwy,Jiwx,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,Iiwy,Jiwz,Xx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixu,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixw,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiwy,Jixz,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiwy,Jizw,Xx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jizx,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,IiyX,Jiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IiyX,Jiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IiyX,Jiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IiyX,Jizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiya,Jixa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,Iiya,Jiza,Xx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiya,iJwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiya,iJwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiya,iJxa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiya,iJza,Xx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvxzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jiwx,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jiwz,Xx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixu,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiyw,Jixw,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixz,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jizu,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iiyw,Jizw,Xx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jizx,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IiXy,Jiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iiwy,Jiwu,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiwy,Jiwx,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,Iiwy,Jiwz,Xx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixu,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixw,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiwy,Jixz,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiwy,Jizw,Xx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jizx,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,IiyX,Jiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IiyX,Jiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IiyX,Jiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IiyX,Jizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiya,Jixa,Xz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,Iiya,Jiza,Xx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiya,iJwa,Xwxz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiya,iJwa,Xwzx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiya,iJxa,Xz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiya,iJza,Xx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvxzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jiwx,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jiwz,Xx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixu,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiyw,Jixw,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixz,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jizu,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iiyw,Jizw,Xx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iiyw,Jizx,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Juxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Juxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IwXy,Jwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Jx,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Jz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iway,JXau,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iway,JXax,zw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iway,JXaz,xw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iway,JXua,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iway,JXxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iway,JXza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iway,Ja,Xwxz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iway,Juav,Xwvxzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iway,Juax,Xwuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iway,Juaz,Xwxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iway,Juva,Xwvuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iway,Juva,Xwvxzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iway,Juxa,Xwuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iway,Juza,Xwux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iway,Juza,Xwxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iwuy,JXuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iwuy,JXux,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwuy,JXuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iwuy,JXvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwuy,JXvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,JXvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,JXvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iwuy,JXxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,JXzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,JXzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwuy,JXzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iwuy,Ju,Xwxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvsz,Xwsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsz,Xwsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Iwuy,Jvus,Xwsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwuy,Jvux,Xwvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwuy,Jvuz,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iwuy,Jvxs,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jvxu,Xwvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jvxz,Xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzu,Xwvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzu,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzx,Xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzx,Xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jwvs,Xvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwuy,Jwvs,Xvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jx,Xwuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jz,Xwux->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jz,Xwxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IwyX,Juvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,IwyX,Juvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,IwyX,Juvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IwyX,Juvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Juxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Juxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IwyX,Juzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IwyX,Juzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IwyX,Jwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,IwyX,Jwuv,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Jx,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IwyX,Jz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,JXau,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,JXau,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwya,JXax,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,JXaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,JXua,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,JXua,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,JXxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwya,JXza,xw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Ja,Xwxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Ja,Xwzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juav,Xwvxzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Juav,Xwvzxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwya,Juax,Xwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Juax,Xwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Juaz,Xwux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwya,Juaz,Xwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juva,Xwvxuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Juva,Xwvzux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,Juxa,Xwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwya,Juza,Xwxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,JXuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,JXuv,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,JXux,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,JXvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,JXvu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,JXvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXxv,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iwyu,JXxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,JXzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,JXzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iwyu,JXzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Ju,Xwxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Ju,Xwzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvsu,Xwsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jvsu,Xwszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsx,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvsx,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwsxzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvux,Xwvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvux,Xwzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvuz,Xwvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvuz,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxu,Xwzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxz,Xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,Jvzs,Xwsxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,Jvzu,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,Jvzx,Xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvsxzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvszxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jx,Xwzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iwyu,Jz,Xwxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Jwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Jwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXa,Jwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXa,Jwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXw,Juvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Juvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Juwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Juwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Juzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXw,Juzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Jz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxaX,Ja,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxaX,Jwau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxaX,Jwaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IxaX,Jwua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IxaX,Jwza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Ixab,JXab,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixab,JXba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixab,Jwab,Xywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixab,Jwba,Xywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixaw,JXau,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Ixaw,JXaw,yz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixaw,JXaz,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,JXua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixaw,JXwa,yz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,JXza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixaw,Ja,Xywz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juav,Xyvuwz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juav,Xyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juav,Xyvwuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixaw,Juav,Xyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juav,Xyvzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juav,Xyvzwu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixaw,Juaw,Xyuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixaw,Juaz,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixaw,Juva,Xyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juva,Xyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,Juwa,Xyuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixaw,Juza,Xyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixaw,Juza,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IxwX,Juvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxwX,Juvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxwX,Juwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxwX,Juwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxwX,Juzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IxwX,Juzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxwX,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxwX,Jz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,JXau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixwa,JXaw,yz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,JXaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwa,JXua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Ixwa,JXwa,yz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwa,JXza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Ja,Xywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwa,Juav,Xyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Juaw,Xyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Juaz,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwa,Juwa,Xyuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juza,Xyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juza,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXuv,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixwu,JXuw,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXuz,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,JXvu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,JXvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,JXvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Ixwu,JXwu,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,JXwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,JXwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,JXzu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,JXzv,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,JXzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Ju,Xywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsw,Xysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvsw,Xysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xysuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xyswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvus,Xyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Jvuw,Xyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Jvuz,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvws,Xysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvws,Xysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvws,Xysvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvws,Xysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvws,Xyszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvws,Xyszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,Jvwu,Xyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,Jvwz,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvzs,Xysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvzs,Xyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvzu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvzu,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvzw,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvzw,Xyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Ixwu,Jw,Xyuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jz,Xyuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jz,Xywu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iy,JXwx,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,JXwz,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,JXxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iy,JXzw,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iy,Jwux,Xuwz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iy,Jwux,Xuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iy,Jwuz,Xuwx->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iy,Jwuz,Xuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jwxu,Xuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jwxz,Xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iy,Jwzu,Xuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iy,Jwzx,Xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jx,Xz->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iy,Jz,Xx->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Ja,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Jwau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Jwua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Juvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Juwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IzaX,Ja,yx->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IzaX,Jwau,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IzaX,Jwua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,IzaX,Jwua,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izab,JXab,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izab,JXba,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izab,Jwab,Xyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izab,Jwba,Xywx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izab,Jwba,Xyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izaw,JXau,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izaw,JXaw,yx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izaw,JXua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izaw,JXwa,yx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izaw,Ja,Xyxw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izaw,Juav,Xyvxwu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izaw,Juaw,Xyxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izaw,Juva,Xyvuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juva,Xyvxwu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izaw,Juwa,Xyux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juwa,Xyxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IzwX,Juvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,IzwX,Juvw,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IzwX,Juwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,IzwX,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,JXau,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,JXau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwa,JXaw,yx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,JXua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,JXua,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwa,JXwa,yx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Ja,Xywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Ja,Xyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juav,Xyvwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juav,Xyvxwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juaw,Xyux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juaw,Xyxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juva,Xyvwux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juva,Xyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwa,Juwa,Xyxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,JXuv,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,JXuv,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwu,JXuw,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,JXvu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,JXvu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwu,JXvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwu,JXwu,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwu,JXwv,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Ju,Xywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Ju,Xyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvsu,Xyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsu,Xysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvus,Xyswxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvus,Xysxwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvuw,Xyvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvuw,Xyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwu,Jvws,Xysxuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwu,Jvwu,Xyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Izwu,Jw,Xyxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXax,Ia,yz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXax,Iwau,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXax,Iwua,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXax,Izaw,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXax,Izwa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXaz,Ia,yx->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXaz,Iwau,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXaz,Iwua,ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,JXaz,Iwua,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXwx,Iuvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXwx,Iuwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXwx,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXwx,Izuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXwx,Izuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXwx,Izwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXwz,Iuvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,JXwz,Iuvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXwz,Iuwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXwz,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxa,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxa,Iwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXxa,Iwua,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXxa,Izaw,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXxa,Izwa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXxw,Iuvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Iuwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Izuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXxw,Izuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXxw,Izwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXza,Ia,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXza,Iwau,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,JXza,Iwua,ywux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXza,Iwua,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,JXzw,Iuvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXzw,Iuvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXzw,Iuwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXzw,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,IiXu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiwx,IiXw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwx,IiuX,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,Iiuw,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jiwx,IiwX,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwx,Iiwu,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXu,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,IiuX,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,IiuX,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwz,IiwX,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwz,Iiwu,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixa,IiXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,Iiwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,iIXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixa,iIwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiXu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixw,IiXw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,IiuX,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jixw,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,Iiuw,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiwX,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,Iiwu,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixz,IiXw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,IiwX,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,Iiwu,Xywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiza,IiXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jiza,Iiwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiza,iIXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiza,iIwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiza,iIwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiXu,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jizw,IiXw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,IiuX,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,IiuX,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuxv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywxuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiwX,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizx,IiXw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jizx,IiwX,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizx,Iiwu,Xyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizx,Iiwu,Xywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,IiXu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiwx,IiXw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwx,IiuX,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,Iiuw,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jiwx,IiwX,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwx,Iiwu,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXu,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,IiuX,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,IiuX,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwz,IiwX,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jiwz,Iiwu,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixa,IiXa,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,Iiwa,Xywz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,iIXa,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixa,iIwa,Xywz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiXu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixw,IiXw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,IiuX,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jixw,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,Iiuw,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiwX,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,Iiwu,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixz,IiXw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,IiwX,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,Iiwu,Xywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiza,IiXa,yx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jiza,Iiwa,Xywx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiza,iIXa,yx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiza,iIwa,Xywx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiza,iIwa,Xyxw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiXu,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jizw,IiXw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,IiuX,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,IiuX,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuxv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywxuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiwX,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizx,IiXw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jizx,IiwX,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizx,Iiwu,Xyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizx,Iiwu,Xywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwax,Ia,Xywz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwax,IuXa,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwax,IuaX,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuav,Xyuvwz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuav,Xyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuav,Xyuwvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwax,Iuav,Xyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuav,Xyuzvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuav,Xyuzwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwax,Iuva,Xyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Iuva,Xyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwax,IzXa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwax,IzaX,yw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwax,Izau,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Izua,Xyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwax,Izua,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwaz,Ia,Xyxw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwaz,IuXa,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwaz,IuaX,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwaz,Iuav,Xyuxwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuvwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuxwv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,Iu,Xywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwux,IvXu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Ivsu,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivsu,Xyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,IvuX,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivus,Xyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivus,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivus,Xyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwux,Ivus,Xyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivus,Xyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Ivus,Xyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,IwXv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwux,IwvX,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,IzXu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwux,IzXv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwux,IzuX,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwux,Izuv,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwux,IzvX,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwux,IzvX,yuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwux,Izvs,Xyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwux,Izvs,Xyuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Izvu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Izvu,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwuz,Iu,Xyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwuz,IvXu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwuz,IvuX,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwuz,Ivus,Xyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwuz,IwXv,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,IwvX,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwuz,IwvX,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Iwvs,Xyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwuz,Iwvs,Xyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,Ia,Xywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxa,IuXa,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,IuaX,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuvwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuwvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwxa,Iuav,Xyuwzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuzvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuzwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,Iuva,Xyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxa,IzXa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,IzaX,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,Izau,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,Izua,Xyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,Iu,Xywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,IvXu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,Ivsu,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,IvuX,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwxu,Ivus,Xyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxu,IwXv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,IwvX,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwxu,Iwvs,Xyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxu,IzXu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Jwxu,IzXv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,IzuX,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,Izuv,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,IzvX,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,Izvs,Xyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,Izvu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxz,IwXu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxz,IwuX,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxz,Iwuv,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Ia,Xywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Ia,Xyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwza,IuXa,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,IuaX,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,IuaX,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuwxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuxwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Iuva,Xyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuva,Xyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iu,Xywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Iu,Xyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwzu,IvXu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Ivsu,Xyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivsu,Xyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,IvuX,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,IvuX,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvxws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwzu,IwXv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,IwvX,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,IwvX,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyuxvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwzx,IwXu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwzx,IwuX,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzx,Iwuv,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzx,Iwuv,Xyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Jx,IzXw,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jx,IzwX,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jx,Izwu,Xywu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jyab,Iwab,Xwxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyab,Iwba,Xwxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyab,Iwba,Xwzx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jyaw,Ia,Xwxz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jyaw,IuXa,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jyaw,IuaX,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jyaw,Iuav,Xwuxzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jyaw,Iuaw,Xuxz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuvzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuxzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuwa,Xuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyaw,Iuwa,Xuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Ia,Xwxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Ia,Xwzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywa,IuXa,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,IuaX,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,IuaX,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuxzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuzxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuaw,Xuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuaw,Xuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuva,Xwuvxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuva,Xwuxvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jywa,Iuwa,Xuxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Iu,Xwxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Iu,Xwzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywu,IvXu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywu,IvXw,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivsu,Xwvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsu,Xwvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,IvuX,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,IvuX,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivuw,Xvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivuw,Xvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jywu,IvwX,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jywu,Ivws,Xuvxzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jywu,Ivwu,Xvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jywu,Iw,Xuxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jywu,IxXv,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jywu,IxvX,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Ixvs,Xwusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,Ixvs,Xwuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jywu,IzXv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,IzvX,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,IzvX,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,Izvs,Xwuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Izvs,Xwuxvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,iIya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iIya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iIya,Jixa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iIya,Jiza,Xx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iIya,iJwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iIya,iJxa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,iIya,iJza,Xx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iJxa,IiXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJxa,Iiwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iJxa,iIXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJxa,iIwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJza,IiXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iJza,Iiwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,iJza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJza,iIXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJza,iIwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,iIya,Jiwa,Xwxz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iIya,Jiwa,Xwzx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iIya,Jixa,Xz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iIya,Jiza,Xx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iIya,iJwa,Xwxz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iIya,iJxa,Xz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Yxyz,iIya,iJza,Xx->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iJxa,IiXa,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJxa,Iiwa,Xywz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iJxa,iIXa,yz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJxa,iIwa,Xywz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJza,IiXa,yx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iJza,Iiwa,Xywx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,iJza,Iiwa,Xyxw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJza,iIXa,yx->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,iJza,iIwa,Xyxw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Juyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Juyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Jw,zy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Jy,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYXx,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYax,JXau,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYax,JXaw,zy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYax,JXay,zw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYax,JXua,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYax,JXwa,zy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYax,JXya,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYax,Ja,Xzyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYax,Juav,Xzvywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYax,Juaw,Xzyu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYax,Juay,Xzuw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYax,Juva,Xzvuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Juva,Xzvywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYax,Juwa,Xzuy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYax,Juwa,Xzyu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYax,Juya,Xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYax,Jzau,Xuyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Jzua,Xuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYax,Jzua,Xuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYux,JXuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYux,JXuw,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYux,JXuy,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYux,JXvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,JXvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,JXvw,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYux,JXvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXwu,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,JXwv,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,JXwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYux,JXwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYux,JXyu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYux,Ju,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYux,Jvsu,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jvsu,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvsw,Xzsuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsw,Xzsyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvsy,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsy,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYux,Jvus,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYux,Jvuw,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYux,Jvuy,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvws,Xzsuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvws,Xzsyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvwu,Xzvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvwu,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvwy,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvwy,Xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IYux,Jvys,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jvyu,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jvyw,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jw,Xzuy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jw,Xzyu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jy,Xzuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYux,Jzuv,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jzvs,Xvsuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jzvs,Xvsyuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jzvu,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYux,Jzvu,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxX,Juvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxX,Juvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxX,Juwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxX,Juwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYxX,Juyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IYxX,Juyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxX,Jw,zy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYxX,Jy,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxX,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,JXau,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,JXaw,zy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYxa,JXay,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxa,JXua,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxa,JXwa,zy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYxa,JXya,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,Ja,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,Juav,Xzvywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,Juaw,Xzyu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,Juay,Xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxa,Juva,Xzvuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxa,Juva,Xzvywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxa,Juwa,Xzuy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxa,Juwa,Xzyu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxa,Juya,Xzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxa,Jzau,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxa,Jzua,Xuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxa,Jzua,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,JXuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXuw,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYxu,JXuy,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxu,JXvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,JXvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,JXvw,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,JXwu,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,JXwv,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,JXwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IYxu,JXyu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,JXyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,JXyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,Ju,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxu,Jvsu,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxu,Jvsu,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsy,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvsy,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,Jvus,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,Jvuw,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,Jvuy,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvws,Xzsuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvws,Xzsyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvwu,Xzvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvwu,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvwy,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvwy,Xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvys,Xzsuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jvys,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvys,Xzsvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvys,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvys,Xzswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvys,Xzswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,Jvyu,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,Jvyw,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jw,Xzuy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jw,Xzyu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxu,Jy,Xzuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxu,Jzuv,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jzvs,Xvsuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jzvs,Xvsyuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxu,Jzvu,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxu,Jzvu,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxz,JXuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,JXuy,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,JXwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxz,JXyu,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxz,Juvw,Xvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxz,Juvw,Xvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxz,Juvy,Xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxz,Juvy,Xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Juwv,Xvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Juwy,Xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxz,Juyv,Xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxz,Juyw,Xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Jw,Xy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYxz,Jy,Xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IiXx,JiYu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiYw,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,IiXx,JiYy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,JiuY,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiuy,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,JiwY,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiwu,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiwy,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiyY,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyu,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iiux,JiYu,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiYv,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiYw,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iiux,JiYy,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iiux,JiuY,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvwYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvwyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvyYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iiux,Jiuw,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iiux,Jiuy,XzYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JivY,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iiux,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iiux,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Iiux,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iiux,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/240 * einsum('xyzw,Iiux,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iiux,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iiux,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iiux,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iiux,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iiux,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iiux,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iiux,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iiux,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jivu,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,Jivu,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivw,XzvuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jivy,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,JiwY,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiwY,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiwu,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwu,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwy,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jiwy,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiyY,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iiux,Jiyu,XzYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyw,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyw,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixX,JiYu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,JiYw,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixX,JiYy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixX,JiuY,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixX,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IixX,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixX,Jiuw,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiuy,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,JiwY,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixX,Jiwu,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiwu,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiwy,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixX,JiyY,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,Jiyu,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,Jiyw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,JiYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,Jiua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixa,Jiwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixa,Jiya,XzYw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixa,iJYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixa,iJua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixa,iJua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,iJwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,iJya,XzYw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiYu,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiYv,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYw,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYy,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiuY,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixu,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,Jiuv,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiuw,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuw,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiuy,XzYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixu,JivY,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,JivY,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iixu,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iixu,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iixu,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iixu,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iixu,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iixu,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iixu,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iixu,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iixu,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iixu,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iixu,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iixu,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Iixu,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iixu,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iixu,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iixu,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Iixu,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivu,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivu,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivw,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivw,XzvyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivy,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,JiwY,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JiwY,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiwu,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jiwu,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwy,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwy,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiyY,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixu,Jiyu,XzYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiyv,XzvYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiyw,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixz,JiYu,Xuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iixz,JiYw,Xy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiYy,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixz,JiuY,Xuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixz,JiuY,Xuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iixz,Jiuv,XuvYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iixz,Jiuv,XuvyYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiuw,XuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixz,Jiuw,XuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixz,Jiuy,XuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiuy,XuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiwY,Xy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixz,Jiwu,XuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiwu,XuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,Jiwy,XY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,JiyY,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,Jiyu,XuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixz,Jiyw,XY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IiXx,JiYu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiYw,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,IiXx,JiYy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,JiuY,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiuy,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,JiwY,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiwu,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiwy,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiyY,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyu,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iiux,JiYu,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiYv,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiYw,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iiux,JiYy,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iiux,JiuY,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvwYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvwyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvyYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jiuv,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iiux,Jiuw,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iiux,Jiuy,XzYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JivY,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iiux,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iiux,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Iiux,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iiux,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/240 * einsum('xyzw,Iiux,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iiux,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iiux,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iiux,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iiux,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iiux,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iiux,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iiux,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iiux,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,Jivu,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,Jivu,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivw,XzvuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jivy,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,JiwY,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiwY,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiwu,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwu,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwy,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jiwy,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiyY,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iiux,Jiyu,XzYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyw,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyw,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixX,JiYu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,JiYw,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixX,JiYy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixX,JiuY,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixX,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IixX,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixX,Jiuw,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiuy,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,JiwY,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixX,Jiwu,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiwu,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiwy,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixX,JiyY,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,Jiyu,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixX,Jiyw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,JiYa,Xzyw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,Jiua,XzuywY->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixa,Jiwa,XzYy->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiwa,XzyY->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixa,Jiya,XzYw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixa,iJYa,Xzyw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixa,iJua,XzuYwy->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixa,iJua,XzuywY->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,iJwa,XzYy->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJwa,XzyY->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,iJya,XzYw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiYu,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiYv,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYw,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYy,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiuY,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixu,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,Jiuv,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiuw,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuw,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiuy,XzYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixu,JivY,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,JivY,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iixu,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iixu,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iixu,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iixu,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iixu,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iixu,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iixu,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iixu,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iixu,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iixu,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iixu,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iixu,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Iixu,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iixu,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iixu,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iixu,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Iixu,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivu,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivu,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivw,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivw,XzvyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivy,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,JiwY,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JiwY,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiwu,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jiwu,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwy,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwy,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiyY,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixu,Jiyu,XzYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiyv,XzvYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,Jiyw,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixz,JiYu,Xuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iixz,JiYw,Xy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiYy,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iixz,JiuY,Xuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixz,JiuY,Xuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iixz,Jiuv,XuvYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iixz,Jiuv,XuvyYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiuw,XuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixz,Jiuw,XuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixz,Jiuy,XuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiuy,XuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiwY,Xy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixz,Jiwu,XuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiwu,XuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,Jiwy,XY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,JiyY,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixz,Jiyu,XuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iixz,Jiyw,XY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JuYv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuXx,JuvY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuXx,Juvs,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IuXx,JvYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuXx,JvYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuXx,Jvsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JvwY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JvyY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuXx,Jvys,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvyw,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuXx,JzYv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuXx,JzvY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywsuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywvsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuXx,Jzvs,Yywvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuax,JXYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuax,JXaY,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JXav,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JXav,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,JXav,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JXav,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JXav,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JXav,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuax,JXaw,Yyzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuax,JXay,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,JXva,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuax,JXwa,Yyzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuax,JXya,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,Ja,XzuYwy->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Ja,XzuYyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Ja,XzuwYy->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Ja,XzuwyY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Ja,XzuyYw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Ja,XzuywY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,JvYa,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,JvaY,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JvaY,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JvaY,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JvaY,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JvaY,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,JvaY,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvas,XzusYvwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvas,XzusYvyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvas,XzusYwvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Iuax,Jvas,XzusYwyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuax,Jvas,XzusYyvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Iuax,Jvas,XzusYywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvas,XzuswYyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvas,XzuswyYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvas,XzusyYwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvas,XzusywYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuax,Jvaw,XzuYvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvaw,XzuYyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvaw,XzuvYy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvaw,XzuvyY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvaw,XzuyYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvaw,XzuyvY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuax,Jvay,XzuYwv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuax,Jvsa,XzusYvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuax,Jvsa,XzusYvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuax,Jvsa,XzusYwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvsa,XzusYwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iuax,Jvsa,XzusYyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzusYywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzusvYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvsa,XzusvYyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzuswYvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuax,Jvsa,XzuswYyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzuswvYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvsa,XzuswvyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuax,Jvsa,XzuswyYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzusyYvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuax,Jvsa,XzusyYwv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzusyvYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzusyvwY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuax,Jvsa,XzusywYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvwa,XzuYvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,Jvwa,XzuvYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvya,XzuYwv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,Jvya,XzuvwY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuax,JzYa,Xuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuax,JzaY,Xuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuax,Jzav,XuvYyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jzva,XuvYyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jzva,XuvwyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsv,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsy,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXvY,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXvs,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JXvs,Yywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JXvs,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JXvs,Yywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JXvs,Yywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JXvs,Yywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXvw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXvy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXwY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXws,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXwv,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXwy,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXyY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXys,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXys,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXyv,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXyw,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXyw,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsYv,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JsYw,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,JsYy,Xzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuvx,Jstv,XzutYswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jstv,XzutYsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuvx,Jstv,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jstv,XzutYwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iuvx,Jstv,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutYyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jstv,XzutsYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutwYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jstv,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutwsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jstv,XzutwsyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jstv,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutyYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuvx,Jstv,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutysYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutyswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jstv,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jstw,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jstw,XzutYsyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jstw,XzutvsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jstw,XzutysYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jstw,XzutysvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsty,XzutYvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jsty,XzutYwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsty,XzutvYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsty,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsty,XzutwsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsty,XzutwsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsty,XzutwvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsvY,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JsvY,Xzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JsvY,Xzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JsvY,Xzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JsvY,Xzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JsvY,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jsvt,XzutYswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jsvt,XzutYsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jsvt,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Iuvx,Jsvt,XzutYwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuvx,Jsvt,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Iuvx,Jsvt,XzutYyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jsvt,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jsvt,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jsvt,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jsvt,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsvw,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsvw,XzuYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsvw,XzusYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsvw,XzusyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsvw,XzuyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsvw,XzuysY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,Jsvy,XzuYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JswY,Xzusvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JswY,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYsyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswt,XzutvYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswv,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswv,XzusYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswy,XzuYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswy,XzuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYsvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutvYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutwvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyw,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyw,XzuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JuYs,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JusY,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JusY,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 13/240 * einsum('xyzw,Iuvx,Just,XzstYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iuvx,Just,XzstYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 31/240 * einsum('xyzw,Iuvx,Just,XzstYwvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuvx,Just,XzstYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Iuvx,Just,XzstYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iuvx,Just,XzstYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Iuvx,Just,XzstvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iuvx,Just,XzstvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iuvx,Just,XzstwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iuvx,Just,XzstwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Iuvx,Just,XzstwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iuvx,Just,XzstwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iuvx,Just,XzstwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iuvx,Just,XzstwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iuvx,Just,XzstyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Iuvx,Just,XzstyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iuvx,Just,XzstyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Iuvx,Just,XzstyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iuvx,Just,XzstywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuvx,Just,XzstywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jv,XzuYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jv,XzuYyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jv,XzuwYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jv,XzuwyY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jv,XzuyYw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jv,XzuywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jw,XzuYvy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jw,XzuvYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jy,XzuYwv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jy,XzuvwY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JzYs,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuvx,JzYv,Xuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JzsY,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JzsY,Xuswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jzst,XustYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzst,XustYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/60 * einsum('xyzw,Iuvx,Jzst,XustYwvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Iuvx,Jzst,XustYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuvx,Jzst,XustYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jzst,XustYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jzst,XustvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzst,XustvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuvx,Jzst,XustwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuvx,Jzst,XustwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jzst,XustwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuvx,Jzst,XustyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuvx,Jzst,XustyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/48 * einsum('xyzw,Iuvx,Jzst,XustyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jzst,XustywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzsv,XusYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jzsv,XuswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuvx,JzvY,Xuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuvx,Jzvs,XusYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxX,JuYv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IuxX,JuvY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IuxX,Juvs,Yywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IuxX,Juvs,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxX,JvYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxX,JvYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsy,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,JvwY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,JvwY,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvws,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvwy,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxX,JvyY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvys,Ywvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvys,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvys,Ywvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,Jvys,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvys,Ywvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvys,Ywvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxX,Jvyw,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jw,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxX,Jy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxX,JzYv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,JzvY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,JzvY,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jzvs,Yywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jzvs,Yywvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxa,JXYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxa,JXaY,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JXav,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXav,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JXaw,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,JXaw,Yyzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxa,JXay,Ywuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXva,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JXva,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,JXwa,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JXwa,Yyzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxa,JXya,Ywuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Ja,XzuYwy->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Ja,XzuywY->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxa,JvYa,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JvaY,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JvaY,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYvyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYwvy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvas,XzusYwyv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuxa,Jvas,XzusYyvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxa,Jvas,XzusYywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvas,XzuswYyv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvas,XzuswyYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvas,XzusyYwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxa,Jvas,XzusywYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvaw,XzuYvy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvaw,XzuyvY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvay,XzuYwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvay,XzuvwY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxa,Jvsa,XzusYwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Iuxa,Jvsa,XzusYyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxa,Jvsa,XzuswYyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxa,Jvsa,XzuswvYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxa,Jvsa,XzuswvyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxa,Jvsa,XzuswyYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Jvsa,XzusyYvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusyYwv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusyvYw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusyvwY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusywYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuYyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuyYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxa,Jvya,XzuYwv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxa,JzYa,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JzaY,Xuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JzaY,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzav,XuvYyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Jzav,XuvyYw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzva,XuvYwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Jzva,XuvywY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxv,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXYw,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iuxv,JXYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JXsv,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXsv,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxv,JXvY,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXvs,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JXvs,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXvw,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXvw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXvy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,JXwY,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXws,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXws,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXwv,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXwv,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iuxv,JXyY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,JXys,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,JXyv,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,JXyw,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxv,JsYv,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzusvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzusyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuvys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,JsYw,Xzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JsYy,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxv,Jstv,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Iuxv,Jstv,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxv,Jstv,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxv,Jstv,XzutwsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxv,Jstv,XzutwsyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxv,Jstv,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jstv,XzutyYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutysYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutyswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jstw,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jstw,XzutysvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsty,XzutYsvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,Jsty,XzutYwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsty,XzutsYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsty,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsty,XzutwsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JsvY,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JsvY,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jsvt,XzutYwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuxv,Jsvt,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxv,Jsvt,XzutYyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jsvt,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jsvt,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jsvt,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxv,Jsvt,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvw,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jsvw,XzuysY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JswY,Xzusyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JswY,Xzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswt,XzutYyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jswt,XzutyYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswv,XzuYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jswv,XzuyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswy,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jswy,XzusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,JsyY,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,Jsyt,XzutYwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,Jsyv,XzuYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,Jsyw,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsyw,XzuYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsyw,XzusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsyw,XzusvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsyw,XzuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsyw,XzuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxv,JuYs,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JusY,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JusY,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iuxv,Just,XzstYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iuxv,Just,XzstYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Iuxv,Just,XzstYwvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Iuxv,Just,XzstYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iuxv,Just,XzstYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/40 * einsum('xyzw,Iuxv,Just,XzstYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Iuxv,Just,XzstvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Iuxv,Just,XzstvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iuxv,Just,XzstwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iuxv,Just,XzstwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Iuxv,Just,XzstwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Iuxv,Just,XzstwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuxv,Just,XzstwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iuxv,Just,XzstwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iuxv,Just,XzstyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Iuxv,Just,XzstyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iuxv,Just,XzstyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iuxv,Just,XzstyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Iuxv,Just,XzstywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuxv,Just,XzstywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jv,XzuYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jv,XzuywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jw,XzuYyv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jw,XzuyYv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxv,Jy,XzuYwv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xuswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xuswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,JzYs,Xusyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxv,JzYv,Xuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JzsY,Xuswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzsY,Xusyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jzst,XustYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jzst,XustyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzsv,XusYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jzsv,XusywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JzvY,Xuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JzvY,Xuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzvs,XusYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jzvs,XusyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXYw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,Iuxz,JXYy,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,JXvw,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JXvw,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXvy,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,JXwY,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JXwv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,JXwv,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXwy,Yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,Iuxz,JXyY,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,JXyv,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,JXyw,Yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxz,JuYv,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxz,JuvY,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxz,JuvY,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxz,Juvs,XvsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxz,Juvs,XvsYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxz,Juvs,XvswYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxz,Juvs,XvswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxz,Juvs,XvsyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxz,Juvs,XvsywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JvYw,Xuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JvYy,Xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsw,XusYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvsw,XusyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsy,XusYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvsy,XusvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,JvwY,Xuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JvwY,Xuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvws,XusYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvws,XusyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvwy,XuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvwy,XuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,JvyY,Xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,Jvys,XusYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,Jvyw,XuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jw,XuYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jw,XuyY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuxz,Jy,XuYw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXYw,zy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,Ix,JXYy,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JXuw,Yyuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,JXuw,Yyzu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXuy,Ywuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JXwY,zy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,JXwu,Yyuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JXwu,Yyzu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXwy,Yz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,Ix,JXyY,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JXyu,Ywuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JXyw,Yz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JuYw,Xzyu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JuYy,Xzuw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvw,XzvYuy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juvw,XzvyuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvy,XzvYwu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juvy,XzvuwY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,JuwY,Xzuy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JuwY,Xzyu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwv,XzvYyu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juwv,XzvyYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwy,XzYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juwy,XzuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JuyY,Xzuw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,Juyv,XzvYwu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,Juyw,XzYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Jw,XzYy->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jw,XzyY->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,Jy,XzYw->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JzYu,Xuyw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JzuY,Xuwy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,JzuY,Xuyw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jzuv,XuvYyw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Jzuv,XuvyYw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Ja,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXa,JuYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,JuaY,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juav,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juaz,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXa,Juva,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juza,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Ju,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JvYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxXu,JvYz,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jvsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,Jvsz,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,JvuY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvus,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvuz,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,JvzY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxXu,Jvzs,Yuvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxXu,JwYv,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JwvY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,Jwvs,Yzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IxXu,JyYv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JyvY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxXu,Jyvs,Yzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,Jz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaX,Ja,Yzyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaX,JuYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaX,JuaY,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaX,Juav,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaX,Juaz,Yuyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaX,Juva,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juva,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaX,Juza,Yuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juza,Yuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixab,JXab,Yzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixab,JXba,Yzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixab,Juab,XywYuz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juab,XywYzu->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juab,XywuYz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juab,XywuzY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juab,XywzYu->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juab,XywzuY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixab,Juba,XywYuz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixab,Juba,XywuYz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixau,JXYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixau,JXaY,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixau,JXau,Yzyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixau,JXav,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JXav,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JXav,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JXav,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JXav,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JXav,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixau,JXaz,Yuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixau,JXua,Yzyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixau,JXva,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixau,JXza,Yuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixau,Ja,XywYuz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Ja,XywYzu->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Ja,XywuYz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Ja,XywuzY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Ja,XywzYu->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Ja,XywzuY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixau,JvYa,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JvaY,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JvaY,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixau,JvaY,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JvaY,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JvaY,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,JvaY,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvas,XywsYuvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Ixau,Jvas,XywsYuzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvas,XywsYvuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvas,XywsYvzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Ixau,Jvas,XywsYzuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvas,XywsYzvu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvas,XywsuYzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvas,XywsuzYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvas,XywszYuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvas,XywszuYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixau,Jvau,XywYvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvau,XywYzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvau,XywvYz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvau,XywvzY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvau,XywzYv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvau,XywzvY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixau,Jvaz,XywYuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsYuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvsa,XywsYuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixau,Jvsa,XywsYvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixau,Jvsa,XywsYvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywsYzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixau,Jvsa,XywsYzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywsuYvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsuYzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywsuvYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsuzYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywsvYuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvsa,XywsvuYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixau,Jvsa,XywszYuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywszYvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixau,Jvsa,XywszuYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvsa,XywszuvY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywszvYu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywszvuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvua,XywYvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvua,XywvYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvza,XywYuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvza,XywvuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuX,Ju,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuX,JvYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuX,JvYz,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jvsz,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvsz,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuX,JvuY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuX,Jvus,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuX,Jvuz,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,JvzY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,JvzY,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuX,Jvzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvzu,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuX,JwYv,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,JwvY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,JwvY,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jwvs,Yzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jwvs,Yzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuX,JyYv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuX,JyvY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jz,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JXYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixua,JXaY,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JXau,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXav,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXav,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXaz,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXaz,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixua,JXua,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXva,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXva,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXza,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXza,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Ja,XywYuz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Ja,XywuYz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JvYa,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JvaY,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JvaY,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvas,XywsYuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvas,XywsYuzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvas,XywsYvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvas,XywsYvzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixua,Jvas,XywsYzuv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvas,XywsYzvu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixua,Jvas,XywsuYzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvas,XywsuzYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvas,XywszYuv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvas,XywszuYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvau,XywYvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvau,XywvYz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvaz,XywYuv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvaz,XywuYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsYuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsYuzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixua,Jvsa,XywsYvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixua,Jvsa,XywsYvzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsYzuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsuYvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsuYzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixua,Jvsa,XywsuvYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsuzYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsvYuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsvuYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywszYuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixua,Jvsa,XywszYvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywszuYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixua,Jvsa,XywszuvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixua,Jvsa,XywszvYu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixua,Jvsa,XywszvuY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,Jvua,XywYvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvua,XywYzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvua,XywvYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvua,XywvzY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvua,XywzYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvua,XywzvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvza,XywYvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvza,XywuvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixuv,JXYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixuv,JXYz,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixuv,JXuY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXus,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXus,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXus,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXus,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXus,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXus,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,JXuv,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,JXuz,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,JXvY,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXvs,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXvs,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXvu,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXvz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXvz,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixuv,JXzY,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXzs,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXzs,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXzv,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXzv,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JsYu,Xywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JsYv,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixuv,JsYz,Xywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixuv,Jstu,XywtYsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstu,XywtYszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtYvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstu,XywtYvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstu,XywtYzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtYzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtsYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstu,XywtsvYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtvYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtvYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtvsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtvzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtzYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstu,XywtzYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtzsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtzsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstu,XywtzvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstu,XywtzvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixuv,Jstv,XywtYsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,Jstv,XywtYszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtYusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtYuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtYzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtsYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtsuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtuYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtuYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixuv,Jstv,XywtusYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtuzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstv,XywtzYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtzYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstv,XywtzsYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstv,XywtzsuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtzuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstv,XywtzusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstz,XywtYsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstz,XywtYusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/24 * einsum('xyzw,Ixuv,Jstz,XywtYvsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/48 * einsum('xyzw,Ixuv,Jstz,XywtuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstz,XywtuYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstz,XywtusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstz,XywtusvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstz,XywtuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstz,XywtuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstz,XywtvYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtvYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstz,XywtvsYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstz,XywtvsuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtvuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstz,XywtvusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JsuY,Xywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsuY,Xywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsuY,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsuY,Xywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsuY,Xywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsuY,Xywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsut,XywtYsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsut,XywtYszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsut,XywtYvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Ixuv,Jsut,XywtYvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsut,XywtYzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Ixuv,Jsut,XywtYzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jsut,XywtvYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jsut,XywtvzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jsut,XywtzYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jsut,XywtzvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jsuv,XywYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsuv,XywYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsuv,XywsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsuv,XywszY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsuv,XywzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsuv,XywzsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,Jsuz,XywYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JsvY,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsvY,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvt,XywtYsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvt,XywtYszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvt,XywtYusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jsvt,XywtYuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvt,XywtYzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jsvt,XywtYzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jsvt,XywtuYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jsvt,XywtuzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jsvt,XywtzYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jsvt,XywtzuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvu,XywYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvu,XywsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvz,XywYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvz,XywuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JszY,Xywsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JszY,Xywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYsuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYvsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszt,XywtYvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jszt,XywtuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszu,XywYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszu,XywsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszv,XywYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszv,XywusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Ju,XywYvz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Ju,XywYzv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Ju,XywvYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Ju,XywvzY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Ju,XywzYv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Ju,XywzvY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jv,XywYuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jv,XywuYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixuv,JwYs,Xysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JwsY,Xysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JwsY,Xyszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Ixuv,Jwst,XystYuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/120 * einsum('xyzw,Ixuv,Jwst,XystYuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 9/40 * einsum('xyzw,Ixuv,Jwst,XystYvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Ixuv,Jwst,XystYvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Ixuv,Jwst,XystYzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Ixuv,Jwst,XystYzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Ixuv,Jwst,XystuYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Ixuv,Jwst,XystuYzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Ixuv,Jwst,XystuvYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Ixuv,Jwst,XystuvzY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Ixuv,Jwst,XystvYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Ixuv,Jwst,XystvYzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Ixuv,Jwst,XystvuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Ixuv,Jwst,XystvuzY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jwst,XystzYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jwst,XystzYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Ixuv,Jwst,XystzuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Ixuv,Jwst,XystzuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Ixuv,Jwst,XystzvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Ixuv,Jwst,XystzvuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ixuv,JyYs,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JysY,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JysY,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstYuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Ixuv,Jyst,XwstYuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstYvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstYvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/24 * einsum('xyzw,Ixuv,Jyst,XwstYzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstYzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstuYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Ixuv,Jyst,XwstuYzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstvYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstvYzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jyst,XwstzYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstzYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Ixuv,Jyst,XwstzuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstzuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstzvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jyst,XwstzvuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,Jz,XywYvu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jz,XywuvY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXax,IYau,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXax,IYua,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXax,Ia,Yzyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXax,Iuav,Yzvywu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXax,Iuva,Yzvuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXax,Iuva,Yzvywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXux,IYuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXux,IYvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXux,Iu,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXux,Ivsu,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXux,Ivsu,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXux,Ivus,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,IYau,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXxa,IYua,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,Ia,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,Iuav,Yzvywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXxa,Iuva,Yzvuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXxa,Iuva,Yzvywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,IYuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JXxu,IYvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,Iu,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXxu,Ivsu,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXxu,Ivsu,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,Ivus,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiYx,IiXu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,IiuX,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,IiXu,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,IiXv,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jiux,IiuX,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jiux,Iiuv,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywYzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywvzY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywzYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywzvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivX,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jiux,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Jiux,Iivs,XywuYszv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Jiux,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Jiux,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jiux,Iivs,XywusYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jiux,Iivs,XywusYzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jiux,Iivs,XywusvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuszYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jiux,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jiux,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Jiux,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jiux,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jiux,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Jiux,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jiux,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iivu,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,Iivu,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixY,IiXu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixY,IiuX,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JixY,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JixY,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixa,Iiua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixa,Iiua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixa,iIua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixa,iIua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,IiXu,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiXv,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuX,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,Iiuv,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,Iiuv,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,IivX,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivX,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Jixu,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuYszv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Jixu,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Jixu,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Jixu,Iivs,XywusYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Jixu,Iivs,XywusYzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jixu,Iivs,XywusvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuszYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Jixu,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jixu,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Jixu,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Jixu,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Jixu,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jixu,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Jixu,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,Iivu,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixu,Iivu,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,IiXu,Yuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixz,IiuX,Yuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuX,Yuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jixz,Iiuv,XywYuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywYvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jixz,Iiuv,XywuYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywuvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywvYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywvuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiYx,IiXu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,IiuX,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,IiXu,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,IiXv,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jiux,IiuX,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jiux,Iiuv,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywYzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywvzY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywzYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iiuv,XywzvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivX,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jiux,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Jiux,Iivs,XywuYszv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Jiux,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Jiux,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jiux,Iivs,XywusYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jiux,Iivs,XywusYzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jiux,Iivs,XywusvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jiux,Iivs,XywuszYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jiux,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jiux,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Jiux,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jiux,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jiux,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Jiux,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jiux,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,Iivu,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,Iivu,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixY,IiXu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixY,IiuX,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JixY,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JixY,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiXa,Yzyw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixa,Iiua,XywYuz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixa,Iiua,XywuYz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIXa,Yzyw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixa,iIua,XywYuz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixa,iIua,XywuYz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,IiXu,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiXv,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuX,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,Iiuv,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,Iiuv,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,IivX,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivX,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Jixu,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuYszv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Jixu,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Jixu,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Jixu,Iivs,XywusYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Jixu,Iivs,XywusYzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jixu,Iivs,XywusvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuszYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Jixu,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jixu,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jixu,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Jixu,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Jixu,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Jixu,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jixu,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Jixu,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,Iivu,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixu,Iivu,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,IiXu,Yuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixz,IiuX,Yuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuX,Yuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jixz,Iiuv,XywYuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywYvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jixz,Iiuv,XywuYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywuvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywvYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jixz,Iiuv,XywvuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuYx,IuXv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuYx,IuvX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuYx,Iuvs,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juax,IYXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Juax,IYaX,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IYav,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IYav,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juax,IYav,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IYav,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IYav,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IYav,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IYva,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juax,Ia,XywYuz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ia,XywYzu->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ia,XywuYz->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ia,XywuzY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ia,XywzYu->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ia,XywzuY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IvXa,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juax,IvaX,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaX,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaX,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaX,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaX,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaX,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivas,XywvYsuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivas,XywvYszu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivas,XywvYusz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Juax,Ivas,XywvYuzs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivas,XywvYzsu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Juax,Ivas,XywvYzus->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivas,XywvuYzs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivas,XywvuzYs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivas,XywvzYus->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivas,XywvzuYs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juax,Ivsa,XywvYsuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juax,Ivsa,XywvYszu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvYusz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivsa,XywvYuzs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juax,Ivsa,XywvYzsu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvYzus->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvsYuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivsa,XywvsuYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvuYsz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvuYzs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvusYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvuzYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvzYsu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juax,Ivsa,XywvzYus->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvzsYu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvzsuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juax,Ivsa,XywvzuYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivsa,XywvzusY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juvx,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IYsv,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Juvx,IYvX,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IYvs,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IYvs,Xywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IYvs,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IYvs,Xywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IYvs,Xywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IYvs,Xywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IsXv,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juvx,Istv,XywsYtuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juvx,Istv,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsYutz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Istv,XywsYuzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juvx,Istv,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywstYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Istv,XywstuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywsuYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywsutYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywszYtu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juvx,Istv,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywsztYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywsztuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juvx,Istv,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Istv,XywszutY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IsvX,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvX,Yzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvX,Yzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvX,Yzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvX,Yzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvX,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Isvt,XywsYtuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Isvt,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Isvt,XywsYutz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Juvx,Isvt,XywsYuzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Isvt,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Juvx,Isvt,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Isvt,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Isvt,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Isvt,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Isvt,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IuXs,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IusX,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusX,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Juvx,Iust,XywvYstz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Iust,XywvYszt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('xyzw,Juvx,Iust,XywvYtsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 31/240 * einsum('xyzw,Juvx,Iust,XywvYtzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Iust,XywvYzst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Juvx,Iust,XywvYzts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Juvx,Iust,XywvsYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Juvx,Iust,XywvsYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Juvx,Iust,XywvstYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juvx,Iust,XywvszYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('xyzw,Juvx,Iust,XywvtYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Iust,XywvtYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Juvx,Iust,XywvtsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Juvx,Iust,XywvtzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Juvx,Iust,XywvzYst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Juvx,Iust,XywvzYts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Juvx,Iust,XywvzsYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Juvx,Iust,XywvzstY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Juvx,Iust,XywvztYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Juvx,Iust,XywvztsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,Iv,XywYuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Iv,XywYzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Iv,XywuYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Iv,XywuzY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Iv,XywzYu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Iv,XywzuY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxY,IuXv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JuxY,IuvX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JuxY,Iuvs,Xywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JuxY,Iuvs,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IYXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxa,IYaX,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IYav,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYav,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYva,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IYva,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,Ia,XywYuz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ia,XywuYz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IvXa,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IvaX,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IvaX,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ivas,XywvYsuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ivas,XywvYszu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ivas,XywvYusz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxa,Ivas,XywvYuzs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ivas,XywvYzsu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivas,XywvYzus->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivas,XywvuYzs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxa,Ivas,XywvuzYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxa,Ivas,XywvzYus->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxa,Ivas,XywvzuYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxa,Ivsa,XywvYszu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxa,Ivsa,XywvYzsu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivsa,XywvsYuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivsa,XywvsuYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivsa,XywvuYsz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivsa,XywvuYzs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivsa,XywvusYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivsa,XywvuzYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,Ivsa,XywvzYsu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivsa,XywvzYus->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivsa,XywvzuYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IYsv,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYsv,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IYvX,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYvs,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IYvs,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IsXv,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxv,Istv,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxv,Istv,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Istv,XywstYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Istv,XywstuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Istv,XywsuYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Istv,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Istv,XywsutYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Istv,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,Istv,XywszYtu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Istv,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Istv,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IsvX,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IsvX,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Isvt,XywsYtuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Isvt,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Isvt,XywsYutz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxv,Isvt,XywsYuzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Isvt,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Isvt,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Isvt,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxv,Isvt,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxv,Isvt,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxv,Isvt,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IuXs,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IusX,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IusX,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxv,Iust,XywvYstz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Juxv,Iust,XywvYszt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxv,Iust,XywvYtsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Juxv,Iust,XywvYtzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Juxv,Iust,XywvYzst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Juxv,Iust,XywvYzts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Juxv,Iust,XywvsYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Juxv,Iust,XywvsYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Juxv,Iust,XywvstYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Juxv,Iust,XywvszYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Juxv,Iust,XywvtYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Juxv,Iust,XywvtYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Juxv,Iust,XywvtsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Juxv,Iust,XywvtzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Juxv,Iust,XywvzYst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juxv,Iust,XywvzYts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juxv,Iust,XywvzsYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Juxv,Iust,XywvzstY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Juxv,Iust,XywvztYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('xyzw,Juxv,Iust,XywvztsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,Iv,XywYuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Iv,XywuYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxz,IuXv,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxz,IuvX,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxz,IuvX,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxz,Iuvs,XywYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxz,Iuvs,XywYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxz,Iuvs,XywsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxz,Iuvs,XywsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxz,Iuvs,XywvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Juxz,Iuvs,XywvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,Ia,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxYa,IuXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,IuaX,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,Iuav,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JxYa,Iuva,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,Iu,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxYu,IvXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JxYu,Ivsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,IvuX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,Ivus,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxaY,Ia,Xzyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaY,IuXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxaY,IuaX,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxaY,Iuav,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxaY,Iuva,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxaY,Iuva,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxab,IYab,Xzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxab,IYba,Xzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxab,Iuab,XzuYwy->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuab,XzuYyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuab,XzuwYy->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuab,XzuwyY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuab,XzuyYw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuab,XzuywY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxab,Iuba,XzuYwy->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxab,Iuba,XzuywY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxau,IYXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Jxau,IYaX,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxau,IYau,Xzyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,IYav,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IYav,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IYav,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IYav,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IYav,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IYav,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxau,IYua,Xzyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IYva,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,Ia,XzuYwy->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ia,XzuYyw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ia,XzuwYy->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ia,XzuwyY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ia,XzuyYw->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ia,XzuywY->IXJY', v_aaaa, t1_xaea, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IvXa,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaX,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaX,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,IvaX,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaX,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaX,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaX,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivas,XzuvYswy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivas,XzuvYsyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivas,XzuvYwsy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Jxau,Ivas,XzuvYwys->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jxau,Ivas,XzuvYysw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Jxau,Ivas,XzuvYyws->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivas,XzuvwYys->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivas,XzuvwyYs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivas,XzuvyYws->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivas,XzuvywYs->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,Ivau,XzvYwy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivau,XzvYyw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivau,XzvwYy->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivau,XzvwyY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivau,XzvyYw->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivau,XzvywY->IXJY', v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxau,Ivsa,XzuvYswy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvYsyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxau,Ivsa,XzuvYwsy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvYwys->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jxau,Ivsa,XzuvYysw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvYyws->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvsYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvsYyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvwYsy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvwYys->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvwsYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvwsyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvwyYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvyYsw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxau,Ivsa,XzuvyYws->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvysYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvyswY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvywYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivua,XzvYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivua,XzvywY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxuY,Iu,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuY,IvXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxuY,IvuX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxuY,Ivus,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IYXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxua,IYaX,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IYau,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYav,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IYav,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxua,IYua,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IYva,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYva,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ia,XzuYwy->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ia,XzuywY->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IvXa,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IvaX,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IvaX,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYswy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYsyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYwsy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivas,XzuvYwys->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jxua,Ivas,XzuvYysw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxua,Ivas,XzuvYyws->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivas,XzuvwYys->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivas,XzuvwyYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivas,XzuvyYws->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxua,Ivas,XzuvywYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivau,XzvYwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivau,XzvywY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxua,Ivsa,XzuvYswy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvYsyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxua,Ivsa,XzuvYwsy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvYwys->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Jxua,Ivsa,XzuvYysw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvYyws->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxua,Ivsa,XzuvsYwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxua,Ivsa,XzuvsYyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxua,Ivsa,XzuvwYsy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvwYys->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxua,Ivsa,XzuvwsYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvwsyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvwyYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxua,Ivsa,XzuvyYsw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvyYws->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvysYw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvyswY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvywYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,Ivua,XzvYwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivua,XzvYyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivua,XzvwYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivua,XzvwyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivua,XzvyYw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivua,XzvywY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxuv,IYXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IYsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Jxuv,IYuX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IYus,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYus,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYus,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYus,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYus,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYus,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxuv,IYuv,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxuv,IYvX,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYvs,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYvs,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IYvu,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IsXu,Yywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IsXv,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxuv,Istu,XzvsYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istu,XzvsYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Istu,XzvsYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Istu,XzvsYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jxuv,Istu,XzvsYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvsYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvstYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istu,XzvstYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvswYty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istu,XzvswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvswtYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istu,XzvswtyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istu,XzvswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvsyYtw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Istu,XzvsyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvsytYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvsytwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istu,XzvsywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Istv,XzusYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,Istv,XzusYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Jxuv,Istv,XzusYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istv,XzustYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istv,XzustYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istv,XzuswYty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istv,XzuswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Istv,XzuswtYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzuswtyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzuswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istv,XzusyYtw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istv,XzusyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusytYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusytwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IsuX,Yywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuX,Yywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuX,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuX,Yywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuX,Yywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuX,Yywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isut,XzvsYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isut,XzvsYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isut,XzvsYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('xyzw,Jxuv,Isut,XzvsYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jxuv,Isut,XzvsYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Jxuv,Isut,XzvsYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Isut,XzvswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Isut,XzvswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Isut,XzvsyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Isut,XzvsywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,Isuv,XzsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isuv,XzsYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isuv,XzswYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isuv,XzswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isuv,XzsyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isuv,XzsywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsvX,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsvX,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Isvt,XzusYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jxuv,Isvt,XzusYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Isvt,XzusYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Isvt,XzuswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Isvt,XzuswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Isvt,XzusyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Isvt,XzusywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Isvu,XzsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvu,XzsywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,Iu,XzvYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iu,XzvYyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iu,XzvwYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iu,XzvwyY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iu,XzvyYw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iu,XzvywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Iv,XzuYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Iv,XzuywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxa,JiYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iIxa,Jiua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iIxa,Jiwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxa,Jiya,XzYw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iIxa,iJYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,iJua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuYyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuwYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuwyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuyYw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxa,iJwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,iIxa,iJya,XzYw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,Iiua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iJxa,Iiua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iJxa,iIXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iJxa,iIua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywYzu->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywuzY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywzYu->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywzuY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxa,JiYa,Xzyw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,Jiua,XzuYwy->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iIxa,Jiua,XzuywY->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iIxa,Jiwa,XzYy->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiwa,XzyY->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxa,Jiya,XzYw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iIxa,iJYa,Xzyw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,iJua,XzuYwy->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuYyw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuwYy->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuwyY->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuyYw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iIxa,iJua,XzuywY->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxa,iJwa,XzYy->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,iIxa,iJya,XzYw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiXa,Yzyw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,Iiua,XywYuz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iJxa,Iiua,XywuYz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iJxa,iIXa,Yzyw->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iJxa,iIua,XywYuz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywYzu->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywuYz->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywuzY->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywzYu->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,iJxa,iIua,XywzuY->IXJY', v_aaaa, t1_vxae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ia,Jxay,xy->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ia,Jxya,xy->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jizw,xyzw->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jizw,xyzw->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Iixy,Jizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,Iixy,Jizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ix,Jyxz,yz->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ix,Jyzx,yz->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixab,Jyab,xy->IXJY', e_cvs, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixab,Jyba,xy->IXJY', e_cvs, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixay,Ja,xy->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixay,Jzaw,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixay,Jzay,xz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixay,Jzwa,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixay,Jzya,xz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixya,Ja,xy->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixya,Jzaw,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixya,Jzay,xz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixya,Jzwa,xwzy->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixya,Jzya,xz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixyz,Jwuy,xuzw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixyz,Jwuz,xuwy->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixyz,Jwyu,xuzw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixyz,Jwyz,xw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixyz,Jwzu,xuyw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixyz,Jwzy,xw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,Ixyz,Jxwu,yzwu->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,XY,Ixyz,Jy,xz->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,XY,Ixyz,Jz,xy->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,iIxa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,iIxa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,XY,iIxa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,XY,iIxa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ia,Jxay,xy->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ia,Jxya,xy->IXJY', e_cvs, np.identity(ncas), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jizw,xyzw->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jizw,xyzw->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Iixy,Jizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,Iixy,Jizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ix,Jyxz,yz->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ix,Jyzx,yz->IXJY', e_cvs, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixab,Jyab,xy->IXJY', e_cvs, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixab,Jyba,xy->IXJY', e_cvs, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixay,Ja,xy->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixay,Jzaw,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixay,Jzay,xz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixay,Jzwa,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixay,Jzya,xz->IXJY', e_cvs, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixya,Ja,xy->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixya,Jzaw,xwyz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixya,Jzay,xz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixya,Jzwa,xwzy->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixya,Jzya,xz->IXJY', e_cvs, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixyz,Jwuy,xuzw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixyz,Jwuz,xuwy->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixyz,Jwyu,xuzw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixyz,Jwyz,xw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixyz,Jwzu,xuyw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixyz,Jwzy,xw->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,Ixyz,Jxwu,yzwu->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,XY,Ixyz,Jy,xz->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,XY,Ixyz,Jz,xy->IXJY', e_cvs, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,iIxa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,iIxa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,XY,iIxa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,XY,iIxa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xa,Yxya,xy->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,Xa,xYya,xy->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,XxYa,ya,xy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,XxYa,yzwa,xwzy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,Xxab,Yyab,xy->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxab,Yyba,xy->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxba,Yyab,xy->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,Xxba,Yyba,xy->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxya,Ya,xy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxya,Yzwa,xwzy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,Xxya,Yzya,xz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxya,zYwa,xwyz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,Xxya,zYya,xz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXYa,ixay,yx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXYa,ixya,yx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXaY,ixay,yx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXaY,ixya,yx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXax,iYay,xy->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXax,iYya,xy->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXxa,iYay,xy->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXxa,iYya,xy->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iYax,Xx->IXJY', e_extern, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ia,iYxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,ijxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,ijYa,jixa,Xx->IXJY', e_extern, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,ijxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,ijYa,jixa,Xx->IXJY', e_extern, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,ia,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixYa,iyXa,xy->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyaX,xy->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyaz,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyza,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,ia,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaY,iyXa,xy->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,iyaX,xy->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,iyaz,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaY,iyza,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixab,iYab,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixab,iYba,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYXa,yx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ixay,iYaX,yx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYay,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYaz,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixay,iYya,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixay,iYza,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixba,iYab,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixba,iYba,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYXa,yx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iYaX,yx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYay,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYaz,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iYya,Xx->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYza,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,iXYa,ixay,yx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXYa,ixya,yx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,iXaY,ixay,yx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXaY,ixya,yx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXax,iYay,xy->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXax,iYya,xy->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,iXxa,iYay,xy->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,iXxa,iYya,xy->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iYax,Xx->IXJY', e_extern, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ia,iYxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,ijxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,ijYa,jixa,Xx->IXJY', e_extern, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,ijYa,ijxa,Xx->IXJY', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,ijYa,jixa,Xx->IXJY', e_extern, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,ia,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixYa,iyXa,xy->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyaX,xy->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyaz,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixYa,iyza,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,ia,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaY,iyXa,xy->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,iyaX,xy->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaY,iyaz,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaY,iyza,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixab,iYab,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixab,iYba,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYXa,yx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ixay,iYaX,yx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYay,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iYaz,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixay,iYya,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixay,iYza,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixba,iYab,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixba,iYba,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYXa,yx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iYaX,yx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYay,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYaz,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iYya,Xx->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iYza,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xXYa,ya,xy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xXYa,yzwa,xwzy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,xXya,Ya,xy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xXya,Yzwa,xwyz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xXya,Yzya,xz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,xXya,zYwa,xwyz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,xXya,zYya,xz->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xa,Ya,Xx->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,xa,YyXa,xy->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xa,Yyza,Xyzx->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xa,yYXa,xy->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xa,yYza,Xyxz->IXJY', e_extern, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyYa,za,Xzxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyYa,zwXa,xyzw->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyYa,zwua,Xwzuxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyYa,zwua,Xwzuyx->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyYa,zwua,Xwzxuy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,IJ,xyYa,zwua,Xwzxyu->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyYa,zwua,Xwzyux->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyYa,zwua,Xwzyxu->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyab,Yzab,Xzxy->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyab,Yzba,Xzyx->IXJY', e_extern, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,Ya,Xzyx->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,xyza,YwXa,zwxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,IJ,xyza,Ywua,Xzwuxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyza,Ywua,Xzwuyx->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyza,Ywua,Xzwxuy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyza,Ywua,Xzwxyu->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyza,Ywua,Xzwyux->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,IJ,xyza,Ywua,Xzwyxu->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,Ywza,Xwxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,wYXa,zwxy->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,wYua,Xzwyxu->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,wYza,Xwyx->IXJY', e_extern, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,XY,Ja,Ixay,xy->IXJY', e_extern, np.identity(ncas), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Ja,Ixya,xy->IXJY', e_extern, np.identity(ncas), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,XY,Jixa,Iiya,xy->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,XY,Jixa,iIya,xy->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,XY,Jixa,Iiya,xy->IXJY', e_extern, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,XY,Jixa,iIya,xy->IXJY', e_extern, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,XY,Jxab,Iyab,xy->IXJY', e_extern, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxab,Iyba,xy->IXJY', e_extern, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,XY,Jxay,Ia,xy->IXJY', e_extern, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,XY,Jxay,Izaw,xwyz->IXJY', e_extern, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,XY,Jxay,Izay,xz->IXJY', e_extern, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxay,Izwa,xwyz->IXJY', e_extern, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxay,Izya,xz->IXJY', e_extern, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxba,Iyab,xy->IXJY', e_extern, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,XY,Jxba,Iyba,xy->IXJY', e_extern, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxya,Ia,xy->IXJY', e_extern, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxya,Izaw,xwyz->IXJY', e_extern, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxya,Izay,xz->IXJY', e_extern, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,XY,Jxya,Izwa,xwzy->IXJY', e_extern, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,XY,Jxya,Izya,xz->IXJY', e_extern, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,XY,iJxa,Iiya,xy->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,XY,iJxa,iIya,xy->IXJY', e_extern, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,XY,iJxa,Iiya,xy->IXJY', e_extern, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,XY,iJxa,iIya,xy->IXJY', e_extern, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iX,ixYy,yx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iX,ixyY,yx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYa,ixay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXYa,ixya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYx,iyxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXYx,iyzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaY,ixay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXaY,ixya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXax,iYay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXax,iYya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxY,iyxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxY,iyzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxa,iYay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxa,iYya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxy,iYyz,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxy,iYzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYzy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXa,ixay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYXa,ixya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYXx,iy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXx,iyxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYXx,iyzw,xyzw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYXx,iyzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iYaX,ixay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYaX,ixya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYab,ixab,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYab,ixba,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iXay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iXya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,ia,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iyax,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iyaz,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iyxa,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iyza,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('i,IJ,iYxX,iy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxX,iyxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iYxX,iyzw,xyzw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxX,iyzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iXay,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iXya,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,ia,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyax,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyaz,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iyxa,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyza,Xzyx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXxz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iXyz,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYxy,iXzw,yxwz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iXzx,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXzy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,ix,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYxy,iz,Xzyx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuxyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuxzy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,IJ,iYxy,izwu,Xwuyxz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuyzx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuzxy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuzyx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izwx,Xwyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izwy,Xwzx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,izxw,Xwyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,izxy,Xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izyw,Xwxz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izyx,Xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iYax,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ia,iYxa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ia,ixYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,ixaY,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,jiYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYa,jixa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijxy,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijyx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijyz,Xxyz->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,jiXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxa,jiYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,ijYy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYz,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,jiYx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYz,Xzyx->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,jiYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYa,jixa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijxy,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijyx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijyz,Xxyz->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,jiXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxa,jiYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,ijYy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYz,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,jiYx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYz,Xzyx->IXJY', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iXYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ix,iXyY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iY,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iYxy,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ix,iYyx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ix,iyYx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iyYz,Xzxy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iyxY,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iyzY,Xzyx->IXJY', e_cvs, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXa,iyYa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXa,iyaY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixXy,iY,yx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,ixYz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,ixzY,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixXy,izYw,yzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,izYy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixXy,izwY,yzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,izyY,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,ia,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixYa,iyXa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyaX,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyaz,Xyxz->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyza,Xyzx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixYy,ixXz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixYy,ixzX,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixYy,ixzw,Xyzw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,iy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixYy,izXy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izwy,Xzwx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izyX,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izyw,Xzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaX,iyYa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaX,iyaY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,ia,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaY,iyXa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,iyaX,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,iyaz,Xyxz->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaY,iyza,Xyxz->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixab,iYab,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixab,iYba,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iXYa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iXaY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYXa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iYaX,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYay,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYaz,Xyzx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,iYya,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,iYza,Xyzx->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,izYa,Xxzy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,izaY,Xxzy->IXJY', e_cvs, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,iY,yx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,ixYz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,ixzY,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,izYw,yzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,izYy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,izwY,yzwx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,izyY,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyY,ixXz,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyY,ixzX,yz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyY,ixzw,Xywz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,iy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyY,izXy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyY,izwy,Xzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,izyX,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,izyw,Xzxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iXYa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iXaY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYXa,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iYaX,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYay,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYaz,Xyzx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iYya,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYza,Xyxz->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,izYa,Xxyz->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,izaY,Xxzy->IXJY', e_cvs, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iXYw,xwzy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXYy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iXYz,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixyz,iXwY,xwzy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iXyY,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXzY,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iY,Xxyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYXy,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYXz,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYwy,Xzwx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYwz,Xyxw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iYyX,xz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYyw,Xzwx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYyz,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYzX,xy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYzw,Xywx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYzy,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iwYu,Xxuyzw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwYy,Xxwz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwYz,Xxyw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuwyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,IJ,ixyz,iwuY,Xxuwzy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuywz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuyzw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuzwy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuzyw->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iwyY,Xxwz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwzY,Xxwy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,ixYw,Xwyz->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,ixwY,Xwzy->IXJY', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,ijYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jiYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYa,ijxa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,jixa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijxy,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyz,Xxzy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,jiXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixa,ijYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixa,jiYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,ijYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jiYy,xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYa,ijxa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,jixa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijxy,Xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyx,Xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyz,Xxzy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,jiXy,xy->IXJY', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixa,ijYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixa,jiYa,Xx->IXJY', e_cvs, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixy,Jiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,XY,Iixy,Jizw,xyzw->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixy,Jizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixa,Iiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixa,iIya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iixz,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixy,Iiyz,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixy,Iizx,yz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iizy,xz->IXJY', e_cvs, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,iIxa,Jiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iIxa,iJya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,iJxa,Iiya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iJxa,iIya,xy->IXJY', e_cvs, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iX,ixYy,yx->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iX,ixyY,yx->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYa,ixay,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXYa,ixya,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXYx,iyxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXYx,iyzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaY,ixay,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXaY,ixya,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXax,iYay,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXax,iYya,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxY,iyxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxY,iyzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxa,iYay,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxa,iYya,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxy,iYyz,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXxy,iYzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxy,iYzy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXa,ixay,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYXa,ixya,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYXx,iy,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYXx,iyxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYXx,iyzw,xyzw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYXx,iyzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iYaX,ixay,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYaX,ixya,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYab,ixab,Xx->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYab,ixba,Xx->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iXay,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iXya,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,ia,Xx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iyax,Xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYax,iyaz,Xzxy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iyxa,Xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYax,iyza,Xzxy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('i,IJ,iYxX,iy,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iYxX,iyxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iYxX,iyzw,xyzw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxX,iyzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iXay,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iXya,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,ia,Xx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyax,Xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyaz,Xzxy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxa,iyxa,Xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxa,iyza,Xzyx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXxz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iXyz,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYxy,iXzw,yxwz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iXzx,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,iXzy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,ix,Xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,iy,Xx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iYxy,iz,Xzyx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuxyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuxzy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,IJ,iYxy,izwu,Xwuyxz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuyzx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuzxy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,iYxy,izwu,Xwuzyx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izwx,Xwyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izwy,Xwzx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,izxw,Xwyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iYxy,izxy,Xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izyw,Xwxz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iYxy,izyx,Xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iYax,Xx->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ia,iYxa,Xx->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ia,ixYa,Xx->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,ixaY,Xx->IXJY', e_val, np.identity(ncvs), t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,jiYy,xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,Xx->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYa,jixa,Xx->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijxy,Xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijyx,Xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijyz,Xxyz->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,jiXy,xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxa,jiYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYx,Xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,ijYy,Xx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYz,Xzxy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,jiYx,Xy->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYy,Xx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYz,Xzyx->IXJY', e_val, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijYy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,jiYy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYa,ijxa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYa,jixa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijXy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijxy,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijYx,ijyx,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,ijyz,Xxyz->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijYx,jiXy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxa,ijYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxa,jiYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYx,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,ijYy,Xx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,ijYz,Xzxy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxy,jiYx,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYy,Xx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxy,jiYz,Xzyx->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iXYy,xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ix,iXyY,xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iY,Xx->IXJY', e_val, np.identity(ncvs), t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iYxy,Xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ix,iYyx,Xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ix,iyYx,Xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iyYz,Xzxy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iyxY,Xy->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ix,iyzY,Xzyx->IXJY', e_val, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXa,iyYa,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXa,iyaY,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixXy,iY,yx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,ixYz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,ixzY,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixXy,izYw,yzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,izYy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixXy,izwY,yzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,izyY,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,ia,Xx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixYa,iyXa,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyaX,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyaz,Xyxz->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYa,iyza,Xyzx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixYy,ixXz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixYy,ixzX,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixYy,ixzw,Xyzw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,iy,Xx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixYy,izXy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izwy,Xzwx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izyX,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixYy,izyw,Xzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaX,iyYa,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaX,iyaY,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,ia,Xx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaY,iyXa,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,iyaX,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaY,iyaz,Xyxz->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaY,iyza,Xyxz->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixab,iYab,Xx->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixab,iYba,Xx->IXJY', e_val, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iXYa,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iXaY,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYXa,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iYaX,xy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYay,Xx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iYaz,Xyzx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,iYya,Xx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,iYza,Xyzx->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixay,izYa,Xxzy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,izaY,Xxzy->IXJY', e_val, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,iY,yx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,ixYz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,ixzY,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,izYw,yzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,izYy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,izwY,yzwx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,izyY,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyY,ixXz,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyY,ixzX,yz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyY,ixzw,Xywz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,iy,Xx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyY,izXy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyY,izwy,Xzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,izyX,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyY,izyw,Xzxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iXYa,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iXaY,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYXa,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iYaX,xy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYay,Xx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYaz,Xyzx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iYya,Xx->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iYza,Xyxz->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,izYa,Xxyz->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,izaY,Xxzy->IXJY', e_val, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iXYw,xwzy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXYy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iXYz,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixyz,iXwY,xwzy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iXyY,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXzY,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iY,Xxyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYXy,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYXz,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYwy,Xzwx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYwz,Xyxw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iYyX,xz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYyw,Xzwx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYyz,Xx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iYzX,xy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYzw,Xywx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iYzy,Xx->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyz,iwYu,Xxuyzw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwYy,Xxwz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwYz,Xxyw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuwyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,IJ,ixyz,iwuY,Xxuwzy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuywz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuyzw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuzwy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IJ,ixyz,iwuY,Xxuzyw->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iwyY,Xxwz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iwzY,Xxwy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,ixYw,Xwyz->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,ixwY,Xwzy->IXJY', e_val, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,ijYy,xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jiYy,xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYa,ijxa,Xx->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,jixa,Xx->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijXy,xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijxy,Xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyx,Xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyz,Xxzy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,jiXy,xy->IXJY', e_val, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixa,ijYa,Xx->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixa,jiYa,Xx->IXJY', e_val, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,ijYy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jiYy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYa,ijxa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYa,jixa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijXy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,ijxy,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyx,Xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiYx,ijyz,Xxzy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiYx,jiXy,xy->IXJY', e_val, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixa,ijYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixa,jiYa,Xx->IXJY', e_val, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixa,Jiya,xy->IXJY', e_val, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixa,iJya,xy->IXJY', e_val, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jixz,yz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixy,Jiyz,xz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,XY,Iixy,Jizw,xyzw->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Iixy,Jizx,yz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Iixy,Jizy,xz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixa,Iiya,xy->IXJY', e_val, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixa,iIya,xy->IXJY', e_val, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iixz,yz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixy,Iiyz,xz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,Jixy,Iizx,yz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,Jixy,Iizy,xz->IXJY', e_val, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,iIxa,Jiya,xy->IXJY', e_val, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iIxa,iJya,xy->IXJY', e_val, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,XY,iJxa,Iiya,xy->IXJY', e_val, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,XY,iJxa,iIya,xy->IXJY', e_val, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,Yyxa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,Yyxa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYax,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYax,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxa,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxa,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxy,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYyx,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iyYz,zy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,ix,iyzY,zy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYa,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYa,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYy,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaY,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixaY,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixay,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixay,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyY,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixya,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixya,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYwu,zyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyax,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyax,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxa,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxa,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iY,zy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwuY,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iY,zy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwYu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwuY,zwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyzx,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYax,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYax,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxa,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxa,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iYxy,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYxy,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iYyx,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Xx,IJ,iYyx,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iyYz,zy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,ix,iyzY,zy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYa,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYa,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixYy,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixYy,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaY,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixaY,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixay,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixay,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyY,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyY,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixya,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixya,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYwu,zyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyz,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixyz,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyax,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyax,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxa,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxa,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iY,zy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwuY,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iY,zy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwYu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwuY,zwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyzx,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xa,Yyza,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xa,yYza,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyYa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyYa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyab,Yzab,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xyab,Yzba,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xyza,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xyza,Ywua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyza,Ywza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xyza,wYua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,xyza,wYza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,yYxa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,yYxa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxYa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxYa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,yxza,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxza,Ywua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxza,Ywza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,yxza,wYua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,yxza,wYza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,yzxa,wuYa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,Xyxa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,Xyxa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXax,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXax,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxa,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxa,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxy,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXyx,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,ijya,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxa,jiya,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,ijya,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxa,jiya,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iy,Xy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,ix,iyXz,zy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iyzX,zy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iyzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXa,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXa,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXy,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixaX,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixaX,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixab,iyab,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixab,iyba,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,izwa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyX,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izwa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXwu,zyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvwyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvwzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvywz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvzwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,IJ,ixyz,iwuv,Xuvzyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwuy,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwuz,Xuwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyax,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyax,izwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxa,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iX,zy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwuX,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwuvy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yx,IJ,iyxz,iwuv,Xzwuyv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwvuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwvyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwyvu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iX,zy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwXu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuX,zwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuz,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXax,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXax,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxa,iyaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxa,iyza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iXxy,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXxy,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iXyx,izwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('Yx,IJ,iXyx,izyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,ijya,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxa,jiya,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxa,ijya,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxa,jiya,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ijxy,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ijxy,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iy,Xy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,ix,iyXz,zy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iyzX,zy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,ix,iyzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXa,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXa,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixXy,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixXy,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixaX,iyaz,zy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixaX,iyza,zy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixab,iyab,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixab,iyba,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixay,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,izwa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixay,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyX,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yx,IJ,ixyX,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixya,izwa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixya,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXwu,zyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iXyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvwyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvwzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvywz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,ixyz,iwuv,Xuvzwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,IJ,ixyz,iwuv,Xuvzyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwuy,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwuz,Xuwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,IJ,ixyz,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,ixyz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyax,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyax,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyax,izwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxa,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxa,izwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iX,zy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyxz,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwuX,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwuvy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yx,IJ,iyxz,iwuv,Xzwuyv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwvuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwvyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,iyxz,iwuv,Xzwyvu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyxz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iX,zy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwXu,zwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuX,zwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,iyzx,iwuz,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,iyzx,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xa,Xyza,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xa,yXza,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xa,ya,Xy->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xa,yzwa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xyXa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xyXa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xyab,Xzab,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyab,Xzba,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyab,zwab,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,Xwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,xyza,Xwza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,wXua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,wXza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,wa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,wuva,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,xyza,wuza,Xywu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,yXxa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,yXxa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxXa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxXa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,yxza,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxza,Xwua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxza,Xwza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,yxza,wXua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IJ,yxza,wXza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxza,wa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,yxza,wuva,Xyvuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yx,IJ,yxza,wuva,Xyvuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,yxza,wuva,Xyvwuz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,yxza,wuva,Xyvwzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,yxza,wuva,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,IJ,yxza,wuva,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IJ,yxza,wuza,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,yzxa,wa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,IJ,yzxa,wuXa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,yzxa,wuva,Xuwvyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,yzxa,wuva,Xuwvzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,yzxa,wuva,Xuwyvz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,IJ,yzxa,wuva,Xuwyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,yzxa,wuva,Xuwzvy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,IJ,yzxa,wuva,Xuwzyv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XxYa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XxYa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Xxab,Yzab,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Xxab,Yzba,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Xxza,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Xxza,Ywua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Xxza,Ywza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Xxza,wYua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Xxza,wYza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Xzxa,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Xzxa,Ywua,ywuz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,Xzxa,Ywya,zw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Xzxa,wYua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Xzxa,wYya,zw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,YxXa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,YxXa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Yxab,Xzab,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxab,Xzba,yz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxab,zwab,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,Xwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Yxza,Xwza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,wXua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,wXza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,wa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,wuva,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,Yxza,wuza,Xywu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Yzxa,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Yzxa,Xwua,ywuz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Yzxa,wXua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Yzxa,wa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,Yzxa,wuva,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,Yzxa,wuya,Xzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXYx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXYx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXYx,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXYx,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXax,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXax,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxY,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxY,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxY,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxY,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxa,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxa,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxz,iYwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXxz,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxz,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxz,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxz,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXzx,iYwu,yzuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXzx,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXzx,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXzx,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXzx,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYXx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYXx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYXx,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYXx,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYax,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYax,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYax,izwa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYax,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxX,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxX,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxX,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iYxX,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxa,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxa,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,izwa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxa,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iXwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxz,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvwyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvwzy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvywz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvzwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,iYxz,iwuv,Xuvzyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxz,iwuy,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iwuz,Xuwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxz,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iXwu,yzuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwuy,Xuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iwuz,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYzx,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijYx,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,ijYx,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxa,ijYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxa,jiYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,ijYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxz,ijYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijYx,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,ijYx,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxa,ijYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxa,jiYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,ijYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxz,ijYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iXYz,yz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iXzY,yz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iY,Xy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iYXz,yz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iYzX,yz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iYzw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,izYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,izwY,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXa,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXa,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwYu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwuY,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYa,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iwXu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwuX,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwuvy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixYz,iwuv,Xzwuyv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwvuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwvyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwyvu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaX,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaX,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaY,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaY,izwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixab,iYab,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixab,iYba,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYaw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYaz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iYwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iYza,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iwYa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iwaY,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwYu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwuY,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzX,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwXu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuX,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuz,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYaw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYaz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iYza,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iwYa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iwaY,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXYu,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXYz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXuY,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iXzY,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iY,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYXu,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYXz,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYuX,yuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzuvy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzuyv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzvuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixzw,iYuv,Xwzvyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzyuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzyvu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYuw,Xzyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYwu,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYwz,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iYzX,yw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYzu,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYzw,Xy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYv,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYw,Xyzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYz,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixzw,iuvY,Xyvuwz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvuzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvwuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvwzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuwY,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iuzY,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iwYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izXx,iwYy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izXx,iwuY,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izXx,iwyY,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izYx,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izYx,iw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izYx,iwXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izYx,iwuX,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywuvz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izYx,iwuv,Xywuzv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywvuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywzvu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iwuy,Xwuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iwyu,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iYaw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izax,iYwa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izax,iwYa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iwaY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iXYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXuY,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYuX,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYuw,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYwu,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvuwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izwx,iuYv,Xzvwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iuYw,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iuvY,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iuwY,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxX,iwYy,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwuY,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxX,iwyY,zw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwuX,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxY,iwuy,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxY,iwyu,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxY,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYaw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYwa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iwYa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iwaY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXYu,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXuY,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iY,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYXu,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iYuX,ywuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywuvz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywuzv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izxw,iYuv,Xywvuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywzvu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYuw,Xyzu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYwu,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuYv,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuYw,Xzyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izxw,iuvY,Xzvuwy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvwuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvwyu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuwY,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXYx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXYx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXYx,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXYx,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXax,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXax,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxY,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxY,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxY,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxY,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxa,iYaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxa,iYza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxz,iYwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXxz,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxz,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxz,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXxz,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXzx,iYwu,yzuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXzx,iYwy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXzx,iYwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXzx,iYyw,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXzx,iYzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYXx,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYXx,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYXx,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYXx,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYax,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYax,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYax,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYax,izwa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYax,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxX,iz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxX,izwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxX,izwy,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iYxX,izyw,wz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,iXaz,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxa,iXza,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,izaw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxa,izay,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxa,izwa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxa,izya,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iXwu,yzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYxz,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvwyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvwzy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvywz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,iYxz,iwuv,Xuvzwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,iYxz,iwuv,Xuvzyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxz,iwuy,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iwuz,Xuwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYxz,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYxz,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYxz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iXwu,yzuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iXwz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iXzw,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iwuv,Xuvyzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwuy,Xuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iYzx,iwuz,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwyu,Xuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iwyz,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iwzu,Xuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iYzx,iwzy,Xw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iYzx,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iYzx,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijYx,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,ijYx,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxa,ijYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxa,jiYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,ijYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxz,ijYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,ijYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,jiYz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijYx,ijXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ijYx,ijyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,ijzw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijYx,jiXz,yz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,ijYx,jiyz,Xz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxa,ijYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxa,jiYa,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,ijYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxz,ijYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYw,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxz,jiYz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iXYz,yz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iXzY,yz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iY,Xy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iYXz,yz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iYzX,yz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iYzw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,izYw,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,izwY,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXa,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXa,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwYu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwuY,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYa,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYa,izwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iwXu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixYz,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwuX,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwuvy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixYz,iwuv,Xzwuyv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwvuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwvyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixYz,iwuv,Xzwyvu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixYz,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaX,izYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaX,izaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,ia,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaY,izXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,izaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaY,izaw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaY,izwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixab,iYab,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixab,iYba,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYaw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iYaz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iYwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iYza,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaz,iwYa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iwaY,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwYu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwYz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwuY,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzX,iwzY,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iw,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwXu,yuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwXz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuX,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuv,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzY,iwuz,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iwzX,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iwzu,Xwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzY,iz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYaw,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYaz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iYwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iYza,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iwYa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iwaY,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXYu,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXYz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXuY,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iXzY,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iY,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYXu,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYXz,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYuX,yuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzuvy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzuyv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzvuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixzw,iYuv,Xwzvyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzyuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iYuv,Xwzyvu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYuw,Xzyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYuz,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYwu,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iYwz,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iYzX,yw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYzu,Xwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iYzw,Xy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYv,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYw,Xyzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuYz,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,ixzw,iuvY,Xyvuwz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvuzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvwuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvwzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,ixzw,iuvY,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iuwY,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iuzY,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iwYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izXx,iwYy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izXx,iwuY,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izXx,iwyY,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izYx,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izYx,iw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izYx,iwXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izYx,iwuX,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywuvz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izYx,iwuv,Xywuzv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywvuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izYx,iwuv,Xywzvu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iwuy,Xwuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iwyu,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izYx,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iYaw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izax,iYwa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izax,iwYa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iwaY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iXYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXuY,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYuX,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iYuw,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iYwu,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvuwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izwx,iuYv,Xzvwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izwx,iuYv,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iuYw,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iuvY,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iuwY,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwYu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxX,iwYy,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwuY,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxX,iwyY,zw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iw,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwXu,ywzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwuX,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxY,iwuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxY,iwuy,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxY,iwyu,Xwzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxY,iy,Xz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iXaY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iYaX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYaw,Xywz->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iYwa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iwYa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iwaY,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXYu,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXYw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXuY,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXwY,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iY,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYXu,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYXw,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iYuX,ywuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywuvz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywuzv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izxw,iYuv,Xywvuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywvzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywzuv->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iYuv,Xywzvu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYuw,Xyzu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iYwX,yz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iYwu,Xyuz->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuYv,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuYw,Xzyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,izxw,iuvY,Xzvuwy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvwuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvwyu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,izxw,iuvY,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iuwY,Xzuy->IXJY', h_aa, np.identity(ncvs), t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXYa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXYa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xXza,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXza,Ywua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXza,Ywza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xXza,wYua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xXza,wYza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYXa,za,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYXa,zwua,yuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xYza,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYza,Xwua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYza,Xwza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xYza,wXua,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xYza,wXza,yw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYza,wa,Xywz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xYza,wuva,Xyvuwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,xYza,wuva,Xyvuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xYza,wuva,Xyvwuz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xYza,wuva,Xyvwzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xYza,wuva,Xyvzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xYza,wuva,Xyvzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xYza,wuza,Xyuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xa,XzYa,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,Ya,Xy->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xa,YzXa,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,Yzwa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,zXYa,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,zYXa,yz->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,zYwa,Xzyw->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,zwYa,Xyzw->IXJY', h_aa, np.identity(ncvs), t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzXa,wuYa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzYa,wa,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzYa,wuXa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzYa,wuva,Xuwyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzab,Ywab,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzab,Ywba,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwa,XuYa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,Ya,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwa,YuXa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,Yuva,Xwuvyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,Yuwa,Xuyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,uXYa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,uYXa,yzwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xzwa,uYva,Xwuvyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xzwa,uYva,Xwuvzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xzwa,uYva,Xwuyvz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xzwa,uYva,Xwuyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,xzwa,uYva,Xwuzvy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,xzwa,uYva,Xwuzyv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,uYwa,Xuzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,uvYa,Xyzuwv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zXxa,Ya,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zXxa,Ywua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zXxa,Ywya,zw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zXxa,wYua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,zXxa,wYya,zw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zYxa,Xa,yz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zYxa,Xwua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zYxa,wXua,ywzu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zYxa,wa,Xzwy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zYxa,wuva,Xzvuwy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,zYxa,wuva,Xzvuyw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zYxa,wuva,Xzvwuy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zYxa,wuva,Xzvwyu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zYxa,wuva,Xzvyuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zYxa,wuva,Xzvywu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zYxa,wuya,Xzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zwxa,XuYa,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zwxa,Ya,Xywz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zwxa,YuXa,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,Yuva,Xyuvwz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,zwxa,Yuva,Xyuvzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,Yuva,Xyuwvz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,Yuva,Xyuwzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,Yuva,Xyuzvw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,Yuva,Xyuzwv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zwxa,uXYa,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zwxa,uYXa,yuzw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zwxa,uYva,Xyuwzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,uvYa,Xzwuvy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IJ,zwxa,uvYa,Xzwuyv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,uvYa,Xzwvuy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,uvYa,Xzwvyu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,uvYa,Xzwyuv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IJ,zwxa,uvYa,Xzwyvu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxXa,wuYa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxYa,wa,Xwzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxYa,wuXa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxYa,wuva,Xuwvyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxYa,wuva,Xuwvzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxYa,wuva,Xuwyvz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxYa,wuva,Xuwyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxYa,wuva,Xuwzvy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,zxYa,wuva,Xuwzyv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zxwa,XuYa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,Ya,Xwyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zxwa,YuXa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,Yuva,Xwuvyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,zxwa,Yuva,Xwuvzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,Yuva,Xwuyvz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,Yuva,Xwuyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,Yuva,Xwuzvy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,Yuva,Xwuzyv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,Yuwa,Xuzy->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,uXYa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,uYXa,yzuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,uYva,Xwuyzv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,uYwa,Xuyz->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IJ,zxwa,uvYa,Xyzuvw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,uvYa,Xyzuwv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,uvYa,Xyzvuw->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,uvYa,Xyzvwu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,uvYa,Xyzwuv->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IJ,zxwa,uvYa,Xyzwvu->IXJY', h_aa, np.identity(ncvs), t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iixa,Jiza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixa,iJza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixz,Jiwu,yzwu->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Iixz,Jiwy,zw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iixz,Jiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,XY,Iixz,Jiyw,zw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixz,Jizw,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iizx,Jiwu,yzuw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iizx,Jiwy,zw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iizx,Jiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Iizx,Jiyw,zw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iizx,Jizw,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iixa,Jiza,yz->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixa,iJza,yz->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixz,Jiwu,yzwu->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Iixz,Jiwy,zw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iixz,Jiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,XY,Iixz,Jiyw,zw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iixz,Jizw,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iizx,Jiwu,yzuw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,XY,Iizx,Jiwy,zw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Iizx,Jiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Iizx,Jiyw,zw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Iizx,Jizw,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ix,Jzwy,zw->IXJY', h_aa, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,XY,Ix,Jzyw,zw->IXJY', h_aa, np.identity(ncas), t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixab,Jzab,yz->IXJY', h_aa, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixab,Jzba,yz->IXJY', h_aa, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixaz,Ja,yz->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixaz,Jwau,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixaz,Jwaz,yw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixaz,Jwua,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixaz,Jwza,yw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixza,Ja,yz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixza,Jwau,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixza,Jwaz,yw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixza,Jwua,yuwz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixza,Jwza,yw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixzw,Juvw,yvuz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixzw,Juvz,yvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixzw,Juwv,yvzu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixzw,Juwz,yu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixzw,Juzv,yvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixzw,Juzw,yu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Ixzw,Jw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixzw,Jyuv,zwuv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Ixzw,Jz,yw->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Izax,Ja,yz->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Izax,Jwau,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,XY,Izax,Jway,zw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izax,Jwua,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izax,Jwya,zw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izwx,Juvw,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izwx,Juvy,zvuw->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Izwx,Juwv,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,XY,Izwx,Juwy,zu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izwx,Juyv,zvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izwx,Juyw,zu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Izwx,Jw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izwx,Jy,zw->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Izwx,Jzuv,ywvu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxa,Ja,yz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxa,Jwau,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izxa,Jway,zw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxa,Jwua,ywuz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,XY,Izxa,Jwya,zw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxw,Juvw,yuvz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izxw,Juvy,zvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxw,Juwv,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Izxw,Juwy,zu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,XY,Izxw,Juyv,zvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,XY,Izxw,Juyw,zu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Izxw,Jw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,XY,Izxw,Jy,zw->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Izxw,Jzuv,ywuv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jixa,Iiza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixa,iIza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixz,Iiwu,yzwu->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jixz,Iiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixz,Iizw,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jizx,Iiwu,yzuw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jizx,Iiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jizx,Iizw,yw->IXJY', h_aa, np.identity(ncas), t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jixa,Iiza,yz->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixa,iIza,yz->IXJY', h_aa, np.identity(ncas), t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixz,Iiwu,yzwu->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jixz,Iiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jixz,Iizw,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jizx,Iiwu,yzuw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jizx,Iiwz,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jizx,Iizw,yw->IXJY', h_aa, np.identity(ncas), t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxab,Izab,yz->IXJY', h_aa, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxab,Izba,yz->IXJY', h_aa, np.identity(ncas), t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxaz,Ia,yz->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxaz,Iwau,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxaz,Iwaz,yw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxaz,Iwua,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxaz,Iwza,yw->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxza,Ia,yz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxza,Iwau,yuzw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxza,Iwaz,yw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxza,Iwua,yuwz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxza,Iwza,yw->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxzw,Iuvw,yvuz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxzw,Iuvz,yvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxzw,Iuwv,yvzu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxzw,Iuwz,yu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxzw,Iuzv,yvwu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxzw,Iuzw,yu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jxzw,Iw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,Jxzw,Iz,yw->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Jzax,Ia,yz->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Jzax,Iwau,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzax,Iwua,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzwx,Iuvw,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Jzwx,Iuwv,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,XY,Jzwx,Iw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jzwx,Izuv,ywvu->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxa,Ia,yz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxa,Iwau,ywzu->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxa,Iwua,ywuz->IXJY', h_aa, np.identity(ncas), t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxw,Iuvw,yuvz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxw,Iuwv,yuzv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,XY,Jzxw,Iw,yz->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,Jzxw,Izuv,ywuv->IXJY', h_aa, np.identity(ncas), t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,iIxa,Jiza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,iIxa,iJza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,iJxa,Iiza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,iJxa,iIza,yz->IXJY', h_aa, np.identity(ncas), t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,iIxa,Jiza,yz->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,iIxa,iJza,yz->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,XY,iJxa,Iiza,yz->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,XY,iJxa,iIza,yz->IXJY', h_aa, np.identity(ncas), t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,ijyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,ijxz,jiyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,ijyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,ijxz,jiyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ix,iz,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ix,izwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ix,izwy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,ix,izyw,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixab,izab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixab,izba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixaz,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixaz,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixza,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iu,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,ixzw,iuvs,yvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuvw,yvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuvz,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,iy,iz,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,iy,izwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyab,izab,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyab,izba,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyaz,iwua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyaz,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyza,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iu,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,iyzw,iuvs,xvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuvw,xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuvz,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuwv,xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuwz,xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iuzw,xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izax,iway,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izax,iwya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izay,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izay,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izay,iwua,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuvy,wuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izwx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuyv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iu,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iuvw,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwy,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwy,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxa,iway,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,iwua,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxa,iwya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iu,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywusvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,izxw,iuvs,ywuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iuvw,yuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxw,iuvy,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxw,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iuyv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,iwua,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iu,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwusvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,izyw,iuvs,xwuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iuvw,xuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,ijyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,ijxz,jiyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,XYxy,ijxz,ijyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,ijxz,jiyw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ix,iz,yz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ix,izwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ix,izwy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,ix,izyw,wz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixab,izab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixab,izba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixaz,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixaz,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixaz,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixza,iwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixza,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iu,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,ixzw,iuvs,yvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,ixzw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuvw,yvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuvz,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,ixzw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,ixzw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,iy,iz,xz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,iy,izwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyab,izab,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyab,izba,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyaz,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyaz,iwua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyaz,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyza,iwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyza,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iu,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,iyzw,iuvs,xvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuvw,xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuvz,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuwv,xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iuwz,xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iuzw,xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,iyzw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,iyzw,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izax,iway,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izax,iwya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izay,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izay,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izay,iwua,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuvy,wuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izwx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuyv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izwx,iy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iu,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izwy,iuvw,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwy,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,izwy,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxa,iway,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxa,iwua,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxa,iwya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iu,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywusvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,izxw,iuvs,ywuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iuvw,yuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxw,iuvy,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XYxy,izxw,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iuyv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,XYxy,izxw,iy,wz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izya,iwua,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iu,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwusvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,izyw,iuvs,xwuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iuvw,xuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,izyw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xa,za,yz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xa,zwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xzab,wuab,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xzwa,ua,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xzwa,uvsa,yzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,xzwa,uvwa,yzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ya,za,xz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,ya,zwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,yzab,wuab,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,yzwa,ua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,yzwa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,yzwa,uvwa,xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,zwxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwxa,uvsa,yvuswz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwxa,uvsa,yvuszw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwxa,uvsa,yvuwsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwxa,uvsa,yvuwzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwxa,uvsa,yvuzsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,zwxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,XYxy,zwxa,uvya,zwuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XYxy,zwya,ua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwya,uvsa,xvuswz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwya,uvsa,xvuszw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwya,uvsa,xvuwsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwya,uvsa,xvuwzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XYxy,zwya,uvsa,xvuzsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,XYxy,zwya,uvsa,xvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,zxwa,ua,yzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zxwa,uvsa,yzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zxwa,uvsa,yzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zxwa,uvsa,yzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,zxwa,uvsa,yzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zxwa,uvsa,yzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zxwa,uvsa,yzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,zxwa,uvwa,yzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,zywa,ua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zywa,uvsa,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zywa,uvsa,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zywa,uvsa,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,XYxy,zywa,uvsa,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zywa,uvsa,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XYxy,zywa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XYxy,zywa,uvwa,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,ijyz,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,ijyz,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ix,iz,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ix,izwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixab,izab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixab,izba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixaz,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixaz,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixza,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iu,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,ixzw,iuvs,yvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuvw,yvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuvz,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,iy,iz,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,iy,izwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iy,izwx,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,iy,izxw,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyab,izab,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyab,izba,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyaz,iwua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyaz,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyza,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iu,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,iyzw,iuvs,xvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuvw,xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuvz,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuwv,xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuwz,xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iuzw,xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izay,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izay,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izay,iwax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izay,iwua,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izay,iwxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iu,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iuvw,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuvx,wuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwy,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izwy,iuwx,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuxv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuxw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwy,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,ix,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,iwua,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iu,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywusvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,izxw,iuvs,ywuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iuvw,yuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izya,iwax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,iwua,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izya,iwxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iu,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwusvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,izyw,iuvs,xwuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iuvw,xuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izyw,iuvx,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izyw,iuwx,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,iuxv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,iuxw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,ix,wz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,ijyz,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxa,ijza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxa,jiza,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijxz,ijzw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijxz,jizw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijya,ijza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijya,jiza,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,XxyY,ijyz,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ijyz,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,ijyz,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ijyz,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ix,iz,yz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ix,izwu,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixab,izab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixab,izba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixaz,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixaz,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixaz,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixza,iwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixza,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iu,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,ixzw,iuvs,yvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,ixzw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuvw,yvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuvz,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,ixzw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,ixzw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,iy,iz,xz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,iy,izwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iy,izwx,wz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,iy,izxw,wz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyab,izab,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyab,izba,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyaz,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyaz,iwua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyaz,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwau,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyza,iwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyza,iwza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iu,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvsuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvsuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvswuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,iyzw,iuvs,xvswzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvszuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,iyzw,iuvs,xvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuvw,xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuvz,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuwv,xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iuwz,xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iuzv,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iuzw,xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,iyzw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,iyzw,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izay,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izay,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izay,iwax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izay,iwua,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izay,iwxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iu,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izwy,iuvw,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuvx,wuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwy,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izwy,iuwx,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuxv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,iuxw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,izwy,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izwy,ix,wz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxa,iwua,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iu,ywuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywusvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,izxw,iuvs,ywuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iuvw,yuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,ia,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,iwau,xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izya,iwax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izya,iwua,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izya,iwxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iu,xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwusvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,izyw,iuvs,xwuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,izyw,iuvs,xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iuvw,xuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izyw,iuvx,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iuwv,xuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyY,izyw,iuwx,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,iuxv,wuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,iuxw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,izyw,iw,xz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,XxyY,izyw,ix,wz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xa,za,yz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xa,zwua,yuwz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xzab,wuab,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xzwa,ua,yzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xzwa,uvsa,yzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,xzwa,uvwa,yzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ya,za,xz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,ya,zwua,xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,yzab,wuab,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,yzwa,ua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,yzwa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,yzwa,uvwa,xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,zwxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwxa,uvsa,yvuswz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwxa,uvsa,yvuszw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwxa,uvsa,yvuwsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwxa,uvsa,yvuwzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwxa,uvsa,yvuzsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,zwxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,XxyY,zwya,ua,xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwya,uvsa,xvuswz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwya,uvsa,xvuszw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwya,uvsa,xvuwsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwya,uvsa,xvuwzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,XxyY,zwya,uvsa,xvuzsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,XxyY,zwya,uvsa,xvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyY,zwya,uvxa,zwuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,zxwa,ua,yzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zxwa,uvsa,yzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zxwa,uvsa,yzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zxwa,uvsa,yzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,zxwa,uvsa,yzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zxwa,uvsa,yzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zxwa,uvsa,yzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,zxwa,uvwa,yzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,zywa,ua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zywa,uvsa,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zywa,uvsa,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zywa,uvsa,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,XxyY,zywa,uvsa,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zywa,uvsa,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,XxyY,zywa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,XxyY,zywa,uvwa,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,Ywxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,Ywxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,Ywxa,uzva,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,Ywxa,za,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,Ywxa,zuva,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,Ywza,ua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,Ywza,uvsa,yvuxws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,Yyab,wuab,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,Yywa,ua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,Yywa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,Yywa,uvwa,xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iYax,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYax,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYaz,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYaz,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYaz,iwua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYwx,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYwx,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iYwx,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iuvw,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwz,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwz,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxa,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYxa,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxa,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxw,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxw,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYxw,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxz,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxz,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,iwua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywusvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywusxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuvsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iYzw,iuvs,ywuvxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuxsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iuvw,yuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYzx,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYzx,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijYy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,ijYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,jiYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,ijYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,jiYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,ijYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijYy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,ijYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,jiYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,ijYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,jiYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,ijYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwYy,iu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwYy,iuvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwax,iuYa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwax,iuaY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwax,izYa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwax,izaY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iway,iYau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iway,iYax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iway,iYaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iway,iYua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iway,iYxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iway,iYza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwaz,iuYa,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwaz,iuaY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,iY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivYs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivYu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvswz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwux,ivsY,yuvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwux,ivuY,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izYu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izYv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwux,izuY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izvY,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuy,iYuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iwuy,iYux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuy,iYvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuy,iYvu,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,iY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwuz,ivYs,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivYu,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivsY,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuz,ivuY,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxa,iuYa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxa,iuaY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxa,izYa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxa,izaY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivYs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivYu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivsY,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivuY,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izYu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izYv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izuY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izvY,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iuYv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxz,iuvY,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyY,iu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyY,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwya,iYau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwya,iYax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwya,iYaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwya,iYua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwya,iYxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwya,iYza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyu,iYuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwyu,iYvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyu,iYvu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYxv,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iwyu,iYzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuYa,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuaY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,iY,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivYs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivYu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwzu,ivsY,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivuY,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuYv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuvY,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iY,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iwYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ix,iwuY,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ix,izYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ix,izwY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYa,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYa,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaY,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaY,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixab,iYab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixab,iYba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaw,iYaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixaw,iYua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixaw,iYza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwa,iYau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwa,iYaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwa,iYwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYuv,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYuw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYuz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvs,ysvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYvu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwu,iYwu,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYzu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iy,iYwu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYwx,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iy,iYwz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iy,iYxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iyaw,iuYa,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iyaw,iuaY,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuYa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuaY,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,iY,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYs,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYw,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,iywu,ivsY,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivuY,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iywu,ivwY,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iY,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwuY,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,iwua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iu,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izYw,iuvs,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iuvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaY,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaY,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaY,iwua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izab,iYab,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izab,iYba,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaw,iYau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaw,iYaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaw,iYua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaw,iYwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iu,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iuvw,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwY,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwY,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwa,iYwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYuv,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYuw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izwu,iYvs,ysvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvwux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYvu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwu,iYwu,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwu,iYwv,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iYax,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYax,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYaz,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYaz,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYaz,iwua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,iYwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYwx,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYwx,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iYwx,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYwz,iuvw,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwz,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYwz,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxa,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYxa,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxa,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxw,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxw,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iYxw,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iYxw,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxz,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYxz,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYza,iwua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywusvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywusxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuvsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iYzw,iuvs,ywuvxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuxsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iYzw,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iuvw,yuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iYzw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYzx,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iYzx,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijYy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,ijYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,jiYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,ijYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,jiYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,ijYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijYy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijYy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijYy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiYa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,ijYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,jiYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiYw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,ijYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,jiYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiYa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,ijYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiYw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwYy,iu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwYy,iuvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwYy,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwYy,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwYy,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwax,iuYa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwax,iuaY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwax,izYa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwax,izaY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iway,iYau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iway,iYax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iway,iYaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iway,iYua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iway,iYxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iway,iYza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwaz,iuYa,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwaz,iuaY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,iY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivYs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivYu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvswz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwux,ivsY,yuvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsY,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwux,ivuY,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izYu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izYv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwux,izuY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izvY,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuy,iYuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iwuy,iYux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuy,iYvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuy,iYvu,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwuy,iYzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwuy,iYzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,iY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwuz,ivYs,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivYs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivYu,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivsY,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuz,ivuY,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxa,iuYa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxa,iuaY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxa,izYa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxa,izaY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iY,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivYs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivYu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivsY,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivuY,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izYu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izYv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izuY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izvY,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iuYv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxz,iuvY,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyY,iu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyY,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyY,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyY,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwya,iYau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwya,iYax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwya,iYaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwya,iYua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwya,iYxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwya,iYza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyu,iYuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwyu,iYvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwyu,iYvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyu,iYvu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyu,iYxv,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyu,iYzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Xxyz,iwyu,iYzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuYa,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuaY,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,iY,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivYs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivYu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwzu,ivsY,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsY,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivuY,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuYv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuvY,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iY,yz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iwYu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ix,iwuY,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ix,izYw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ix,izwY,yw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYa,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYa,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYa,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixYw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixYw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaY,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaY,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaY,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixab,iYab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixab,iYba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaw,iYaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixaw,iYua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaw,iYwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixaw,iYza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwY,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwY,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwa,iYau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwa,iYaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwa,iYwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwa,iYza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYuv,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYuw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYuz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvs,ysvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYvu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwu,iYwu,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwu,iYzu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixwu,iYzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iy,iYwu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYwx,zw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iy,iYwz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iy,iYxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iy,iYzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iyaw,iuYa,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iyaw,iuaY,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuYa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuaY,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,iY,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYs,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivYw,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,iywu,ivsY,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsY,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivuY,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iywu,ivwY,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iY,yx->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwYu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwuY,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYa,iwua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iu,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izYw,iuvs,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izYw,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iuvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izYw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaY,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaY,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaY,iwua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izab,iYab,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izab,iYba,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaw,iYau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaw,iYaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaw,iYua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaw,iYwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iu,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwY,iuvw,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwY,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwY,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwa,iYua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwa,iYwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYuv,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYuw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izwu,iYvs,ysvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvwux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izwu,iYvs,ysvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYvu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwu,iYvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwu,iYwu,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwu,iYwv,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wYxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wYxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wYxa,uzva,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wYxa,za,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wYxa,zuva,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wYza,ua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wYza,uvsa,yvuswx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wYza,uvsa,yvusxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wYza,uvsa,yvuwsx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,wYza,uvsa,yvuwxs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wYza,uvsa,yvuxsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wYza,uvsa,yvuxws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wuxa,vsYa,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wuxa,vzYa,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wuxa,zvYa,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wuya,Ya,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuya,Yvsa,xzvsuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,wuya,Yvsa,xzvswu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuya,Yvsa,xzvusw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuya,Yvsa,xzvuws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuya,Yvsa,xzvwsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuya,Yvsa,xzvwus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,wuya,Yvxa,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wuya,Yvza,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wuya,vYsa,xzvuws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wuya,vYxa,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wuya,vYza,xvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsYa,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsYa,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsYa,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,wuza,vsYa,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsYa,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsYa,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxYa,ua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxYa,uvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxYa,uvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wxua,Ya,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxua,Yvsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxua,Yvua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxua,Yvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wxua,vYsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wxua,vYua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,wxua,vYza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsYa,xzwsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsYa,xzwsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsYa,xzwusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsYa,xzwuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,wyua,vsYa,xzwvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsYa,xzwvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzYa,ua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzYa,uvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzYa,uvsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzYa,uvsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,wzYa,uvsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzYa,uvsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzYa,uvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzua,Ya,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzua,Yvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzua,Yvsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,wzua,Yvsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzua,Yvsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzua,Yvsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzua,Yvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzua,Yvua,ywvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzua,vYsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzua,vYua,ywxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xa,Ya,yz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xa,Ywua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xa,Ywza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xa,wYua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xa,wYza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwYa,ua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwYa,uvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwYa,uvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwab,Yuab,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwab,Yuba,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwua,Ya,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,xwua,Yvsa,ywsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,xwua,Yvsa,ywsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,xwua,Yvsa,ywsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,xwua,Yvsa,ywsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,xwua,Yvsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,xwua,Yvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwua,Yvua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwua,Yvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwua,vYsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwua,vYua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xwua,vYza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzYa,wa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzYa,wuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzab,Ywab,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xzab,Ywba,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xzwa,Ya,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xzwa,Yuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzwa,Yuwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xzwa,uYva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,xzwa,uYwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,yYwa,ua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,yYwa,uvsa,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,yYwa,uvsa,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,yYwa,uvsa,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,yYwa,uvsa,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,yYwa,uvsa,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,yYwa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,yYwa,uvwa,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ya,wuYa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ywua,vsYa,xzwvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,za,Ya,yx->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,za,Ywua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,za,wYua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwYa,ua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwYa,uvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwab,Yuab,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwab,Yuba,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwua,Ya,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwua,Yvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwua,Yvua,ywxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,zwua,vYsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,zwua,vYsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,zwua,vYsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,zwua,vYsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,zwua,vYsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,zwua,vYsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwua,vYua,ywvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxYa,wa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxYa,wuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,zxwa,Ya,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxwa,Yuva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxwa,Yuwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,zxwa,uYva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,zxwa,uYwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,Xwxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,Xwxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,Xwxa,uzva,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,Xwxa,za,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,Xwxa,zuva,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,Xwza,ua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,Xwza,uvsa,yvuxws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,Xyab,wuab,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,Xywa,ua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,Xywa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,Xywa,uvwa,xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iXax,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXax,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXaz,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXaz,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXaz,iwua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXwx,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXwx,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iXwx,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iuvw,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwz,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwz,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxa,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXxa,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxa,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxw,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxw,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXxw,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxz,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxz,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,iwua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywusvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywusxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuvsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iXzw,iuvs,ywuvxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuxsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iuvw,yuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXzx,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXzx,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijXy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxa,ijXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,jiXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxa,jiwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxw,ijXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,jiXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxz,ijXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,ijwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,jiXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijya,ijwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,ijxa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijya,ijza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijya,jiwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijya,jixa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,jiza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijxw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijyw,ijzw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijyw,jiwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixu,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jixz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jizu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jizw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,ijXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,jiwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijXy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxa,ijXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,jiXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxa,jiwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxw,ijXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,jiXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxz,ijXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,ijwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,jiXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijya,ijwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,ijxa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijya,ijza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijya,jiwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijya,jixa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,jiza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijxw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijyw,ijzw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijyw,jiwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixu,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jixz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jizu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jizw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,ijXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,jiwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwXy,iu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwXy,iuvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwax,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwax,iuXa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwax,iuaX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,Yxyz,iwax,iuav,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuva,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwax,izXa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwax,izaX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwax,izau,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwax,izua,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,iXau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iway,iXax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iXaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iway,iXua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iXxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iXza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,iuav,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iuax,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iuaz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iway,iuva,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iuxa,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iuza,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwaz,iuXa,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,iuaX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,iuav,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwaz,iuva,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,iX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwux,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,iv,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivXs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivXu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvswz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivsX,yuvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,iwux,ivst,Xyuvsztw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,iwux,ivst,Xyuvtzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivst,Xyuvwzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iwux,ivst,Xyuvzwst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwux,ivst,Xyuvzwts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivsu,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwux,ivuX,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,Yxyz,iwux,ivus,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izXu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izXv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwux,izuX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwux,izuv,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izvX,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwux,izvs,Xyuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izvu,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,iXuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iwuy,iXux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iXvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iXvu,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iv,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvzux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzxvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,ivsu,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivsx,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,ivus,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,ivux,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,ivuz,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwszvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivxu,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivxz,Xwuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzs,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzu,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzx,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ix,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,iX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,iv,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwuz,ivXs,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivXu,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivsX,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivst,Xyuvxwst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivsu,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,ivuX,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,ivus,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxa,iuXa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,iuaX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxa,iuav,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,iuva,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxa,izXa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izaX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izau,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izua,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,iX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,iv,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,ivXs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,ivXu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivsX,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvsztw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvszwt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvtzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvtzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvwzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvwzts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvzwst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvzwts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivsu,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivuX,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxu,ivus,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxu,izXu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxu,izXv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izuX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izuv,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvX,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvu,Xyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxz,iX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxz,iu,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxz,iuXv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxz,iuvX,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyX,iu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyX,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iXau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iXax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iXaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iXua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iXxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iXza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iuav,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuax,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuaz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvuzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwya,iuva,Xwvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvzux->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuxa,Xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iuza,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iXuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,iXvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iXvu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXxv,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iwyu,iXzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvuzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,iv,Xwvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvzux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvzux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/32 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/120 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/120 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzuvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzuxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzxvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsvzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsxvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwszvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwszxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwszvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivsz,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,ivus,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivux,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivuz,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxs,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxu,Xwzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxz,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzs,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzu,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzx,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ix,Xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuXa,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuaX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuav,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuwvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwza,iuva,Xyuxvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,iX,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuwvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuwxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,iv,Xyuxvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivXs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivXu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,ivsX,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxstw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxswt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxtsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxtws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxwst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxwts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvswx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivuX,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivus,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuXv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuvX,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ix,iX,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ix,iw,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ix,iwXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ix,iwuX,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,ix,iwuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ix,izXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ix,izwX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ix,izwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXa,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXa,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaX,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaX,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixab,iXab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixab,iXba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixab,iwab,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixab,iwba,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaw,iXaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iXua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iXza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,ixaw,iuav,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iuaw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iuaz,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuva,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuwa,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuza,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iXau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iXaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwa,iXwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwa,iuav,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuaw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuaz,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuva,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iuwa,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuza,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXuv,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXuw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXuz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvs,ysvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXvu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwu,iXwu,yz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXzu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iv,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,Yxyz,ixwu,ivst,Xystvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,ixwu,ivst,Xystvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystwzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystwzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzwuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzwvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivsu,Xysvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivsw,Xysuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xyszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xyszvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivsz,Xysuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xysvwz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xysvzw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyswvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivus,Xyswzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyszvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyszwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivuw,Xyvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivuz,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,ixwu,ivws,Xysuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xyszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xyszvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,ivwu,Xyvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,ivwz,Xyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivzs,Xysuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xyswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xyswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivzu,Xyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivzw,Xyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iz,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iXwu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXwx,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iXwz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iXxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iw,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iwuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwux,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwuz,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iwzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iwzx,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,ix,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iz,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyab,iwab,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyab,iwba,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuXa,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaX,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuav,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuva,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuwa,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuXa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuaX,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuav,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuaw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywa,iuva,Xwuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywa,iuwa,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,iX,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwvzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwxvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,iv,Xuwxzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwzvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwzxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXs,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXw,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,ivsX,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvstxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvstzx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvsxzt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvszxt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtsxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtszx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtxzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtzxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxstz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxszt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxtsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxtzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 97/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxzts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzstx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzsxt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvztsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iywu,ivst,Xuwvztxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzxst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzxts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvsxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvszx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,ivsu,Xwvxsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvzsx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvzxs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivsw,Xuvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivuX,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivus,Xwvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivuw,Xvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivwX,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivws,Xuvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivwu,Xvxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,iw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iX,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iw,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwuX,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,iwua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iu,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izXw,iuvs,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iuvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaX,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaX,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaX,iwua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izab,iXab,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izab,iXba,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izab,iwab,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izab,iwba,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iXau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iXaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iXua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iXwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iuav,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iuaw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iuva,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iuwa,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iu,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iuvw,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwX,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwX,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwa,iXwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iuav,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iuaw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvwux->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwa,iuva,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwa,iuwa,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXuv,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXuw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,iXvs,ysvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvwux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXvu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iXwu,yx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iXwv,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvwux->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,iv,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxwuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxwvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysvwx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysvxw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xyswvx->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xyswxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,ivsu,Xysxvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivsw,Xysxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivus,Xysxwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivuw,Xyxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,ivws,Xysxuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,ivwu,Xyxv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXax,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXax,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXax,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iXax,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXax,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXaz,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXaz,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXaz,iwua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwx,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXwx,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,iXwx,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXwx,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXwx,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iXwx,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXwz,iuvw,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwz,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXwz,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxa,iwau,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxa,iwua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXxa,izaw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxa,izwa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iuvs,ywuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxw,iuvw,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxw,iuwv,yuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXxw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxw,izuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iXxw,izuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iXxw,izwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxz,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXxz,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,iwau,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXza,iwua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywusvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywusxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuvsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iXzw,iuvs,ywuvxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuxsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iXzw,iuvs,ywuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iuvw,yuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iuwv,yuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iXzw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXzx,iw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iXzx,iwuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijXy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxa,ijXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,jiXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxa,jiwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxw,ijXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,jiXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxz,ijXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,ijwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,jiXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijya,ijwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,ijxa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijya,ijza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijya,jiwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijya,jixa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,jiza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijxw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijyw,ijzw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijyw,jiwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixu,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jixz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jizu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jizw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,ijXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,jiwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijXy,ijwu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,ijxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,ijzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijXy,jixw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijXy,jizw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxa,ijXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,ijwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxa,jiXa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxa,jiwa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,ijXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ijxw,ijXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,ijwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxw,jiXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiXw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxw,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijxz,ijXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,ijwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijxz,jiXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijya,ijwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,ijxa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijya,ijza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijya,jiwa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijya,jixa,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijya,jiza,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijyw,ijuv,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijyw,ijwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijxw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,ijxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,ijzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Yxyz,ijyw,ijzw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijyw,jiwu,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixu,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jixw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jixz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ijyw,jizu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,ijyw,jizw,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijza,ijwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiXa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijza,jiwa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,ijXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,Yxyz,ijzw,ijuv,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,ijwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXu,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ijzw,jiXw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ijzw,jiwu,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwXy,iu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwXy,iuvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwXy,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwXy,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwXy,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwax,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwax,iuXa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwax,iuaX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,Yxyz,iwax,iuav,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuav,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwax,iuva,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwax,iuva,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwax,izXa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwax,izaX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwax,izau,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwax,izua,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,iXau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iway,iXax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iXaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iway,iXua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iXxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iXza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iway,iuav,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iuax,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iway,iuaz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iway,iuva,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iuxa,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iway,iuza,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwaz,iuXa,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,iuaX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwaz,iuav,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwaz,iuva,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,iX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwux,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,iv,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,iv,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivXs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivXu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvswz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivsX,yuvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsX,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,iwux,ivst,Xyuvsztw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,iwux,ivst,Xyuvtzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwux,ivst,Xyuvwzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iwux,ivst,Xyuvzwst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwux,ivst,Xyuvzwts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivsu,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwux,ivsu,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwux,ivuX,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,Yxyz,iwux,ivus,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwux,ivus,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izXu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izXv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwux,izuX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwux,izuv,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izvX,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwux,izvs,Xyuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwux,izvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwux,izvu,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,iXuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iwuy,iXux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iXvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iXvu,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXvx,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iXzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,iXzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,iv,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvzux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstxzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iwuy,ivst,Xwstzxvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuy,ivsu,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivsx,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwuy,ivsz,Xwsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuy,ivus,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,ivux,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwuy,ivuz,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwuy,ivxs,Xwszvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivxu,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivxz,Xwuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzs,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzu,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ivzx,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,ix,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwuy,iz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,iX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,iv,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwuz,ivXs,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwuz,ivXs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivXu,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivsX,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivst,Xyuvxwst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwuz,ivsu,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,ivuX,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwuz,ivus,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxa,iuXa,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,iuaX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuvwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxa,iuav,Xyuwzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxa,iuav,Xyuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxa,iuva,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxa,izXa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izaX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izau,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxa,izua,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,iX,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,iv,Xyuvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,ivXs,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxu,ivXu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivsX,yuvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvsztw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvszwt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvtzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvtzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvwzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvwzts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvzwst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iwxu,ivst,Xyuvzwts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivsu,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxu,ivuX,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvswz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvszw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvwsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxu,ivus,Xyvwzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvzsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxu,ivus,Xyvzws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxu,izXu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwxu,izXv,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izuX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izuv,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvX,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iwxu,izvu,Xyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxz,iX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxz,iu,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,iwxz,iuXv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwxz,iuvX,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwxz,iuvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyX,iu,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyX,iuvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuvz,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuxv,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,iuxz,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iuzv,xuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iuzx,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyX,ix,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyX,iz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iXau,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iXax,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iXaz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iXua,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iXxa,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iXza,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwya,iuav,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuax,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuaz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvuzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwya,iuva,Xwvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvzux->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwya,iuva,Xwvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwya,iuxa,Xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwya,iuza,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iXuv,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXux,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXuz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,iXvs,xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iXvs,xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iXvu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXvx,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXvz,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXxu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,iXxv,zuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXxz,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXzu,xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iXzv,xuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,Yxyz,iwyu,iXzx,uw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvuzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,iv,Xwvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvzux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,iv,Xwvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvxuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvxzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvzux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstvzxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/32 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/120 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/120 * einsum('IJ,Yxyz,iwyu,ivst,Xwstxzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzuvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzuxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,iwyu,ivst,Xwstzxvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsvzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsxvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwszvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwyu,ivsu,Xwszxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwyu,ivsx,Xwszvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivsz,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwyu,ivus,Xwsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivux,Xwvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivuz,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxs,Xwszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxu,Xwzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ivxz,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzs,Xwsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzu,Xwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,ivzx,Xwvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iwyu,ix,Xwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iwyu,iz,Xwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuXa,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuaX,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwza,iuav,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuwvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwza,iuva,Xyuxvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwza,iuva,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,iX,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuwvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuwxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,iv,Xyuxvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,iv,Xyuxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivXs,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivXu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,ivsX,yuvswx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsX,yuvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxstw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxswt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxtsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxtws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxwst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,Yxyz,iwzu,ivst,Xyuvxwts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvswx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvsxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvwsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvwxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvxsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,iwzu,ivsu,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivuX,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzu,ivus,Xyvxws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuXv,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuvX,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iwzx,iuvs,Xyuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ix,iX,yz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ix,iw,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,ix,iwXu,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ix,iwuX,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,ix,iwuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ix,iwuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ix,izXw,yw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ix,izwX,yw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ix,izwu,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXa,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXa,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXa,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixXw,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixXw,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,ia,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,iwau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaX,iwaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaX,iwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaX,iwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixab,iXab,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixab,iXba,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixab,iwab,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixab,iwba,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixaw,iXaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iXua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iXwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iXza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,ixaw,iuav,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuav,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iuaw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixaw,iuaz,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixaw,iuva,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixaw,iuva,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuwa,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixaw,iuza,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iu,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvs,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iuwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iuwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iuzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwX,iw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwX,iz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iXau,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXaw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iXaz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwa,iXwa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iXza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,ia,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwa,iuav,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwa,iuav,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuaw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuaz,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuva,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwa,iuwa,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwa,iuza,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXuv,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXuw,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXuz,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvs,ysvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXvu,yvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvw,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXvz,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,ixwu,iXwu,yz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXwv,yvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXwz,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iXzu,yw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXzv,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iXzw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iu,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iv,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystuzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystuzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,Yxyz,ixwu,ivst,Xystvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,ixwu,ivst,Xystvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystwzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,ixwu,ivst,Xystwzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzwuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,ixwu,ivst,Xystzwvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivsu,Xysvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivsw,Xysuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xysvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xyszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivsw,Xyszvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivsz,Xysuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xysvwz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xysvzw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyswvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivus,Xyswzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyszvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivus,Xyszwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivuw,Xyvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivuz,Xywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,Yxyz,ixwu,ivws,Xysuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xysvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xyszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivws,Xyszvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,ivwu,Xyvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,ivwz,Xyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,ixwu,ivzs,Xysuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xysvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xyswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,ixwu,ivzs,Xyswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivzu,Xyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,ivzw,Xyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,ixwu,iw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,ixwu,iz,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iXwu,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXwx,zw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iXwz,xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iXxw,zw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iXzw,xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iw,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iy,iwuv,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwux,Xuwz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwuz,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwxu,Xuzw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,iwxz,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iwzu,Xuxw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iwzx,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iy,ix,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Yxyz,iy,iz,Xx->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyab,iwab,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyab,iwba,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuXa,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaX,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuav,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iyaw,iuaw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuva,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iyaw,iuwa,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,ia,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuXa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuaX,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuav,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywa,iuaw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywa,iuva,Xwuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywa,iuva,Xwuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywa,iuwa,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,iX,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,iu,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwvzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwxvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,iv,Xuwxzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwzvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,iv,Xuwzxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXs,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXu,xzwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivXw,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,ivsX,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsX,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvstxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvstzx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvsxzt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvszxt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtsxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtszx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtxzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvtzxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxstz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxszt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxtsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxtzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 97/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvxzts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzstx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzsxt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvztsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,iywu,ivst,Xuwvztxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzxst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,iywu,ivst,Xuwvzxts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvsxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvszx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,iywu,ivsu,Xwvxsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvzsx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,iywu,ivsu,Xwvzxs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivsw,Xuvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivuX,xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivus,Xwvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,iywu,ivuw,Xvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivwX,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivws,Xuvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,ivwu,Xvxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,iywu,iw,Xuxz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iX,yx->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iw,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwXu,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwuX,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,iz,iwuv,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXa,iwua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iu,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izXw,iuvs,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izXw,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iuvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izXw,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaX,ia,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaX,iwau,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaX,iwua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izab,iXab,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izab,iXba,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izab,iwab,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izab,iwba,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iXau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iXaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iXua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iXwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iuav,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izaw,iuaw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iuva,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izaw,iuwa,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iu,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iuvs,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwX,iuvw,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwX,iuwv,yvxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwX,iw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXau,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXaw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iXua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwa,iXwa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,ia,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iuav,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwa,iuaw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvwux->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwa,iuva,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwa,iuva,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwa,iuwa,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXuv,yvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXuw,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,iXvs,ysvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvwux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iXvs,ysvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXvu,yvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iXvw,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iXwu,yx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iXwv,yvux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,iu,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvwux->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,iv,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,iv,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxwuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,izwu,ivst,Xystxwvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysvwx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysvxw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xyswvx->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xyswxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,izwu,ivsu,Xysxvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,izwu,ivsu,Xysxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivsw,Xysxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivus,Xysxwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,izwu,ivuw,Xyxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,ivws,Xysxuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,ivwu,Xyxv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Yxyz,izwu,iw,Xyxu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wXxa,ua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wXxa,uvsa,yvuzws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wXxa,uzva,yuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wXxa,za,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wXxa,zuva,yuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wXza,ua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wXza,uvsa,yvuswx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wXza,uvsa,yvusxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wXza,uvsa,yvuwsx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wXza,uvsa,yvuwxs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wXza,uvsa,yvuxsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wXza,uvsa,yvuxws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wuxa,va,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wuxa,vsXa,yvszwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,wuxa,vsta,Xysvtzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,Yxyz,wuxa,vsta,Xysvtzwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,wuxa,vsta,Xysvuztw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,wuxa,vsta,Xysvuzwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,Yxyz,wuxa,vsta,Xysvwztu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/48 * einsum('IJ,Yxyz,wuxa,vsta,Xysvwzut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,wuxa,vsta,Xysvzutw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,wuxa,vsta,Xysvzuwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,Yxyz,wuxa,vsta,Xysvzwtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,Yxyz,wuxa,vsta,Xysvzwut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wuxa,vzXa,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvsuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvswu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvusw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvuws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvwsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuxa,vzsa,Xyvwus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wuxa,za,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wuxa,zvXa,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wuxa,zvsa,Xyvwsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wuya,Xa,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,Xvsa,xzvsuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wuya,Xvsa,xzvswu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,Xvsa,xzvusw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,Xvsa,xzvuws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,Xvsa,xzvwsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,Xvsa,xzvwus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,Yxyz,wuya,Xvxa,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wuya,Xvza,xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Yxyz,wuya,vXsa,xzvuws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wuya,vXxa,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wuya,vXza,xvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,va,Xwuvxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,va,Xwuvzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,va,Xwuxvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wuya,va,Xwuxzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,va,Xwuzvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuya,va,Xwuzxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutsvxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutsvzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutsxzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutszxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutvsxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutvszx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,wuya,vsta,Xwutvxzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,wuya,vsta,Xwutvzxs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutxsvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,Yxyz,wuya,vsta,Xwutxszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutxvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,Yxyz,wuya,vsta,Xwutxvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 97/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutxzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/160 * einsum('IJ,Yxyz,wuya,vsta,Xwutxzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutzsvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,wuya,vsta,Xwutzsxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutzvsx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,wuya,vsta,Xwutzvxs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,Yxyz,wuya,vsta,Xwutzxsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/160 * einsum('IJ,Yxyz,wuya,vsta,Xwutzxvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuya,vsxa,Xwusvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuya,vsxa,Xwuszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuya,vsxa,Xwuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,Yxyz,wuya,vsxa,Xwuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuya,vsxa,Xwuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wuya,vsxa,Xwuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wuya,vsza,Xwuxvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,va,Xyvuwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,va,Xyvuxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,va,Xyvwux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,va,Xyvwxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,va,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wuza,va,Xyvxwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,vsXa,yvsuwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,vsXa,yvsuxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,vsXa,yvswux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wuza,vsXa,yvswxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,vsXa,yvsxuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wuza,vsXa,yvsxwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxtuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxtwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxutw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxuwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxwtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,Yxyz,wuza,vsta,Xysvxwut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxXa,ua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxXa,uvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxXa,uvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wxua,Xa,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxua,Xvsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxua,Xvua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxua,Xvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wxua,vXsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wxua,vXua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,wxua,vXza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxua,va,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wxua,vsta,Xywtszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsta,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsta,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsta,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsta,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsta,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,wxua,vsta,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,wxua,vsta,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsua,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wxua,vsua,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsua,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsua,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsua,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wxua,vsua,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wxua,vsza,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,va,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,va,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wyua,va,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,va,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,va,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,va,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,vsXa,xzwsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,vsXa,xzwsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,vsXa,xzwusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,vsXa,xzwuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wyua,vsXa,xzwvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wyua,vsXa,xzwvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvtxwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvtxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvtzwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvtzxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,wyua,vsta,Xusvwtxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,Yxyz,wyua,vsta,Xusvwtzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvwxtz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvwxzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvwztx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvwzxt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvxtwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvxtzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/32 * einsum('IJ,Yxyz,wyua,vsta,Xusvxwtz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,Yxyz,wyua,vsta,Xusvxwzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/120 * einsum('IJ,Yxyz,wyua,vsta,Xusvxztw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/120 * einsum('IJ,Yxyz,wyua,vsta,Xusvxzwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvztwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvztxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvzwtx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,Yxyz,wyua,vsta,Xusvzwxt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,wyua,vsta,Xusvzxtw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,wyua,vsta,Xusvzxwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wyua,vsua,Xsvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzXa,ua,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzXa,uvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzXa,uvsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzXa,uvsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wzXa,uvsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzXa,uvsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzXa,uvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzua,Xa,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,Xvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,Xvsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wzua,Xvsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,Xvsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,Xvsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,Xvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzua,Xvua,ywvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzua,vXsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzua,vXua,ywxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,va,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,va,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,va,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,va,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,wzua,va,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,wzua,va,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Yxyz,wzua,vsta,Xywtxsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wzua,vsta,Xywtxsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wzua,vsta,Xywtxusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,Yxyz,wzua,vsta,Xywtxuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wzua,vsta,Xywtxvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Yxyz,wzua,vsta,Xywtxvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,wzua,vsua,Xywxsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xa,Xa,yz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xa,Xwua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xa,Xwza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xa,wXua,yuzw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xa,wXza,yw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xa,wa,Xywz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xa,wuva,Xyvuwz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,xa,wuva,Xyvuzw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xa,wuva,Xyvwuz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xa,wuva,Xyvwzu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xa,wuva,Xyvzuw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xa,wuva,Xyvzwu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xa,wuza,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xwXa,ua,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xwXa,uvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xwXa,uvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xwab,Xuab,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwab,Xuba,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwab,uvab,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,Xa,ywzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,Xvsa,ywsuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,Xvsa,ywsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,Xvsa,ywsvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,Xvsa,ywsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,Xvsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,xwua,Xvsa,ywszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xwua,Xvua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,Xvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,vXsa,ywszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,vXua,ywzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,vXza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,va,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,xwua,va,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,va,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,va,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,va,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,va,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,Yxyz,xwua,vsta,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,vsta,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,Yxyz,xwua,vsta,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('IJ,Yxyz,xwua,vsta,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,xwua,vsta,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xwua,vsua,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,vsza,Xywsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,vsza,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,vsza,Xywusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,xwua,vsza,Xywuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,vsza,Xywvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,xwua,vsza,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xzXa,wa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xzXa,wuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xzab,Xwab,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzab,Xwba,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzab,wuab,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,Xa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,Xuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,xzwa,Xuwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,uXva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,uXwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,ua,Xywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,uvsa,Xyswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,xzwa,uvwa,Xyuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,yXwa,ua,xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,yXwa,uvsa,xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,yXwa,uvsa,xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,yXwa,uvsa,xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,yXwa,uvsa,xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,yXwa,uvsa,xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,yXwa,uvsa,xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,yXwa,uvwa,xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ya,wa,Xwxz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ya,wuXa,xzwu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ya,wuva,Xuwxzv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvwxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvwzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvxwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 5/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvzwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,ywab,uvab,Xuvzxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ywua,va,Xuvxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,ywua,vsXa,xzwvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvtxwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvtxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvtzwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvtzxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,ywua,vsta,Xusvwtxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,Yxyz,ywua,vsta,Xusvwtzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvwxtz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvwxzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvwztx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvwzxt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,ywua,vsta,Xusvxtwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,ywua,vsta,Xusvxtzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvxwtz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvxwzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,ywua,vsta,Xusvxztw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,Yxyz,ywua,vsta,Xusvxzwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,ywua,vsta,Xusvztwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,Yxyz,ywua,vsta,Xusvztxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvzwtx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,Yxyz,ywua,vsta,Xusvzwxt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,ywua,vsta,Xusvzxtw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,Yxyz,ywua,vsta,Xusvzxwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ywua,vsua,Xvswxz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ywua,vsua,Xvswzx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ywua,vsua,Xvsxwz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,ywua,vsua,Xvsxzw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ywua,vsua,Xvszwx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,ywua,vsua,Xvszxw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,za,Xa,yx->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,za,Xwua,yuwx->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,za,wXua,yuxw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,za,wa,Xyxw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,za,wuva,Xyvxuw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwXa,ua,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwXa,uvsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwab,Xuab,ywxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwab,Xuba,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,zwab,uvab,Xywuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,zwab,uvab,Xywuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,zwab,uvab,Xywvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,zwab,uvab,Xywvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 5/24 * einsum('IJ,Yxyz,zwab,uvab,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,Yxyz,zwab,uvab,Xywxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,Xa,ywux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,Xvsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,Xvua,ywxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vXsa,ywsuvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,zwua,vXsa,ywsuxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vXsa,ywsvux->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vXsa,ywsvxu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vXsa,ywsxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vXsa,ywsxvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,vXua,ywvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,va,Xywxuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zwua,vsta,Xywtxusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vsua,Xywsvx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vsua,Xywsxv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vsua,Xywvsx->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vsua,Xywvxs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zwua,vsua,Xywxsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,zwua,vsua,Xywxvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxXa,wa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxXa,wuva,yvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,zxwa,Xa,yw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxwa,Xuva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxwa,Xuwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,zxwa,uXva,yvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Yxyz,zxwa,uXwa,yu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxwa,ua,Xyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zxwa,uvsa,Xysuvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zxwa,uvsa,Xysuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zxwa,uvsa,Xysvuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Yxyz,zxwa,uvsa,Xysvwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zxwa,uvsa,Xyswuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Yxyz,zxwa,uvsa,Xyswvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Yxyz,zxwa,uvwa,Xyvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,Xuxa,Ya,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,Xuxa,Yvsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Xuxa,Yvwa,zuyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,Xuxa,Yvya,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xuxa,Yzva,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Xuxa,vYsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Xuxa,vYsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Xuxa,vYsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,Xuxa,vYsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Xuxa,vYsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Xuxa,vYsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Xuxa,vYwa,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Xuxa,vYya,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xuxa,zYva,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,XxYa,ua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxYa,uvsa,zvuswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxYa,uvsa,zvusyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxYa,uvsa,zvuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,XxYa,uvsa,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxYa,uvsa,zvuysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxYa,uvsa,zvuyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,XxYa,uvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Xxab,Yuab,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxab,Yuba,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxua,Ya,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxua,Yvsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Xxua,Yvua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxua,Yvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Xxua,vYsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Xxua,vYsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Xxua,vYsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Xxua,vYsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Xxua,vYsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Xxua,vYsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxua,vYua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Xxua,vYza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,Yuxa,Xa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,Yuxa,Xvsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Yuxa,vXsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Yuxa,vXsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Yuxa,vXsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,Yuxa,vXsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Yuxa,vXsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,Yuxa,vXsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,Yuxa,va,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yuxa,vsta,Xzutsvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yuxa,vsta,Xzutsvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutsywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwvsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwvys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwysv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,Yuxa,vsta,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,Yuxa,vsta,Xzutyvsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,Yuxa,vsta,Xzutyvws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 61/240 * einsum('IJ,xyzw,Yuxa,vsta,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,Yuxa,vsta,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,vswa,Xzusvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,vswa,Xzusyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,vswa,Xzuvsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,vswa,Xzuvys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,vswa,Xzuysv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,Yuxa,vswa,Xzuyvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Yuxa,vsya,Xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yuxa,vzsa,Xusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yuxa,za,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yuxa,zvsa,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yuxa,zvsa,Xusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yuxa,zvsa,Xuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yuxa,zvsa,Xuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yuxa,zvsa,Xusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yuxa,zvsa,Xusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,YxXa,ua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,YxXa,uvsa,zvuswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,YxXa,uvsa,zvusyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,YxXa,uvsa,zvuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,YxXa,uvsa,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,YxXa,uvsa,zvuysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,YxXa,uvsa,zvuyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,YxXa,uvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Yxab,Xuab,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxab,Xuba,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yxab,uvab,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxab,uvab,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxab,uvab,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxab,uvab,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxab,uvab,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxab,uvab,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxua,Xa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxua,Xvsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,Yxua,Xvua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vXsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vXsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vXsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yxua,vXsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vXsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vXsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxua,vXua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxua,va,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtusvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/60 * einsum('IJ,xyzw,Yxua,vsta,Xywtuszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yxua,vsta,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('IJ,xyzw,Yxua,vsta,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,Yxua,vsta,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtvszu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,Yxua,vsta,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,Yxua,vsta,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,Yxua,vsta,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,Yxua,vsta,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,Yxua,vsta,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,Yxua,vsta,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,Yxua,vsta,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vsua,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vsua,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,Yxua,vsua,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vsua,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vsua,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,Yxua,vsua,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,Yxua,vsza,Xywusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXYx,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXYx,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iXYx,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXax,iYau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXax,iYaw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXax,iYay,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXax,iYua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXax,iYwa,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXax,iYya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXux,iYuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYuw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXux,iYuy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXux,iYvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXux,iYvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYvw,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYwu,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYwv,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYyu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxY,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iXxY,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxY,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXxa,iYau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxa,iYaw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxa,iYay,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxa,iYua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxa,iYwa,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxa,iYya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXxu,iYuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYuw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYuy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxu,iYvs,zsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxu,iYvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYwu,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxu,iYyu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXzx,iYuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXzx,iYuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYuy,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXzx,iYyu,wu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYXx,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYXx,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYXx,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,iXau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYax,iXua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,iuav,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYax,iuaw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYax,iuay,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYax,iuva,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,iuwa,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,iuya,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,izau,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYax,izua,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,iXuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iXvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iXvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,iYux,ivst,Xzstuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,iYux,ivst,Xzstuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstwuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstwuyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstwvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstwvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstwyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstwyvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstyuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstyuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstyvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstyvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,xyzw,iYux,ivst,Xzstywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,ivsu,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsuyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYux,ivsw,Xzsyvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivsy,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,ivus,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYux,ivuw,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYux,ivuy,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivws,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivwu,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivwy,Xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYux,ivys,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivyu,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivyw,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,iw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,iy,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,izuv,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,izvs,Xsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYux,izvu,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxX,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iYxX,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxX,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,iXau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxa,iXua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,iuav,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuaw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuay,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxa,iuva,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuwa,Xzuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxa,iuya,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxa,izau,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxa,izua,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,iXuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,iXvs,zsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxu,iXvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,iv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 2/15 * einsum('IJ,xyzw,iYxu,ivst,Xzstuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/60 * einsum('IJ,xyzw,iYxu,ivst,Xzstuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,iYxu,ivst,Xzstwuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/40 * einsum('IJ,xyzw,iYxu,ivst,Xzstwuyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstwvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstwvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,xyzw,iYxu,ivst,Xzstwyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstwyvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstyuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('IJ,xyzw,iYxu,ivst,Xzstyuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstyvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstyvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,iYxu,ivst,Xzstywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('IJ,xyzw,iYxu,ivst,Xzstywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,ivsu,Xzsvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivsw,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivsy,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,ivus,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivuw,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivuy,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivws,Xzsuyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsvuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsyvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivwu,Xzvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivwy,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 2/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,ivyu,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,ivyw,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,iw,Xzuy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,iy,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izuv,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izvs,Xsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izvu,Xvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iXuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iuvs,Xvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuvw,Xvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuvy,Xvuw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iuwv,Xvyu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iuwy,Xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuyv,Xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuyw,Xu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iw,Xy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iy,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,ijYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,ijYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijXx,ijYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,jiYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijXx,jiYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,jiYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijYx,ijXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijYx,ijuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijwu,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijYx,jiXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxa,ijYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxa,jiYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxu,ijYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,ijYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,jiYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxz,ijYu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,ijYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,ijYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijXx,ijYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,jiYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijXx,jiYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,jiYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijYx,ijXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijYx,ijuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijwu,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijYx,jiXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxa,ijYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxa,jiYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxu,ijYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,ijYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,jiYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxz,ijYu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuXx,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuXx,ivYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuXx,ivYw,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuXx,ivYy,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivsY,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,ivwY,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,ivyY,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,izYv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuXx,izvY,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuYx,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,iv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuYx,ivXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivsX,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuYx,ivst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,iuYx,ivst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuYx,ivst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuYx,ivsw,Xyvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivsy,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivws,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivwy,Xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuYx,ivys,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivyw,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,iw,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,iy,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuYx,izvs,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuax,iYav,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYva,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivYa,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuax,ivaY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iXsY,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iYsX,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,iYst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuvx,iYst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsv,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iYvs,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwvsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYt,Xzutwvys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwysv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYt,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutyvsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isYv,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuvx,istY,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,isvY,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxX,ivYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivYw,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivYy,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,ivsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivwY,zuyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxX,ivyY,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxX,izYv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxX,izvY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,iv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxY,ivXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,ivsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/60 * einsum('IJ,xyzw,iuxY,ivst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('IJ,xyzw,iuxY,ivst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,ivsw,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivsy,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivws,Xyvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,ivwy,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 2/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxY,ivyw,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,iw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxY,iy,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywsuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywusv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,izvs,Xywuvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywvsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxa,iYav,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iYva,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,ivYa,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxa,ivaY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iYsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYsv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxv,iYvs,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,isYt,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,isYv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,iuxv,istY,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,iuxv,istY,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,iuxv,istY,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,xyzw,iuxv,istY,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxv,isvY,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iXYv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iXvY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iY,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iYXv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iYvX,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iYvs,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxz,ivYs,Xusywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,ivsY,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iXYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iXuY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iY,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iYXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iYuX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,ix,iYuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iuYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,ix,iuvY,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXa,iuYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXa,iuaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixXu,ivYs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivYz,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivsY,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivzY,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYa,iuXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuaz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYa,iuva,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuza,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYu,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,iv,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixYu,ivXs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYu,ivXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivsX,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvstwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvstyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvswty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixYu,ivst,Xzuvswyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvsytw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivst,Xzuvsywt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwsty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwtys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwyst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwyts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,ixYu,ivst,Xzuvystw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvyswt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,ixYu,ivst,Xzuvytsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvytws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvywst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvywts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivsu,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivsz,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivuz,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivzs,Xuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivzu,Xvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,iz,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaX,iuYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaX,iuaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuaz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuza,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixab,iYab,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixab,iYba,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iYau,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixau,iYav,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixau,iYua,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYva,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivYa,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixau,ivaY,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuX,ivYs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivYz,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivsY,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuX,ivuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivzY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iv,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuY,ivXs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivsX,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvstwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvstyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvswty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvswyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvsytw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvsywt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwsty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwtys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwyst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwyts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvystw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvyswt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvytsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvytws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 61/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvywst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvywts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuY,ivsz,Xuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivuz,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivzs,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivzu,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYau,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixua,iYav,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iYua,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,ivYa,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixua,ivaY,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXYs,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXsY,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iXuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYXs,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYsX,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvustwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvustyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuswty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvuswyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvusytw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,ixuv,iYst,Xzvusywt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvutwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvutwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,xyzw,ixuv,iYst,Xzvutyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwsty->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwtys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 31/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwyst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwyts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvuystw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvuyswt->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,ixuv,iYst,Xzvuytsw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuytws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuywst->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuywts->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYsu,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYsv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iYuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixuv,iYus,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYuv,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYvs,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYvu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixuv,isYt,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixuv,isYt,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isYu,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,isYv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,ixuv,istY,Xywtsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtszuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/480 * einsum('IJ,xyzw,ixuv,istY,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtusvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('IJ,xyzw,ixuv,istY,Xywtuszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('IJ,xyzw,ixuv,istY,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 49/240 * einsum('IJ,xyzw,ixuv,istY,Xywtvszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('IJ,xyzw,ixuv,istY,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,ixuv,istY,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,ixuv,istY,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixuv,isuY,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isvY,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXYx,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXYx,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXYx,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXYx,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXYx,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iXYx,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXax,iYau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXax,iYaw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXax,iYay,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXax,iYua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXax,iYwa,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXax,iYya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXux,iYuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYuw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXux,iYuy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXux,iYvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXux,iYvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYvw,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYwu,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYwv,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXux,iYyu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXux,iYyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxY,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iXxY,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxY,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxY,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxY,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxY,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXxa,iYau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxa,iYaw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxa,iYay,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxa,iYua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxa,iYwa,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxa,iYya,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXxu,iYuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYuw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYuy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxu,iYvs,zsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXxu,iYvs,zsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxu,iYvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYwu,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxu,iYwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxu,iYyu,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxu,iYyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXzx,iYuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXzx,iYuw,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYuy,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXzx,iYwu,yu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXzx,iYyu,wu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYXx,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYXx,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYXx,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYXx,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYXx,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYXx,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,iXau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYax,iXua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYax,iuav,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYax,iuaw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYax,iuay,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYax,iuva,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,iuwa,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,iuya,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYax,izau,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYax,izua,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,iXuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iXvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iXvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,iv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,iYux,ivst,Xzstuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,iYux,ivst,Xzstuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstwuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstwuyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstwvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstwvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstwyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstwyvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstyuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,iYux,ivst,Xzstyuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstyvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,iYux,ivst,Xzstyvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,xyzw,iYux,ivst,Xzstywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYux,ivst,Xzstywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYux,ivsu,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsuyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivsw,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYux,ivsw,Xzsyvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivsy,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYux,ivus,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYux,ivuw,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYux,ivuy,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivws,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivwu,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivwy,Xzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYux,ivys,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,ivys,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivyu,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,ivyw,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,iw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,iy,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYux,izuv,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iYux,izvs,Xsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYux,izvs,Xsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYux,izvu,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxX,iu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iYxX,iuvs,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxX,iuvs,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuvw,zvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuvy,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuwv,zvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iuwy,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iuyv,zvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iuyw,zu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxX,iw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iYxX,iy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxX,izuv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,iXau,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxa,iXua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxa,iuav,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuaw,Xzyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuay,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxa,iuva,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxa,iuva,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxa,iuwa,Xzuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxa,iuya,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxa,izau,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxa,izua,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,iXuv,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,iXvs,zsvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iXvs,zsvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iYxu,iXvu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,iv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,iv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 2/15 * einsum('IJ,xyzw,iYxu,ivst,Xzstuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/60 * einsum('IJ,xyzw,iYxu,ivst,Xzstuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,iYxu,ivst,Xzstwuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/40 * einsum('IJ,xyzw,iYxu,ivst,Xzstwuyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstwvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstwvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,xyzw,iYxu,ivst,Xzstwyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstwyvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/120 * einsum('IJ,xyzw,iYxu,ivst,Xzstyuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('IJ,xyzw,iYxu,ivst,Xzstyuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstyvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,iYxu,ivst,Xzstyvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,iYxu,ivst,Xzstywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('IJ,xyzw,iYxu,ivst,Xzstywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iYxu,ivsu,Xzsvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iYxu,ivsu,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivsw,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivsy,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivsy,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYxu,ivus,Xzsywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivuw,Xzyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivuy,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivws,Xzsuyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsvuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsyuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iYxu,ivws,Xzsyvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivwu,Xzvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,ivwy,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsuvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 2/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzsvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzswuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iYxu,ivys,Xzswvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,ivyu,Xzvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,ivyw,Xzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYxu,iw,Xzuy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYxu,iy,Xzuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izuv,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izvs,Xsvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iYxu,izvu,Xvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iXuv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iYzx,iuvs,Xvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuvw,Xvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuvy,Xvuw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iuwv,Xvyu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iuwy,Xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuyv,Xvwu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iuyw,Xu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iYzx,iw,Xy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iYzx,iy,Xw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,ijYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,ijYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijXx,ijYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,jiYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijXx,jiYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,jiYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijYx,ijXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijYx,ijuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijwu,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijYx,jiXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxa,ijYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxa,jiYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxu,ijYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,ijYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,jiYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxz,ijYu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,ijYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,ijYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijXx,ijYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,jiYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijXx,jiYw,zy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijXx,jiYy,zw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijYx,ijXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijYx,ijuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijYx,ijuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijwu,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,ijyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijYx,jiXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijYx,jiwu,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyu,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijYx,jiyw,Xz->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxa,ijYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxa,jiYa,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxu,ijYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,ijYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxu,jiYu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ijxu,jiYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxz,ijYu,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuXx,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuXx,ivYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuXx,ivYw,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuXx,ivYy,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivsY,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsY,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,ivwY,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,ivyY,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuXx,izYv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuXx,izvY,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuYx,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,iv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,iv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuYx,ivXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuYx,ivsX,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivsX,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuYx,ivst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuYx,ivst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuYx,ivst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,iuYx,ivst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuYx,ivst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuYx,ivst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuYx,ivsw,Xyvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivsw,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivsy,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivws,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivwy,Xvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuYx,ivys,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuYx,ivys,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,ivyw,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,iw,Xyzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuYx,iy,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuYx,izvs,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuax,iYav,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYav,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,iYva,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,iYva,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivYa,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuax,ivYa,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuax,ivaY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuax,ivaY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iXsY,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsY,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iYsX,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsX,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,iYst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuvx,iYst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,iuvx,iYst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,iuvx,iYst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuvx,iYst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYsv,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iYsv,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iYvs,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iYvs,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwvsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYt,Xzutwvys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,iuvx,isYt,Xzutwysv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYt,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutyvsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,isYt,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isYv,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,isYv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuvx,istY,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuvx,istY,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,isvY,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,isvY,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxX,ivYs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivYs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivYw,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivYy,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,ivsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxX,ivwY,zuyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxX,ivyY,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxX,izYv,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxX,izvY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,iv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxY,ivXs,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxY,ivXs,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxY,ivsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvsuzt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvszut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvtuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvtzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvustz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/60 * einsum('IJ,xyzw,iuxY,ivst,Xywvuszt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvutsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvutzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('IJ,xyzw,iuxY,ivst,Xywvuzst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvuzts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvzsut->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,iuxY,ivst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvztus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,iuxY,ivst,Xywvzust->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,iuxY,ivst,Xywvzuts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,ivsw,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivsy,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivsy,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivws,Xyvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,ivws,Xyvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,ivwy,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 2/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,iuxY,ivys,Xwvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxY,ivyw,Xvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxY,iw,Xyuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxY,iy,Xwuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywsuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywusv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,iuxY,izvs,Xywuvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywvsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,iuxY,izvs,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxa,iYav,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,iYav,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iYva,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,ivYa,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxa,ivaY,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxa,ivaY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXsY,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iY,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXs,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iYsX,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvstzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvsztu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvtszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvtzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvzstu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,iuxv,iYst,Xywvztsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iYsv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxv,iYvs,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,iYvs,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,isYt,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,isYv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,iuxv,istY,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,iuxv,istY,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,iuxv,istY,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,xyzw,iuxv,istY,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,iuxv,istY,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxv,isvY,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxv,isvY,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iXYv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iXvY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iY,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iYXv,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iYvX,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iYvs,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxz,ivYs,Xusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxz,ivYs,Xusywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,ivsY,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iXYu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iXuY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iY,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iYXu,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iYuX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,ix,iYuv,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iYuv,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iuYv,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,ix,iuvY,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ix,iuvY,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_va, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXa,iuYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXa,iuaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixXu,ivYs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivYs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivYz,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivsY,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsY,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivzY,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYa,iuXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuaz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYa,iuva,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYa,iuva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYa,iuza,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYu,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,iv,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,iv,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixYu,ivXs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivXs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixYu,ivXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivsX,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsX,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvstwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvstyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvswty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixYu,ivst,Xzuvswyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvsytw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivst,Xzuvsywt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,ixYu,ivst,Xzuvtyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwsty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwtys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwyst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvwyts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,ixYu,ivst,Xzuvystw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvyswt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,ixYu,ivst,Xzuvytsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,ixYu,ivst,Xzuvytws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvywst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,ixYu,ivst,Xzuvywts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivsu,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivsz,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivuz,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixYu,ivzs,Xuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixYu,ivzs,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,ivzu,Xvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixYu,iz,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaX,iuYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaX,iuaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,ia,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaY,iuaz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaY,iuza,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixab,iYab,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixab,iYba,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iYau,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixau,iYav,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixau,iYua,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,iYva,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,iYva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivYa,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixau,ivYa,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixau,ivaY,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixau,ivaY,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,iY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuX,ivYs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivYs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivYz,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivsY,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuX,ivuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivzY,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,iu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iv,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuY,ivXs,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivXs,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivsX,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvstwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvstyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvswty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvswyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvsytw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvsywt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvtyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwsty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwtys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwyst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvwyts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvystw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvyswt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/480 * einsum('IJ,xyzw,ixuY,ivst,Xzuvytsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuY,ivst,Xzuvytws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 61/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvywst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('IJ,xyzw,ixuY,ivst,Xzuvywts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuY,ivsz,Xuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuY,ivsz,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuY,ivuz,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivzs,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,ivzu,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuY,iz,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iXaY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iYaX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYau,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixua,iYav,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,iYav,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iYua,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iYva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,ivYa,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixua,ivaY,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixua,ivaY,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXYs,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXYu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXYv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXsY,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iXuY,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXvY,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iY,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_va, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYXs,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYXu,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYXv,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYsX,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvustwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvustyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuswty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvuswyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvusytw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,ixuv,iYst,Xzvusywt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvutwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvutwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvutysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,xyzw,ixuv,iYst,Xzvutyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwsty->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwtys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 31/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwyst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuwyts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,ixuv,iYst,Xzvuystw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,ixuv,iYst,Xzvuyswt->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,ixuv,iYst,Xzvuytsw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuytws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuywst->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,iYst,Xzvuywts->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYsu,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYsu,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYsv,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iYuX,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixuv,iYus,Xzvswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYus,Xzvyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYuv,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iYvX,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,iYvs,Xzuswy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzusyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuwys->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuysw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,iYvs,Xzuyws->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iYvu,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,ixuv,isYt,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixuv,isYt,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,ixuv,isYt,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,ixuv,isYt,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isYu,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isYu,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,isYv,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,ixuv,istY,Xywtsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtszuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/480 * einsum('IJ,xyzw,ixuv,istY,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtusvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('IJ,xyzw,ixuv,istY,Xywtuszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('IJ,xyzw,ixuv,istY,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 49/240 * einsum('IJ,xyzw,ixuv,istY,Xywtvszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,ixuv,istY,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('IJ,xyzw,ixuv,istY,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,ixuv,istY,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,ixuv,istY,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,ixuv,istY,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,ixuv,istY,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixuv,isuY,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywszv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywvsz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywvzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywzsv->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isuY,Xywzvs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuv,isvY,Xywsuz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywszu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywusz->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywuzs->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywzsu->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuv,isvY,Xywzus->IXJY', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uXxa,Ya,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uXxa,Yvsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uXxa,Yvsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uXxa,Yvsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,Yvsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uXxa,Yvsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uXxa,Yvsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uXxa,Yvwa,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uXxa,Yvya,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uXxa,Yzva,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,vYsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,vYsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,vYsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,uXxa,vYsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,vYsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uXxa,vYsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uXxa,vYwa,zuvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,uXxa,vYya,zuwv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uXxa,zYva,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uYxa,Xa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,Xvsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,Xvsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,Xvsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,Xvsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,Xvsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,Xvsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,vXsa,zusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,vXsa,zusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,vXsa,zuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,uYxa,vXsa,zuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,vXsa,zusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,vXsa,zusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,uYxa,va,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,va,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,va,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,va,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,va,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,va,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutsvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutsvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vsta,Xzutswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutsyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,uYxa,vsta,Xzutsywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,uYxa,vsta,Xzutvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,uYxa,vsta,Xzutvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,uYxa,vsta,Xzutwsvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutwsyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,uYxa,vsta,Xzutwvsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutwvys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutwysv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutwyvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uYxa,vsta,Xzutysvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutyswv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uYxa,vsta,Xzutyvsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/96 * einsum('IJ,xyzw,uYxa,vsta,Xzutyvws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutywsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/32 * einsum('IJ,xyzw,uYxa,vsta,Xzutywvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uYxa,vswa,Xzusvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vsya,Xzusvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,uYxa,vsya,Xzuswv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vsya,Xzuvsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vsya,Xzuvws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vsya,Xzuwsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vsya,Xzuwvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vzsa,Xusvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vzsa,Xusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vzsa,Xuswvy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uYxa,vzsa,Xuswyv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vzsa,Xusyvw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uYxa,vzsa,Xusywv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uYxa,za,Xuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uYxa,zvsa,Xusvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uvxa,XsYa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uvxa,Ya,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uvxa,YsXa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,uvxa,Ysta,Xywstuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/160 * einsum('IJ,xyzw,uvxa,Ysta,Xywstvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywstzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 41/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywstzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsutvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 49/240 * einsum('IJ,xyzw,uvxa,Ysta,Xywsutzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsuvtz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsuvzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('IJ,xyzw,uvxa,Ysta,Xywsuztv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,uvxa,Ysta,Xywsuzvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvtuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvtzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvutz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvuzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvztu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/160 * einsum('IJ,xyzw,uvxa,Ysta,Xywsvzut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsztuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywsztvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywszutv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,uvxa,Ysta,Xywszuvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,Ysta,Xywszvtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,uvxa,Ysta,Xywszvut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uvxa,sXYa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uvxa,sYXa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,uvxa,sYta,Xywsuvzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,uvxa,sYta,Xywsuzvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,uvxa,sYta,Xywsvuzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,uvxa,sYta,Xywsvzut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxa,sYta,Xywsztuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxa,sYta,Xywsztvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxa,sYta,Xywszutv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,uvxa,sYta,Xywszuvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uvxa,sYta,Xywszvtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,uvxa,sYta,Xywszvut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,uvxa,stYa,Xzuvstwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/160 * einsum('IJ,xyzw,uvxa,stYa,Xzuvstyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvswty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('IJ,xyzw,uvxa,stYa,Xzuvswyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,uvxa,stYa,Xzuvsytw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('IJ,xyzw,uvxa,stYa,Xzuvsywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/160 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('IJ,xyzw,uvxa,stYa,Xzuvtyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/120 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwsty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwsyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwtsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwtys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwyst->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 31/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvwyts->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,uvxa,stYa,Xzuvystw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 41/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvyswt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('IJ,xyzw,uvxa,stYa,Xzuvytsw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/160 * einsum('IJ,xyzw,uvxa,stYa,Xzuvytws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 59/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvywst->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/480 * einsum('IJ,xyzw,uvxa,stYa,Xzuvywts->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsYa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsYa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxXa,vsYa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsYa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsYa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsYa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxYa,va,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,va,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,va,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,va,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,va,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,va,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,vsXa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,vsXa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxYa,vsXa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,vsXa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,vsXa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxYa,vsXa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvtwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvtwyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvtyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvtywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvutwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvutyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvuwty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 2/15 * einsum('IJ,xyzw,uxYa,vsta,Xzsvuwyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvuytw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/60 * einsum('IJ,xyzw,uxYa,vsta,Xzsvuywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwtuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwtyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwuty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/40 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwuyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwytu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('IJ,xyzw,uxYa,vsta,Xzsvwyut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvytuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('IJ,xyzw,uxYa,vsta,Xzsvytwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/120 * einsum('IJ,xyzw,uxYa,vsta,Xzsvyutw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('IJ,xyzw,uxYa,vsta,Xzsvyuwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('IJ,xyzw,uxYa,vsta,Xzsvywtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,uxYa,vsta,Xzsvywut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxYa,vsza,Xvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxva,XsYa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,Ya,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxva,YsXa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvstwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvstyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('IJ,xyzw,uxva,Ysta,Xzvsuwty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('IJ,xyzw,uxva,Ysta,Xzvsuwyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('IJ,xyzw,uxva,Ysta,Xzvsuytw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('IJ,xyzw,uxva,Ysta,Xzvsuywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvswtuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvswyut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvsytuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,uxva,Ysta,Xzvsywut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxva,Ysva,Xzsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxva,Ysva,Xzsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxva,Ysva,Xzswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxva,Ysva,Xzswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxva,Ysva,Xzsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxva,Ysva,Xzsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,sXYa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,sYXa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,sYta,Xzvsywut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,sYva,Xzsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 3/16 * einsum('IJ,xyzw,uxva,stYa,Xywustzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uxva,stYa,Xywusztv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uxva,stYa,Xywutszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uxva,stYa,Xywutzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uxva,stYa,Xywuzstv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,uxva,stYa,Xywuztsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXYa,ua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXYa,uvsa,zvuswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXYa,uvsa,zvusyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXYa,uvsa,zvuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXYa,uvsa,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXYa,uvsa,zvuysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXYa,uvsa,zvuyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXYa,uvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xXua,Ya,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXua,Yvsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXua,Yvsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXua,Yvsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,Yvsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXua,Yvsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXua,Yvsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXua,Yvua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXua,Yvza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,vYsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,vYsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,vYsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xXua,vYsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,vYsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXua,vYsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xXua,vYua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xXua,vYza,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xYXa,ua,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYXa,uvsa,zvuswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYXa,uvsa,zvusyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYXa,uvsa,zvuwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYXa,uvsa,zvuwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYXa,uvsa,zvuysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYXa,uvsa,zvuyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xYXa,uvza,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xYua,Xa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,Xvsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,Xvsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,Xvsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,Xvsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,Xvsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,Xvsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xYua,Xvua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vXsa,zuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vXsa,zuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vXsa,zuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xYua,vXsa,zuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vXsa,zuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vXsa,zuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xYua,vXua,zvwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,va,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,va,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,va,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,va,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,va,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,va,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xYua,vsta,Xywtsuzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtsvzu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsta,Xywtszuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtszvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,xYua,vsta,Xywtusvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,xYua,vsta,Xywtuszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,xYua,vsta,Xywtuvsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,xYua,vsta,Xywtuvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('IJ,xyzw,xYua,vsta,Xywtuzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,xYua,vsta,Xywtuzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtvszu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtvuzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtvzsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xYua,vsta,Xywtvzus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,xYua,vsta,Xywtzvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xYua,vsua,Xywsvz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xYua,vsza,Xywsuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsza,Xywsvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsza,Xywusv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsza,Xywuvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsza,Xywvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xYua,vsza,Xywvus->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xa,XuYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xa,Ya,Xzyw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xa,YuXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xa,Yuva,Xzuvwy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,Yuva,Xzuvyw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,Yuva,Xzuwvy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,Yuva,Xzuwyv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,Yuva,Xzuyvw->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,Yuva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xa,uXYa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xa,uYXa,zuwy->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xa,uYva,Xzuywv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xa,uvYa,Xywuvz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,uvYa,Xywuzv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,uvYa,Xywvuz->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,uvYa,Xywvzu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,uvYa,Xywzuv->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xa,uvYa,Xywzvu->IXJY', np.identity(ncvs), v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuXa,vsYa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuYa,va,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuYa,vsXa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvtwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvtwyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvtyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvtywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,xuYa,vsta,Xzsvutwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('IJ,xyzw,xuYa,vsta,Xzsvutyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvuwty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvuwyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvuytw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvuywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwtuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwtyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwuty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwuyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwytu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,xuYa,vsta,Xzsvwyut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,xuYa,vsta,Xzsvytuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/160 * einsum('IJ,xyzw,xuYa,vsta,Xzsvytwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvyutw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/480 * einsum('IJ,xyzw,xuYa,vsta,Xzsvyuwt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('IJ,xyzw,xuYa,vsta,Xzsvywtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 61/240 * einsum('IJ,xyzw,xuYa,vsta,Xzsvywut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuYa,vsza,Xvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuYa,vsza,Xvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuYa,vsza,Xvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuYa,vsza,Xvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuYa,vsza,Xvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuYa,vsza,Xvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuab,Yvab,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuab,Yvba,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuab,Yvba,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuab,Yvba,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuab,Yvba,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuab,Yvba,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuab,Yvba,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsYa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsYa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsYa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xuva,XsYa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsYa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsYa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,Ya,Xzvuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,Ya,Xzvuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,Ya,Xzvwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,Ya,Xzvwyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,Ya,Xzvyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,Ya,Xzvywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,YsXa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,YsXa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,YsXa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xuva,YsXa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,YsXa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,YsXa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvstwuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvstyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsuwty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsuwyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsuytw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsuywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvswtyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvswyut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsytwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,xuva,Ysta,Xzvsywtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,Ysta,Xzvsywut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuva,Ysva,Xzsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXYa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXYa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXYa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,sXYa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXYa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXYa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYXa,zvsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYXa,zvsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYXa,zvswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,sYXa,zvswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYXa,zvsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYXa,zvsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsuwyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsuywt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xuva,sYta,Xzvswtuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xuva,sYta,Xzvswtyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xuva,sYta,Xzvswuty->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYta,Xzvswuyt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xuva,sYta,Xzvswytu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYta,Xzvswyut->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsytuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsytwu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsyutw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('IJ,xyzw,xuva,sYta,Xzvsywtu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,sYva,Xzsuwy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYva,Xzsuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYva,Xzswuy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYva,Xzswyu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYva,Xzsyuw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sYva,Xzsywu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywustzv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('IJ,xyzw,xuva,stYa,Xywusvzt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywusztv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('IJ,xyzw,xuva,stYa,Xywuszvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywutszv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywutvzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywutzsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,xuva,stYa,Xywutzvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,xuva,stYa,Xywuvstz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('IJ,xyzw,xuva,stYa,Xywuvszt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('IJ,xyzw,xuva,stYa,Xywuvtsz->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuvtzs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('IJ,xyzw,xuva,stYa,Xywuvzst->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('IJ,xyzw,xuva,stYa,Xywuvzts->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuzstv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuzsvt->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuztsv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuztvs->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuzvst->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('IJ,xyzw,xuva,stYa,Xywuzvts->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzXa,uvYa,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzYa,ua,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzYa,uvXa,ywuv->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzYa,uvsa,Xvuyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzab,Yuab,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzua,Yvua,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxua,XvYa,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,Ya,Xuyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxua,YvXa,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,Yvsa,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,vXYa,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,vYXa,ywvu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,zxua,vYsa,Xuvswy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,zxua,vYsa,Xuvsyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,zxua,vYsa,Xuvwsy->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,zxua,vYsa,Xuvwys->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,zxua,vYsa,Xuvysw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,zxua,vYsa,Xuvyws->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,vYua,Xvyw->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,vsYa,Xywvsu->IXJY', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iiux,Jiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiuw,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iiux,Jiuy,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iiux,Jivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iiux,Jivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jivw,zvyu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jivy,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiwu,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiwv,zvuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiwy,zu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiyu,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiyv,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiyw,zu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iixa,Jiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixa,Jiwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixa,Jiya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixa,iJua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixa,iJwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixa,iJya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixu,Jiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiuw,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiuy,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsuyw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iixu,Jivs,zvswyu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsyuw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsywu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iixu,Jivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jivw,zvuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jivy,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiwu,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiwv,zvyu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiwy,zu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixu,Jiyu,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiyv,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiyw,zu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixz,Jiuv,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiuw,yu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixz,Jiuy,wu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixz,Jiwu,yu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiyu,wu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iiux,Jiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiuw,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iiux,Jiuy,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iiux,Jivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iiux,Jivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jivw,zvyu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jivy,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiwu,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiwv,zvuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiwy,zu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iiux,Jiyu,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiyv,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iiux,Jiyw,zu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iixa,Jiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixa,Jiwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixa,Jiya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixa,iJua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixa,iJwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixa,iJya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixu,Jiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiuw,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiuy,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsuyw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iixu,Jivs,zvswyu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsyuw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iixu,Jivs,zvsywu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iixu,Jivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jivw,zvuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jivy,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiwu,zy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiwv,zvyu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixu,Jiwy,zu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,Iixu,Jiyu,zw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiyv,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixu,Jiyw,zu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iixz,Jiuv,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiuw,yu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixz,Jiuy,wu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iixz,Jiwu,yu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,Iixz,Jiyu,wu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iuax,Ja,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvas,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvas,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvas,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Iuax,Jvas,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvas,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvas,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuax,Jvaw,zuvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuax,Jvay,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuax,Jvsa,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuax,Jvsa,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuax,Jvsa,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuax,Jvsa,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuax,Jvsa,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuax,Jvsa,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuax,Jvwa,zuvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuax,Jvya,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuax,Jzav,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuax,Jzva,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuvx,Jstv,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuvx,Jstv,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuvx,Jstv,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jstv,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuvx,Jstv,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuvx,Jstv,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jstw,zutsyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jsty,zutsvw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jsty,zutswv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jsty,zutvsw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jsty,zutvws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Iuvx,Jsty,zutwsv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jsty,zutwvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jsvt,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jsvt,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jsvt,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Iuvx,Jsvt,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jsvt,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jsvt,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuvx,Jsvw,zusy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuvx,Jsvy,zuws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jswt,zutsvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jswt,zutsyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jswt,zutvsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Iuvx,Jswt,zutvys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jswt,zutysv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuvx,Jswt,zutyvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jswv,zusy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jswy,zuvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jsyt,zutwvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jsyv,zuws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jsyw,zusv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuvx,Just,zstwvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iuvx,Jv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jw,zuvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jy,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jzst,ywvstu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jzst,ywvsut->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jzst,ywvtsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jzst,ywvtus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuvx,Jzst,ywvust->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Iuvx,Jzst,ywvuts->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuvx,Jzsv,ywus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuvx,Jzvs,ywus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Iuxa,Ja,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxa,Jvas,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxa,Jvas,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxa,Jvas,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuxa,Jvas,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxa,Jvas,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxa,Jvas,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxa,Jvaw,zuvy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxa,Jvay,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Iuxa,Jvsa,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxa,Jvwa,zuyv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxa,Jvya,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuxa,Jzav,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuxa,Jzva,ywvu->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Iuxv,Jstv,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Iuxv,Jstw,zutsvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Jstw,zutsyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Jstw,zutvsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Jstw,zutvys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Jstw,zutysv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Jstw,zutyvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jsty,zutwvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxv,Jsvt,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxv,Jsvt,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxv,Jsvt,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Iuxv,Jsvt,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxv,Jsvt,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Iuxv,Jsvt,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jsvw,zusy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jsvy,zuws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jswt,zutyvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jswv,zuys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jswy,zusv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxv,Jsyt,zutwvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxv,Jsyv,zuws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxv,Jsyw,zusv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iuxv,Just,zstvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iuxv,Just,zstvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iuxv,Just,zstwvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Iuxv,Just,zstwyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iuxv,Just,zstyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Iuxv,Just,zstywv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Iuxv,Jv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxv,Jw,zuyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxv,Jy,zuwv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Iuxv,Jzst,ywvstu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuxv,Jzsv,ywsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuxv,Jzvs,ywus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Iuxz,Juvs,ywvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxz,Jvsw,yvsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxz,Jvsy,wvus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxz,Jvws,yvus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxz,Jvwy,uv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxz,Jvys,wvus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxz,Jvyw,uv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Iuxz,Jw,yu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Iuxz,Jy,wu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ix,Juvw,zvuy->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ix,Juvy,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ix,Juwv,zvyu->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ix,Juwy,zu->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Ix,Juyv,zvwu->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Ix,Juyw,zu->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ix,Jw,zy->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XY,xyzw,Ix,Jy,zw->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Ix,Jzuv,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixab,Juab,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixab,Juba,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixau,Ja,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvas,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvas,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvas,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Ixau,Jvas,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvas,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvas,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixau,Jvau,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixau,Jvaz,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixau,Jvsa,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixau,Jvsa,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixau,Jvsa,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixau,Jvsa,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixau,Jvsa,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixau,Jvsa,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixau,Jvua,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixau,Jvza,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixua,Ja,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixua,Jvas,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixua,Jvas,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixua,Jvas,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixua,Jvas,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixua,Jvas,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixua,Jvas,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixua,Jvau,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixua,Jvaz,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixua,Jvsa,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixua,Jvua,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixua,Jvza,ywvu->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jstu,zvstwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jstu,zvstyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jstu,zvswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jstu,zvswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jstu,zvsytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jstu,zvsywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jstv,zuswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Ixuv,Jstz,ywtvsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsut,zvstwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsut,zvstyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsut,zvswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Ixuv,Jsut,zvswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsut,zvsytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsut,zvsywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixuv,Jsuv,zswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixuv,Jsuz,ywvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jsvt,zustwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jsvt,zustyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jsvt,zuswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jsvt,zuswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jsvt,zusytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Ixuv,Jsvt,zusywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jsvu,zswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jsvz,ywus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Ixuv,Jszt,ywtsuv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Ixuv,Jszt,ywtsvu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Ixuv,Jszt,ywtusv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Ixuv,Jszt,ywtuvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Ixuv,Jszt,ywtvsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Ixuv,Jszt,ywtvus->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jszu,ywvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jszv,ywsu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixuv,Ju,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Ixuv,Jv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jwst,zuvsty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jwst,zuvsyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Ixuv,Jwst,zuvtsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jwst,zuvtys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jwst,zuvyst->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Ixuv,Jwst,zuvyts->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Ixuv,Jyst,zuvwst->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Ixuv,Jz,ywvu->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jiux,Iiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jiux,Iivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jiux,Iivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jixa,Iiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixa,iIua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixu,Iiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsuyw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jixu,Iivs,zvswyu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsyuw->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsywu->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jixu,Iivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixz,Iiuv,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jiux,Iiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jiux,Iivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jiux,Iivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jixa,Iiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixa,iIua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixu,Iiuv,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsuwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsuyw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvswuy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jixu,Iivs,zvswyu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsyuw->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jixu,Iivs,zvsywu->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jixu,Iivu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jixz,Iiuv,ywuv->IXJY', np.identity(ncas), v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Juax,Ia,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivas,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivas,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivas,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Juax,Ivas,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivas,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivas,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juax,Ivsa,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juax,Ivsa,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juax,Ivsa,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juax,Ivsa,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juax,Ivsa,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juax,Ivsa,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juvx,Istv,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juvx,Istv,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juvx,Istv,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Istv,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juvx,Istv,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juvx,Istv,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Isvt,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Isvt,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Isvt,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('XY,xyzw,Juvx,Isvt,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Isvt,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juvx,Isvt,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Juvx,Iust,zstwvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,Juvx,Iv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Juxa,Ia,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxa,Ivas,zusvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxa,Ivas,zusvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxa,Ivas,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juxa,Ivas,zuswyv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxa,Ivas,zusyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxa,Ivas,zusywv->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Juxa,Ivsa,zuswvy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Juxv,Istv,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxv,Isvt,zutswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxv,Isvt,zutsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxv,Isvt,zutwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('XY,xyzw,Juxv,Isvt,zutwys->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxv,Isvt,zutysw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XY,xyzw,Juxv,Isvt,zutyws->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Juxv,Iust,zstvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Juxv,Iust,zstvyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Juxv,Iust,zstwvy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Juxv,Iust,zstwyv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Juxv,Iust,zstyvw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Juxv,Iust,zstywv->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('XY,xyzw,Juxv,Iv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Juxz,Iuvs,ywvs->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxab,Iuab,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxab,Iuba,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxau,Ia,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivas,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivas,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivas,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Jxau,Ivas,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivas,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivas,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxau,Ivau,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxau,Ivsa,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxau,Ivsa,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxau,Ivsa,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxau,Ivsa,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxau,Ivsa,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxau,Ivsa,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxau,Ivua,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxua,Ia,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxua,Ivas,zuvswy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxua,Ivas,zuvsyw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxua,Ivas,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxua,Ivas,zuvwys->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxua,Ivas,zuvysw->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxua,Ivas,zuvyws->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxua,Ivau,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxua,Ivsa,zuvwsy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxua,Ivua,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Istu,zvstwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Istu,zvstyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Istu,zvswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Istu,zvswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Istu,zvsytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Istu,zvsywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxuv,Istv,zuswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isut,zvstwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isut,zvstyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isut,zvswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('XY,xyzw,Jxuv,Isut,zvswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isut,zvsytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isut,zvsywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxuv,Isuv,zswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Isvt,zustwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Isvt,zustyw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Isvt,zuswty->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XY,xyzw,Jxuv,Isvt,zuswyt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Isvt,zusytw->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('XY,xyzw,Jxuv,Isvt,zusywt->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxuv,Isvu,zswy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,Jxuv,Iu,zvwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,Jxuv,Iv,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,iIxa,Jiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,iIxa,Jiwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,iIxa,Jiya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,iIxa,iJua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,iIxa,iJwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,iIxa,iJya,zw->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,iJxa,Iiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,iJxa,iIua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,iIxa,Jiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XY,xyzw,iIxa,Jiwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('XY,xyzw,iIxa,Jiya,zw->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,iIxa,iJua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XY,xyzw,iIxa,iJwa,zy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('XY,xyzw,iIxa,iJya,zw->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XY,xyzw,iJxa,Iiua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XY,xyzw,iJxa,iIua,zuwy->IXJY', np.identity(ncas), v_aaaa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
     
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ca, n_ca)
        M_00[s_ca_aa:f_ca_aa, s_ca_aa:f_ca_aa] += temp
        M_00[s_ca_bb:f_ca_bb, s_ca_bb:f_ca_bb] += temp
        del temp
     
        ## aa,bb || bb,aa
        temp  = einsum('Ia,JXYa->IXJY', h_xe, t1_xaae, optimize = einsum_type)
        temp += einsum('Ix,JXYx->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('Ja,IYXa->IXJY', h_xe, t1_xaae, optimize = einsum_type)
        temp += einsum('Jx,IYXx->IXJY', h_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('IYab,JbXa->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp += einsum('IYax,JxXa->IXJY', t1_xaea, v_xaae, optimize = einsum_type)
        temp += einsum('IYxa,JaXx->IXJY', t1_xaae, v_xeaa, optimize = einsum_type)
        temp += einsum('IYxy,JyXx->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('Ia,JYXa->IXJY', t1_xe, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('IiXa,JYia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('IiXa,iYJa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('IiXx,JYix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('IiXx,JxiY->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('IixX,JYix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('IiXa,JYia->IXJY', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('IiXa,iYJa->IXJY', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += 2 * einsum('IiXx,JYix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('IiXx,JxiY->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('IixX,JYix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('Ix,JYXx->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp += einsum('JXab,IbYa->IXJY', t1_xaee, v_xeae, optimize = einsum_type)
        temp += einsum('JXax,IxYa->IXJY', t1_xaea, v_xaae, optimize = einsum_type)
        temp += einsum('JXxa,IaYx->IXJY', t1_xaae, v_xeaa, optimize = einsum_type)
        temp += einsum('JXxy,IyYx->IXJY', t1_xaaa, v_xaaa, optimize = einsum_type)
        temp += einsum('Ja,IXYa->IXJY', t1_xe, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('JiYa,IXia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('JiYa,iXIa->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiYx,IXix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('JiYx,IxiX->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp -= einsum('JixY,IXix->IXJY', t1_xxaa, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('JiYa,IXia->IXJY', t1_xvae, v_xave, optimize = einsum_type)
        temp -= einsum('JiYa,iXIa->IXJY', t1_xvae, v_vaxe, optimize = einsum_type)
        temp += 2 * einsum('JiYx,IXix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('JiYx,IxiX->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp -= einsum('JixY,IXix->IXJY', t1_xvaa, v_xava, optimize = einsum_type)
        temp += einsum('Jx,IXYx->IXJY', t1_xa, v_xaaa, optimize = einsum_type)
        temp += einsum('Xa,JYaI->IXJY', t1_ae, v_xaex, optimize = einsum_type)
        temp += einsum('Ya,IXaJ->IXJY', t1_ae, v_xaex, optimize = einsum_type)
        temp -= einsum('iIXa,JYia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iJYa,IXia->IXJY', t1_xxae, v_xaxe, optimize = einsum_type)
        temp -= einsum('iX,iIJY->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iXYa,iJIa->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp -= einsum('iXYx,iJIx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iY,iJIX->IXJY', t1_xa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iYXa,iIJa->IXJY', t1_xaae, v_xxxe, optimize = einsum_type)
        temp -= einsum('iYXx,iIJx->IXJY', t1_xaaa, v_xxxa, optimize = einsum_type)
        temp -= einsum('iIXa,JYia->IXJY', t1_vxae, v_xave, optimize = einsum_type)
        temp -= einsum('iJYa,IXia->IXJY', t1_vxae, v_xave, optimize = einsum_type)
        temp -= einsum('iX,iIJY->IXJY', t1_va, v_vxxa, optimize = einsum_type)
        temp -= einsum('iXYa,iJIa->IXJY', t1_vaae, v_vxxe, optimize = einsum_type)
        temp -= einsum('iXYx,iJIx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp -= einsum('iY,iJIX->IXJY', t1_va, v_vxxa, optimize = einsum_type)
        temp -= einsum('iYXa,iIJa->IXJY', t1_vaae, v_vxxe, optimize = einsum_type)
        temp -= einsum('iYXx,iIJx->IXJY', t1_vaaa, v_vxxa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXa,Ja->IXJY', e_cvs, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXx,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYab,JXba->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYax,JXxa->IXJY', e_cvs, t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYxa,JXax->IXJY', e_cvs, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYxy,JXyx->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ia,JXYa->IXJY', e_cvs, t1_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('I,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('I,IiXa,JiYa->IXJY', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,iJYa->IXJY', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('I,IiXx,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixX,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ix,JXYx->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIXa,JiYa->IXJY', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXa,Ja->IXJY', e_cvs, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXx,Jx->IXJY', e_cvs, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYab,JXba->IXJY', e_cvs, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYax,JXxa->IXJY', e_cvs, t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYxa,JXax->IXJY', e_cvs, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYxy,JXyx->IXJY', e_cvs, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ia,JXYa->IXJY', e_cvs, t1_xe, t1_xaae, optimize = einsum_type)
        temp -= einsum('J,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('J,IiXa,JiYa->IXJY', e_cvs, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,iJYa->IXJY', e_cvs, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('J,IiXx,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JixY->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixX,JiYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ix,JXYx->IXJY', e_cvs, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIXa,JiYa->IXJY', e_cvs, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('a,JXYa,Ia->IXJY', e_extern, t1_xaae, t1_xe, optimize = einsum_type)
        temp += einsum('a,JXab,IYba->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += einsum('a,JXax,IYxa->IXJY', e_extern, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += einsum('a,JXba,IYab->IXJY', e_extern, t1_xaee, t1_xaee, optimize = einsum_type)
        temp += einsum('a,JXxa,IYax->IXJY', e_extern, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += einsum('a,Ja,IYXa->IXJY', e_extern, t1_xe, t1_xaae, optimize = einsum_type)
        temp += 2 * einsum('a,JiYa,IiXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('a,JiYa,iIXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('a,JiYa,IiXa->IXJY', e_extern, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= einsum('a,JiYa,iIXa->IXJY', e_extern, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('a,iJYa,IiXa->IXJY', e_extern, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('a,iJYa,IiXa->IXJY', e_extern, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,IiXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,iJYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiXx,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,JixY->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('i,JiYa,IiXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,iIXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiYx,IiXx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,IixX->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixY,IiXx->IXJY', e_cvs, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIXa,JiYa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJYa,IiXa->IXJY', e_cvs, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,IiXa,JiYa->IXJY', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,iJYa->IXJY', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,IiXx,JiYx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,JixY->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixX,JiYx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('i,JiYa,IiXa->IXJY', e_val, t1_xvae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,iIXa->IXJY', e_val, t1_xvae, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,JiYx,IiXx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,IixX->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixY,IiXx->IXJY', e_val, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIXa,JiYa->IXJY', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJYa,IiXa->IXJY', e_val, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JXxa,Yx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxYa,Xx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ia,Jxya,XyYx->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ia,Jxya,XyxY->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JXyx,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyYx,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ix,Jyzx,XzYy->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ix,Jyzx,XzyY->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IYxa,Xx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxXa,Yx->IXJY', h_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ja,Ixya,XxYy->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ja,Ixya,XxyY->IXJY', h_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IYyx,Xy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyXx,Yy->IXJY', h_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jx,Iyzx,XyYz->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jx,Iyzx,XyzY->IXJY', h_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxa,Ja->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxy,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Xx,Iixa,JiYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,iJYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Iixy,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iiyx,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Xx,Iixa,JiYa->IXJY', h_aa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,iJYa->IXJY', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('Xx,Iixy,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iiyx,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYa,Ia->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYy,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxab,IYba->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxay,IYya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxya,IYay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jxyz,IYzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iIxa,JiYa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iIxa,JiYa->IXJY', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXa,Ja->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXy,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixab,JXba->IXJY', h_aa, t1_xaee, t1_xaee, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixay,JXya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixya,JXay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Ixyz,JXzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxa,Ia->IXJY', h_aa, t1_xaae, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxy,Iy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('Yx,Jixa,IiXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,iIXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += einsum('Yx,Jixy,IiXy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiyX->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jiyx,IiXy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += einsum('Yx,Jixa,IiXa->IXJY', h_aa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,iIXa->IXJY', h_aa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += einsum('Yx,Jixy,IiXy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiyX->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jiyx,IiXy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,iJxa,IiXa->IXJY', h_aa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,iJxa,IiXa->IXJY', h_aa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += einsum('xy,IYXx,Jy->IXJY', h_aa, t1_xaaa, t1_xa, optimize = einsum_type)
        temp += einsum('xy,IYax,JXya->IXJY', h_aa, t1_xaea, t1_xaae, optimize = einsum_type)
        temp += einsum('xy,IYxa,JXay->IXJY', h_aa, t1_xaae, t1_xaea, optimize = einsum_type)
        temp += einsum('xy,IYxz,JXzy->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += einsum('xy,IYzx,JXyz->IXJY', h_aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IiXx,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,JiyY->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IixX,JiYy->IXJY', h_aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('xy,IiXx,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,JiyY->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,IixX,JiYy->IXJY', h_aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,Ix,JXYy->IXJY', h_aa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('IYXa,Jaxy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYXa,Jxya,yx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IYXx,Jxyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYXx,Jyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYab,Jbxa,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYax,Jxya,Xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYax,JyXa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IYax,Jyza,Xyxz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IYax,Jyza,Xyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,JaXy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,Jayx,Xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxa,Jayz,Xzxy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IYxa,Jyza,Xyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IYxa,Jyza,Xyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,JyXz,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,Jyzw,Xwxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,Jyzx,Xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IYxy,JzXx,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('IYxy,Jzwx,Xzwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IYxy,Jzwx,Xzyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IYxy,Jzwy,Xzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IYxy,Jzwy,Xzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JYxa,Xx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxXa,Yx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ia,Jxya,XxYy->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ia,Jxya,XxyY->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiXa,Jxia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXa,ixJa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,JYiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jxiy,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,JyiY,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,Jyix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jyiz,Yxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,JYiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,Jyix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('IixX,Jyiz,Yxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IixX,Jyiz,Yxzy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Iixa,JYia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Iixa,Jyia,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Iixa,Jyia,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixa,iYJa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixa,iyJa,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixa,iyJa,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Iixy,JYiy,Xx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYiz,Xzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JyiY,Xx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jyiz,XzYx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jyiz,XzxY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,JziY,Xzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,JziY,Xzyx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwYyx->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jziw,XzwxYy->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwxyY->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwyYx->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwyxY->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jzix,XzYy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jzix,XzyY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixy,Jziy,XzYx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Iixy,Jziy,XzxY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiXa,Jxia,Yx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXa,ixJa,Yx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,JYiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jxiy,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,JyiY,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiXx,Jyix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiXx,Jyiz,Yxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,JYiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixX,Jyix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('IixX,Jyiz,Yxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IixX,Jyiz,Yxzy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Iixa,JYia,Xx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Iixa,Jyia,XyYx->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Iixa,Jyia,XyxY->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixa,iYJa,Xx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixa,iyJa,XyYx->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixa,iyJa,XyxY->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('Iixy,JYiy,Xx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JYiz,Xzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Iixy,JyiY,Xx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jyiz,XzYx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jyiz,XzxY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,JziY,Xzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,JziY,Xzyx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwYyx->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jziw,XzwxYy->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwxyY->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwyYx->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Iixy,Jziw,XzwyxY->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Iixy,Jzix,XzYy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Iixy,Jzix,XzyY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Iixy,Jziy,XzYx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Iixy,Jziy,XzxY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JYyx,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyXx,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ix,Jyzx,XyYz->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ix,Jyzx,XyzY->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IxXa,JYya,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,JayY,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,Jayz,Yyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXa,Jyza,Yzyx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IxXy,JYxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxXy,JYzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,JyzY,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,Jyzw,Yzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxXy,Jzwy,Ywzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxXy,JzxY,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxXy,Jzxw,Yyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaX,JYya,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxaX,Jyza,Yzxy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IxaX,Jyza,Yzyx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixab,JbXa,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ixab,Jbya,XxYy->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixab,Jbya,XxyY->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Ixay,JYXa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JYza,Xxzy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JyXa,Yx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ixay,Jyza,XxYz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixay,Jyza,XxzY->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JzXa,Yyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jzwa,XxzYwy->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jzwa,XxzwYy->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixay,Jzwa,XxzwyY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jzwa,XxzyYw->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixay,Jzwa,XxzywY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxyX,JYxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyX,JYzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxyX,Jzwy,Ywxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IxyX,Jzwy,Ywzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyX,Jzxw,Yywz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IxyX,Jzxw,Yyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JYXa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JYza,Xxyz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JaXy,Yx->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,JaXz,Yyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JaXz,Yyzx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,JazY,Xxyz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JazY,Xxzy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazw,XxwYzy->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jazw,XxwyYz->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazw,XxwyzY->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazw,XxwzYy->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,Jazw,XxwzyY->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jazy,XxYz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,Jazy,XxzY->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JzXa,Yyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,JzXa,Yyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,Jzwa,XxzYwy->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,Jzwa,XxzywY->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('Ixyz,JYXy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYXz,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYwy,Xxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JYwz,Xxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JYxw,Xwyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JwXy,Yzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,JwXz,Yywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JwXz,Yyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuy,XxwYuz->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuy,XxwuYz->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwuy,XxwuzY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuy,XxwzYu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwuy,XxwzuY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwuz,XxwYuy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,Jwuz,XxwyuY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Ixyz,JwxY,Xwyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JwxY,Xwzy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwxu,XwuYzy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jwxu,XwuyYz->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwxu,XwuyzY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwxu,XwuzYy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jwxu,XwuzyY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzXw,Yywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,JzXw,Yyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JzXy,Yx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzwY,Xxwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,JzwY,Xxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwu,XxuYwy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwu,XxuwYy->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwu,XxuwyY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jzwu,XxuyYw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,Jzwu,XxuywY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,Jzwy,XxYw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,Jzwy,XxwY->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('JXYa,Iaxy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXYa,Ixya,yx->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('JXYx,Ixyz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXYx,Iyzx,zy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXab,Ibxa,Yx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXax,Ixya,Yy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXax,IyYa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JXax,Iyza,Yyxz->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('JXax,Iyza,Yyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,IaYy,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,Iayx,Yy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxa,Iayz,Yzxy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('JXxa,Iyza,Yyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JXxa,Iyza,Yyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,IyYz,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,Iyzw,Ywxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,Iyzx,Yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JXxy,IzYx,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('JXxy,Izwx,Yzwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JXxy,Izwx,Yzyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('JXxy,Izwy,Yzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('JXxy,Izwy,Yzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IXxa,Yx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxYa,Xx->IXJY', t1_xe, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ja,Ixya,XyYx->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ja,Ixya,XyxY->IXJY', t1_xe, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JiYa,Ixia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYa,ixIa,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,IXiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Ixiy,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,IyiX,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,Iyix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Iyiz,Xxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,IXiy,xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,Iyix,Xy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('JixY,Iyiz,Xxyz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JixY,Iyiz,Xxzy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jixa,IXia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Jixa,Iyia,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Jixa,Iyia,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iXIa,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixa,iyIa,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixa,iyIa,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXix,Yy->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,IXiy,Yx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXiz,Yzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiX,Yx->IXJY', t1_xxaa, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iyiz,XxYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Iyiz,XxzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,IziX,Yzxy->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziX,Yzyx->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyYwz->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxywYz->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxywzY->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iziw,XxyzYw->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyzwY->IXJY', t1_xxaa, v_xaxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Izix,XyYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Izix,XyzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixy,Iziy,XxYz->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Jixy,Iziy,XxzY->IXJY', t1_xxaa, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JiYa,Ixia,Xx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYa,ixIa,Xx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,IXiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Ixiy,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,IyiX,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiYx,Iyix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiYx,Iyiz,Xxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,IXiy,xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixY,Iyix,Xy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('JixY,Iyiz,Xxyz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JixY,Iyiz,Xxzy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jixa,IXia,Yx->IXJY', t1_xvae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Jixa,Iyia,XxYy->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Jixa,Iyia,XxyY->IXJY', t1_xvae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iXIa,Yx->IXJY', t1_xvae, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixa,iyIa,XxYy->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixa,iyIa,XxyY->IXJY', t1_xvae, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXix,Yy->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,IXiy,Yx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IXiz,Yzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiX,Yx->IXJY', t1_xvaa, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iyiz,XxYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Iyiz,XxzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,IziX,Yzxy->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziX,Yzyx->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyYwz->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxywYz->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxywzY->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Iziw,XxyzYw->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,Iziw,XxyzwY->IXJY', t1_xvaa, v_xava, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,Izix,XyYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,Izix,XyzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jixy,Iziy,XxYz->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Jixy,Iziy,XxzY->IXJY', t1_xvaa, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IXyx,Yy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyYx,Xy->IXJY', t1_xa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jx,Iyzx,XzYy->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jx,Iyzx,XzyY->IXJY', t1_xa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('JxYa,IXya,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,IayX,xy->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,Iayz,Xyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYa,Iyza,Xzyx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('JxYy,IXxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxYy,IXzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,IyzX,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,Iyzw,Xzxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxYy,Izwy,Xwzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxYy,IzxX,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxYy,Izxw,Xyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaY,IXya,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JxaY,Iyza,Xzxy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('JxaY,Iyza,Xzyx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxab,IbYa,Xx->IXJY', t1_xaee, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jxab,Ibya,XyYx->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxab,Ibya,XyxY->IXJY', t1_xaee, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jxay,IXYa,xy->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IXza,Yxzy->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IyYa,Xx->IXJY', t1_xaea, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jxay,Iyza,XzYx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxay,Iyza,XzxY->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IzYa,Xyzx->IXJY', t1_xaea, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Izwa,XywYzx->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Izwa,XywxYz->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Izwa,XywxzY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxay,Izwa,XywzYx->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxay,Izwa,XywzxY->IXJY', t1_xaea, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxyY,IXxz,yz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyY,IXzy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('JxyY,Izwy,Xwxz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('JxyY,Izwy,Xwzx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('JxyY,Izxw,Xywz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('JxyY,Izxw,Xyzw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IXYa,xy->IXJY', t1_xaae, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IXza,Yxyz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IaYy,Xx->IXJY', t1_xaae, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,IaYz,Xyxz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IaYz,Xyzx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,IazX,Yxyz->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IazX,Yxzy->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazw,XyzYwx->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazw,XyzwYx->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazw,XyzwxY->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Iazw,XyzxYw->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,Iazw,XyzxwY->IXJY', t1_xaae, v_xeaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Iazy,XzYx->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,Iazy,XzxY->IXJY', t1_xaae, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IzYa,Xyxz->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,IzYa,Xyzx->IXJY', t1_xaae, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,Izwa,XywYzx->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,Izwa,XywzYx->IXJY', t1_xaae, v_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('Jxyz,IXYy,xz->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXYz,xy->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXwy,Yxwz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IXwz,Yxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IXxw,Ywyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IwYy,Xzwx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,IwYz,Xywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IwYz,Xyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuy,XzuYwx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuy,XzuwYx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwuy,XzuwxY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuy,XzuxYw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwuy,XzuxwY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwuz,XyuYwx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,Iwuz,XyuwYx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jxyz,IwxX,Ywyz->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IwxX,Ywzy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwxu,XyzYuw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwxu,XyzuYw->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwxu,XyzuwY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Iwxu,XyzwYu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Iwxu,XyzwuY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzYw,Xywx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,IzYw,Xyxw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IzYy,Xx->IXJY', t1_xaaa, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzwX,Yxwy->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,IzwX,Yxyw->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwu,XywYux->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwu,XywuYx->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwu,XywuxY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Izwu,XywxYu->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,Izwu,XywxuY->IXJY', t1_xaaa, v_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,Izwy,XwYx->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,Izwy,XwxY->IXJY', t1_xaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xa,JxaI,Yx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxya,JYaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxya,JzaI,Yxyz->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxya,JzaI,Yxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ya,IxaJ,Xx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxya,IXaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxya,IzaJ,Xxyz->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxya,IzaJ,Xxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iIXa,Jxia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxa,JYia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iIxa,Jyia,XyYx->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('iIxa,Jyia,XyxY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJYa,Ixia,Xx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IXia,Yx->IXJY', t1_xxae, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iJxa,Iyia,XxYy->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('iJxa,Iyia,XxyY->IXJY', t1_xxae, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iX,iIJx,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXYx,iJIy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxa,iJIa,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxy,iJIy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('iXxy,iJIz,Yzxy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iXxy,iJIz,Yzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iY,iJIx,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYXx,iIJy,xy->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxa,iIJa,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxy,iIJy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('iYxy,iIJz,Xzxy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iYxy,iIJz,Xzyx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iIJY,Xx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iIJy,XyYx->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ix,iIJy,XyxY->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIX,Yx->IXJY', t1_xa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iJIy,XxYy->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ix,iJIy,XxyY->IXJY', t1_xa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixXa,iIJa,Yx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixXy,iIJY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJy,Yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJz,Yyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixYa,iJIa,Xx->IXJY', t1_xaae, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixYy,iJIX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIy,Xx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIz,Xyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iIJY,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyX,iIJz,Yyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyX,iIJz,Yyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyY,iJIX,yx->IXJY', t1_xaaa, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyY,iJIz,Xyxz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyY,iJIz,Xyzx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iIJa,XxYy->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixya,iIJa,XxyY->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iJIa,XyYx->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixya,iJIa,XyxY->IXJY', t1_xaae, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iIJY,Xxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJw,XxwYzy->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iIJw,XxwyzY->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJz,XxYy->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iIJz,XxyY->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIX,Yxyz->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIw,XyzYwx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iJIw,XyzwYx->IXJY', t1_xaaa, v_xxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIz,XyYx->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iJIz,XyxY->IXJY', t1_xaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iIXa,Jxia,Yx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxa,JYia,Xx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iIxa,Jyia,XyYx->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('iIxa,Jyia,XyxY->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJYa,Ixia,Xx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IXia,Yx->IXJY', t1_vxae, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('iJxa,Iyia,XxYy->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('iJxa,Iyia,XxyY->IXJY', t1_vxae, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iX,iIJx,Yx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXYx,iJIy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxa,iJIa,Yx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXxy,iJIy,Yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('iXxy,iJIz,Yzxy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iXxy,iJIz,Yzyx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iY,iJIx,Xx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYXx,iIJy,xy->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxa,iIJa,Xx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iYxy,iIJy,Xx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('iYxy,iIJz,Xzxy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('iYxy,iIJz,Xzyx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iIJY,Xx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iIJy,XyYx->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ix,iIJy,XyxY->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIX,Yx->IXJY', t1_va, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ix,iJIy,XxYy->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ix,iJIy,XxyY->IXJY', t1_va, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixXa,iIJa,Yx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixXy,iIJY,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJy,Yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixXy,iIJz,Yyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixYa,iJIa,Xx->IXJY', t1_vaae, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixYy,iJIX,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIy,Xx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixYy,iJIz,Xyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iIJY,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyX,iIJz,Yyxz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyX,iIJz,Yyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyY,iJIX,yx->IXJY', t1_vaaa, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyY,iJIz,Xyxz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyY,iJIz,Xyzx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iIJa,XxYy->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixya,iIJa,XxyY->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixya,iJIa,XyYx->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixya,iJIa,XyxY->IXJY', t1_vaae, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iIJY,Xxyz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJw,XxwYzy->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iIJw,XxwyzY->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iIJz,XxYy->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iIJz,XxyY->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIX,Yxyz->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIw,XyzYwx->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iJIw,XyzwYx->IXJY', t1_vaaa, v_vxxa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyz,iJIz,XyYx->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyz,iJIz,XyxY->IXJY', t1_vaaa, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xXYa,JyaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += einsum('xXya,JYaI,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXya,JzaI,Yxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xYXa,IyaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += einsum('xYya,IXaJ,xy->IXJY', t1_aaae, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xYya,IzaJ,Xxzy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IXaJ,Yx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xa,IyaJ,XxYy->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xa,IyaJ,XxyY->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,JYaI,Xx->IXJY', t1_ae, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xa,JyaI,XyYx->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xa,JyaI,XyxY->IXJY', t1_ae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyXa,IzaJ,Yzxy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyXa,IzaJ,Yzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyYa,JzaI,Xzxy->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyYa,JzaI,Xzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,IXaJ,Yzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,IwaJ,XyxYwz->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyza,IwaJ,XyxwYz->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,JYaI,Xzyx->IXJY', t1_aaae, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,JwaI,XzwYxy->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyza,JwaI,XzwyxY->IXJY', t1_aaae, v_xaex, rdm_cccaaa, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiya,Iixa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('XxyY,Jiya,iIxa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiyz,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jizy,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiya,Iixa->IXJY', v_aaaa, t1_xvae, t1_xvae, optimize = einsum_type)
        temp -= einsum('XxyY,Jiya,iIxa->IXJY', v_aaaa, t1_xvae, t1_vxae, optimize = einsum_type)
        temp += 2 * einsum('XxyY,Jiyz,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('XxyY,Jizy,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('XxyY,Jy,Ix->IXJY', v_aaaa, t1_xa, t1_xa, optimize = einsum_type)
        temp -= einsum('XxyY,iJya,Iixa->IXJY', v_aaaa, t1_xxae, t1_xxae, optimize = einsum_type)
        temp -= einsum('XxyY,iJya,Iixa->IXJY', v_aaaa, t1_vxae, t1_xvae, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,JiYy,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiyY,Iixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,JiYy,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,JiyY,Iixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jy,IYxz->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += 2 * einsum('Yxyz,IiXy,Jixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jizx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiyX,Jixz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Yxyz,IiXy,Jixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jizx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Yxyz,IiyX,Jixz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iy,JXxz->IXJY', v_aaaa, t1_xa, t1_xaaa, optimize = einsum_type)
        temp += einsum('xyzw,IYxz,JXwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXa,Jxay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYXa,Jxya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IYXx,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYXx,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYab,Jxba,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYax,JXya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYax,Jyxa,Xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYax,Jyza,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IYax,Jyza,Xzyx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,JXay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Ja,Xx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Jyax,Xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxa,Jyaz,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IYxa,Jyza,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxa,Jyza,Xzyx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,JXyz,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,JXzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jy,Xx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxy,Jzwx,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IYxy,Jzwx,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IYxy,Jzwy,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IYxy,Jzwy,Xwzx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jzyw,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IYxy,Jzyx,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ia,JXxa,Yx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ia,JxYa,Xx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ia,Jxya,XyYx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ia,Jxya,XyxY->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('I,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwYyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwxyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwyYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwyxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('I,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('I,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwYyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwxyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwyYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Iixy,Jizw,XzwyxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('I,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ix,JXyx,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ix,JyYx,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ix,Jyzx,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ix,Jyzx,XzyY->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Ja,Yx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxXa,JyYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,JyaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Jyaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXa,Jyza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxXy,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxXy,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxXy,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxXy,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxXy,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaX,JyYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxaX,Jyza,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IxaX,Jyza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixab,JXba,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixab,Jyba,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixab,Jyba,XxyY->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ixay,JXYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JXya,Yx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JXza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixay,JzYa,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzwa,XxwyYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixay,Jzwa,XxwzYy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixay,Jzwa,XxwzyY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixay,Jzya,XxYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixay,Jzya,XxzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyX,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyX,Jxzw,Yywz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,IxyX,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyX,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IxyX,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyX,Jzwy,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JXYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JXay,Yx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,JXaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JXaz,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JXza,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,JXza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Ja,XxYy->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,Ja,XxyY->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixya,JzYa,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,JzaY,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,JzaY,Xxzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzaw,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzaw,XxwyYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzaw,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzaw,XxwzYy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixya,Jzaw,XxwzyY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzay,XxYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,Jzay,XxzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixya,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixya,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Ixyz,JXYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXYz,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,JXwz,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JXwz,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JXzw,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,JXzw,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JXzy,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JwYy,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,Ixyz,JwYz,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuy,XxuYwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuy,XxuwYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwuy,XxuwzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuy,XxuzYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwuy,XxuzwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwuz,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,Jwuz,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,JwzY,Xxwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,JwzY,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzu,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzu,XxuwYy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzu,XxuwyY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwzu,XxuyYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jwzu,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jwzy,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,Jwzy,XxwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixyz,JxYw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,Ixyz,JxwY,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,JxwY,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jxwu,XwuYzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,Ixyz,Jxwu,XwuyYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jxwu,XwuyzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jxwu,XwuzYy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jxwu,XwuzyY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,Ixyz,Jz,XxYy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,Ixyz,Jz,XxyY->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIXa,Jixa,Yx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxa,JiYa,Xx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXa,Jxay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYXa,Jxya,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IYXx,Jyxz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYXx,Jyzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYab,Jxba,Xx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYax,JXya,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYax,Jyxa,Xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYax,Jyza,Xzxy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IYax,Jyza,Xzyx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,JXay,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Ja,Xx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Jyax,Xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxa,Jyaz,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IYxa,Jyza,Xzxy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxa,Jyza,Xzyx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,JXyz,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,JXzx,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jy,Xx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxy,Jzwx,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IYxy,Jzwx,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IYxy,Jzwy,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IYxy,Jzwy,Xwzx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jzyw,Xwxz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IYxy,Jzyx,Xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ia,JXxa,Yx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ia,JxYa,Xx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ia,Jxya,XyYx->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ia,Jxya,XyxY->IXJY', e_cvs, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('J,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwYyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwxyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwyYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwyxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('J,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,JiyY,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,JiYy,xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('J,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwYyx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwxyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwyYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Iixy,Jizw,XzwyxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('J,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ix,JXyx,Yy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ix,JyYx,Xy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ix,Jyzx,XzYy->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ix,Jyzx,XzyY->IXJY', e_cvs, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Ja,Yx->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxXa,JyYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,JyaY,xy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Jyaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXa,Jyza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxXy,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxXy,JxzY,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxXy,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jy,Yx->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxXy,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,JzyY,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxXy,Jzyw,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaX,JyYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxaX,Jyza,Yyxz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IxaX,Jyza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixab,JXba,Yx->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixab,Jyba,XxYy->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixab,Jyba,XxyY->IXJY', e_cvs, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ixay,JXYa,xy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JXya,Yx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JXza,Yyzx->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixay,JzYa,Xxzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzwa,XxwyYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixay,Jzwa,XxwzYy->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixay,Jzwa,XxwzyY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixay,Jzya,XxYz->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixay,Jzya,XxzY->IXJY', e_cvs, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyX,JxYz,yz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyX,Jxzw,Yywz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,IxyX,Jxzw,Yyzw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyX,JzYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IxyX,Jzwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyX,Jzwy,Yzxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JXYa,xy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JXay,Yx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,JXaz,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JXaz,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JXza,Yyxz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,JXza,Yyzx->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Ja,XxYy->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,Ja,XxyY->IXJY', e_cvs, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixya,JzYa,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,JzaY,Xxyz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,JzaY,Xxzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzaw,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzaw,XxwyYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzaw,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzaw,XxwzYy->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixya,Jzaw,XxwzyY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzay,XxYz->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,Jzay,XxzY->IXJY', e_cvs, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixya,Jzwa,XxwYzy->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixya,Jzwa,XxwyzY->IXJY', e_cvs, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,Ixyz,JXYy,xz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXYz,xy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXwy,Yzwx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,JXwz,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JXwz,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JXzw,Yywx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,JXzw,Yyxw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JXzy,Yx->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JwYy,Xxwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,Ixyz,JwYz,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuy,XxuYwz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuy,XxuwYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwuy,XxuwzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuy,XxuzYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwuy,XxuzwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwuz,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,Jwuz,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,JwzY,Xxwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,JwzY,Xxyw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzu,XxuYwy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzu,XxuwYy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzu,XxuwyY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwzu,XxuyYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jwzu,XxuywY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jwzy,XxYw->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,Jwzy,XxwY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,Ixyz,JxYw,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,Ixyz,JxwY,Xwyz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,JxwY,Xwzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jxwu,XwuYzy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,Ixyz,Jxwu,XwuyYz->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jxwu,XwuyzY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jxwu,XwuzYy->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jxwu,XwuzyY->IXJY', e_cvs, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,Ixyz,Jz,XxYy->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,Ixyz,Jz,XxyY->IXJY', e_cvs, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIXa,Jixa,Yx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxa,JiYa,Xx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,JXYa,Ixay,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXYa,Ixya,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXab,Ixba,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXax,IYya,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXax,Iyxa,Yy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,JXax,Iyza,Yzxy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,JXax,Iyza,Yzyx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXba,Ixab,Yx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,IYay,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Ia,Yx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Iyax,Yy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JXxa,Iyaz,Yzxy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,JXxa,Iyza,Yzxy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,JXxa,Iyza,Yzyx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IYxa,Xx->IXJY', e_extern, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IxXa,Yx->IXJY', e_extern, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Ja,Ixya,XxYy->IXJY', e_extern, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Ja,Ixya,XxyY->IXJY', e_extern, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,JiYa,Iixa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JiYa,iIxa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jixa,Iiya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('a,Jixa,Iiya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jixa,iIya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,Jixa,iIya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,JiYa,Iixa,Xx->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JiYa,iIxa,Xx->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiXa,Yx->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jixa,Iiya,XxYy->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('a,Jixa,Iiya,XxyY->IXJY', e_extern, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIXa,Yx->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jixa,iIya,XxYy->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,Jixa,iIya,XxyY->IXJY', e_extern, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Ia,Xx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxYa,IyXa,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,IyaX,xy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Iyaz,Xyxz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxYa,Iyza,Xyzx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaY,IyXa,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,JxaY,Iyza,Xyxz->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,JxaY,Iyza,Xyzx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxab,IYba,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxab,Iyba,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxab,Iyba,XyxY->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,Jxay,IYXa,xy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IYya,Xx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IYza,Xyzx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IzXa,Yxzy->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izwa,XyzYwx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izwa,XyzwYx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxay,Izwa,XyzwxY->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izwa,XyzxYw->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxay,Izwa,XyzxwY->IXJY', e_extern, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxay,Izya,XzYx->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxay,Izya,XzxY->IXJY', e_extern, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxba,IYab,Xx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxba,Iyab,XyYx->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxba,Iyab,XyxY->IXJY', e_extern, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IYXa,xy->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IYay,Xx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,IYaz,Xyxz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IYaz,Xyzx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IYza,Xyxz->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,IYza,Xyzx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Ia,XyYx->IXJY', e_extern, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,Ia,XyxY->IXJY', e_extern, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IzXa,Yxyz->IXJY', e_extern, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,IzaX,Yxyz->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IzaX,Yxzy->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izaw,XyzYwx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izaw,XyzwYx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izaw,XyzwxY->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izaw,XyzxYw->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,Izaw,XyzxwY->IXJY', e_extern, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izay,XzYx->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,Izay,XzxY->IXJY', e_extern, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,Izwa,XyzYwx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,Izwa,XyzwYx->IXJY', e_extern, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJYa,Iixa,Xx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiXa,Yx->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,iJxa,Iiya,XxYy->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,iJxa,Iiya,XxyY->IXJY', e_extern, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJYa,Iixa,Xx->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiXa,Yx->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('a,iJxa,Iiya,XxYy->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('a,iJxa,Iiya,XxyY->IXJY', e_extern, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXa,iJxa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IiXx,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXx,Jixy,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,JiyY,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JiYy,xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixX,Jiyx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('i,IixX,Jiyz,Yxyz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixX,Jiyz,Yxzy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Iixa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixa,iJYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixa,iJya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixa,iJya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiYx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixy,JiYy,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,JiYz,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiyY,Xx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jiyz,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jiyz,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('i,Iixy,JizY,Xzxy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,JizY,Xzyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwYyx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizw,XzwxYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwxyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwyYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwyxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jizx,XzYy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizx,XzyY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizy,XzYx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Iixy,Jizy,XzxY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,Iixa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYa,iIxa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYx,Iixy,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,Iiyx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JixY,Iiyx,Xy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixa,Iiya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Jixa,Iiya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixa,iIya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixa,iIya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiXx,Yy->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,IiXy,Yx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyX,Yx->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iiyz,XxYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iiyz,XxzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iizx,XyYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iizx,XyzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixy,Iizy,XxYz->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Jixy,Iizy,XxzY->IXJY', e_cvs, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIXa,Jixa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxa,JiYa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,iIxa,Jiya,XyYx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,iIxa,Jiya,XyxY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJYa,Iixa,Xx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiXa,Yx->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,iJxa,Iiya,XxYy->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,iJxa,Iiya,XxyY->IXJY', e_cvs, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXa,Jixa,Yx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXa,iJxa,Yx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IiXx,JiYy,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiXx,Jixy,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,JiyY,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiXx,Jiyx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiXx,Jiyz,Yxyz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixX,JiYy,xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixX,Jiyx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('i,IixX,Jiyz,Yxyz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixX,Jiyz,Yxzy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixa,JiYa,Xx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixa,Jiya,XyYx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Iixa,Jiya,XyxY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixa,iJYa,Xx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixa,iJya,XyYx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixa,iJya,XyxY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiYx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Iixy,JiYy,Xx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iixy,JiYz,Xzxy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Iixy,JiyY,Xx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jiyz,XzYx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jiyz,XzxY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('i,Iixy,JizY,Xzxy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,JizY,Xzyx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwYyx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizw,XzwxYy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwxyY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwyYx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizw,XzwyxY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Iixy,Jizx,XzYy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Iixy,Jizx,XzyY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Iixy,Jizy,XzYx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Iixy,Jizy,XzxY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYa,Iixa,Xx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYa,iIxa,Xx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JiYx,Iixy,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiYx,Iiyx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,JixY,Iiyx,Xy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiXa,Yx->IXJY', e_val, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixa,Iiya,XxYy->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Jixa,Iiya,XxyY->IXJY', e_val, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIXa,Yx->IXJY', e_val, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixa,iIya,XxYy->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixa,iIya,XxyY->IXJY', e_val, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiXx,Yy->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,IiXy,Yx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyX,Yx->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iiyz,XxYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iiyz,XxzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('i,Jixy,Iizx,XyYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,Jixy,Iizx,XyzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,Jixy,Iizy,XxYz->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('i,Jixy,Iizy,XxzY->IXJY', e_val, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIXa,Jixa,Yx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxa,JiYa,Xx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,iIxa,Jiya,XyYx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,iIxa,Jiya,XyxY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJYa,Iixa,Xx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiXa,Yx->IXJY', e_val, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('i,iJxa,Iiya,XxYy->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,iJxa,Iiya,XxyY->IXJY', e_val, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxa,Jyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IYxa,Jyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IYxy,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IYxy,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixa,iJya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iiyx,Jizw,Yywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Iiyx,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixa,Jiya,Yy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixa,iJya,Yy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iixy,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iixy,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iiyx,Jizw,Yywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Iiyx,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iiyx,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyax,JzYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xx,Iyax,Jzwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iyax,Jzwa,Yzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Ja,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iyxa,JzYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,JzaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Jzaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxa,Jzwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Iyxz,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Iyxz,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyxz,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyxz,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyxz,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Iyzx,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xx,Iyzx,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xx,Iyzx,Jwuz,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Iyzx,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Iyzx,Jywu,Yzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Iyzx,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYa,Iyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,JxYa,Iyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,JxYy,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,JxYy,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxab,Iyba,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxay,IYza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxay,Izwa,Ywyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Jxay,Izwa,Ywzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxay,Izya,Yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,IYaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Ia,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Izaw,Ywyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxya,Izay,Yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Jxya,Izwa,Ywyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxya,Izwa,Ywzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,IYwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,IYzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Jxyz,Iwuy,Yuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxyz,Iwuy,Yuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xx,Jxyz,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xx,Jxyz,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iwzu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iwzy,Yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jxyz,Iz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,iIxa,Jiya,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,iIxa,Jiya,Yy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXa,Jyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IxXa,Jyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,IxXy,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,IxXy,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixab,Jyba,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixay,JXza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixay,Jzwa,Xwyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Ixay,Jzwa,Xwzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixay,Jzya,Xz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,JXaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Ja,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Jzaw,Xwyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixya,Jzay,Xz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Ixya,Jzwa,Xwyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixya,Jzwa,Xwzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,JXwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,JXzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Ixyz,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixyz,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Ixyz,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Ixyz,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jwzu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jwzy,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Ixyz,Jz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxa,Iyaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,JXxa,Iyza,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,JXxy,Izwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,JXxy,Izyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,Iiya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixa,iIya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iiyz,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,Iizy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jiyx,Iizw,Xywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Jiyx,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,Iizy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixa,Iiya,Xy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixa,iIya,Xy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iiyz,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jixy,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jixy,Iizy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jiyx,Iizw,Xywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Jiyx,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jiyx,Iizy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyax,IzXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yx,Jyax,Izwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jyax,Izwa,Xzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Ia,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jyxa,IzXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,IzaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Izaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxa,Izwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yx,Jyxz,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yx,Jyxz,IyXw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyxz,IywX,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyxz,Iywu,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyxz,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yx,Jyzx,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yx,Jyzx,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yx,Jyzx,Iwuz,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,Jyzx,IyXw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yx,Jyzx,Iywu,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yx,Jyzx,Iywu,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,iJxa,Iiya,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yx,iJxa,Iiya,Xy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYXx,Jzwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IYXx,Jzyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYax,JXza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYax,Jzwa,Xwyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYax,Jzwa,Xwzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYax,Jzya,Xz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,JXaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,Ja,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxa,Jzaw,Xwyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxa,Jzay,Xz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYxa,Jzwa,Xwyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYxa,Jzwa,Xwzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxz,JXwy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,JXzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IYxz,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYxz,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYxz,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYxz,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,Jwzu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYxz,Jwzy,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYxz,Jz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IYzx,JXwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,JXyw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYzx,Jwuy,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IYzx,Jwuy,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IYzx,Jwuz,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IYzx,Jwuz,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jwyu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jwyz,Xw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IYzx,Jy,Xz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,JizY,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixX,JiYz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixX,Jizw,Yywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IixX,Jizw,Yyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixX,Jizy,Yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,JiYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixa,Jiza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iixa,Jiza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixa,iJYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixa,iJza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixa,iJza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JiYw,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iixz,JiYy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiYz,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,JiwY,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,JiwY,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuYzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jiwu,XwuyYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuyzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuzYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuzyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwy,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iixz,Jiwy,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwz,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iixz,Jiwz,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JizY,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jizw,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jizw,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYw,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,Iizx,JiYy,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYz,Xy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,JiwY,Xwyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,JiwY,Xwzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwu,XwuYzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiwu,XwuzYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iizx,Jiwy,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xy,Iizx,Jiwy,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwz,XwYy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiwz,XwyY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iizx,JiyY,Xz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiyw,XwYz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iizx,Jiyw,XwzY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IiXx,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IiXx,Jiyz,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,JizY,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IiXx,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IiXx,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixX,JiYz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixX,Jizw,Yywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IixX,Jizw,Yyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixX,Jizy,Yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixa,JiYa,Xy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixa,Jiza,XzYy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iixa,Jiza,XzyY->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixa,iJYa,Xy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixa,iJza,XzYy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixa,iJza,XzyY->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JiYw,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iixz,JiYy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Iixz,JiYz,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,JiwY,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,JiwY,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuYzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jiwu,XwuyYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuyzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuzYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Iixz,Jiwu,XwuzyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jiwy,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iixz,Jiwy,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Iixz,Jiwz,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iixz,Jiwz,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iixz,JizY,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iixz,Jizw,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iixz,Jizw,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYw,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,Iizx,JiYy,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Iizx,JiYz,Xy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,JiwY,Xwyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,JiwY,Xwzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwu,XwuYzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiwu,XwuzYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Iizx,Jiwy,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xy,Iizx,Jiwy,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Iizx,Jiwz,XwYy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiwz,XwyY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Iizx,JiyY,Xz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Iizx,Jiyw,XwYz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xy,Iizx,Jiyw,XwzY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ix,JXzy,Yz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ix,JzYy,Xz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ix,Jzwy,XwYz->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Ix,Jzwy,XwzY->IXJY', h_aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Ja,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXa,JzYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,JzaY,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Jzaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXa,Jzwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,JwzY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jwzu,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IxXz,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,JywY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxXz,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxXz,Jz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaX,JzYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxaX,Jzwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxaX,Jzwa,Yzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixab,JXba,Yy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixab,Jzba,XyYz->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixab,Jzba,XyzY->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixaz,JXYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JXwa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JXza,Yy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixaz,JwYa,Xywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwua,XyuYwz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwua,XyuwYz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixaz,Jwua,XyuwzY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwua,XyuzYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixaz,Jwua,XyuzwY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixaz,Jwza,XyYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixaz,Jwza,XywY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzX,JwYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxzX,Jwuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxzX,Jwuz,Ywyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzX,JyYw,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IxzX,Jywu,Yzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IxzX,Jywu,Yzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JXYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JXaw,Yzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,JXaw,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JXaz,Yy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,JXwa,Yzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JXwa,Yzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Ja,XyYz->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,Ja,XyzY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixza,JwYa,Xyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,JwaY,Xywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,JwaY,Xyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwau,XyuYwz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwau,XyuwYz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwau,XyuwzY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwau,XyuzYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixza,Jwau,XyuzwY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwaz,XyYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,Jwaz,XywY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixza,Jwua,XyuYwz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixza,Jwua,XyuzwY->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixzw,JXYz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,JXuw,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JXuw,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXuz,Ywuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JXwu,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,JXwu,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JXwz,Yy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JuYw,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Ixzw,JuYz,Xyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juvw,XyvYuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Juvw,XyvzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvz,XyvYuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvz,XyvuYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juvz,XyvuwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvz,XyvwYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juvz,XyvwuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,JuwY,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,JuwY,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwv,XyvYuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwv,XyvuYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwv,XyvuzY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juwv,XyvzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Ixzw,Juwv,XyvzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Juwz,XyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Juwz,XyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Ixzw,Jw,XyYz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jw,XyzY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Ixzw,JyYu,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ixzw,JyuY,Xuwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Ixzw,JyuY,Xuzw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jyuv,XuvYwz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jyuv,XuvwYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jyuv,XuvwzY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Ixzw,Jyuv,XuvzYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Ixzw,Jyuv,XuvzwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xy,IzXx,JwYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jwuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,JwyY,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jwyu,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,Jy,Yz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzXx,JzYw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzXx,JzwY,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzXx,Jzwu,Yywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izax,JXYa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izax,JXwa,Yywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izax,JXya,Yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izax,JwYa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izax,Jwua,XzuYwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izax,Jwua,XzuwYy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izax,Jwua,XzuwyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izax,Jwua,XzuyYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izax,Jwua,XzuywY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izax,Jwya,XzYw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izax,Jwya,XzwY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Izwx,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JXYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izwx,JXuw,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,JXuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JXuy,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JXyu,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,JXyu,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JXyw,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izwx,JuYw,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izwx,JuYy,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Juvw,XzvYuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Juvw,XzvuYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izwx,Juvw,XzvuyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Juvw,XzvyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Juvw,XzvyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juvy,XzvYuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,Juvy,XzvwuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,JuyY,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,JuyY,Xzwu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyv,XzvYuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyv,XzvuYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyv,XzvuwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juyv,XzvwYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Juyv,XzvwuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Juyw,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,Juyw,XzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izwx,Jy,XzYw->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izwx,Jy,XzwY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izwx,JzYu,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,JzuY,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,JzuY,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izwx,Jzuv,XuvYwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izwx,Jzuv,XuvwYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxX,JwYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IzxX,Jwuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IzxX,Jwuy,Ywzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxX,JzYw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IzxX,Jzwu,Yyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IzxX,Jzwu,Yywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxa,JXYa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JXaw,Yywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,JXaw,Yyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxa,JXay,Yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,JXwa,Yywz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JXwa,Yyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Ja,XzYy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,Ja,XzyY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxa,JwYa,Xzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,JwaY,Xzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,JwaY,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwau,XzuYwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwau,XzuwYy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwau,XzuwyY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Jwau,XzuyYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxa,Jwau,XzuywY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,Jway,XzYw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izxa,Jway,XzwY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxa,Jwua,XzuYwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxa,Jwua,XzuywY->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxw,JXYw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,Izxw,JXYy,zw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,JXuw,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JXuw,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JXuy,Ywuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JXwu,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,JXwu,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JXwy,Yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Izxw,JuYw,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Izxw,JuYy,Xzuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Juvw,XzvYuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Juvw,XzvyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juvy,XzvYuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juvy,XzvuYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Juvy,XzvuwY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juvy,XzvwYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,Juvy,XzvwuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,JuwY,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,JuwY,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juwv,XzvYuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juwv,XzvuYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juwv,XzvuyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Juwv,XzvyYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Juwv,XzvyuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Juwy,XzYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Izxw,Juwy,XzuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jw,XzYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Izxw,Jw,XzyY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Izxw,JzYu,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,JzuY,Xuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Izxw,JzuY,Xuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jzuv,XuvYwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jzuv,XuvwYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jzuv,XuvwyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Izxw,Jzuv,XuvyYw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Izxw,Jzuv,XuvywY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXax,IYza,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXax,Izwa,Ywyz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,JXax,Izwa,Ywzy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,IYaz,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,Ia,Yy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxa,Izaw,Ywyz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,JXxa,Izwa,Ywyz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXxa,Izwa,Ywzy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,IYzw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXxz,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,JXxz,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,Iwzu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXxz,Iz,Yy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JXzx,IYwz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,JXzx,Iwuz,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,JXzx,Iwuz,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiYx,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,IizX,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixY,IiXz,yz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JixY,Iizw,Xywz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,JixY,Iizw,Xyzw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixa,Iiza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Jixa,Iiza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixa,iIza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixa,iIza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,IiwX,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwX,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzYuw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzuYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzuwY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iiwu,XyzwYu->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzwuY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixz,Iiwz,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Jixz,Iiwz,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizX,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iizw,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,Iizw,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXw,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXz,Yy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwX,Ywyz->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,IiwX,Ywzy->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwu,XyzYuw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,Iiwu,XyzwuY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwz,XyYw->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,Iiwz,XywY->IXJY', h_aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiYx,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,IizX,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiYx,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixY,IiXz,yz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JixY,Iizw,Xywz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,JixY,Iizw,Xyzw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiXa,Yy->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixa,Iiza,XyYz->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Jixa,Iiza,XyzY->IXJY', h_aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIXa,Yy->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixa,iIza,XyYz->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixa,iIza,XyzY->IXJY', h_aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IiXw,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,IiXz,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,IiwX,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwX,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzYuw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzuYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzuwY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iiwu,XyzwYu->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,Iiwu,XyzwuY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jixz,Iiwz,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,Jixz,Iiwz,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizX,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,Iizw,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,Iizw,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXw,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,IiXz,Yy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwX,Ywyz->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,IiwX,Ywzy->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwu,XyzYuw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,Iiwu,XyzwuY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,Iiwz,XyYw->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,Iiwz,XywY->IXJY', h_aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Ia,Xy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxYa,IzXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,IzaX,yz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Izaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYa,Izwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxYz,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,IwzX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iwzu,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxYz,Iz,Xy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaY,IzXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,JxaY,Izwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JxaY,Izwa,Xzyw->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxab,IYba,Xy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxab,Izba,XzYy->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxab,Izba,XzyY->IXJY', h_aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxaz,IYXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IYwa,Xzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IYza,Xy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IwXa,Yywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwua,XzwYuy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwua,XzwuYy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxaz,Iwua,XzwuyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwua,XzwyYu->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxaz,Iwua,XzwyuY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxaz,Iwza,XwYy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxaz,Iwza,XwyY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzY,IwXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,JxzY,Iwuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JxzY,Iwuz,Xwyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IYXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IYaw,Xzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,IYaw,Xzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IYaz,Xy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,IYwa,Xzwy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IYwa,Xzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Ia,XzYy->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,Ia,XzyY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IwXa,Yyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IwaX,Yywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,IwaX,Yyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwau,XzwYuy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwau,XzwuYy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwau,XzwuyY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwau,XzwyYu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,Iwau,XzwyuY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwaz,XwYy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,Iwaz,XwyY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,Iwua,XzwYuy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,Iwua,XzwuYy->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxzw,IYXz,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,IYuw,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IYuw,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYuz,Xwuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IYwu,Xzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,IYwu,Xzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IYwz,Xy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuXw,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuXz,Yyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuvw,XzuYvy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,Iuvw,XzuvYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvz,XwuYvy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvz,XwuvYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuvz,XwuvyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvz,XwuyYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuvz,XwuyvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IuwX,Yyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,IuwX,Yyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwv,XzuYvy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwv,XzuvYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwv,XzuvyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuwv,XzuyYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,Iuwv,XzuyvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iuwz,XuYy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,Iuwz,XuyY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,Iw,XzYy->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,Iw,XzyY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzYx,IzXw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzYx,IzwX,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzYx,Izwu,Xywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzax,IYXa,yz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IYwa,Xywz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IwXa,Yzwy->IXJY', h_aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzax,Iwua,XywYuz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzax,Iwua,XywuYz->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzax,Iwua,XywuzY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzax,Iwua,XywzYu->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzax,Iwua,XywzuY->IXJY', h_aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzwx,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IYuw,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IuXw,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Iuvw,XyuYvz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Iuvw,XyuvYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzwx,Iuvw,XyuvzY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Iuvw,XyuzYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Iuvw,XyuzvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IzXu,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jzwx,IzuX,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,IzuX,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,Izuv,XywYvu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jzwx,Izuv,XywuvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxY,IzXw,yw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,JzxY,Izwu,Xyuw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,JzxY,Izwu,Xywu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IYXa,yz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IYaw,Xywz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,IYaw,Xyzw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,IYwa,Xywz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IYwa,Xyzw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Ia,XyYz->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,Ia,XyzY->IXJY', h_aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IwXa,Yzyw->IXJY', h_aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IwaX,Yzwy->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,IwaX,Yzyw->IXJY', h_aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwau,XywYuz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwau,XywuYz->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwau,XywuzY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Iwau,XywzYu->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,Iwau,XywzuY->IXJY', h_aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,Iwua,XywYuz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,Iwua,XywuYz->IXJY', h_aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IYXw,yz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,IYuw,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IYuw,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IYwu,Xyuz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,IYwu,Xyzu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IuXw,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iuvw,XyuYvz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,Iuvw,XyuvYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IuwX,Yzuy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,IuwX,Yzyu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuwv,XyuYvz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuwv,XyuvYz->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuwv,XyuvzY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iuwv,XyuzYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Iuwv,XyuzvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Iw,XyYz->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,Iw,XyzY->IXJY', h_aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IzXu,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IzuX,Yuwy->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jzxw,IzuX,Yuyw->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Izuv,XywYvu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,Izuv,XywuYv->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Izuv,XywuvY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Izuv,XywvYu->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,Izuv,XywvuY->IXJY', h_aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxa,JiYa,Xy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iIxa,Jiza,XzYy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,iIxa,Jiza,XzyY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiXa,Yy->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iJxa,Iiza,XyYz->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,iJxa,Iiza,XyzY->IXJY', h_aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxa,JiYa,Xy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iIxa,Jiza,XzYy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,iIxa,Jiza,XzyY->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiXa,Yy->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,iJxa,Iiza,XyYz->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,iJxa,Iiza,XyzY->IXJY', h_aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixa,Jiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixa,iJza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jiwu,yzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixz,Jiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jizw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iizx,Jiwu,yzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iizx,Jiwu,yzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iizx,Jiwz,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixa,Jiza,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixa,iJza,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jiwu,yzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Iixz,Jiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iixz,Jizw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iizx,Jiwu,yzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iizx,Jiwu,yzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iizx,Jiwz,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyab,Jzba,xz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iyaz,Jwua,xuwz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyaz,Jwua,xuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyaz,Jwza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Ja,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Jwau,xuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyza,Jwaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyza,Jwua,xuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iyza,Jwua,xuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyzw,Juvw,xvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iyzw,Juvw,xvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Iyzw,Juvz,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Iyzw,Juvz,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Juwv,xvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Juwz,xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Iyzw,Jw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Iyzw,Jxuv,zwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('XxyY,Iyzw,Jxuv,zwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Izax,Jwua,ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Izax,Jwua,ywzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Izwx,Juvw,yuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Izwx,Juvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Izwx,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Izwx,Jzuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Jwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxa,Jwua,ywuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Juvw,yuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Izxw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Izxw,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiya,Iiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiya,iIza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jiyz,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiyz,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jizy,Iiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jizy,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jizy,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jizy,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiya,Iiza,xz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiya,iIza,xz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jiyz,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jiyz,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxyY,Jiyz,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jiyz,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jizy,Iiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jizy,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jizy,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyY,Jizy,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxab,Izba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jxaz,Iwua,yuwz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxaz,Iwua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxaz,Iwza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Iwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxza,Iwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxza,Iwua,yuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jxza,Iwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxzw,Iuvw,yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jxzw,Iuvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jxzw,Iuvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jxzw,Iuvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iuwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iuwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jxzw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jy,Izwx,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jy,Izxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Jzay,Iwua,xwuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jzay,Iwua,xwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzay,Iwxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Jzwy,Iuvw,xuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('XxyY,Jzwy,Iuvw,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('XxyY,Jzwy,Iuvx,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('XxyY,Jzwy,Iuvx,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Iuxv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Iuxw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzwy,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('XxyY,Jzwy,Izuv,xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('XxyY,Jzwy,Izuv,xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Ia,xz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Iwau,xwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzya,Iwax,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzya,Iwua,xwuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XxyY,Jzya,Iwxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iuvw,xuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzyw,Iuvx,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iuwv,xuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyY,Jzyw,Iuwx,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Iuxv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Iuxw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('XxyY,Jzyw,Iw,xz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('XxyY,Jzyw,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,Jzyw,Izuv,xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iIxa,Jiza,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iJya,Iiza,xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iIxa,Jiza,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('XxyY,iJya,Iiza,xz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IYaz,Jwua,ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYaz,Jwua,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IYwz,Juvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYwz,Juvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxa,Jwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYxa,Jwua,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYxa,Jzaw,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYxa,Jzwa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYxw,Juvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Juwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IYxw,Jzuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IYxw,Jzuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IYxw,Jzwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYza,Ja,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYza,Jwau,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYza,Jwua,ywux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IYza,Jwua,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IYzw,Juvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IYzw,Juvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYzw,Juwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IYzw,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,JiYu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiwx,JiYw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYu,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,JiuY,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,JiuY,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,Jiuw,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixa,JiYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,Jiwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,iJYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixa,iJwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiYu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixw,JiYw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,JiuY,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iixw,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiwY,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,Jiwu,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixz,JiYw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,JiwY,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,Jiwu,Yywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiza,JiYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iiza,Jiwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iiza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiza,iJYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiza,iJwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiza,iJwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiYu,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iizw,JiYw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,JiuY,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,JiuY,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuxv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywvux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywvxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iizw,Jiuw,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiwY,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,Jiwu,Yyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizx,JiYw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizx,Jiwu,Yyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizx,Jiwu,Yywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,JiYu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiwx,JiYw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iiwx,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYu,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiwz,JiYw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,JiuY,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,JiuY,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiwz,Jiuw,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiwz,Jiuw,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixa,JiYa,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,Jiwa,Yywz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixa,iJYa,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixa,iJwa,Yywz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiYu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Iixw,JiYw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,JiuY,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iixw,Jiuv,Yywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iixw,Jiuv,Yywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixw,JiwY,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixw,Jiwu,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iixz,JiYw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,JiwY,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iixz,Jiwu,Yywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iiza,JiYa,yx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iiza,Jiwa,Yywx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iiza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iiza,iJYa,yx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iiza,iJwa,Yywx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iiza,iJwa,Yyxw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiYu,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iizw,JiYw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,JiuY,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,JiuY,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywuxv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywvux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywvxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iizw,Jiuv,Yywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iizw,Jiuw,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iizw,Jiuw,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizw,JiwY,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizw,Jiwu,Yyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizw,Jiwu,Yyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iizx,JiYw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iizx,Jiwu,Yyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iizx,Jiwu,Yywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwax,JuYa,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwax,Juva,Yyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwax,Juva,Yyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwax,JzYa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwax,Jzua,Yyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwax,Jzua,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwaz,JuYa,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuvwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuvxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuwvx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuwxv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwaz,Juva,Yyuxvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwux,JvYu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwux,Jvsu,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jvsu,Yyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,JwYv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwux,Jwvs,Yyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwux,JzYu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwux,JzYv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Iwux,JzvY,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwux,JzvY,yuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Iwux,Jzvs,Yyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwux,Jzvs,Yyuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwux,Jzvu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwux,Jzvu,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwuz,JvYu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvwsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jvsu,Yyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwuz,JwYv,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwuz,JwvY,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,JwvY,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwuz,Jwvs,Yyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwuz,Jwvs,Yyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,Ja,Yywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxa,JuYa,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,JuaY,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuvwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuwvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwxa,Juav,Yyuwzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuzvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxa,Juav,Yyuzwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxa,Juva,Yyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxa,JzYa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,JzaY,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,Jzau,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxa,Jzua,Yyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,Ju,Yywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,JvYu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,Jvsu,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwxu,JvuY,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwxu,Jvus,Yyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwxu,Jvus,Yyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxu,JwYv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,JwvY,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwxu,Jwvs,Yyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwxu,Jwvs,Yyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxu,JzYu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Iwxu,JzYv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,JzuY,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,Jzuv,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,JzvY,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Iwxu,Jzvs,Yyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxu,Jzvu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iwxz,JwYu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxz,JwuY,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwxz,Jwuv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwza,Ja,Yywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Ja,Yyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwza,JuYa,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,JuaY,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwza,JuaY,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juav,Yyuvwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juav,Yyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juav,Yyuwvx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Juav,Yyuwxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwza,Juav,Yyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwza,Juva,Yyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwza,Juva,Yyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwzu,Ju,Yywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Ju,Yyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iwzu,JvYu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwzu,Jvsu,Yyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jvsu,Yyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,JvuY,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iwzu,JvuY,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvwsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jvus,Yyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwzu,JwYv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,JwvY,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwzu,JwvY,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyusvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyusxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iwzu,Jwvs,Yyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iwzx,JwYu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iwzx,Jwuv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iwzx,Jwuv,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Ix,JzYw,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Ix,JzwY,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Ix,Jzwu,Yywu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyab,Jwba,Ywxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iyab,Jwba,Ywzx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iyaw,JuYa,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuvxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuvzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuxvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuzvx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iyaw,Juva,Ywuzxv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iyaw,Juwa,Yuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iyaw,Juwa,Yuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Ja,Ywxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywa,Ja,Ywzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywa,JuYa,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,JuaY,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywa,JuaY,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juav,Ywuvxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juav,Ywuvzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juav,Ywuxvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywa,Juav,Ywuzvx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juav,Ywuzxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juaw,Yuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywa,Juaw,Yuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywa,Juva,Ywuvxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywa,Juva,Ywuxvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Ju,Ywxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Ju,Ywzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywu,JvYu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Iywu,JvYw,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jvsu,Ywvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvsu,Ywvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvzsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvsw,Yuvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,JvuY,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,JvuY,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvzsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvus,Ywvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Iywu,Jvuw,Yvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jvuw,Yvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iywu,JxYv,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,Jxvs,Ywusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iywu,Jxvs,Ywuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Iywu,JzYv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,JzvY,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Iywu,JzvY,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywusvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywusxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Iywu,Jzvs,Ywuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JiYy,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiuw,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iiux,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Xxyz,Jiwy,Iiuz,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixu,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiwy,Iixz,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iizu,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iizx,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JiyY,Iiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JiyY,Iiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiya,Iixa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiya,iIwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiya,iIwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiya,iIxa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvwzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiyw,Iiuw,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiyw,Iiux,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiyw,Iiuz,Yuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiwu,Yuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iiwx,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixu,Yuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiyw,Iixw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixz,Yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JiYy,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,JiYy,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiYy,Iizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwy,Iiuw,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiuw,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iiux,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iiux,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Xxyz,Jiwy,Iiuz,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiwy,Iiuz,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixu,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iixw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiwy,Iixz,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiwy,Iizu,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwy,Iizu,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwy,Iizx,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JiyY,Iiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JiyY,Iiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JiyY,Iixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiya,Iixa,Yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiya,iIwa,Ywxz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiya,iIwa,Ywzx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiya,iIxa,Yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvwzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiuv,Yuvzxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jiyw,Iiuw,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jiyw,Iiuw,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiux,Yuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiyw,Iiux,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jiyw,Iiuz,Yuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiuz,Yuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiyw,Iiwu,Yuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiyw,Iiwu,Yuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iiwx,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixu,Yuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,Jiyw,Iixw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiyw,Iixz,Yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Iuxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Iuxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iuzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JwYy,Iwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,JwYy,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwYy,Iz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jway,IYua,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jway,IYxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jway,IYza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jway,Iuva,Ywvuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jway,Iuva,Ywvuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jway,Iuva,Ywvxuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jway,Iuva,Ywvzux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jway,Iuva,Ywvzxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jway,Iuxa,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jway,Iuza,Ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jway,Iuza,Ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwuy,IYvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,IYvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,IYvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jwuy,IYxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,IYzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,IYzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,IYzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywsvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Ivsu,Ywszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivsx,Ywszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,Ivsz,Ywsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivsz,Ywsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jwuy,Ivxs,Ywsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivxs,Ywszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ivxu,Ywvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ivxz,Ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Ivzs,Ywsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,Ivzu,Ywvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzu,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,Ivzx,Ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Ivzx,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuy,Iwvs,Yvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuy,Iwvs,Yvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwuy,Ix,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwuy,Iz,Ywux->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwuy,Iz,Ywxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,JwyY,Iuvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,JwyY,Iuvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,JwyY,Iuvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,JwyY,Iuvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Iuxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Iuxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JwyY,Iwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JwyY,Iwuv,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JwyY,Ix,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,IYau,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,IYau,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,IYaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,IYua,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,IYua,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,IYxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Ia,Ywxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Ia,Ywzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvxuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvzux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Iuav,Ywvzxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Iuax,Ywuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwya,Iuax,Ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwya,Iuaz,Ywux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Iuaz,Ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwya,Iuva,Ywvxuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwya,Iuva,Ywvzux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwya,Iuxa,Ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,IYuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,IYuv,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,IYvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,IYvu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,IYxv,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jwyu,IYxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iu,Ywxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Iu,Ywzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Ivsu,Ywsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivsu,Ywszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivsx,Ywsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwyu,Ivsx,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwyu,Ivsz,Ywsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywsvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Ivus,Ywszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivux,Ywvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwyu,Ivux,Ywzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jwyu,Ivuz,Ywvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwyu,Ivuz,Ywxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxs,Ywszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxu,Ywzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ivxz,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvsuzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvszux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwyu,Iwvs,Yvszxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwyu,Ix,Ywzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Iwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYa,Iwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYa,Iwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYa,Iwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYw,Iuvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iuvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iuwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iuwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iuzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JxYw,Iuzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,JxYw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,JxYw,Iz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxab,IYba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxab,Iwba,Yywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,IYua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxaw,IYwa,yz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,IYza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxaw,Iuva,Yyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxaw,Iuva,Yyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxaw,Iuwa,Yyuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxaw,Iuza,Yyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxaw,Iuza,Yywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,IYau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxwa,IYaw,yz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,IYaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Ia,Yywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwa,Iuav,Yyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuav,Yyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Iuaw,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwa,Iuaz,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwa,Iuva,Yyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwa,Iuza,Yyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwa,Iuza,Yywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYuv,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jxwu,IYuw,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYuz,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,IYvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jxwu,IYvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jxwu,IYzv,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,IYzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,IYzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Iu,Yywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jxwu,Ivsu,Yyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivsw,Yysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivsw,Yysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yysvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yysvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivsz,Yyswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jxwu,Ivus,Yyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivus,Yyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Ivuw,Yyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jxwu,Ivuz,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivzs,Yysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jxwu,Ivzs,Yyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivzu,Yyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivzu,Yywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jxwu,Ivzw,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Ivzw,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jxwu,Iz,Yyuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jxwu,Iz,Yywu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,IYwz,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,IYxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jy,Iwux,Yuwz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jy,Iwux,Yuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jy,Iwuz,Yuwx->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jy,Iwuz,Yuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Iwxu,Yuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Iwxz,Yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jy,Ix,Yz->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Ia,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Iwau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYa,Iwua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iuvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iuwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,JzYw,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JzaY,Iwua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JzaY,Iwua,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzab,IYba,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzab,Iwba,Yywx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzab,Iwba,Yyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzaw,IYua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzaw,IYwa,yx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvwux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvwxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzaw,Iuva,Yyvxuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzaw,Iuwa,Yyux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzaw,Iuwa,Yyxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,JzwY,Iuvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,JzwY,Iuvw,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,IYau,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwa,IYau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwa,IYaw,yx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwa,IYua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,IYua,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwa,Ia,Yywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Ia,Yyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvwux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwa,Iuav,Yyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwa,Iuaw,Yyux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuaw,Yyxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwa,Iuva,Yyvwux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwa,Iuva,Yyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,IYuv,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwu,IYuv,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwu,IYuw,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwu,IYvu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,IYvu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jzwu,IYvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwu,Iu,Yywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Iu,Yyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwu,Ivsu,Yyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivsu,Yysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivsw,Yysxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivus,Yysvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivus,Yysvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivus,Yyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivus,Yyswxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jzwu,Ivus,Yysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jzwu,Ivuw,Yyvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jzwu,Ivuw,Yyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iIxa,JiYa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIxa,Jiwa,Yywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIza,JiYa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,iIza,Jiwa,Yywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iIza,Jiwa,Yyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iJya,Iiwa,Ywxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,iJya,Iiwa,Ywzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJya,Iixa,Yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iIxa,JiYa,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIxa,Jiwa,Yywz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIza,JiYa,yx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,iIza,Jiwa,Yywx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iIza,Jiwa,Yyxw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,iJya,Iiwa,Ywxz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,iJya,Iiwa,Ywzx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJya,Iixa,Yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IiXy,Jiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jiwx,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jizw,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiuw,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jiux,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Yxyz,Iiwy,Jiuz,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixu,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixw,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiwy,Jixz,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jizu,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jizx,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IiyX,Jiwu,xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IiyX,Jiwu,xzwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jiwz,xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jixw,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiya,Jixa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiya,iJwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiya,iJwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiya,iJxa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvwzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiyw,Jiuw,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuwz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiyw,Jiux,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiyw,Jiuz,Xuwx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuxw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuxz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiwu,Xuzx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jiwx,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixu,Xuzw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiyw,Jixw,Xz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixz,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IiXy,Jiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jiwx,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,IiXy,Jixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiXy,Jizw,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiwy,Jiuw,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiuw,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jiux,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jiux,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('Yxyz,Iiwy,Jiuz,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiwy,Jiuz,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixu,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jixw,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiwy,Jixz,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiwy,Jizu,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiwy,Jizu,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiwy,Jizx,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IiyX,Jiwu,xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IiyX,Jiwu,xzwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jiwz,xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IiyX,Jixw,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiya,Jixa,Xz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiya,iJwa,Xwxz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiya,iJwa,Xwzx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiya,iJxa,Xz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvwxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvwzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvxwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiuv,Xuvzxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iiyw,Jiuw,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iiyw,Jiuw,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiux,Xuwz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiyw,Jiux,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iiyw,Jiuz,Xuwx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiuz,Xuxw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iiyw,Jiwu,Xuxz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iiyw,Jiwu,Xuzx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jiwx,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixu,Xuzw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Iiyw,Jixw,Xz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Iiyw,Jixz,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Juxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Juxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Juzx,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IwXy,Jwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,IwXy,Jx,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwXy,Jz,xw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iway,JXua,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iway,JXxa,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iway,JXza,xw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iway,Juva,Xwvuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iway,Juva,Xwvuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iway,Juva,Xwvxuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iway,Juva,Xwvzux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iway,Juva,Xwvzxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iway,Juxa,Xwuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iway,Juza,Xwux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iway,Juza,Xwxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Iwuy,JXvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,JXvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,JXvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iwuy,JXxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,JXzu,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,JXzv,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,JXzv,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwsvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jvsu,Xwszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvsx,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,Jvsz,Xwsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvsz,Xwsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Iwuy,Jvxs,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvxs,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jvxu,Xwvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jvxz,Xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jvzs,Xwsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,Jvzu,Xwvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzu,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,Jvzx,Xwuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jvzx,Xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwuy,Jwvs,Xvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwuy,Jwvs,Xvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwuy,Jx,Xwuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwuy,Jz,Xwux->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwuy,Jz,Xwxu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,IwyX,Juvx,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,IwyX,Juvx,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,IwyX,Juvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,IwyX,Juvz,xuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Juxv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Juxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IwyX,Jwuv,xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IwyX,Jwuv,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IwyX,Jx,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,JXau,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,JXau,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,JXaz,xw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,JXua,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,JXua,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,JXxa,zw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Ja,Xwxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Ja,Xwzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juav,Xwvuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juav,Xwvuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juav,Xwvxuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwya,Juav,Xwvzux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Juav,Xwvzxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Juax,Xwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwya,Juax,Xwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwya,Juaz,Xwux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Juaz,Xwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwya,Juva,Xwvxuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwya,Juva,Xwvzux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwya,Juxa,Xwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,JXuv,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,JXuv,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXuz,xw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,JXvu,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,JXvu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXvz,xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXxu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,JXxv,zuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Iwyu,JXxz,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Ju,Xwxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Ju,Xwzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jvsu,Xwsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvsu,Xwszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvsx,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwyu,Jvsx,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Iwyu,Jvsz,Xwsxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwsvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwsvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwsxvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwszvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jvus,Xwszxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvux,Xwvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwyu,Jvux,Xwzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iwyu,Jvuz,Xwvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iwyu,Jvuz,Xwxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxu,Xwzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jvxz,Xwvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvsuxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvsuzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvsxuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvszux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Iwyu,Jwvs,Xvszxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iwyu,Jx,Xwzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Ja,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Jwau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXa,Jwaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXa,Jwua,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXa,Jwza,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXw,Juvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Juvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Juwv,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Juwz,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Juzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IxXw,Juzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,IxXw,Jw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,IxXw,Jz,yw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixab,JXba,yz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixab,Jwba,Xywz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,JXua,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixaw,JXwa,yz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,JXza,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixaw,Juva,Xyvuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixaw,Juva,Xyvwzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixaw,Juwa,Xyuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixaw,Juza,Xyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixaw,Juza,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,JXau,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixwa,JXaw,yz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,JXaz,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Ja,Xywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwa,Juav,Xyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juav,Xyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Juaw,Xyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwa,Juaz,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvuwz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvwuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvwzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvzuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwa,Juva,Xyvzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwa,Juza,Xyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwa,Juza,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXuv,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Ixwu,JXuw,yz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXuz,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXvw,yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,JXvz,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Ixwu,JXvz,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Ixwu,JXzv,yvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,JXzv,yvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,JXzw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Ju,Xywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Ixwu,Jvsu,Xyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvsw,Xysuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvsw,Xysvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xysvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xysvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvsz,Xyswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xysvwz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xysvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyswvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Ixwu,Jvus,Xyswzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyszvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvus,Xyszwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Jvuw,Xyvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Ixwu,Jvuz,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvzs,Xysuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Ixwu,Jvzs,Xyswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvzu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvzu,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Ixwu,Jvzw,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jvzw,Xyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Ixwu,Jz,Xyuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Ixwu,Jz,Xywu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,JXwz,xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,JXxw,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iy,Jwux,Xuwz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iy,Jwux,Xuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Iy,Jwuz,Xuwx->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Iy,Jwuz,Xuxw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jwxu,Xuzw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jwxz,Xw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Iy,Jx,Xz->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Ja,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Jwau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXa,Jwua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Juvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Juwv,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,IzXw,Jw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IzaX,Jwua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IzaX,Jwua,yuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izab,JXba,yx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izab,Jwba,Xywx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izab,Jwba,Xyxw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izaw,JXua,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izaw,JXwa,yx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izaw,Juva,Xyvuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juva,Xyvuxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juva,Xyvwux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juva,Xyvwxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izaw,Juva,Xyvxuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izaw,Juwa,Xyux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izaw,Juwa,Xyxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,IzwX,Juvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,IzwX,Juvw,yvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,JXau,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwa,JXau,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwa,JXaw,yx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwa,JXua,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,JXua,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwa,Ja,Xywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Ja,Xyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juav,Xyvuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juav,Xyvuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juav,Xyvwux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juav,Xyvwxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwa,Juav,Xyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwa,Juaw,Xyux->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juaw,Xyxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwa,Juva,Xyvwux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwa,Juva,Xyvxuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,JXuv,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwu,JXuv,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwu,JXuw,yx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwu,JXvu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,JXvu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Izwu,JXvw,yvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwu,Ju,Xywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Ju,Xyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwu,Jvsu,Xyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvsu,Xysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysvux->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysvxu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvsw,Xysxvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvus,Xysvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvus,Xysvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvus,Xyswvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvus,Xyswxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Izwu,Jvus,Xysxvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Izwu,Jvuw,Xyvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Izwu,Jvuw,Xyxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,JXaz,Iwua,ywux->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXaz,Iwua,ywxu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,JXwz,Iuvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXwz,Iuvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxa,Ia,yz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxa,Iwau,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXxa,Iwua,ywzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXxa,Izaw,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXxa,Izwa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXxw,Iuvw,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Iuwv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Iw,yz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,JXxw,Izuv,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,JXxw,Izuw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,JXxw,Izwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXza,Ia,yx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXza,Iwau,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXza,Iwua,ywux->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,JXza,Iwua,ywxu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,JXzw,Iuvw,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,JXzw,Iuvw,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXzw,Iuwv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,JXzw,Iw,yx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,IiXu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiwx,IiXw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,Iiuw,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXu,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,IiuX,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,IiuX,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,Iiuw,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixa,IiXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,Iiwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,iIXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixa,iIwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiXu,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixw,IiXw,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,IiuX,ywzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jixw,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,Iiuw,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiwX,yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,Iiwu,Xyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixz,IiXw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,IiwX,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,Iiwu,Xywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiza,IiXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jiza,Iiwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jiza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiza,iIXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiza,iIwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiza,iIwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiXu,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jizw,IiXw,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,IiuX,ywux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,IiuX,ywxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuxv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywvux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywvxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jizw,Iiuw,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiwX,yx->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,Iiwu,Xyux->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyxu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizx,IiXw,yw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizx,Iiwu,Xyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizx,Iiwu,Xywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,IiXu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiwx,IiXw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jiwx,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwx,Iiuw,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXu,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiwz,IiXw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,IiuX,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,IiuX,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiwz,Iiuw,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiwz,Iiuw,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixa,IiXa,yz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,Iiwa,Xywz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixa,iIXa,yz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixa,iIwa,Xywz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiXu,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Yxyz,Jixw,IiXw,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,IiuX,ywzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jixw,Iiuv,Xywuzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywvzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jixw,Iiuv,Xywzvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,Iiuw,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixw,IiwX,yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixw,Iiwu,Xyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jixz,IiXw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,IiwX,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jixz,Iiwu,Xywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jiza,IiXa,yx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jiza,Iiwa,Xywx->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jiza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jiza,iIXa,yx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jiza,iIwa,Xywx->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jiza,iIwa,Xyxw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiXu,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jizw,IiXw,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,IiuX,ywux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,IiuX,ywxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuvx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywuxv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywvux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywvxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jizw,Iiuv,Xywxvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jizw,Iiuw,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jizw,Iiuw,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizw,IiwX,yx->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizw,Iiwu,Xyux->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizw,Iiwu,Xyxu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jizx,IiXw,yw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jizx,Iiwu,Xyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jizx,Iiwu,Xywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwax,IuXa,yuzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwax,Iuva,Xyuvzw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwax,Iuva,Xyuwzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwax,IzXa,yw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwax,Izua,Xyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwax,Izua,Xywu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwaz,IuXa,yuwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuvwx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuvxw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuwvx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuwxv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwaz,Iuva,Xyuxvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwux,IvXu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwux,Ivsu,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Ivsu,Xyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,IwXv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwux,Iwvs,Xyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwux,IzXu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwux,IzXv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Jwux,IzvX,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwux,IzvX,yuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Yxyz,Jwux,Izvs,Xyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwux,Izvs,Xyuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwux,Izvu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwux,Izvu,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwuz,IvXu,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvwsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Ivsu,Xyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwuz,IwXv,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwuz,IwvX,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,IwvX,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwuz,Iwvs,Xyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwuz,Iwvs,Xyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,Ia,Xywz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxa,IuXa,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,IuaX,yuzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuvwz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuwvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwxa,Iuav,Xyuwzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuzvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxa,Iuav,Xyuzwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxa,Iuva,Xyuvzw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxa,IzXa,yw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,IzaX,yw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,Izau,Xywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxa,Izua,Xyuw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,Iu,Xywz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,IvXu,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,Ivsu,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwxu,IvuX,yvzw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvswz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvszw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvwsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwxu,Ivus,Xyvwzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvzsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwxu,Ivus,Xyvzws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxu,IwXv,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,IwvX,yuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwxu,Iwvs,Xyuvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwxu,Iwvs,Xyuzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxu,IzXu,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Yxyz,Jwxu,IzXv,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,IzuX,yw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,Izuv,Xywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,IzvX,yuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jwxu,Izvs,Xyuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxu,Izvu,Xyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jwxz,IwXu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxz,IwuX,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwxz,Iwuv,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwza,Ia,Xywx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Ia,Xyxw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwza,IuXa,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,IuaX,yuwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwza,IuaX,yuxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuvwx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuwvx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuwxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwza,Iuav,Xyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwza,Iuva,Xyuvxw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwza,Iuva,Xyuxvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwzu,Iu,Xywx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iu,Xyxw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Yxyz,Jwzu,IvXu,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwzu,Ivsu,Xyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Ivsu,Xyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,IvuX,yvwx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jwzu,IvuX,yvxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvswx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvsxw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvwsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvwxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Ivus,Xyvxsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwzu,IwXv,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,IwvX,yuvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwzu,IwvX,yuxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyusvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyusxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jwzu,Iwvs,Xyuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jwzx,IwXu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jwzx,Iwuv,Xyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jwzx,Iwuv,Xyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Yxyz,Jx,IzXw,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jx,IzwX,yw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,Jx,Izwu,Xywu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyab,Iwba,Xwxz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jyab,Iwba,Xwzx->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jyaw,IuXa,xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuvxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuvzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuxvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuzvx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jyaw,Iuva,Xwuzxv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jyaw,Iuwa,Xuxz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jyaw,Iuwa,Xuzx->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Ia,Xwxz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywa,Ia,Xwzx->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywa,IuXa,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,IuaX,xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywa,IuaX,xzwu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuvxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuvzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuxvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuzvx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuav,Xwuzxv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuaw,Xuxz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywa,Iuaw,Xuzx->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywa,Iuva,Xwuvxz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywa,Iuva,Xwuxvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Iu,Xwxz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Iu,Xwzx->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywu,IvXu,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,Jywu,IvXw,xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Ivsu,Xwvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivsu,Xwvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvzsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivsw,Xuvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,IvuX,xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,IvuX,xzwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvsxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvszx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvxsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvzsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivus,Xwvzxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,Jywu,Ivuw,Xvxz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Ivuw,Xvzx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jywu,IxXv,zvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,Ixvs,Xwusvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jywu,Ixvs,Xwuvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,Jywu,IzXv,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,IzvX,xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Yxyz,Jywu,IzvX,xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Izvs,Xwusvx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Izvs,Xwusxv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Izvs,Xwuvsx->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,Jywu,Izvs,Xwuvxs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,Jywu,Izvs,Xwuxsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iIya,Jiwa,Xwxz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,iIya,Jiwa,Xwzx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iIya,Jixa,Xz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iJxa,IiXa,yz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJxa,Iiwa,Xywz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJza,IiXa,yx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,iJza,Iiwa,Xywx->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iJza,Iiwa,Xyxw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iIya,Jiwa,Xwxz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,iIya,Jiwa,Xwzx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Yxyz,iIya,Jixa,Xz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Yxyz,iJxa,IiXa,yz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJxa,Iiwa,Xywz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,iJza,IiXa,yx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Yxyz,iJza,Iiwa,Xywx->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,iJza,Iiwa,Xyxw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Juwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Juyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Juyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYXx,Jw,zy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYXx,Jy,zw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IYXx,Jzuv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYax,JXua,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYax,JXwa,zy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYax,JXya,zw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYax,Juva,Xzvuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Juva,Xzvuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Juva,Xzvwuy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Juva,Xzvwyu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Juva,Xzvyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYax,Juwa,Xzuy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYax,Juwa,Xzyu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYax,Juya,Xzuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYax,Jzua,Xuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYax,Jzua,Xuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYux,JXvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,JXvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,JXvw,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXwu,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,JXwv,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,JXwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IYux,JXyu,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXyv,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,JXyw,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYux,Jvsu,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jvsu,Xzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jvsu,Xzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jvsu,Xzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jvsu,Xzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,Jvsw,Xzsuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvsw,Xzsyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsy,Xzsuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvsy,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsy,Xzsvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsy,Xzswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvsy,Xzswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvws,Xzsuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvws,Xzsuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvws,Xzsvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvws,Xzsvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jvws,Xzsyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,Jvwu,Xzvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvwu,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,Jvwy,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvwy,Xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IYux,Jvys,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzswuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jvys,Xzswvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jvyu,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jvyw,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYux,Jw,Xzuy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYux,Jw,Xzyu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYux,Jy,Xzuw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IYux,Jzvs,Xvsuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jzvs,Xvsyuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYux,Jzvu,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYux,Jzvu,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,JXau,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,JXaw,zy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYxa,JXay,zw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,Ja,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxa,Juav,Xzvywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,Juaw,Xzyu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxa,Juay,Xzuw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxa,Juva,Xzvuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxa,Juva,Xzvywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxa,Juwa,Xzuy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxa,Juwa,Xzyu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxa,Jzau,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxa,Jzua,Xuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxa,Jzua,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,JXuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXuw,zy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IYxu,JXuy,zw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,JXvw,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,JXvw,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXvy,zvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,JXwv,zvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,JXwv,zvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,JXwy,zu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,Ju,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IYxu,Jvsu,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvsu,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvsw,Xzsyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvsy,Xzsuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jvsy,Xzsvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IYxu,Jvus,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,Jvuw,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxu,Jvuy,Xzvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvws,Xzsuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jvws,Xzsyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvwu,Xzvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jvwu,Xzyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jvwy,Xzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jvwy,Xzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jw,Xzuy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxu,Jw,Xzyu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IYxu,Jzuv,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jzvs,Xvsuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jzvs,Xvswuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jzvs,Xvswyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jzvs,Xvsyuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxu,Jzvs,Xvsywu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IYxu,Jzvu,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IYxu,Jzvu,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,JXuy,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,JXwu,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxz,Juvw,Xvuy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxz,Juvw,Xvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IYxz,Juvy,Xvuw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IYxz,Juvy,Xvwu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Juwv,Xvyu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Juwy,Xu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IYxz,Jw,Xy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IiXx,JiYu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiYw,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,IiXx,JiYy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,JiuY,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiuy,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,JiwY,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiwu,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiwy,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiyY,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyu,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyw,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iiux,JiYu,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiYv,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiYw,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iiux,JiYy,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JivY,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Iiux,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iiux,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iiux,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Iiux,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iiux,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Iiux,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iiux,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/80 * einsum('xyzw,Iiux,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iiux,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iiux,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/60 * einsum('xyzw,Iiux,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iiux,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iiux,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iiux,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,Jivu,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivu,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivw,XzvuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jivy,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvwYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvwuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,JiwY,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,JiwY,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwu,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwu,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jiwy,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iiux,Jiwy,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiyY,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvwYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvwuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyw,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiyw,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixX,JiYu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,JiYw,zy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixX,JiYy,zw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixX,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixX,Jiuw,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuw,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiuy,Ywuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiwu,Yyuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixX,Jiwu,Yyzu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiwy,Yz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,JiYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixa,Jiwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixa,iJYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixa,iJua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixa,iJwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiYu,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiYv,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYw,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYy,Xzuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiuY,Xzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuv,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuw,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiuw,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,JivY,Xzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JivY,Xzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iixu,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Iixu,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('xyzw,Iixu,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iixu,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iixu,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iixu,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iixu,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/40 * einsum('xyzw,Iixu,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iixu,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iixu,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iixu,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivu,XzvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jivu,XzvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivw,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jivw,XzvyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvYuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivy,XzvuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvwYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvwuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JiwY,Xzuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,JiwY,Xzyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jiwu,XzYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixu,Jiwu,XzyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwy,XzYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiwy,XzuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixz,JiYu,Xuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iixz,JiYw,Xy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiYy,Xw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixz,JiuY,Xuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,JiuY,Xuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvYwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iixz,Jiuv,XuvYyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Iixz,Jiuv,XuvyYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvywY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixz,Jiuw,XuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixz,Jiuw,XuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiuy,XuYw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiuy,XuwY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiwY,Xy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiwu,XuYy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiwu,XuyY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IiXx,JiYu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiYw,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,IiXx,JiYy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,JiuY,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IiXx,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiuy,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,JiwY,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiwu,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,Jiwy,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IiXx,JiyY,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyu,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IiXx,Jiyw,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iiux,JiYu,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,JiYv,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JiYv,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiYw,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iiux,JiYy,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,JivY,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iiux,JivY,Xzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Iiux,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iiux,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iiux,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iiux,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Iiux,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iiux,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 29/240 * einsum('xyzw,Iiux,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iiux,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/80 * einsum('xyzw,Iiux,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Iiux,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iiux,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iiux,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/60 * einsum('xyzw,Iiux,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iiux,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iiux,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iiux,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iiux,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Iiux,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iiux,Jivu,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivu,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jivw,XzvuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jivw,XzvyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jivy,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvwYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jivy,XzvwuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,JiwY,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,JiwY,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwu,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwu,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iiux,Jiwy,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iiux,Jiwy,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iiux,JiyY,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyv,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvwYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iiux,Jiyv,XzvwuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iiux,Jiyw,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iiux,Jiyw,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixX,JiYu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,JiYw,zy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixX,JiYy,zw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuv,Yywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixX,Jiuv,Yywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixX,Jiuw,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiuw,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiuy,Ywuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixX,Jiwu,Yyuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixX,Jiwu,Yyzu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixX,Jiwy,Yz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixa,JiYa,Xzyw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiua,XzuywY->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixa,Jiwa,XzYy->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixa,Jiwa,XzyY->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixa,iJYa,Xzyw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixa,iJua,XzuYwy->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJua,XzuywY->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixa,iJwa,XzYy->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixa,iJwa,XzyY->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iixu,JiYu,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiYv,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYw,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixu,JiYy,Xzuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixu,JiuY,Xzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,Jiuv,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuv,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiuw,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiuw,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixu,JivY,Xzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JivY,Xzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsYuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsYwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iixu,Jivs,XzvsYwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsYyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Iixu,Jivs,XzvsYywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsuYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iixu,Jivs,XzvsuYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('xyzw,Iixu,Jivs,XzvswYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iixu,Jivs,XzvswYyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iixu,Jivs,XzvswuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 13/240 * einsum('xyzw,Iixu,Jivs,XzvswuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvswyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iixu,Jivs,XzvswyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/40 * einsum('xyzw,Iixu,Jivs,XzvsyYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Iixu,Jivs,XzvsyYwu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iixu,Jivs,XzvsyuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Iixu,Jivs,XzvsyuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iixu,Jivs,XzvsywYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iixu,Jivs,XzvsywuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivu,XzvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jivu,XzvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivw,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jivw,XzvyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvYuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jivy,XzvuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvwYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jivy,XzvwuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,JiwY,Xzuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,JiwY,Xzyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixu,Jiwu,XzYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixu,Jiwu,XzyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvYuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iixu,Jiwv,XzvyuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixu,Jiwy,XzYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixu,Jiwy,XzuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iixz,JiYu,Xuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,Iixz,JiYw,Xy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiYy,Xw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iixz,JiuY,Xuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,JiuY,Xuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvYwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iixz,Jiuv,XuvYyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvwyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Iixz,Jiuv,XuvyYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iixz,Jiuv,XuvywY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iixz,Jiuw,XuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 2/3 * einsum('xyzw,Iixz,Jiuw,XuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiuy,XuYw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiuy,XuwY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iixz,JiwY,Xy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iixz,Jiwu,XuYy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iixz,Jiwu,XuyY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JuYv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuXx,JuvY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuXx,Juvs,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IuXx,JvYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuXx,JvYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuXx,Jvsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvsw,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JvwY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,JvyY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuXx,Jvys,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuXx,Jvys,Ywvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jvyw,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuXx,Jy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuXx,JzYv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuXx,JzvY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywsuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuXx,Jzvs,Yywvsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuXx,Jzvs,Yywvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuax,JXYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,JXva,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JXva,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuax,JXwa,Yyzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuax,JXya,Ywuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,JvYa,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,JvYa,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 7/48 * einsum('xyzw,Iuax,Jvsa,XzusYvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuax,Jvsa,XzusYvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuax,Jvsa,XzusYwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuax,Jvsa,XzusYwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuax,Jvsa,XzusYyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuax,Jvsa,XzusYywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzusvYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvsa,XzusvYyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzuswYvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuax,Jvsa,XzuswYyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzuswvYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jvsa,XzuswvyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuax,Jvsa,XzuswyYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuax,Jvsa,XzusyYvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 9/80 * einsum('xyzw,Iuax,Jvsa,XzusyYwv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzusyvYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jvsa,XzusyvwY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuax,Jvsa,XzusywYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,Jvwa,XzuYvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuax,Jvwa,XzuvYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvya,XzuYvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvya,XzuvYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuax,Jvya,XzuvwY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvya,XzuwYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuax,Jvya,XzuwvY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuax,JzYa,Xuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jzva,XuvYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jzva,XuvwYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuax,Jzva,XuvwyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jzva,XuvyYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuax,Jzva,XuvywY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsv,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JXsv,Yywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,JXsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXsy,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXws,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,JXws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXwv,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXwy,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,JXwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXys,Ywvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXys,Ywvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXys,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXys,Ywvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JXys,Ywvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JXyv,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,JXyw,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JXyw,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsYv,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JsYv,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuvx,JsYw,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,JsYy,Xzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsYy,Xzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 7/48 * einsum('xyzw,Iuvx,Jstv,XzutYswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jstv,XzutYsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuvx,Jstv,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jstv,XzutYwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuvx,Jstv,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Iuvx,Jstv,XzutYyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jstv,XzutsYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutwYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuvx,Jstv,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutwsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jstv,XzutwsyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jstv,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Iuvx,Jstv,XzutyYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 9/80 * einsum('xyzw,Iuvx,Jstv,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutysYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jstv,XzutyswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jstv,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jstw,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jstw,XzutYsyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jstw,XzutvsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jstw,XzutysYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jstw,XzutysvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jsty,XzutYvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsty,XzutYwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 2/15 * einsum('xyzw,Iuvx,Jsty,XzutvYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Iuvx,Jsty,XzutvYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsty,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsty,XzutwsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsty,XzutwsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsty,XzutwvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JswY,Xzusvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,JswY,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYsyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswt,XzutYysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Iuvx,Jswt,XzutYyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jswt,XzutvYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswv,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jswv,XzusYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswy,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswy,XzusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswy,XzusvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jswy,XzuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jswy,XzuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsyY,Xzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JsyY,Xzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutYsvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutYswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutYvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutYwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyt,XzutYwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutvYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,Jsyt,XzutwvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyv,XzusYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuwYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jsyv,XzuwsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jsyw,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jsyw,XzuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,JuYs,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JuYs,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,JusY,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JusY,Xzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JusY,Xzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JusY,Xzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,JusY,Xzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 37/240 * einsum('xyzw,Iuvx,Just,XzstYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iuvx,Just,XzstYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('xyzw,Iuvx,Just,XzstYwvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iuvx,Just,XzstYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuvx,Just,XzstYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iuvx,Just,XzstYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/240 * einsum('xyzw,Iuvx,Just,XzstvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 23/240 * einsum('xyzw,Iuvx,Just,XzstvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iuvx,Just,XzstwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 29/240 * einsum('xyzw,Iuvx,Just,XzstwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 2/15 * einsum('xyzw,Iuvx,Just,XzstwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Iuvx,Just,XzstwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iuvx,Just,XzstwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iuvx,Just,XzstwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 19/240 * einsum('xyzw,Iuvx,Just,XzstyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Iuvx,Just,XzstyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iuvx,Just,XzstyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Iuvx,Just,XzstyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Iuvx,Just,XzstywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Iuvx,Just,XzstywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jw,XzuYvy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuvx,Jw,XzuvYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jy,XzuYvw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jy,XzuvYw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jy,XzuvwY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jy,XzuwYv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jy,XzuwvY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Iuvx,JzYs,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuvx,JzYv,Xuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuvx,JzsY,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,JzsY,Xuswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jzst,XustYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuvx,Jzst,XustYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jzst,XustYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jzst,XustYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Iuvx,Jzst,XustYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuvx,Jzst,XustvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuvx,Jzst,XustvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 47/240 * einsum('xyzw,Iuvx,Jzst,XustwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Iuvx,Jzst,XustwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuvx,Jzst,XustwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuvx,Jzst,XustwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jzst,XustwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/16 * einsum('xyzw,Iuvx,Jzst,XustyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/16 * einsum('xyzw,Iuvx,Jzst,XustyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/48 * einsum('xyzw,Iuvx,Jzst,XustyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuvx,Jzst,XustyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuvx,Jzst,XustywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuvx,Jzst,XustywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzsv,XusYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzsv,XuswYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuvx,Jzsv,XuswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzsv,XusyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuvx,Jzsv,XusywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxX,JuYv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IuxX,Juvs,Yywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Juvs,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxX,JvYw,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxX,JvYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jvsw,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,Jvsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvsy,Ywvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,JvwY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,JvwY,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvws,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,Jvws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jvwy,Yvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,Jvwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jw,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxX,Jw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxX,JzYv,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuxX,JzvY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,JzvY,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jzvs,Yywsuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jzvs,Yywsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jzvs,Yywusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxX,Jzvs,Yywvsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxX,Jzvs,Yywvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxa,JXYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JXav,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JXav,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxa,JXaw,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JXaw,Yyzu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxa,JXay,Ywuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXva,Yywuzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JXva,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXva,Yywvzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXva,Yywzuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JXva,Yywzvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JXwa,Yyuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxa,JXwa,Yyzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Ja,XzuYwy->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Ja,XzuywY->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxa,JvYa,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,JvaY,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,JvaY,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYvyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYwvy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxa,Jvas,XzusYwyv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jvas,XzusYyvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvas,XzusYywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxa,Jvas,XzuswYyv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxa,Jvas,XzuswyYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxa,Jvas,XzusyYwv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxa,Jvas,XzusywYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvaw,XzuYvy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxa,Jvaw,XzuyvY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvay,XzuYvw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvay,XzuvYw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvay,XzuvwY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvay,XzuwYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvay,XzuwvY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxa,Jvsa,XzusYwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxa,Jvsa,XzusYyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxa,Jvsa,XzuswYyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxa,Jvsa,XzuswvYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxa,Jvsa,XzuswvyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxa,Jvsa,XzuswyYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iuxa,Jvsa,XzusyYvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 9/80 * einsum('xyzw,Iuxa,Jvsa,XzusyYwv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusyvYw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusyvwY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxa,Jvsa,XzusywYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuYvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuvYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuvyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuyYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jvwa,XzuyvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxa,JzYa,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,JzaY,Xuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,JzaY,Xuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzav,XuvYwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzav,XuvwYy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzav,XuvwyY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Jzav,XuvyYw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxa,Jzav,XuvywY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxa,Jzva,XuvYwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxa,Jzva,XuvywY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxv,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXYw,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,Iuxv,JXYy,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JXsv,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXsv,Yywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXsv,Yywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXsv,Yywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JXsv,Yywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,JXsw,Yyvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXsw,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXsy,Ywvszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JXvs,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXvs,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,JXvw,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXvw,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXvy,Ywuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXws,Yyvsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXws,Yyvusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXws,Yyvuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXws,Yyvzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JXws,Yyvzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JXwv,Yyuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,JXwv,Yyzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JXwy,Yvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxv,JsYv,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzusvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzusyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuvys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,JsYw,Xzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsYw,Xzuyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxv,JsYy,Xzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jstv,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxv,Jstv,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxv,Jstv,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxv,Jstv,XzutwsYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxv,Jstv,XzutwsyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Iuxv,Jstv,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Iuxv,Jstv,XzutyYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 9/80 * einsum('xyzw,Iuxv,Jstv,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutysYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutyswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxv,Jstv,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jstw,XzutYsvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('xyzw,Iuxv,Jstw,XzutsYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,Jstw,XzutysvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,Jsty,XzutYsvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsty,XzutYwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,Jsty,XzutsYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/5 * einsum('xyzw,Iuxv,Jsty,XzutvYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/10 * einsum('xyzw,Iuxv,Jsty,XzutvYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,Jsty,XzutwYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Iuxv,Jsty,XzutwsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,JsvY,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JsvY,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxv,Jsvt,XzutYwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jsvt,XzutYysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Iuxv,Jsvt,XzutYyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxv,Jsvt,XzutwYys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxv,Jsvt,XzutwyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Iuxv,Jsvt,XzutyYws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Iuxv,Jsvt,XzutywYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jsvw,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,Jsvw,XzuysY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuYsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvy,XzusYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuswY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuwYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jsvy,XzuwsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JswY,Xzusvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JswY,Xzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JswY,Xzuvys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JswY,Xzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JswY,Xzuyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/10 * einsum('xyzw,Iuxv,Jswt,XzutYyvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/10 * einsum('xyzw,Iuxv,Jswt,XzutsYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,Jswt,XzutyYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswv,XzuYsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswv,XzusYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswv,XzusyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jswv,XzuyYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jswv,XzuysY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jswy,XzuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,Jswy,XzusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxv,JuYs,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JusY,Xzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JusY,Xzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iuxv,Just,XzstYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Iuxv,Just,XzstYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('xyzw,Iuxv,Just,XzstYwvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iuxv,Just,XzstYwyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('xyzw,Iuxv,Just,XzstYyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Iuxv,Just,XzstYywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iuxv,Just,XzstvYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iuxv,Just,XzstvYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Iuxv,Just,XzstwYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Iuxv,Just,XzstwYyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iuxv,Just,XzstwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Iuxv,Just,XzstwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Iuxv,Just,XzstwyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iuxv,Just,XzstwyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Iuxv,Just,XzstyYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/120 * einsum('xyzw,Iuxv,Just,XzstyYwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iuxv,Just,XzstyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Iuxv,Just,XzstyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Iuxv,Just,XzstywYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Iuxv,Just,XzstywvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jv,XzuYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jv,XzuywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jw,XzuYvy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jw,XzuvYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jw,XzuvyY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,Jw,XzuyYv->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jw,XzuyvY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xuswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xuswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxv,JzYs,Xusyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzYs,Xusywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxv,JzYv,Xuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JzsY,Xusvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JzsY,Xusvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JzsY,Xuswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzsY,Xusyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxv,JzsY,Xusywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzst,XustYvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jzst,XustYvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzst,XustwvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzst,XustwvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Iuxv,Jzst,XustyvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzst,XustyvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jzsv,XusYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,Jzsv,XusywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,JzvY,Xuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxv,JzvY,Xuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzvs,XusYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzvs,XuswYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzvs,XuswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxv,Jzvs,XusyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Iuxv,Jzvs,XusywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXYw,yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,Iuxz,JXYy,wu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JXvw,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,JXvw,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXvy,Ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,JXwv,Yyuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JXwv,Yyvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JXwy,Yu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Iuxz,JuYv,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Iuxz,JuvY,Xvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,JuvY,Xvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxz,Juvs,XvsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Iuxz,Juvs,XvsYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxz,Juvs,XvswYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxz,Juvs,XvswyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Iuxz,Juvs,XvsyYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Iuxz,Juvs,XvsywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JvYw,Xuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Iuxz,JvYy,Xuvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvsw,XusYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,Jvsw,XusyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsy,XusYvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsy,XusvYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvsy,XusvwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsy,XuswYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvsy,XuswvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,JvwY,Xuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,JvwY,Xuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvws,XusYvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvws,XusvYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvws,XusvyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvws,XusyYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Iuxz,Jvws,XusyvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jvwy,XuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,Jvwy,XuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Iuxz,Jw,XuYy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Iuxz,Jw,XuyY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXYw,zy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,Ix,JXYy,zw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,JXuw,Yyuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JXuw,Yyzu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXuy,Ywuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JXwu,Yyuz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,JXwu,Yyzu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JXwy,Yz->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JuYw,Xzyu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ix,JuYy,Xzuw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juvw,XzvYuy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,Juvw,XzvyuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvy,XzvYuw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvy,XzvuYw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juvy,XzvuwY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvy,XzvwYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juvy,XzvwuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,JuwY,Xzuy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,JuwY,Xzyu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwv,XzvYuy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwv,XzvuYy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwv,XzvuyY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juwv,XzvyYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Juwv,XzvyuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Juwy,XzYu->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,Juwy,XzuY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jw,XzYy->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ix,Jw,XzyY->IXJY', v_aaaa, t1_xa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ix,JzYu,Xuyw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,JzuY,Xuwy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ix,JzuY,Xuyw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jzuv,XuvYwy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jzuv,XuvwYy->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jzuv,XuvwyY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ix,Jzuv,XuvyYw->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ix,Jzuv,XuvywY->IXJY', v_aaaa, t1_xa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Ja,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXa,JuYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,JuaY,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juav,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juaz,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXa,Juva,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXa,Juva,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXa,Juza,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Ju,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JvYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxXu,JvYz,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jvsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxXu,Jvsu,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,Jvsz,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,JvuY,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvus,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvuz,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,JvzY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxXu,Jvzs,Yuvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxXu,Jvzs,Yuvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxXu,Jvzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxXu,JwYv,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JwvY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,Jwvs,Yzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IxXu,JyYv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxXu,JyvY,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuswv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxXu,Jyvs,Yzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxXu,Jyvs,Yzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxXu,Jz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaX,JuYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaX,Juva,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juva,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juva,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juva,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaX,Juva,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxaX,Juza,Yuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaX,Juza,Yuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixab,JXba,Yzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixab,Juba,XywYuz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixab,Juba,XywuYz->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixau,JXYa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixau,JXua,Yzyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixau,JXva,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JXva,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixau,JXza,Yuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixau,JvYa,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,JvYa,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixau,Jvsa,XywsYuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixau,Jvsa,XywsYuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixau,Jvsa,XywsYvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsYvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixau,Jvsa,XywsYzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsYzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywsuYvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixau,Jvsa,XywsuYzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Ixau,Jvsa,XywsuvYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Ixau,Jvsa,XywsuzYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywsvYuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvsa,XywsvuYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixau,Jvsa,XywszYuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywszYvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixau,Jvsa,XywszuYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvsa,XywszuvY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywszvYu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvsa,XywszvuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvua,XywYvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixau,Jvua,XywvYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvza,XywYvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvza,XywuYv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvza,XywuvY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixau,Jvza,XywvYu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixau,Jvza,XywvuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuX,JvYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuX,JvYz,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuX,Jvsu,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuX,Jvsz,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jvsz,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuX,JvzY,ywuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,JvzY,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jvzs,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jvzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuX,Jvzu,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuX,JwYv,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxuX,JwvY,zuvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,JwvY,zuyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxuX,Jwvs,Yzuvsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jwvs,Yzuysv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuX,JyYv,zuwv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jyvs,Yzusvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuvsw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuvws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuwsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jyvs,Yzuwvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuX,Jz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuX,Jz,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JXYa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JXau,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXav,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,JXav,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXaz,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,JXaz,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXva,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXva,Yzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXva,Yzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXva,Yzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,JXva,Yzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,JXza,Yuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JXza,Yuyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Ja,XywYuz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,Ja,XywuYz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixua,JvYa,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,JvaY,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,JvaY,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvas,XywsYuzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Ixua,Jvas,XywsYzuv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixua,Jvas,XywsuYzv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixua,Jvas,XywsuzYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixua,Jvas,XywszYuv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixua,Jvas,XywszuYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvau,XywYvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,Jvau,XywvYz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvaz,XywYvu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvaz,XywuYv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvaz,XywuvY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvaz,XywvYu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvaz,XywvuY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixua,Jvsa,XywsYuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywsYuzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixua,Jvsa,XywsYvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixua,Jvsa,XywsYvzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywsYzuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixua,Jvsa,XywsYzvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywsuYvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixua,Jvsa,XywsuYzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Ixua,Jvsa,XywsuvYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/240 * einsum('xyzw,Ixua,Jvsa,XywsuzYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywsvYuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixua,Jvsa,XywsvuYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixua,Jvsa,XywszYuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvsa,XywszYvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixua,Jvsa,XywszuYv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvsa,XywszuvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvsa,XywszvYu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixua,Jvsa,XywszvuY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixua,Jvza,XywYvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixua,Jvza,XywuvY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixuv,JXYu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXYv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixuv,JXYz,ywvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsu,Yzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsu,Yzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXsv,Yzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,JXsv,Yzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JXsz,Yuvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXvs,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXvs,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXvu,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXvz,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXvz,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXzs,Yuvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ixuv,JXzs,Yuvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JXzu,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JXzv,Yuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JXzv,Yuyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JsYu,Xywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsYu,Xywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Ixuv,JsYv,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixuv,JsYz,Xywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixuv,Jstu,XywtYsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtYszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstu,XywtYvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstu,XywtYvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtYzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstu,XywtYzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtsYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstu,XywtsvYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtvYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstu,XywtvYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Ixuv,Jstu,XywtvsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Ixuv,Jstu,XywtvzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtzYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixuv,Jstu,XywtzYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtzsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstu,XywtzsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstu,XywtzvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstu,XywtzvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixuv,Jstv,XywtYsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Ixuv,Jstv,XywtYszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstv,XywtYusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtYuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstv,XywtYzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtYzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtsYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtsuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstv,XywtuYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Ixuv,Jstv,XywtuYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Ixuv,Jstv,XywtusYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/240 * einsum('xyzw,Ixuv,Jstv,XywtuzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstv,XywtzYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstv,XywtzYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstv,XywtzsYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstv,XywtzsuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstv,XywtzuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstv,XywtzusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Ixuv,Jstz,XywtYsuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Ixuv,Jstz,XywtYusv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Ixuv,Jstz,XywtsYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jstz,XywtsuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Ixuv,Jstz,XywtsvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 31/240 * einsum('xyzw,Ixuv,Jstz,XywtuYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 37/240 * einsum('xyzw,Ixuv,Jstz,XywtuYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jstz,XywtusYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstz,XywtusvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixuv,Jstz,XywtuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstz,XywtuvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Ixuv,Jstz,XywtvYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstz,XywtvYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstz,XywtvsYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jstz,XywtvsuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Ixuv,Jstz,XywtvuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jstz,XywtvusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,JsvY,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JsvY,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Ixuv,Jsvt,XywtYuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Ixuv,Jsvt,XywtYzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Ixuv,Jsvt,XywtuYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jsvt,XywtuzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jsvt,XywtzYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Ixuv,Jsvt,XywtzuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvu,XywYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jsvu,XywsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvz,XywYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvz,XywsYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvz,XywsuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jsvz,XywuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jsvz,XywusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JszY,Xywsvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ixuv,JszY,Xywuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/20 * einsum('xyzw,Ixuv,Jszt,XywtYuvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/20 * einsum('xyzw,Ixuv,Jszt,XywtYvus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Ixuv,Jszt,XywtsYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Ixuv,Jszt,XywtsvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszt,XywtuYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,Jszt,XywtuvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszt,XywtvYus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszt,XywtvuYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszu,XywYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszu,XywsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszu,XywsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszu,XywvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jszu,XywvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jszv,XywYsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jszv,XywusY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jv,XywYuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jv,XywuYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Ixuv,JwYs,Xysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Ixuv,JwsY,Xysuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JwsY,Xyszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('xyzw,Ixuv,Jwst,XystYuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/120 * einsum('xyzw,Ixuv,Jwst,XystYuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('xyzw,Ixuv,Jwst,XystYvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/120 * einsum('xyzw,Ixuv,Jwst,XystYvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Ixuv,Jwst,XystYzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Ixuv,Jwst,XystYzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Ixuv,Jwst,XystuYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Ixuv,Jwst,XystuYzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/40 * einsum('xyzw,Ixuv,Jwst,XystuvYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/120 * einsum('xyzw,Ixuv,Jwst,XystuvzY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Ixuv,Jwst,XystvYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Ixuv,Jwst,XystvYzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/120 * einsum('xyzw,Ixuv,Jwst,XystvuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/40 * einsum('xyzw,Ixuv,Jwst,XystvuzY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jwst,XystzYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jwst,XystzYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Ixuv,Jwst,XystzuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Ixuv,Jwst,XystzuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Ixuv,Jwst,XystzvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/80 * einsum('xyzw,Ixuv,Jwst,XystzvuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ixuv,JyYs,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwsvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JyYs,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JysY,Xwsuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,JysY,Xwsuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JysY,Xwsvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JysY,Xwszuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,JysY,Xwszvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstYuvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,Jyst,XwstYuzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstYvuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstYvzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Ixuv,Jyst,XwstYzuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstYzvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/120 * einsum('xyzw,Ixuv,Jyst,XwstuYvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/5 * einsum('xyzw,Ixuv,Jyst,XwstuYzv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 13/120 * einsum('xyzw,Ixuv,Jyst,XwstvYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/30 * einsum('xyzw,Ixuv,Jyst,XwstvYzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jyst,XwstzYuv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Ixuv,Jyst,XwstzYvu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixuv,Jyst,XwstzuYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstzuvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstzvYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Ixuv,Jyst,XwstzvuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Ixuv,Jz,XywYvu->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,Ixuv,Jz,XywuvY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXax,IYua,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXax,Iuva,Yzvuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXax,Iuva,Yzvuyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXax,Iuva,Yzvwuy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXax,Iuva,Yzvwyu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXax,Iuva,Yzvyuw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXux,IYvu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXux,Ivsu,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXux,Ivsu,Yzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXux,Ivsu,Yzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXux,Ivsu,Yzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JXux,Ivsu,Yzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,IYau,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,Ia,Yzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxa,Iuav,Yzvywu->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXxa,Iuva,Yzvuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JXxa,Iuva,Yzvywu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,IYuv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,Iu,Yzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JXxu,Ivsu,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JXxu,Ivsu,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JXxu,Ivus,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiYx,IiXu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,IiuX,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,IiXu,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,IiXv,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivX,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvwuy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvwyu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvyuw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Jiux,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Jiux,Iivs,XywuYszv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Jiux,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jiux,Iivs,XywusYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Jiux,Iivs,XywusYzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jiux,Iivs,XywuszYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jiux,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jiux,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Jiux,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jiux,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jiux,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Jiux,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Jiux,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Jiux,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jiux,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Jiux,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,Iivu,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jiux,Iivu,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixY,IiXu,zuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,JixY,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JixY,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixa,Iiua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Jixa,Iiua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixa,iIua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixa,iIua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,IiXu,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiXv,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuX,Yzyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,Iiuv,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,Iiuv,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivX,Yzvuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,IivX,Yzvywu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jixu,Iivs,XywuYszv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Jixu,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jixu,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jixu,Iivs,XywusYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywusYzv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jixu,Iivs,XywusvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuszYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jixu,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jixu,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jixu,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jixu,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/80 * einsum('xyzw,Jixu,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jixu,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixu,Iivu,XywYvz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Jixu,Iivu,XywvYz->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,IiXu,Yuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuX,Yuwy->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixz,IiuX,Yuyw->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jixz,Iiuv,XywYuv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywYvu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jixz,Iiuv,XywuYv->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywuvY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywvYu->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywvuY->IXJY', v_aaaa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiYx,IiXu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,IiuX,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiYx,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,IiXu,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,IiXv,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IiXv,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivX,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvwuy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvwyu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivX,Yzvyuw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Jiux,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Jiux,Iivs,XywuYszv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Jiux,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jiux,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Jiux,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jiux,Iivs,XywusYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Jiux,Iivs,XywusYzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jiux,Iivs,XywuszYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Jiux,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jiux,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Jiux,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jiux,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jiux,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Jiux,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Jiux,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Jiux,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jiux,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Jiux,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,Iivu,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jiux,Iivu,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixY,IiXu,zuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,JixY,Iiuv,Xywuvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JixY,Iiuv,Xywvuz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiXa,Yzyw->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixa,Iiua,XywYuz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Jixa,Iiua,XywuYz->IXJY', v_aaaa, t1_xvae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIXa,Yzyw->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixa,iIua,XywYuz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixa,iIua,XywuYz->IXJY', v_aaaa, t1_xvae, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,IiXu,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiXv,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuX,Yzyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,Iiuv,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,Iiuv,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivX,Yzvuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,IivX,Yzvywu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuYsvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Jixu,Iivs,XywuYszv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuYvsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuYvzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Jixu,Iivs,XywuYzsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jixu,Iivs,XywuYzvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jixu,Iivs,XywusYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywusYzv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jixu,Iivs,XywusvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Jixu,Iivs,XywuszYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Jixu,Iivs,XywuvYsz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Jixu,Iivs,XywuvYzs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Jixu,Iivs,XywuvsYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Jixu,Iivs,XywuvzYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jixu,Iivs,XywuzYsv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/80 * einsum('xyzw,Jixu,Iivs,XywuzYvs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Jixu,Iivs,XywuzsYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuzsvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Jixu,Iivs,XywuzvYs->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Jixu,Iivs,XywuzvsY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jixu,Iivu,XywYvz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,Jixu,Iivu,XywvYz->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,IiXu,Yuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuX,Yuwy->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixz,IiuX,Yuyw->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jixz,Iiuv,XywYuv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywYvu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jixz,Iiuv,XywuYv->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywuvY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywvYu->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jixz,Iiuv,XywvuY->IXJY', v_aaaa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuYx,IuXv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuYx,IuvX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuYx,Iuvs,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juax,IYXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IYva,Xywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IYva,Xywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IvXa,Yzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvXa,Yzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juax,Ivsa,XywvYsuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvYszu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juax,Ivsa,XywvYusz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juax,Ivsa,XywvYuzs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvYzsu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juax,Ivsa,XywvYzus->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvsYuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivsa,XywvsuYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvuYsz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juax,Ivsa,XywvuYzs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juax,Ivsa,XywvusYz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/240 * einsum('xyzw,Juax,Ivsa,XywvuzYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvzYsu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juax,Ivsa,XywvzYus->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvzsYu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,Ivsa,XywvzsuY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juax,Ivsa,XywvzuYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,Ivsa,XywvzusY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juvx,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IYsv,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IYsv,Xywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IsXv,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsXv,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juvx,Istv,XywsYtuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juvx,Istv,XywsYutz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Istv,XywsYuzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juvx,Istv,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywstYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Istv,XywstuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywsuYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juvx,Istv,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Istv,XywsutYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 17/240 * einsum('xyzw,Juvx,Istv,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywszYtu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juvx,Istv,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywsztYu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,Istv,XywsztuY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juvx,Istv,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,Istv,XywszutY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IuXs,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuXs,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IusX,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusX,Yzsvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusX,Yzswvy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusX,Yzswyv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusX,Yzsyvw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Juvx,Iust,XywvYstz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Iust,XywvYszt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Juvx,Iust,XywvYtsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/240 * einsum('xyzw,Juvx,Iust,XywvYtzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/60 * einsum('xyzw,Juvx,Iust,XywvYzst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Juvx,Iust,XywvYzts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Juvx,Iust,XywvsYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juvx,Iust,XywvsYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/15 * einsum('xyzw,Juvx,Iust,XywvstYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Juvx,Iust,XywvszYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Juvx,Iust,XywvtYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/240 * einsum('xyzw,Juvx,Iust,XywvtYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Juvx,Iust,XywvtzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 11/240 * einsum('xyzw,Juvx,Iust,XywvzYst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Juvx,Iust,XywvzYts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Juvx,Iust,XywvzsYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 17/240 * einsum('xyzw,Juvx,Iust,XywvzstY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 19/240 * einsum('xyzw,Juvx,Iust,XywvztYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 23/240 * einsum('xyzw,Juvx,Iust,XywvztsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxY,IuXv,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JuxY,Iuvs,Xywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,JuxY,Iuvs,Xywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IYXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxa,IYav,Xywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IYav,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYva,Xywuzv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IYva,Xywvuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYva,Xywvzu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYva,Xywzuv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IYva,Xywzvu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,Ia,XywYuz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxa,Ia,XywuYz->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IvXa,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IvaX,Yzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxa,IvaX,Yzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivas,XywvYuzs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Juxa,Ivas,XywvYzus->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juxa,Ivas,XywvuYzs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivas,XywvuzYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivas,XywvzYus->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivas,XywvzuYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxa,Ivsa,XywvYszu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxa,Ivsa,XywvYzsu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxa,Ivsa,XywvYzus->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxa,Ivsa,XywvsYuz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivsa,XywvsuYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxa,Ivsa,XywvuYsz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxa,Ivsa,XywvuYzs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivsa,XywvusYz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivsa,XywvuzYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxa,Ivsa,XywvzYsu->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxa,Ivsa,XywvzYus->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxa,Ivsa,XywvzuYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IYsv,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYsv,Xywszu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYsv,Xywuzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYsv,Xywzsu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IYsv,Xywzus->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IYvs,Xywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxv,IYvs,Xywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IsXv,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Istv,XywsYtzu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Istv,XywsYztu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxv,Istv,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxv,Istv,XywstYuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Istv,XywstuYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxv,Istv,XywsuYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxv,Istv,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Istv,XywsutYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Istv,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxv,Istv,XywszYtu->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Juxv,Istv,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Juxv,Istv,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IsvX,Yzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxv,IsvX,Yzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxv,Isvt,XywsYuzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 7/240 * einsum('xyzw,Juxv,Isvt,XywsYzut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Juxv,Isvt,XywsuYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Isvt,XywsuzYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Isvt,XywszYut->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxv,Isvt,XywszuYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IuXs,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IusX,Yzsvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxv,IusX,Yzsywv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Juxv,Iust,XywvYstz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Juxv,Iust,XywvYszt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Juxv,Iust,XywvYtsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/240 * einsum('xyzw,Juxv,Iust,XywvYtzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Juxv,Iust,XywvYzst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/80 * einsum('xyzw,Juxv,Iust,XywvYzts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Juxv,Iust,XywvsYtz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/15 * einsum('xyzw,Juxv,Iust,XywvsYzt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxv,Iust,XywvstYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Juxv,Iust,XywvszYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/240 * einsum('xyzw,Juxv,Iust,XywvtYsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/80 * einsum('xyzw,Juxv,Iust,XywvtYzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/30 * einsum('xyzw,Juxv,Iust,XywvtsYz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/40 * einsum('xyzw,Juxv,Iust,XywvtzYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 7/80 * einsum('xyzw,Juxv,Iust,XywvzYst->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juxv,Iust,XywvzYts->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/40 * einsum('xyzw,Juxv,Iust,XywvzsYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Juxv,Iust,XywvzstY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 3/80 * einsum('xyzw,Juxv,Iust,XywvztYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/80 * einsum('xyzw,Juxv,Iust,XywvztsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,Iv,XywYuz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxv,Iv,XywuYz->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxz,IuXv,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxz,IuvX,Yvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxz,IuvX,Yvyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxz,Iuvs,XywYsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Juxz,Iuvs,XywYvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxz,Iuvs,XywsYv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxz,Iuvs,XywsvY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Juxz,Iuvs,XywvYs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Juxz,Iuvs,XywvsY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,Ia,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxYa,IuXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,IuaX,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYa,Iuav,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JxYa,Iuva,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYa,Iuva,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,Iu,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxYu,IvXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,JxYu,Ivsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxYu,Ivsu,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,IvuX,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxYu,Ivus,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaY,IuXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxaY,Iuva,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxaY,Iuva,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxaY,Iuva,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxaY,Iuva,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxaY,Iuva,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxab,IYba,Xzyw->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxab,Iuba,XzuYwy->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxab,Iuba,XzuywY->IXJY', v_aaaa, t1_xaee, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxau,IYXa,zuwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxau,IYua,Xzyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IYva,Xzuvwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuvyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuwvy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuwyv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuyvw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IYva,Xzuywv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywuvz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywuzv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IvXa,Yywvuz->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywvzu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywzuv->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvXa,Yywzvu->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Jxau,Ivsa,XzuvYswy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvYsyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxau,Ivsa,XzuvYwsy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvYwys->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxau,Ivsa,XzuvYysw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxau,Ivsa,XzuvYyws->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvsYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvsYyw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvwYsy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxau,Ivsa,XzuvwYys->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvwsYy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvwsyY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvwyYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jxau,Ivsa,XzuvyYsw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 9/80 * einsum('xyzw,Jxau,Ivsa,XzuvyYws->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvysYw->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivsa,XzuvyswY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxau,Ivsa,XzuvywYs->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,Ivua,XzvYwy->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,Ivua,XzvywY->IXJY', v_aaaa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuY,IvXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,JxuY,Ivsu,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IYXa,zuwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IYau,Xzyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IYav,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,IYav,Xzuywv->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IYva,Xzuvwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYva,Xzuvyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYva,Xzuwvy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYva,Xzuwyv->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IYva,Xzuyvw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ia,XzuYwy->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,Ia,XzuywY->IXJY', v_aaaa, t1_xaae, t1_xe, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IvXa,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,IvaX,Yywuvz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IvaX,Yywvuz->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYswy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYsyw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYwsy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxua,Ivas,XzuvYwys->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivas,XzuvYysw->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivas,XzuvYyws->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxua,Ivas,XzuvwYys->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxua,Ivas,XzuvwyYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxua,Ivas,XzuvyYws->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxua,Ivas,XzuvywYs->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivau,XzvYwy->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,Ivau,XzvywY->IXJY', v_aaaa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 11/48 * einsum('xyzw,Jxua,Ivsa,XzuvYswy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jxua,Ivsa,XzuvYsyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Jxua,Ivsa,XzuvYwsy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvYwys->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxua,Ivsa,XzuvYysw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvYyws->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivsa,XzuvsYwy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivsa,XzuvsYyw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,Ivsa,XzuvwYsy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxua,Ivsa,XzuvwYys->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/16 * einsum('xyzw,Jxua,Ivsa,XzuvwsYy->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvwsyY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvwyYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,Ivsa,XzuvyYsw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxua,Ivsa,XzuvyYws->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvysYw->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvyswY->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxua,Ivsa,XzuvywYs->IXJY', v_aaaa, t1_xaae, t1_xaae, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxuv,IYXu,zvwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IYXv,zuwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IYsu,Xzvswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvsyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsu,Xzvyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYsv,Xzusyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuwsy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuwys->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IYsv,Xzuysw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IYvs,Xzuswy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IYvs,Xzuyws->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IYvu,Xzyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IsXu,Yywsvz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywszv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywvsz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywvzs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywzsv->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsXu,Yywzvs->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IsXv,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 7/48 * einsum('xyzw,Jxuv,Istu,XzvsYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istu,XzvsYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Istu,XzvsYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istu,XzvsYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Istu,XzvsYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,Jxuv,Istu,XzvsYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvstYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Istu,XzvstYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvswYty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Istu,XzvswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvswtYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Istu,XzvswtyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istu,XzvswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/60 * einsum('xyzw,Jxuv,Istu,XzvsyYtw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 9/80 * einsum('xyzw,Jxuv,Istu,XzvsyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvsytYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istu,XzvsytwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istu,XzvsywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 11/48 * einsum('xyzw,Jxuv,Istv,XzusYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/16 * einsum('xyzw,Jxuv,Istv,XzusYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/8 * einsum('xyzw,Jxuv,Istv,XzusYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,Jxuv,Istv,XzusYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Istv,XzustYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istv,XzustYyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,Istv,XzuswYty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxuv,Istv,XzuswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 3/16 * einsum('xyzw,Jxuv,Istv,XzuswtYy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzuswtyY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istv,XzuswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Istv,XzusyYtw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 5/48 * einsum('xyzw,Jxuv,Istv,XzusyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusytYw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Istv,XzusytwY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,Jxuv,Istv,XzusywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsvX,Yywsuz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IsvX,Yywusz->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYtwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYtyw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYwty->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Isvt,XzusYwyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvt,XzusYytw->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,Jxuv,Isvt,XzusYywt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Isvt,XzuswYyt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Isvt,XzuswyYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/48 * einsum('xyzw,Jxuv,Isvt,XzusyYwt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,Jxuv,Isvt,XzusywYt->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Isvu,XzsYwy->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,Isvu,XzsywY->IXJY', v_aaaa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,Iv,XzuYwy->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,Iv,XzuywY->IXJY', v_aaaa, t1_xaaa, t1_xa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxa,JiYa,Xzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iIxa,Jiua,XzuYwy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiua,XzuywY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiwa,XzYy->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,iIxa,Jiwa,XzyY->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiXa,Yzyw->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iJxa,Iiua,XywYuz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iJxa,Iiua,XywuYz->IXJY', v_aaaa, t1_xxae, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxa,JiYa,Xzyw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iIxa,Jiua,XzuYwy->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiua,XzuywY->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iIxa,Jiwa,XzYy->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,iIxa,Jiwa,XzyY->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiXa,Yzyw->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iJxa,Iiua,XywYuz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,iJxa,Iiua,XywuYz->IXJY', v_aaaa, t1_vxae, t1_xvae, rdm_cccaaa, optimize = einsum_type)
     
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ca, n_ca)
        M_00[s_ca_aa:f_ca_aa, s_ca_bb:f_ca_bb] += temp
        M_00[s_ca_bb:f_ca_bb, s_ca_aa:f_ca_aa] += temp
        del temp
     
        # CE - CA
        ## aa,aa || bb,bb
        temp  = einsum('Ja,IXAa->IAJX', h_xe, t1_xaee, optimize = einsum_type)
        temp -= einsum('Ja,IXaA->IAJX', h_xe, t1_xaee, optimize = einsum_type)
        temp += einsum('Jx,IXAx->IAJX', h_xa, t1_xaea, optimize = einsum_type)
        temp -= einsum('Jx,IXxA->IAJX', h_xa, t1_xaae, optimize = einsum_type)
        temp -= einsum('IXab,JaAb->IAJX', t1_xaee, v_xeee, optimize = einsum_type)
        temp += einsum('IXab,JbAa->IAJX', t1_xaee, v_xeee, optimize = einsum_type)
        temp -= einsum('IXax,JaAx->IAJX', t1_xaea, v_xeea, optimize = einsum_type)
        temp += einsum('IXax,JxAa->IAJX', t1_xaea, v_xaee, optimize = einsum_type)
        temp += einsum('IXxa,JaAx->IAJX', t1_xaae, v_xeea, optimize = einsum_type)
        temp -= einsum('IXxa,JxAa->IAJX', t1_xaae, v_xaee, optimize = einsum_type)
        temp -= einsum('IXxy,JxAy->IAJX', t1_xaaa, v_xaea, optimize = einsum_type)
        temp += einsum('IXxy,JyAx->IAJX', t1_xaaa, v_xaea, optimize = einsum_type)
        temp += einsum('Ia,JXAa->IAJX', t1_xe, v_xaee, optimize = einsum_type)
        temp -= einsum('Ia,JaAX->IAJX', t1_xe, v_xeea, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JXia->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp -= einsum('IiAa,iXJa->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp -= einsum('IixA,JXix->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp += einsum('IixA,JxiX->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JXia->IAJX', t1_xvee, v_xave, optimize = einsum_type)
        temp -= einsum('IiAa,iXJa->IAJX', t1_xvee, v_vaxe, optimize = einsum_type)
        temp -= einsum('IixA,JXix->IAJX', t1_xvae, v_xava, optimize = einsum_type)
        temp += einsum('IixA,JxiX->IAJX', t1_xvae, v_xava, optimize = einsum_type)
        temp += einsum('Ix,JXAx->IAJX', t1_xa, v_xaea, optimize = einsum_type)
        temp -= einsum('Ix,JxAX->IAJX', t1_xa, v_xaea, optimize = einsum_type)
        temp += einsum('Ja,IAXa->IAJX', t1_xe, v_xeae, optimize = einsum_type)
        temp -= einsum('Ja,IaXA->IAJX', t1_xe, v_xeae, optimize = einsum_type)
        temp += 2 * einsum('JiXa,IAia->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp -= einsum('JiXa,iAIa->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp -= einsum('JiXx,IxiA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiXx,ixIA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += einsum('JixX,IxiA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp -= einsum('JixX,ixIA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiXa,IAia->IAJX', t1_xvae, v_xeve, optimize = einsum_type)
        temp -= einsum('JiXa,iAIa->IAJX', t1_xvae, v_vexe, optimize = einsum_type)
        temp -= einsum('JiXx,IxiA->IAJX', t1_xvaa, v_xave, optimize = einsum_type)
        temp += 2 * einsum('JiXx,ixIA->IAJX', t1_xvaa, v_vaxe, optimize = einsum_type)
        temp += einsum('JixX,IxiA->IAJX', t1_xvaa, v_xave, optimize = einsum_type)
        temp -= einsum('JixX,ixIA->IAJX', t1_xvaa, v_vaxe, optimize = einsum_type)
        temp += einsum('Jx,IAXx->IAJX', t1_xa, v_xeaa, optimize = einsum_type)
        temp -= einsum('Jx,IxXA->IAJX', t1_xa, v_xaae, optimize = einsum_type)
        temp += einsum('Xa,IAaJ->IAJX', t1_ae, v_xeex, optimize = einsum_type)
        temp -= einsum('Xa,JIAa->IAJX', t1_ae, v_xxee, optimize = einsum_type)
        temp += einsum('iA,JIiX->IAJX', t1_xe, v_xxxa, optimize = einsum_type)
        temp -= einsum('iA,iIJX->IAJX', t1_xe, v_xxxa, optimize = einsum_type)
        temp -= einsum('iIAa,JXia->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp += einsum('iIAa,iXJa->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iIxA,JXix->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= einsum('iIxA,JxiX->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= einsum('iJXa,IAia->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp += einsum('iJXa,iAIa->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp += einsum('iX,IJiA->IAJX', t1_xa, v_xxxe, optimize = einsum_type)
        temp -= einsum('iX,iJIA->IAJX', t1_xa, v_xxxe, optimize = einsum_type)
        temp += einsum('iXAa,JIia->IAJX', t1_xaee, v_xxxe, optimize = einsum_type)
        temp -= einsum('iXAa,iIJa->IAJX', t1_xaee, v_xxxe, optimize = einsum_type)
        temp += einsum('iXAx,JIix->IAJX', t1_xaea, v_xxxa, optimize = einsum_type)
        temp -= einsum('iXAx,iIJx->IAJX', t1_xaea, v_xxxa, optimize = einsum_type)
        temp -= 2 * einsum('iXaA,JIia->IAJX', t1_xaee, v_xxxe, optimize = einsum_type)
        temp += einsum('iXaA,iIJa->IAJX', t1_xaee, v_xxxe, optimize = einsum_type)
        temp -= 2 * einsum('iXxA,JIix->IAJX', t1_xaae, v_xxxa, optimize = einsum_type)
        temp += einsum('iXxA,iIJx->IAJX', t1_xaae, v_xxxa, optimize = einsum_type)
        temp += einsum('iA,JIiX->IAJX', t1_ve, v_xxva, optimize = einsum_type)
        temp -= einsum('iA,iIJX->IAJX', t1_ve, v_vxxa, optimize = einsum_type)
        temp -= einsum('iIAa,JXia->IAJX', t1_vxee, v_xave, optimize = einsum_type)
        temp += einsum('iIAa,iXJa->IAJX', t1_vxee, v_vaxe, optimize = einsum_type)
        temp += 2 * einsum('iIxA,JXix->IAJX', t1_vxae, v_xava, optimize = einsum_type)
        temp -= einsum('iIxA,JxiX->IAJX', t1_vxae, v_xava, optimize = einsum_type)
        temp -= einsum('iJXa,IAia->IAJX', t1_vxae, v_xeve, optimize = einsum_type)
        temp += einsum('iJXa,iAIa->IAJX', t1_vxae, v_vexe, optimize = einsum_type)
        temp += einsum('iX,IJiA->IAJX', t1_va, v_xxve, optimize = einsum_type)
        temp -= einsum('iX,iJIA->IAJX', t1_va, v_vxxe, optimize = einsum_type)
        temp += einsum('iXAa,JIia->IAJX', t1_vaee, v_xxve, optimize = einsum_type)
        temp -= einsum('iXAa,iIJa->IAJX', t1_vaee, v_vxxe, optimize = einsum_type)
        temp += einsum('iXAx,JIix->IAJX', t1_vaea, v_xxva, optimize = einsum_type)
        temp -= einsum('iXAx,iIJx->IAJX', t1_vaea, v_vxxa, optimize = einsum_type)
        temp -= 2 * einsum('iXaA,JIia->IAJX', t1_vaee, v_xxve, optimize = einsum_type)
        temp += einsum('iXaA,iIJa->IAJX', t1_vaee, v_vxxe, optimize = einsum_type)
        temp -= 2 * einsum('iXxA,JIix->IAJX', t1_vaae, v_xxva, optimize = einsum_type)
        temp += einsum('iXxA,iIJx->IAJX', t1_vaae, v_vxxa, optimize = einsum_type)
        temp += einsum('xA,IJXx->IAJX', t1_ae, v_xxaa, optimize = einsum_type)
        temp -= einsum('xA,IxXJ->IAJX', t1_ae, v_xaax, optimize = einsum_type)
        temp += einsum('A,IJ,XA->IAJX', e_extern, np.identity(ncvs), t2_ae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAa,Ja->IAJX', e_extern, t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAx,Jx->IAJX', e_extern, t1_xaea, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IXaA,Ja->IAJX', e_extern, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IXxA,Jx->IAJX', e_extern, t1_xaae, t1_xa, optimize = einsum_type)
        temp += einsum('A,IiAa,JiXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,JiXx->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('A,IixA,JixX->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('A,IiAa,JiXa->IAJX', e_extern, t1_xvee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJXa->IAJX', e_extern, t1_xvee, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,JiXx->IAJX', e_extern, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('A,IixA,JixX->IAJX', e_extern, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,iJXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += einsum('A,iIxA,JiXx->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixX->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiXa->IAJX', e_extern, t1_vxee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,iJXa->IAJX', e_extern, t1_vxee, t1_vxae, optimize = einsum_type)
        temp += einsum('A,iIxA,JiXx->IAJX', e_extern, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixX->IAJX', e_extern, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAa,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAx,Jx->IAJX', e_cvs, t1_xaea, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IXaA,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('I,IXxA,Jx->IAJX', e_cvs, t1_xaae, t1_xa, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiXa->IAJX', e_cvs, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJXa->IAJX', e_cvs, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,JiXx->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IixA,JixX->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiXa->IAJX', e_cvs, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,iJXa->IAJX', e_cvs, t1_vxee, t1_vxae, optimize = einsum_type)
        temp -= einsum('I,iIxA,JiXx->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixX->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAa,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAx,Jx->IAJX', e_cvs, t1_xaea, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IXaA,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('J,IXxA,Jx->IAJX', e_cvs, t1_xaae, t1_xa, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiXa->IAJX', e_cvs, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJXa->IAJX', e_cvs, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,JiXx->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IixA,JixX->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiXa->IAJX', e_cvs, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('J,iIAa,iJXa->IAJX', e_cvs, t1_vxee, t1_vxae, optimize = einsum_type)
        temp -= einsum('J,iIxA,JiXx->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixX->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('a,Ja,IXAa->IAJX', e_extern, t1_xe, t1_xaee, optimize = einsum_type)
        temp -= einsum('a,Ja,IXaA->IAJX', e_extern, t1_xe, t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('a,JiXa,IiAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,JiXa,iIAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 2 * einsum('a,JiXa,IiAa->IAJX', e_extern, t1_xvae, t1_xvee, optimize = einsum_type)
        temp -= einsum('a,JiXa,iIAa->IAJX', e_extern, t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= einsum('a,iJXa,IiAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += einsum('a,iJXa,iIAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,iJXa,IiAa->IAJX', e_extern, t1_vxae, t1_xvee, optimize = einsum_type)
        temp += einsum('a,iJXa,iIAa->IAJX', e_extern, t1_vxae, t1_vxee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('i,JiXa,IiAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXa,iIAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXx,IixA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiXx,iIxA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixX,IixA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixX,iIxA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJXa,IiAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJXa,iIAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiXa->IAJX', e_val, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJXa->IAJX', e_val, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiXx->IAJX', e_val, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JixX->IAJX', e_val, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('i,JiXa,IiAa->IAJX', e_val, t1_xvae, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXa,iIAa->IAJX', e_val, t1_xvae, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXx,IixA->IAJX', e_val, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,JiXx,iIxA->IAJX', e_val, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,JixX,IixA->IAJX', e_val, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixX,iIxA->IAJX', e_val, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiXa->IAJX', e_val, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,iJXa->IAJX', e_val, t1_vxee, t1_vxae, optimize = einsum_type)
        temp -= einsum('i,iIxA,JiXx->IAJX', e_val, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixX->IAJX', e_val, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJXa,IiAa->IAJX', e_val, t1_vxae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iJXa,iIAa->IAJX', e_val, t1_vxae, t1_vxee, optimize = einsum_type)
        temp -= einsum('iA,IJ,iX->IAJX', h_xe, np.identity(ncvs), t1_xa, optimize = einsum_type)
        temp -= einsum('iX,IJ,iA->IAJX', h_xa, np.identity(ncvs), t1_xe, optimize = einsum_type)
        temp -= einsum('ia,IJ,iXAa->IAJX', h_xe, np.identity(ncvs), t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iXaA->IAJX', h_xe, np.identity(ncvs), t1_xaee, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXAx->IAJX', h_xa, np.identity(ncvs), t1_xaea, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iXxA->IAJX', h_xa, np.identity(ncvs), t1_xaae, optimize = einsum_type)
        temp -= einsum('iA,IJ,iX->IAJX', h_ve, np.identity(ncvs), t1_va, optimize = einsum_type)
        temp -= einsum('iX,IJ,iA->IAJX', h_va, np.identity(ncvs), t1_ve, optimize = einsum_type)
        temp -= einsum('ia,IJ,iXAa->IAJX', h_ve, np.identity(ncvs), t1_vaee, optimize = einsum_type)
        temp += 2 * einsum('ia,IJ,iXaA->IAJX', h_ve, np.identity(ncvs), t1_vaee, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXAx->IAJX', h_va, np.identity(ncvs), t1_vaea, optimize = einsum_type)
        temp += 2 * einsum('ix,IJ,iXxA->IAJX', h_va, np.identity(ncvs), t1_vaae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,xA->IAJX', h_aa, np.identity(ncvs), t2_ae, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxAa,Xx->IAJX', h_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IxaA,Xx->IAJX', h_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyAx,Xy->IAJX', h_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IyxA,Xy->IAJX', h_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAa,Ja->IAJX', h_aa, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAy,Jy->IAJX', h_aa, t1_xaea, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IxaA,Ja->IAJX', h_aa, t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IxyA,Jy->IAJX', h_aa, t1_xaae, t1_xa, optimize = einsum_type)
        temp += einsum('Xx,Jixa,IiAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixa,iIAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,IiyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Jixy,iIyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jiyx,IiyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jiyx,iIyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Jixa,IiAa->IAJX', h_aa, t1_xvae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixa,iIAa->IAJX', h_aa, t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,IiyA->IAJX', h_aa, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp += einsum('Xx,Jixy,iIyA->IAJX', h_aa, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jiyx,IiyA->IAJX', h_aa, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jiyx,iIyA->IAJX', h_aa, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iJxa,IiAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,iJxa,iIAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iJxa,IiAa->IAJX', h_aa, t1_vxae, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,iJxa,iIAa->IAJX', h_aa, t1_vxae, t1_vxee, optimize = einsum_type)
        temp += einsum('xy,IXAx,Jy->IAJX', h_aa, t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('xy,IXxA,Jy->IAJX', h_aa, t1_xaae, t1_xa, optimize = einsum_type)
        temp -= einsum('xy,IixA,JiXy->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,IixA,JiyX->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IixA,JiXy->IAJX', h_aa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,IixA,JiyX->IAJX', h_aa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,JiXy->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyX->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,JiXy->IAJX', h_aa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyX->IAJX', h_aa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXab,iaAb->IAJX', np.identity(ncvs), t1_xaee, v_xeee, optimize = einsum_type)
        temp -= einsum('IJ,iXab,ibAa->IAJX', np.identity(ncvs), t1_xaee, v_xeee, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXax,iaAx->IAJX', np.identity(ncvs), t1_xaea, v_xeea, optimize = einsum_type)
        temp -= einsum('IJ,iXax,ixAa->IAJX', np.identity(ncvs), t1_xaea, v_xaee, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iaAx->IAJX', np.identity(ncvs), t1_xaae, v_xeea, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxa,ixAa->IAJX', np.identity(ncvs), t1_xaae, v_xaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxy,ixAy->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,iyAx->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, optimize = einsum_type)
        temp -= einsum('IJ,ia,iAXa->IAJX', np.identity(ncvs), t1_xe, v_xeae, optimize = einsum_type)
        temp -= einsum('IJ,ia,iXAa->IAJX', np.identity(ncvs), t1_xe, v_xaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaAX->IAJX', np.identity(ncvs), t1_xe, v_xeea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaXA->IAJX', np.identity(ncvs), t1_xe, v_xeae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iXja->IAJX', np.identity(ncvs), t1_xxee, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jXia->IAJX', np.identity(ncvs), t1_xxee, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iAja->IAJX', np.identity(ncvs), t1_xxae, v_xexe, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jAia->IAJX', np.identity(ncvs), t1_xxae, v_xexe, optimize = einsum_type)
        temp += einsum('IJ,ijXx,ixjA->IAJX', np.identity(ncvs), t1_xxaa, v_xaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,jxiA->IAJX', np.identity(ncvs), t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iXjx->IAJX', np.identity(ncvs), t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,jXix->IAJX', np.identity(ncvs), t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iXja->IAJX', np.identity(ncvs), t1_xvee, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jXia->IAJX', np.identity(ncvs), t1_xvee, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iAja->IAJX', np.identity(ncvs), t1_xvae, v_xeve, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jAia->IAJX', np.identity(ncvs), t1_xvae, v_vexe, optimize = einsum_type)
        temp += einsum('IJ,ijXx,ixjA->IAJX', np.identity(ncvs), t1_xvaa, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,jxiA->IAJX', np.identity(ncvs), t1_xvaa, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iXjx->IAJX', np.identity(ncvs), t1_xvae, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,jXix->IAJX', np.identity(ncvs), t1_xvae, v_vaxa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iAXx->IAJX', np.identity(ncvs), t1_xa, v_xeaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iXAx->IAJX', np.identity(ncvs), t1_xa, v_xaea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixAX->IAJX', np.identity(ncvs), t1_xa, v_xaea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixXA->IAJX', np.identity(ncvs), t1_xa, v_xaae, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXab,iaAb->IAJX', np.identity(ncvs), t1_vaee, v_veee, optimize = einsum_type)
        temp -= einsum('IJ,iXab,ibAa->IAJX', np.identity(ncvs), t1_vaee, v_veee, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXax,iaAx->IAJX', np.identity(ncvs), t1_vaea, v_veea, optimize = einsum_type)
        temp -= einsum('IJ,iXax,ixAa->IAJX', np.identity(ncvs), t1_vaea, v_vaee, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iaAx->IAJX', np.identity(ncvs), t1_vaae, v_veea, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxa,ixAa->IAJX', np.identity(ncvs), t1_vaae, v_vaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxy,ixAy->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,iyAx->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, optimize = einsum_type)
        temp -= einsum('IJ,ia,iAXa->IAJX', np.identity(ncvs), t1_ve, v_veae, optimize = einsum_type)
        temp -= einsum('IJ,ia,iXAa->IAJX', np.identity(ncvs), t1_ve, v_vaee, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaAX->IAJX', np.identity(ncvs), t1_ve, v_veea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ia,iaXA->IAJX', np.identity(ncvs), t1_ve, v_veae, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iXja->IAJX', np.identity(ncvs), t1_vxee, v_vaxe, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jXia->IAJX', np.identity(ncvs), t1_vxee, v_xave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iAja->IAJX', np.identity(ncvs), t1_vxae, v_vexe, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jAia->IAJX', np.identity(ncvs), t1_vxae, v_xeve, optimize = einsum_type)
        temp += einsum('IJ,ijXx,ixjA->IAJX', np.identity(ncvs), t1_vxaa, v_vaxe, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,jxiA->IAJX', np.identity(ncvs), t1_vxaa, v_xave, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iXjx->IAJX', np.identity(ncvs), t1_vxae, v_vaxa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,jXix->IAJX', np.identity(ncvs), t1_vxae, v_xava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijAa,iXja->IAJX', np.identity(ncvs), t1_vvee, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijAa,jXia->IAJX', np.identity(ncvs), t1_vvee, v_vave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXa,iAja->IAJX', np.identity(ncvs), t1_vvae, v_veve, optimize = einsum_type)
        temp += einsum('IJ,ijXa,jAia->IAJX', np.identity(ncvs), t1_vvae, v_veve, optimize = einsum_type)
        temp += einsum('IJ,ijXx,ixjA->IAJX', np.identity(ncvs), t1_vvaa, v_vave, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijXx,jxiA->IAJX', np.identity(ncvs), t1_vvaa, v_vave, optimize = einsum_type)
        temp += einsum('IJ,ijxA,iXjx->IAJX', np.identity(ncvs), t1_vvae, v_vava, optimize = einsum_type)
        temp -= 2 * einsum('IJ,ijxA,jXix->IAJX', np.identity(ncvs), t1_vvae, v_vava, optimize = einsum_type)
        temp -= einsum('IJ,ix,iAXx->IAJX', np.identity(ncvs), t1_va, v_veaa, optimize = einsum_type)
        temp -= einsum('IJ,ix,iXAx->IAJX', np.identity(ncvs), t1_va, v_vaea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixAX->IAJX', np.identity(ncvs), t1_va, v_vaea, optimize = einsum_type)
        temp += 2 * einsum('IJ,ix,ixXA->IAJX', np.identity(ncvs), t1_va, v_vaae, optimize = einsum_type)
        temp += einsum('IXAa,Jaxy,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXAa,Jxya,yx->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IXAx,Jxyz,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXAx,Jyzx,zy->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IXaA,Jaxy,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXaA,Jxya,yx->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXax,JaAy,xy->IAJX', t1_xaea, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXax,JyAa,xy->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IXxA,Jxyz,yz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXxA,Jyzx,zy->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxa,JaAy,xy->IAJX', t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXxa,JyAa,xy->IAJX', t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXxy,JxAz,yz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxy,JyAz,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxy,JzAx,yz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IXxy,JzAy,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ia,JaAx,Xx->IAJX', t1_xe, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxAa,Xx->IAJX', t1_xe, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiAa,Jxia,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiAa,ixJa,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,JXiy,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,Jxiy,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,JyiX,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,Jyix,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IixA,Jyiz,Xxyz->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IixA,Jyiz,Xxzy->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiAa,Jxia,Xx->IAJX', t1_xvee, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiAa,ixJa,Xx->IAJX', t1_xvee, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,JXiy,xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,Jxiy,Xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IixA,JyiX,xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,Jyix,Xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('IixA,Jyiz,Xxyz->IAJX', t1_xvae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IixA,Jyiz,Xxzy->IAJX', t1_xvae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ix,JxAy,Xy->IAJX', t1_xa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyAx,Xy->IAJX', t1_xa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAa,JXya,xy->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,JayX,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,Jayz,Xyxz->IAJX', t1_xaee, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,Jyza,Xzyx->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IxAy,JXxz,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAy,JXzy,xz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,JyzX,xz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,Jyzw,Xzxw->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,Jzwy,Xwzx->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,JzxX,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,Jzxw,Xyzw->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaA,JXya,xy->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxaA,JayX,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxaA,Jayz,Xyxz->IAJX', t1_xaee, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxaA,Jyza,Xzxy->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IxaA,Jyza,Xzyx->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixab,JaAb,Xx->IAJX', t1_xaee, v_xeee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixab,JbAa,Xx->IAJX', t1_xaee, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixay,JXAa,xy->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ixay,JaAX,xy->IAJX', t1_xaea, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,JaAy,Xx->IAJX', t1_xaea, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,JaAz,Xyzx->IAJX', t1_xaea, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JyAa,Xx->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JzAa,Xyzx->IAJX', t1_xaea, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JXxz,yz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JXzy,xz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JyzX,xz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,Jyzw,Xzxw->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyA,Jzwy,Xwxz->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IxyA,Jzwy,Xwzx->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JzxX,yz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxyA,Jzxw,Xywz->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyA,Jzxw,Xyzw->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JXAa,xy->IAJX', t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,JaAX,xy->IAJX', t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JaAy,Xx->IAJX', t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JaAz,Xyxz->IAJX', t1_xaae, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,JaAz,Xyzx->IAJX', t1_xaae, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,JyAa,Xx->IAJX', t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixya,JzAa,Xyxz->IAJX', t1_xaae, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JzAa,Xyzx->IAJX', t1_xaae, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Ixyz,JXAy,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JXAz,xy->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JwAy,Xzwx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JwAz,Xywx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JwAz,Xyxw->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Ixyz,JyAX,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JyAw,Xzwx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JyAz,Xx->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixyz,JzAX,xy->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Ixyz,JzAw,Xywx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzAw,Xyxw->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JzAy,Xx->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IAxa,Xx->IAJX', t1_xe, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ja,IaxA,Xx->IAJX', t1_xe, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiXx,IyiA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiXx,iyIA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixX,IyiA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixX,iyIA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixa,IAia,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iAIa,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,IxiA,Xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiA,Xx->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziA,Xzxy->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,IziA,Xzyx->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,ixIA,Xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,iyIA,Xx->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,izIA,Xzxy->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JiXx,IyiA,xy->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiXx,iyIA,xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JixX,IyiA,xy->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixX,iyIA,xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixa,IAia,Xx->IAJX', t1_xvae, v_xeve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iAIa,Xx->IAJX', t1_xvae, v_vexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jixy,IxiA,Xy->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiA,Xx->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziA,Xzxy->IAJX', t1_xvaa, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jixy,IziA,Xzyx->IAJX', t1_xvaa, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,ixIA,Xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,iyIA,Xx->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,izIA,Xzxy->IAJX', t1_xvaa, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IAyx,Xy->IAJX', t1_xa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jx,IxyA,Xy->IAJX', t1_xa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('JxXa,IAya,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxXa,IayA,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('JxXy,IAxz,yz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxXy,IAzy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxXy,IyzA,xz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxXy,IzxA,yz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaX,IAya,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxaX,IayA,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxay,IAXa,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IAza,Xxzy->IAJX', t1_xaea, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jxay,IaXA,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxay,IazA,Xxzy->IAJX', t1_xaea, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxyX,IAxz,yz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyX,IAzy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxyX,IyzA,xz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyX,IzxA,yz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IAXa,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IAza,Xxyz->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxya,IaXA,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IazA,Xxyz->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxya,IazA,Xxzy->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jxyz,IAXy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAXz,xy->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAwy,Xxwz->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAwz,Xxyw->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IAxw,Xwyz->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IwxA,Xwyz->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IwxA,Xwzy->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Jxyz,IyXA,xz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IywA,Xxwz->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IzXA,xy->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IzwA,Xxwy->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzwA,Xxyw->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxAa,IyaJ,xy->IAJX', t1_aaee, v_xaex, rdm_ca, optimize = einsum_type)
        temp -= einsum('XxAa,JIya,xy->IAJX', t1_aaee, v_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyA,IJyz,xz->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyA,IJzx,yz->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('XxyA,IxzJ,yz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyA,IzyJ,xz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxya,IAaJ,xy->IAJX', t1_aaae, v_xeex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxya,JIAa,xy->IAJX', t1_aaae, v_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iA,JIix,Xx->IAJX', t1_xe, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,iIJx,Xx->IAJX', t1_xe, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIAa,Jxia,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIAa,ixJa,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,JXiy,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jxiy,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiX,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,Jyix,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jyiz,Xxyz->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IAia,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iAIa,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXAx,JIiy,xy->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXAx,iIJy,xy->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxA,JIiy,xy->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxA,iIJy,xy->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiA,Xx->IAJX', t1_xa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIA,Xx->IAJX', t1_xa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAa,JIia,Xx->IAJX', t1_xaee, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iIJa,Xx->IAJX', t1_xaee, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixAy,JIiX,yx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAy,JIiy,Xx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAy,JIiz,Xyzx->IAJX', t1_xaea, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixAy,iIJX,yx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJy,Xx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJz,Xyzx->IAJX', t1_xaea, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixXy,IJiA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixXy,iJIA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixaA,JIia,Xx->IAJX', t1_xaee, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaA,iIJa,Xx->IAJX', t1_xaee, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiX,yx->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyA,JIiy,Xx->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiz,Xyxz->IAJX', t1_xaae, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJX,yx->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,iIJy,Xx->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyA,iIJz,Xyxz->IAJX', t1_xaae, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyA,iIJz,Xyzx->IAJX', t1_xaae, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,IJiA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iJIA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiA,Xxyz->IAJX', t1_xaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIA,Xxyz->IAJX', t1_xaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('iA,JIix,Xx->IAJX', t1_ve, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,iIJx,Xx->IAJX', t1_ve, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIAa,Jxia,Xx->IAJX', t1_vxee, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIAa,ixJa,Xx->IAJX', t1_vxee, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,JXiy,xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jxiy,Xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiX,xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,Jyix,Xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jyiz,Xxyz->IAJX', t1_vxae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IAia,Xx->IAJX', t1_vxae, v_xeve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iJxa,iAIa,Xx->IAJX', t1_vxae, v_vexe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXAx,JIiy,xy->IAJX', t1_vaea, v_xxva, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXAx,iIJy,xy->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += einsum('iXxA,JIiy,xy->IAJX', t1_vaae, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iXxA,iIJy,xy->IAJX', t1_vaae, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ix,IJiA,Xx->IAJX', t1_va, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIA,Xx->IAJX', t1_va, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAa,JIia,Xx->IAJX', t1_vaee, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iIJa,Xx->IAJX', t1_vaee, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixAy,JIiX,yx->IAJX', t1_vaea, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAy,JIiy,Xx->IAJX', t1_vaea, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAy,JIiz,Xyzx->IAJX', t1_vaea, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixAy,iIJX,yx->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJy,Xx->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJz,Xyzx->IAJX', t1_vaea, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('ixXy,IJiA,yx->IAJX', t1_vaaa, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixXy,iJIA,yx->IAJX', t1_vaaa, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += einsum('ixaA,JIia,Xx->IAJX', t1_vaee, v_xxve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaA,iIJa,Xx->IAJX', t1_vaee, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiX,yx->IAJX', t1_vaae, v_xxva, rdm_ca, optimize = einsum_type)
        temp += einsum('ixyA,JIiy,Xx->IAJX', t1_vaae, v_xxva, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,JIiz,Xyxz->IAJX', t1_vaae, v_xxva, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJX,yx->IAJX', t1_vaae, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyA,iIJy,Xx->IAJX', t1_vaae, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('ixyA,iIJz,Xyxz->IAJX', t1_vaae, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyA,iIJz,Xyzx->IAJX', t1_vaae, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyX,IJiA,yx->IAJX', t1_vaaa, v_xxve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iJIA,yx->IAJX', t1_vaaa, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ixyz,IJiA,Xxyz->IAJX', t1_vaaa, v_xxve, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIA,Xxyz->IAJX', t1_vaaa, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xA,IJyx,Xy->IAJX', t1_ae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xA,IxyJ,Xy->IAJX', t1_ae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXAa,IyaJ,xy->IAJX', t1_aaee, v_xaex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xXAa,JIya,xy->IAJX', t1_aaee, v_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xXyA,IJyz,xz->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xXyA,IJzx,yz->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXyA,IxzJ,yz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xXyA,IzyJ,xz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp += einsum('xXya,IAaJ,xy->IAJX', t1_aaae, v_xeex, rdm_ca, optimize = einsum_type)
        temp -= einsum('xXya,JIAa,xy->IAJX', t1_aaae, v_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IAaJ,Xx->IAJX', t1_ae, v_xeex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xa,JIAa,Xx->IAJX', t1_ae, v_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyAa,IzaJ,Xzxy->IAJX', t1_aaee, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyAa,IzaJ,Xzyx->IAJX', t1_aaee, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyAa,JIza,Xzxy->IAJX', t1_aaee, v_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzA,IJXx,zy->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzA,IJXy,zx->IAJX', t1_aaae, v_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzA,IJwx,Xzyw->IAJX', t1_aaae, v_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzA,IJwy,Xzwx->IAJX', t1_aaae, v_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IJzw,Xwyx->IAJX', t1_aaae, v_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzA,IwzJ,Xwxy->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzA,IwzJ,Xwyx->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IxXJ,zy->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzA,IxwJ,Xzwy->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzA,IxwJ,Xzyw->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzA,IyXJ,zx->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IywJ,Xzwx->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,IAaJ,Xzyx->IAJX', t1_aaae, v_xeex, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,JIAa,Xzyx->IAJX', t1_aaae, v_xxee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,IiyA,Jixz->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('Xxyz,IiyA,Jizx->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,IiyA,Jixz->IAJX', v_aaaa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += einsum('Xxyz,IiyA,Jizx->IAJX', v_aaaa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,iIyA,Jixz->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jizx->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,iIyA,Jixz->IAJX', v_aaaa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jizx->IAJX', v_aaaa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,iX->IAJX', e_extern, np.identity(ncvs), t1_xe, t1_xa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAa,ia->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAx,ix->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xa, optimize = einsum_type)
        temp += einsum('A,IJ,iXaA,ia->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp += einsum('A,IJ,iXxA,ix->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijXa->IAJX', e_extern, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiXa->IAJX', e_extern, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijXx->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,jiXx->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijXa->IAJX', e_extern, np.identity(ncvs), t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiXa->IAJX', e_extern, np.identity(ncvs), t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijXx->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,jiXx->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,iX->IAJX', e_extern, np.identity(ncvs), t1_ve, t1_va, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAa,ia->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAx,ix->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_va, optimize = einsum_type)
        temp += einsum('A,IJ,iXaA,ia->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp += einsum('A,IJ,iXxA,ix->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_va, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijXa->IAJX', e_extern, np.identity(ncvs), t1_vxee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiXa->IAJX', e_extern, np.identity(ncvs), t1_vxee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijXx->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_vxaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,jiXx->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijAa,ijXa->IAJX', e_extern, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijAa,jiXa->IAJX', e_extern, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,ijXx->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= einsum('A,IJ,ijxA,jiXx->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iXAa->IAJX', e_extern, np.identity(ncvs), t1_xe, t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ia,iXaA->IAJX', e_extern, np.identity(ncvs), t1_xe, t1_xaee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijXa,ijAa->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp += einsum('a,IJ,ijXa,jiAa->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijXa,ijAa->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_xvee, optimize = einsum_type)
        temp += einsum('a,IJ,ijXa,jiAa->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= einsum('a,IJ,ia,iXAa->IAJX', e_extern, np.identity(ncvs), t1_ve, t1_vaee, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ia,iXaA->IAJX', e_extern, np.identity(ncvs), t1_ve, t1_vaee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijXa,ijAa->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_vxee, optimize = einsum_type)
        temp += einsum('a,IJ,ijXa,jiAa->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_xvee, optimize = einsum_type)
        temp -= 2 * einsum('a,IJ,ijXa,ijAa->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += einsum('a,IJ,ijXa,jiAa->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,iA,iX->IAJX', e_cvs, np.identity(ncvs), t1_xe, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAa,ia->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAx,ix->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaA,ia->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxA,ix->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iXAa->IAJX', e_cvs, np.identity(ncvs), t1_xe, t1_xaee, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iXaA->IAJX', e_cvs, np.identity(ncvs), t1_xe, t1_xaee, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijXa->IAJX', e_cvs, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiXa->IAJX', e_cvs, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijAa->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiAa->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijxA->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,jixA->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijXx->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,jiXx->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijXa->IAJX', e_cvs, np.identity(ncvs), t1_xvee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiXa->IAJX', e_cvs, np.identity(ncvs), t1_xvee, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijAa->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiAa->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijxA->IAJX', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,jixA->IAJX', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijXx->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,jiXx->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_vxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iXAx->IAJX', e_cvs, np.identity(ncvs), t1_xa, t1_xaea, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iXxA->IAJX', e_cvs, np.identity(ncvs), t1_xa, t1_xaae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijXa->IAJX', e_cvs, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiXa->IAJX', e_cvs, np.identity(ncvs), t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijAa->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiAa->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,ijxA->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jixA->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,ijXx->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiXx->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijXa->IAJX', e_cvs, np.identity(ncvs), t1_vxee, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiXa->IAJX', e_cvs, np.identity(ncvs), t1_vxee, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijAa->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiAa->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,ijxA->IAJX', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jixA->IAJX', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,ijXx->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiXx->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,IJ,iA,iX->IAJX', e_val, np.identity(ncvs), t1_ve, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAa,ia->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAx,ix->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_va, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaA,ia->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxA,ix->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_va, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ia,iXAa->IAJX', e_val, np.identity(ncvs), t1_ve, t1_vaee, optimize = einsum_type)
        temp -= einsum('i,IJ,ia,iXaA->IAJX', e_val, np.identity(ncvs), t1_ve, t1_vaee, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijXa->IAJX', e_val, np.identity(ncvs), t1_vxee, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiXa->IAJX', e_val, np.identity(ncvs), t1_vxee, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijAa->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiAa->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijxA->IAJX', e_val, np.identity(ncvs), t1_vxaa, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,jixA->IAJX', e_val, np.identity(ncvs), t1_vxaa, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijXx->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_vxaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,jiXx->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijAa,ijXa->IAJX', e_val, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijAa,jiXa->IAJX', e_val, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXa,ijAa->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXa,jiAa->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,ijxA->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,ijXx,jixA->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,ijXx->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp += einsum('i,IJ,ijxA,jiXx->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ix,iXAx->IAJX', e_val, np.identity(ncvs), t1_va, t1_vaea, optimize = einsum_type)
        temp -= einsum('i,IJ,ix,iXxA->IAJX', e_val, np.identity(ncvs), t1_va, t1_vaae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijXa->IAJX', e_val, np.identity(ncvs), t1_xvee, t1_vxae, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiXa->IAJX', e_val, np.identity(ncvs), t1_xvee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijAa->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_vxee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiAa->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_xvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,ijxA->IAJX', e_val, np.identity(ncvs), t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jixA->IAJX', e_val, np.identity(ncvs), t1_xvaa, t1_xvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,ijXx->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_vxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiXx->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiAa,ijXa->IAJX', e_val, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jiAa,jiXa->IAJX', e_val, np.identity(ncvs), t1_vvee, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXa,ijAa->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXa,jiAa->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += einsum('i,IJ,jiXx,ijxA->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,jixA->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp += einsum('i,IJ,jixA,ijXx->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,jiXx->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,XxyA,yx->IAJX', e_extern, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,xXyA,yx->IAJX', e_extern, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAa,Jxay,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IXAa,Jxya,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAx,Jyxz,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IXAx,Jyzx,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IXaA,Jxay,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IXaA,Jxya,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IXxA,Jyxz,yz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IXxA,Jyzx,yz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,Jixa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IiAa,iJxa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,JiXy,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,Jixy,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,JiyX,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,Jiyx,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IixA,Jiyz,Xxyz->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('A,IixA,Jiyz,Xxzy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,Jixa,Xx->IAJX', e_extern, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IiAa,iJxa,Xx->IAJX', e_extern, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,JiXy,xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,Jixy,Xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IixA,JiyX,xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,Jiyx,Xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IixA,Jiyz,Xxyz->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('A,IixA,Jiyz,Xxzy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Ja,Xx->IAJX', e_extern, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAa,JyXa,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,JyaX,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Jyaz,Xyxz->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Jyza,Xyzx->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IxAy,JxXz,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,JxzX,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,Jxzw,Xyzw->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jy,Xx->IAJX', e_extern, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAy,JzXy,xz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jzwy,Xzwx->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,JzyX,xz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jzyw,Xzxw->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxaA,Ja,Xx->IAJX', e_extern, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxaA,JyXa,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxaA,JyaX,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxaA,Jyaz,Xyxz->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IxaA,Jyza,Xyxz->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('A,IxaA,Jyza,Xyzx->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JxXz,yz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JxzX,yz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('A,IxyA,Jxzw,Xywz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IxyA,Jxzw,Xyzw->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,Jy,Xx->IAJX', e_extern, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JzXy,xz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('A,IxyA,Jzwy,Xzwx->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IxyA,Jzwy,Xzxw->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JzyX,xz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,Jzyw,Xzxw->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIAa,Jixa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,iIAa,iJxa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JiXy,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jixy,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyX,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,Jiyx,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jiyz,Xxyz->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIAa,Jixa,Xx->IAJX', e_extern, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,iIAa,iJxa,Xx->IAJX', e_extern, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JiXy,xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jixy,Xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyX,xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,Jiyx,Xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jiyz,Xxyz->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAa,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IXAa,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAx,Jyxz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IXAx,Jyzx,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IXaA,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IXaA,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IXxA,Jyxz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IXxA,Jyzx,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,JiXy,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,Jixy,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IixA,JiyX,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAa,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAy,JxXz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,JxzX,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,Jxzw,Xyzw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jy,Xx->IAJX', e_cvs, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAy,JzXy,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jzwy,Xzwx->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,JzyX,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jzyw,Xzxw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaA,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxaA,Jyza,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxaA,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JxXz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JxzX,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyA,Jxzw,Xywz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyA,Jxzw,Xyzw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,Jy,Xx->IAJX', e_cvs, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JzXy,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyA,Jzwy,Xzwx->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyA,Jzwy,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JzyX,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,Jzyw,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIAa,Jixa,Xx->IAJX', e_cvs, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIAa,iJxa,Xx->IAJX', e_cvs, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JiXy,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jixy,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyX,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAa,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IXAa,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAx,Jyxz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IXAx,Jyzx,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IXaA,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IXaA,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IXxA,Jyxz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IXxA,Jyzx,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,JiXy,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,Jixy,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IixA,JiyX,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAa,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxAy,JxXz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,JxzX,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,Jxzw,Xyzw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jy,Xx->IAJX', e_cvs, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAy,JzXy,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jzwy,Xzwx->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,JzyX,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jzyw,Xzxw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaA,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaA,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaA,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxaA,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxaA,Jyza,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxaA,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JxXz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JxzX,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyA,Jxzw,Xywz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyA,Jxzw,Xyzw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,Jy,Xx->IAJX', e_cvs, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JzXy,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyA,Jzwy,Xzwx->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyA,Jzwy,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JzyX,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,Jzyw,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIAa,Jixa,Xx->IAJX', e_cvs, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,iIAa,iJxa,Xx->IAJX', e_cvs, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JiXy,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jixy,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyX,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IxAa,Xx->IAJX', e_extern, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Ja,IxaA,Xx->IAJX', e_extern, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiAa,Xx->IAJX', e_extern, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIAa,Xx->IAJX', e_extern, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxXa,IyAa,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxXa,IyaA,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaX,IyAa,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,JxaX,IyaA,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jxay,IXAa,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jxay,IXaA,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IzAa,Xxzy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxay,IzaA,Xxzy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IXAa,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jxya,IXaA,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IzAa,Xxyz->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IzaA,Xxyz->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('a,Jxya,IzaA,Xxzy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiAa,Xx->IAJX', e_extern, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,iJxa,iIAa,Xx->IAJX', e_extern, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IixA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,IixA,Xy->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyA,Xx->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,iIxA,Xy->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,iIyA,Xx->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,Jixa,Xx->IAJX', e_val, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiAa,iJxa,Xx->IAJX', e_val, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JiXy,xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IixA,Jixy,Xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiyX,xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixA,Jiyx,Xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixA,Jiyz,Xxyz->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('i,IixA,Jiyz,Xxzy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiAa,Xx->IAJX', e_val, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIAa,Xx->IAJX', e_val, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Jixy,IixA,Xy->IAJX', e_val, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyA,Xx->IAJX', e_val, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,iIxA,Xy->IAJX', e_val, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,iIyA,Xx->IAJX', e_val, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIAa,Jixa,Xx->IAJX', e_val, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIAa,iJxa,Xx->IAJX', e_val, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,JiXy,xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxA,Jixy,Xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyX,xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,Jiyx,Xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,Jiyz,Xxyz->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiAa,Xx->IAJX', e_val, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iJxa,iIAa,Xx->IAJX', e_val, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= einsum('iA,IJ,ixXy,yx->IAJX', h_xe, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,IJ,ixyX,yx->IAJX', h_xe, np.identity(ncvs), t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iX,IJ,ixAy,yx->IAJX', h_xa, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,IJ,ixyA,yx->IAJX', h_xa, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iXAy,xy->IAJX', h_xa, np.identity(ncvs), t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXyA,xy->IAJX', h_xa, np.identity(ncvs), t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('iA,IJ,ixXy,yx->IAJX', h_ve, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,IJ,ixyX,yx->IAJX', h_ve, np.identity(ncvs), t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iX,IJ,ixAy,yx->IAJX', h_va, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iX,IJ,ixyA,yx->IAJX', h_va, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,IJ,iXAy,xy->IAJX', h_va, np.identity(ncvs), t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('ix,IJ,iXyA,xy->IAJX', h_va, np.identity(ncvs), t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xa,IJ,XyAa,xy->IAJX', h_ae, np.identity(ncvs), t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IJ,yXAa,xy->IAJX', h_ae, np.identity(ncvs), t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijAa->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiAa->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijyA->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,jiyA->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijAa->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiAa->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijyA->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_xvae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,jiyA->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iA->IAJX', h_aa, np.identity(ncvs), t1_xa, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAa,ia->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAy,iy->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaA,ia->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xe, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyA,iy->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijAa->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiAa->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijyA->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_vxae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,jiyA->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_xvae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxa,ijAa->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxa,jiAa->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvee, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,ijyA->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ijxy,jiyA->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iA->IAJX', h_aa, np.identity(ncvs), t1_va, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAa,ia->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAy,iy->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaA,ia->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_ve, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyA,iy->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXAx,iy->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxA,iy->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,ijXy->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,jiXy->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,ijXy->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,jiXy->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_vxaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXAx,iy->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxA,iy->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,ijXy->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_vxaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,jiXy->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('xy,IJ,ijxA,ijXy->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= 2 * einsum('xy,IJ,ijxA,jiXy->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,xyzA,zy->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,yxzA,zy->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,XxzA,yz->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XzxA,yz->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,xXzA,yz->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,zXxA,yz->IAJX', h_aa, np.identity(ncvs), t2_aaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAa,Jyaz,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IxAa,Jyza,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IxAy,Jzwy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAy,Jzyw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IxaA,Jyaz,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IxaA,Jyza,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IxyA,Jzwy,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IxyA,Jzyw,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jixy,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jiyx,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jiyx,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jixy,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jiyx,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jiyx,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyax,IzAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyax,IzaA,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jyxa,IzAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyxa,IzaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jyxz,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyxz,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jyxz,IyAw,zw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyxz,IywA,zw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyzx,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyzx,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyzx,IyAw,zw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyzx,IywA,zw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IXAx,Jzwy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IXAx,Jzyw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IXxA,Jzwy,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IXxA,Jzyw,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,JiXz,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IixA,Jiyz,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixA,JizX,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IixA,Jizw,Xywz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixA,Jizw,Xyzw->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixA,Jizy,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,JiXz,yz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IixA,Jiyz,Xz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IixA,JizX,yz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IixA,Jizw,Xywz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixA,Jizw,Xyzw->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixA,Jizy,Xz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Ja,Xy->IAJX', h_aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAa,JzXa,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,JzaX,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Jzaw,Xzyw->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Jzwa,Xzwy->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JwXz,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jwuz,Xwuy->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,JwzX,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jwzu,Xwyu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IxAz,JyXw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JywX,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,Jywu,Xzwu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jz,Xy->IAJX', h_aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,Ja,Xy->IAJX', h_aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaA,JzXa,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,JzaX,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,Jzaw,Xzyw->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxaA,Jzwa,Xzwy->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IxaA,Jzwa,Xzyw->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzA,JwXz,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxzA,Jwuz,Xwuy->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IxzA,Jwuz,Xwyu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzA,JwzX,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzA,Jwzu,Xwyu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzA,JyXw,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IxzA,JywX,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxzA,Jywu,Xzuw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IxzA,Jywu,Xzwu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxzA,Jz,Xy->IAJX', h_aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IzAx,JwXy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jwuy,Xwuz->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JwyX,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jwyu,Xwzu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jy,Xz->IAJX', h_aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JzXw,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,JzwX,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,Jzwu,Xywu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxA,JwXy,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IzxA,Jwuy,Xwuz->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IzxA,Jwuy,Xwzu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxA,JwyX,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxA,Jwyu,Xwzu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IzxA,Jy,Xz->IAJX', h_aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxA,JzXw,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IzxA,JzwX,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,IzxA,Jzwu,Xyuw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IzxA,Jzwu,Xywu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiXx,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiXx,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixX,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixX,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,IiwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,iIwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,iIzA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,IiwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,IizA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIzA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiXx,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiXx,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JixX,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixX,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiAa,Xy->IAJX', h_aa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIAa,Xy->IAJX', h_aa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jixz,IiwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizA,Xy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,iIwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,iIzA,Xy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jizx,IiwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jizx,IizA,Xy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIzA,Xy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxXa,IzAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxXa,IzaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxXz,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxXz,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaX,IzAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxaX,IzaA,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxaz,IXAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jxaz,IXaA,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IwAa,Xywz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxaz,IwaA,Xywz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzX,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JxzX,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IXAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxza,IXaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IwAa,Xyzw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxza,IwaA,Xywz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IwaA,Xyzw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxzw,IXAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IXwA,yz->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jxzw,IXzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuAw,Xyzu->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuAz,Xyuw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jxzw,IuwA,Xyuz->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IuwA,Xyzu->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jxzw,IuzA,Xyuw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzXx,IzAw,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzXx,IzwA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzax,IXAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jzax,IXaA,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IwAa,Xzwy->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzax,IwaA,Xzwy->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzwx,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jzwx,IXwA,yz->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IuAw,Xzuy->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IuwA,Xzuy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IzAu,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,IzuA,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzwx,IzuA,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxX,IzAw,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,JzxX,IzwA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IXAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxa,IXaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IwAa,Xzyw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxa,IwaA,Xzwy->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IwaA,Xzyw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IXwA,yz->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IuAw,Xzyu->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IuwA,Xzuy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IuwA,Xzyu->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IzAu,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IzuA,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IzuA,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,JiXz,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,iIxA,Jiyz,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizX,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,Jizw,Xyzw->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,Jizy,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,JiXz,yz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,iIxA,Jiyz,Xz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizX,yz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,Jizw,Xyzw->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,Jizy,Xz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiAa,Xy->IAJX', h_aa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,iJxa,iIAa,Xy->IAJX', h_aa, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,XxAa,yzwa,xzwy->IAJX', np.identity(ncvs), t1_aaee, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxab,yaAb,xy->IAJX', np.identity(ncvs), t1_aaee, v_aeee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxab,ybAa,xy->IAJX', np.identity(ncvs), t1_aaee, v_aeee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxya,yAaz,xz->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,zAaw,xzwy->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,zwAa,xwyz->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxya,zyAa,xz->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iA,iXxy,yx->IAJX', np.identity(ncvs), t1_xe, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iA,ixyX,xy->IAJX', np.identity(ncvs), t1_xe, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iX,iAxy,yx->IAJX', np.identity(ncvs), t1_xa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iX,ixyA,xy->IAJX', np.identity(ncvs), t1_xa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXAa,iaxy,yx->IAJX', np.identity(ncvs), t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAa,ixya,xy->IAJX', np.identity(ncvs), t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXAx,ixyz,zy->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAx,iyzw,xzyw->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAx,iyzx,yz->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXaA,iaxy,yx->IAJX', np.identity(ncvs), t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXaA,ixya,xy->IAJX', np.identity(ncvs), t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXax,iaAy,xy->IAJX', np.identity(ncvs), t1_xaea, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXax,iyAa,xy->IAJX', np.identity(ncvs), t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxA,ixyz,zy->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxA,iyzw,xzyw->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxA,iyzx,yz->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxa,iaAy,xy->IAJX', np.identity(ncvs), t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iyAa,xy->IAJX', np.identity(ncvs), t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,ixAz,yz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,iyAz,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izAw,yxwz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izAx,yz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,izAy,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,iyjA,xy->IAJX', np.identity(ncvs), t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jyiA,xy->IAJX', np.identity(ncvs), t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,iXjy,xy->IAJX', np.identity(ncvs), t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jXiy,xy->IAJX', np.identity(ncvs), t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,iyjA,xy->IAJX', np.identity(ncvs), t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jyiA,xy->IAJX', np.identity(ncvs), t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,iXjy,xy->IAJX', np.identity(ncvs), t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jXiy,xy->IAJX', np.identity(ncvs), t1_xvae, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iAXy,xy->IAJX', np.identity(ncvs), t1_xa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iXAy,xy->IAJX', np.identity(ncvs), t1_xa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyAX,xy->IAJX', np.identity(ncvs), t1_xa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyXA,xy->IAJX', np.identity(ncvs), t1_xa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAa,iXya,xy->IAJX', np.identity(ncvs), t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAa,iayX,xy->IAJX', np.identity(ncvs), t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iXzw,yzxw->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iXzy,xz->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,iyzX,xz->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,izwX,ywxz->IAJX', np.identity(ncvs), t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXa,iAya,xy->IAJX', np.identity(ncvs), t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXa,iayA,xy->IAJX', np.identity(ncvs), t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iAzw,yzxw->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iAzy,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,iyzA,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,izwA,ywxz->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaA,iXya,xy->IAJX', np.identity(ncvs), t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaA,iayX,xy->IAJX', np.identity(ncvs), t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaX,iAya,xy->IAJX', np.identity(ncvs), t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaX,iayA,xy->IAJX', np.identity(ncvs), t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iAXa,yx->IAJX', np.identity(ncvs), t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iXAa,xy->IAJX', np.identity(ncvs), t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaAX,xy->IAJX', np.identity(ncvs), t1_xaea, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaXA,yx->IAJX', np.identity(ncvs), t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iXzw,yzxw->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iXzy,xz->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyA,iyzX,xz->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,izwX,ywzx->IAJX', np.identity(ncvs), t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iAzw,yzxw->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iAzy,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyX,iyzA,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,izwA,ywzx->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iAXa,yx->IAJX', np.identity(ncvs), t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iXAa,xy->IAJX', np.identity(ncvs), t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaAX,xy->IAJX', np.identity(ncvs), t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaXA,yx->IAJX', np.identity(ncvs), t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iAXw,xwzy->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iAXy,zx->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iAXz,yx->IAJX', np.identity(ncvs), t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXAw,xwzy->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iXAy,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXAz,xy->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwAX,xwzy->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwXA,xwzy->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyAX,xz->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyXA,zx->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izAX,xy->IAJX', np.identity(ncvs), t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izXA,yx->IAJX', np.identity(ncvs), t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iA,iXxy,yx->IAJX', np.identity(ncvs), t1_ve, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iA,ixyX,xy->IAJX', np.identity(ncvs), t1_ve, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iX,iAxy,yx->IAJX', np.identity(ncvs), t1_va, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iX,ixyA,xy->IAJX', np.identity(ncvs), t1_va, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXAa,iaxy,yx->IAJX', np.identity(ncvs), t1_vaee, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAa,ixya,xy->IAJX', np.identity(ncvs), t1_vaee, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXAx,ixyz,zy->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAx,iyzw,xzyw->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXAx,iyzx,yz->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXaA,iaxy,yx->IAJX', np.identity(ncvs), t1_vaee, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXaA,ixya,xy->IAJX', np.identity(ncvs), t1_vaee, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXax,iaAy,xy->IAJX', np.identity(ncvs), t1_vaea, v_veea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXax,iyAa,xy->IAJX', np.identity(ncvs), t1_vaea, v_vaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,iXxA,ixyz,zy->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxA,iyzw,xzyw->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,iXxA,iyzx,yz->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxa,iaAy,xy->IAJX', np.identity(ncvs), t1_vaae, v_veea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxa,iyAa,xy->IAJX', np.identity(ncvs), t1_vaae, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,ixAz,yz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,iyAz,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izAw,yxwz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,iXxy,izAx,yz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,iXxy,izAy,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,iyjA,xy->IAJX', np.identity(ncvs), t1_vxaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jyiA,xy->IAJX', np.identity(ncvs), t1_vxaa, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,iXjy,xy->IAJX', np.identity(ncvs), t1_vxae, v_vaxa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jXiy,xy->IAJX', np.identity(ncvs), t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijXx,iyjA,xy->IAJX', np.identity(ncvs), t1_vvaa, v_vave, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijXx,jyiA,xy->IAJX', np.identity(ncvs), t1_vvaa, v_vave, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,ijxA,iXjy,xy->IAJX', np.identity(ncvs), t1_vvae, v_vava, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,ijxA,jXiy,xy->IAJX', np.identity(ncvs), t1_vvae, v_vava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iAXy,xy->IAJX', np.identity(ncvs), t1_va, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ix,iXAy,xy->IAJX', np.identity(ncvs), t1_va, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyAX,xy->IAJX', np.identity(ncvs), t1_va, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ix,iyXA,xy->IAJX', np.identity(ncvs), t1_va, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAa,iXya,xy->IAJX', np.identity(ncvs), t1_vaee, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAa,iayX,xy->IAJX', np.identity(ncvs), t1_vaee, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iXzw,yzxw->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixAy,iXzy,xz->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,iyzX,xz->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixAy,izwX,ywxz->IAJX', np.identity(ncvs), t1_vaea, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXa,iAya,xy->IAJX', np.identity(ncvs), t1_vaae, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXa,iayA,xy->IAJX', np.identity(ncvs), t1_vaae, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iAzw,yzxw->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixXy,iAzy,xz->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,iyzA,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixXy,izwA,ywxz->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaA,iXya,xy->IAJX', np.identity(ncvs), t1_vaee, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaA,iayX,xy->IAJX', np.identity(ncvs), t1_vaee, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixaX,iAya,xy->IAJX', np.identity(ncvs), t1_vaea, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixaX,iayA,xy->IAJX', np.identity(ncvs), t1_vaea, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iAXa,yx->IAJX', np.identity(ncvs), t1_vaea, v_veae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixay,iXAa,xy->IAJX', np.identity(ncvs), t1_vaea, v_vaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaAX,xy->IAJX', np.identity(ncvs), t1_vaea, v_veea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixay,iaXA,yx->IAJX', np.identity(ncvs), t1_vaea, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iXzw,yzxw->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,iXzy,xz->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyA,iyzX,xz->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyA,izwX,ywzx->IAJX', np.identity(ncvs), t1_vaae, v_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iAzw,yzxw->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,iAzy,xz->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyX,iyzA,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyX,izwA,ywzx->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iAXa,yx->IAJX', np.identity(ncvs), t1_vaae, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixya,iXAa,xy->IAJX', np.identity(ncvs), t1_vaae, v_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaAX,xy->IAJX', np.identity(ncvs), t1_vaae, v_veea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixya,iaXA,yx->IAJX', np.identity(ncvs), t1_vaae, v_veae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iAXw,xwzy->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iAXy,zx->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iAXz,yx->IAJX', np.identity(ncvs), t1_vaaa, v_veaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXAw,xwzy->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iXAy,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,ixyz,iXAz,xy->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwAX,xwzy->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,iwXA,xwzy->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyAX,xz->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,ixyz,iyXA,zx->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izAX,xy->IAJX', np.identity(ncvs), t1_vaaa, v_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,ixyz,izXA,yx->IAJX', np.identity(ncvs), t1_vaaa, v_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXAa,yzwa,xzwy->IAJX', np.identity(ncvs), t1_aaee, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXya,yAaz,xz->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xXya,zAaw,xzyw->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXya,zwAa,xwyz->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXya,zyAa,xz->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xa,XAay,xy->IAJX', np.identity(ncvs), t1_ae, v_aeea, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xa,XAya,xy->IAJX', np.identity(ncvs), t1_ae, v_aeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yAXa,xy->IAJX', np.identity(ncvs), t1_ae, v_aeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xa,yXAa,xy->IAJX', np.identity(ncvs), t1_ae, v_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyAa,zXwa,xyzw->IAJX', np.identity(ncvs), t1_aaee, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyXa,zAwa,xyzw->IAJX', np.identity(ncvs), t1_aaae, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,XAaw,zwxy->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyza,XAwa,zwxy->IAJX', np.identity(ncvs), t1_aaae, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wAXa,zwxy->IAJX', np.identity(ncvs), t1_aaae, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyza,wXAa,zwxy->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,XxyA,xzwu,ywzu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,XxyA,yzwu,xwzu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xA,Xxyz,yz->IAJX', np.identity(ncvs), t2_ae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xA,Xyzx,zy->IAJX', np.identity(ncvs), t2_ae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xXyA,xzwu,ywzu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xXyA,yzwu,xwzu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xwux,zwuy->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xwuy,zwxu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzA,Xwzu,yxwu->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xxwu,zuyw->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzA,Xxwy,zw->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,Xywu,zuxw->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzA,Xywx,zw->IAJX', np.identity(ncvs), t2_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijxz->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijyA,jixz->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijxz->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijyA,jixz->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijxz->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijyA,jixz->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijxz->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, optimize = einsum_type)
        temp -= 2 * einsum('IJ,Xxyz,ijyA,jixz->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IiyA,Jiwu,xzuw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IiyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IiyA,Jiwx,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jiwz,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jixw,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IiyA,Jizw,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IiyA,Jiwu,xzuw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IiyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IiyA,Jiwx,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jiwz,xw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jixw,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IiyA,Jizw,xw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juvx,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juvz,xuvw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Juxv,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Juxz,wu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juzv,xuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juzx,wu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IwAy,Jwuv,xzuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Jx,zw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Jz,xw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IwyA,Juvx,zuvw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IwyA,Juvx,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IwyA,Juvz,xuvw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IwyA,Juvz,xuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Juxv,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Juxz,wu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IwyA,Juzv,xuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IwyA,Juzx,wu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IwyA,Jwuv,xzuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IwyA,Jwuv,xzvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Jx,zw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IwyA,Jz,xw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Ja,yz->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Jwau,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Jwaz,yw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAa,Jwua,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAa,Jwza,yw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAw,Juvw,yvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Juvz,yvuw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Juwv,yvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Juwz,yu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Juzv,yvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAw,Juzw,yu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Jw,yz->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Jz,yw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxaA,Ja,yz->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxaA,Jwau,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxaA,Jwaz,yw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IxaA,Jwua,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IxaA,Jwza,yw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IxwA,Juvw,yvzu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxwA,Juvz,yvuw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxwA,Juwv,yvzu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxwA,Juwz,yu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxwA,Juzv,yvwu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IxwA,Juzw,yu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxwA,Jw,yz->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxwA,Jz,yw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Ja,yx->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Jwau,yuxw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Jwua,yuwx->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Juvw,yvux->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Juwv,yvxu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Jw,yx->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IzaA,Ja,yx->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IzaA,Jwau,yuxw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IzaA,Jwua,yuwx->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IzaA,Jwua,yuxw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IzwA,Juvw,yvux->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,IzwA,Juvw,yvxu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IzwA,Juwv,yvxu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,IzwA,Jw,yx->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwx,IiuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwx,IiwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwx,iIuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwx,iIwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwz,IiuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwz,IiuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwz,IiwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jixa,IiAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixa,iIAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixw,IiuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,IiwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,iIuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jixw,iIwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixz,IiwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixz,iIwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiza,IiAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiza,iIAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jizw,IiuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jizw,IiuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,IiwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,iIuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jizw,iIwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jizx,IiwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizx,iIwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwx,IiuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jiwx,IiwA,yz->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwx,iIuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwx,iIwA,yz->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwz,IiuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jiwz,IiuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jiwz,IiwA,yx->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIwA,yx->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jixa,IiAa,yz->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixa,iIAa,yz->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixw,IiuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,IiwA,yz->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,iIuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jixw,iIwA,yz->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixz,IiwA,yw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixz,iIwA,yw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiza,IiAa,yx->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiza,iIAa,yx->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jizw,IiuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jizw,IiuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,IiwA,yx->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,iIuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jizw,iIwA,yx->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jizx,IiwA,yw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizx,iIwA,yw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwax,IuAa,yuzw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwax,IuaA,yuzw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwax,IzAa,yw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwax,IzaA,yw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwaz,IuAa,yuwx->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwaz,IuaA,yuwx->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwux,IvAu,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwux,IvuA,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwux,IwAv,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwux,IwvA,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwux,IzAu,yw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwux,IzAv,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwux,IzuA,yw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwux,IzvA,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwux,IzvA,yuwv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwuz,IvAu,yvwx->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuz,IvuA,yvwx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuz,IwAv,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuz,IwvA,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwuz,IwvA,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxa,IuAa,yuzw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwxa,IuaA,yuzw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxa,IzAa,yw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxa,IzaA,yw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxu,IvAu,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwxu,IvuA,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxu,IwAv,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxu,IwvA,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxu,IzAu,yw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jwxu,IzAv,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxu,IzuA,yw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxu,IzvA,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxz,IwAu,yu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxz,IwuA,yu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwza,IuAa,yuxw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwza,IuaA,yuwx->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwza,IuaA,yuxw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwzu,IvAu,yvxw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwzu,IvuA,yvwx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwzu,IvuA,yvxw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwzu,IwAv,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwzu,IwvA,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwzu,IwvA,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwzx,IwAu,yu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwzx,IwuA,yu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jx,IzAw,yw->IAJX', v_aaaa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jx,IzwA,yw->IAJX', v_aaaa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jyaw,IuAa,xzuw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jyaw,IuaA,xzuw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywa,IuAa,xzwu->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jywa,IuaA,xzuw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jywa,IuaA,xzwu->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywu,IvAu,xzwv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywu,IvAw,xzvu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jywu,IvuA,xzvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jywu,IvuA,xzwv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jywu,IvwA,xzvu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jywu,IxAv,zvuw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jywu,IxvA,zvuw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jywu,IzAv,xvwu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jywu,IzvA,xvuw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jywu,IzvA,xvwu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jiwx,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jiwz,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jixw,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jizw,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJxa,IiAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJxa,iIAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iJza,IiAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iJza,iIAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIyA,Jiwu,xzwu->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jiwx,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jiwz,xw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jixw,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jizw,xw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJxa,IiAa,yz->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iJxa,iIAa,yz->IAJX', v_aaaa, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iJza,IiAa,yx->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,iJza,iIAa,yx->IAJX', v_aaaa, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juvw,zvuy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juvy,zvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juwv,zvyu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juwy,zu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Juyv,zvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Juyw,zu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Jw,zy->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Jy,zw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXAx,Jzuv,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXxA,Juvw,zvuy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXxA,Juvy,zvwu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXxA,Juwv,zvyu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXxA,Juwy,zu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IXxA,Juyv,zvwu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IXxA,Juyw,zu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXxA,Jw,zy->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IXxA,Jy,zw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXxA,Jzuv,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,JiXu,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,JiXw,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,JiXy,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixA,JiuX,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IixA,Jiuv,Xywvuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixA,Jiuw,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,JiwX,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixA,Jiwu,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiwy,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixA,JiyX,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,Jiyu,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,Jiyw,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,JiXu,zuwy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,JiXw,zy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,JiXy,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IixA,JiuX,zuwy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IixA,Jiuv,Xywvuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixA,Jiuw,Xyzu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,JiwX,zy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IixA,Jiwu,Xyuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiwy,Xz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IixA,JiyX,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,Jiyu,Xwuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IixA,Jiyw,Xz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JuXv,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,JuvX,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,Juvs,Xywvsz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvXw,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvXy,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuAx,Jvsw,Xyvsuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvusz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvuzs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvzsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvsy,Xwvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvwX,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvws,Xyvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvwy,Xvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvyX,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvsuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvusz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuAx,Jvys,Xwvuzs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvzsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvyw,Xvuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jw,Xyzu->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jy,Xwuz->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuAx,JzXv,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuAx,JzvX,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywsuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywsvu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywusv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywuvs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywvsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuAx,Jzvs,Xywvus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxA,JuXv,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IuxA,JuvX,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IuxA,Juvs,Xywsvz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IuxA,Juvs,Xywvsz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvXw,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvXy,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvsuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvusz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvsy,Xwvszu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsy,Xwvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JvwX,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JvwX,zuyv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvws,Xyvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvws,Xyvzus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvwy,Xvuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvwy,Xvzu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JvyX,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvys,Xwvsuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvys,Xwvszu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvys,Xwvusz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,Jvys,Xwvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvys,Xwvzsu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvys,Xwvzus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,Jvyw,Xvuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jw,Xyuz->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jw,Xyzu->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,Jy,Xwuz->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JzXv,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JzvX,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JzvX,ywvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jzvs,Xywuvs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jzvs,Xywvus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Ja,Xzyw->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAa,JuXa,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,JuaX,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juav,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juaz,Xuyw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAa,Juva,Xzuvwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuvyw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuwvy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuwyv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuyvw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juza,Xuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Ju,Xzyw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JvXu,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxAu,JvXz,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jvsu,Xzvswy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvwsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvwys->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvysw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,Jvsz,Xuvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,JvuX,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvus,Xzvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvuz,Xvyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,JvzX,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvswy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvwsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxAu,Jvzs,Xuvwys->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvysw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvzu,Xvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JwXv,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JwvX,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,Jwvs,Xzuvsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JyXv,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JyvX,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzusvw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuswv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuvsw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxAu,Jyvs,Xzuvws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuwsv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuwvs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,Jz,Xuwy->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,Ja,Xzyw->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaA,JuXa,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,JuaX,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,Juav,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,Juaz,Xuyw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaA,Juva,Xzuvwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juva,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaA,Juza,Xuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juza,Xuyw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuA,Ju,Xzyw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuA,JvXu,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JvXz,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvswy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvyws->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jvsz,Xuvsyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvsz,Xuvysw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuA,JvuX,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuA,Jvus,Xzvyws->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxuA,Jvuz,Xvyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JvzX,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JvzX,ywvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvwys->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvyws->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuA,Jvzu,Xvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvzu,Xvyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JwXv,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JwvX,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JwvX,zuyv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jwvs,Xzuvsy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jwvs,Xzuysv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JyXv,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JyvX,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuswv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuvws->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jz,Xuwy->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jz,Xuyw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiXx,IiuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiXx,iIuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jiux,IiuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,iIuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,iIvA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwuy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwyu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvyuw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixX,IiuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixX,iIuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,IivA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,iIuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,iIvA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixz,IiuA,Xuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuA,Xuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,iIuA,Xuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiXx,IiuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiXx,iIuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jiux,IiuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,iIuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,iIvA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvuyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwuy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwyu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvyuw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JixX,IiuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixX,iIuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiAa,Xzyw->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIAa,Xzyw->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixu,IivA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,iIuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,iIvA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jixz,IiuA,Xuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuA,Xuyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,iIuA,Xuyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuXx,IuAv,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuXx,IuvA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juax,IXAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Juax,IXaA,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IvAa,Xzuvwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuvyw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuwvy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuwyv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuyvw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuywv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juax,IvaA,Xzuvwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaA,Xzuvyw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaA,Xzuwvy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaA,Xzuwyv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaA,Xzuyvw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juax,IvaA,Xzuywv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juvx,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Juvx,IXvA,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IsAv,Xzuswy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzusyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuwsy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuwys->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuysw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IsvA,Xzuswy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvA,Xzusyw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvA,Xzuwsy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvA,Xzuwys->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvA,Xzuysw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IsvA,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IuAs,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsvyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzswvy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzswyv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsyvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IusA,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusA,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxX,IuAv,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JuxX,IuvA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IXAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxa,IXaA,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IvAa,Xzuywv->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxa,IvaA,Xzuvwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IvaA,Xzuywv->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IXvA,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IsAv,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IsvA,Xzuswy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IsvA,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IuAs,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IusA,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IusA,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxz,IuAv,Xvyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxz,IuvA,Xvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxz,IuvA,Xvyw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxXa,IuAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxXa,IuaA,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxXu,IvAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxXu,IvuA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaX,IuAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxaX,IuaA,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxau,IXAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Jxau,IXaA,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywuvz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywuzv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IvAa,Xywvuz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywvzu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywzuv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywzvu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaA,Xywuvz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaA,Xywuzv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxau,IvaA,Xywvuz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaA,Xywvzu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaA,Xywzuv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxau,IvaA,Xywzvu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuX,IvAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,JxuX,IvuA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IXAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxua,IXaA,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IvAa,Xywuvz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IvaA,Xywuvz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxua,IvaA,Xywvuz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxuv,IXAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Jxuv,IXuA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Jxuv,IXvA,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IsAu,Xywsvz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywszv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywvsz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywvzs->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywzsv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywzvs->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IsAv,Xywusz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IsuA,Xywsvz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuA,Xywszv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuA,Xywvsz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuA,Xywvzs->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuA,Xywzsv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsuA,Xywzvs->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jxuv,IsvA,Xywsuz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsvA,Xywusz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,JiXu,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiXw,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,JiXy,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuX,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwX,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiwy,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyX,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyu,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyw,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iJxa,iIAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,JiXu,zuwy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiXw,zy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,JiXy,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuX,zuwy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiuw,Xyuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiuy,Xwuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwX,zy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiwu,Xyzu->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiwy,Xz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyX,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyu,Xwuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyw,Xz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiAa,Xzyw->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iJxa,iIAa,Xzyw->IAJX', v_aaaa, t1_vxae, t1_vxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,XxAa,ya,xy->IAJX', e_extern, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,XxAa,yzwa,xwzy->IAJX', e_extern, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,ixXy,yx->IAJX', e_extern, np.identity(ncvs), t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iA,ixyX,yx->IAJX', e_extern, np.identity(ncvs), t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAa,ixay,yx->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAa,ixya,yx->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iy,xy->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAx,iyxz,zy->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iyzw,xyzw->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iyzx,zy->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,iXaA,ixay,yx->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXaA,ixya,yx->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iy,xy->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,iXxA,iyxz,zy->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iyzw,xyzw->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iyzx,zy->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,ijXy,xy->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jiXy,xy->IAJX', e_extern, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,ijXy,xy->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jiXy,xy->IAJX', e_extern, np.identity(ncvs), t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAa,iyXa,xy->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAa,iyaX,xy->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,iX,yx->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izXw,yzxw->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izXy,xz->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izwX,yzxw->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izyX,xz->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixaA,iyXa,xy->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixaA,iyaX,xy->IAJX', e_extern, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,iX,yx->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izXw,yzxw->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izXy,xz->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izwX,yzwx->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixyA,izyX,xz->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iA,ixXy,yx->IAJX', e_extern, np.identity(ncvs), t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iA,ixyX,yx->IAJX', e_extern, np.identity(ncvs), t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAa,ixay,yx->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAa,ixya,yx->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iy,xy->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXAx,iyxz,zy->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iyzw,xyzw->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,iXAx,iyzx,zy->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,iXaA,ixay,yx->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXaA,ixya,yx->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iy,xy->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += einsum('A,IJ,iXxA,iyxz,zy->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iyzw,xyzw->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,iXxA,iyzx,zy->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,ijXy,xy->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jiXy,xy->IAJX', e_extern, np.identity(ncvs), t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,ijxA,ijXy,xy->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IJ,ijxA,jiXy,xy->IAJX', e_extern, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAa,iyXa,xy->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAa,iyaX,xy->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,iX,yx->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izXw,yzxw->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixAy,izXy,xz->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izwX,yzxw->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixAy,izyX,xz->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixaA,iyXa,xy->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixaA,iyaX,xy->IAJX', e_extern, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,iX,yx->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izXw,yzxw->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izXy,xz->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IJ,ixyA,izwX,yzwx->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IJ,ixyA,izyX,xz->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,xXAa,ya,xy->IAJX', e_extern, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,xXAa,yzwa,xwzy->IAJX', e_extern, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IJ,xyAa,zwXa,xyzw->IAJX', e_extern, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,IJ,ixXa,iyAa,xy->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixXa,iyaA,xy->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaX,iyAa,xy->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaX,iyaA,xy->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iXAa,yx->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ixay,iXaA,yx->IAJX', e_extern, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iXAa,yx->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iXaA,yx->IAJX', e_extern, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixXa,iyAa,xy->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixXa,iyaA,xy->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixaX,iyAa,xy->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixaX,iyaA,xy->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixay,iXAa,yx->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('a,IJ,ixay,iXaA,yx->IAJX', e_extern, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,IJ,ixya,iXAa,yx->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,IJ,ixya,iXaA,yx->IAJX', e_extern, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,IJ,xa,XyAa,xy->IAJX', e_extern, np.identity(ncvs), t1_ae, t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xa,yXAa,xy->IAJX', e_extern, np.identity(ncvs), t1_ae, t1_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyXa,zwAa,xyzw->IAJX', e_extern, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('a,IJ,xyza,XwAa,zwxy->IAJX', e_extern, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,IJ,xyza,wXAa,zwxy->IAJX', e_extern, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('i,IJ,iA,ixXy,yx->IAJX', e_cvs, np.identity(ncvs), t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iA,ixyX,yx->IAJX', e_cvs, np.identity(ncvs), t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAa,ixay,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXAa,ixya,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iXAx,iy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAx,iyxz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iXAx,iyzw,xyzw->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXAx,iyzx,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaA,ixay,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXaA,ixya,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iXxA,iy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxA,iyxz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iXxA,iyzw,xyzw->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxA,iyzx,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,ijyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,ijXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jiXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,ijyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,ijXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jiXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAa,iyXa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAa,iyaX,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,iX,yx->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,ixXz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,ixzX,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,izXw,yzxw->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,izXy,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixAy,izwX,yzxw->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,izyX,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXa,iyAa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXa,iyaA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixXy,ixAz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixXy,ixzA,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,izAy,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,izyA,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaA,iyXa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaA,iyaX,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaX,iyAa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaX,iyaA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iXAa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iXaA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,iX,yx->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,ixXz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,ixzX,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izXw,yzxw->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,izXy,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izwX,yzwx->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,izyX,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyX,ixAz,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,ixzA,yz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,izAy,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,izyA,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iXAa,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iXaA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXAy,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iXAz,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iXyA,xz->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXzA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,jiyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,jiXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,jiyA,xy->IAJX', e_cvs, np.identity(ncvs), t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,jiXy,xy->IAJX', e_cvs, np.identity(ncvs), t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iA,ixXy,yx->IAJX', e_val, np.identity(ncvs), t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iA,ixyX,yx->IAJX', e_val, np.identity(ncvs), t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAa,ixay,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXAa,ixya,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iXAx,iy,xy->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXAx,iyxz,yz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,iXAx,iyzw,xyzw->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,iXAx,iyzx,yz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXaA,ixay,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXaA,ixya,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iXxA,iy,xy->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,iXxA,iyxz,yz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,iXxA,iyzw,xyzw->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,iXxA,iyzx,yz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,ijyA,xy->IAJX', e_val, np.identity(ncvs), t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiyA,xy->IAJX', e_val, np.identity(ncvs), t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,ijXy,xy->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jiXy,xy->IAJX', e_val, np.identity(ncvs), t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijXx,ijyA,xy->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijXx,jiyA,xy->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ijxA,ijXy,xy->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ijxA,jiXy,xy->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAa,iyXa,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAa,iyaX,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,iX,yx->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,ixXz,yz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,ixzX,yz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('i,IJ,ixAy,izXw,yzxw->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixAy,izXy,xz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixAy,izwX,yzxw->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixAy,izyX,xz->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXa,iyAa,xy->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXa,iyaA,xy->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixXy,ixAz,yz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixXy,ixzA,yz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixXy,izAy,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixXy,izyA,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaA,iyXa,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaA,iyaX,xy->IAJX', e_val, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixaX,iyAa,xy->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixaX,iyaA,xy->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixay,iXAa,xy->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixay,iXaA,xy->IAJX', e_val, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,iX,yx->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,ixXz,yz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,ixzX,yz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izXw,yzxw->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyA,izXy,xz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyA,izwX,yzwx->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyA,izyX,xz->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,ixyX,ixAz,yz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,ixyX,ixzA,yz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyX,izAy,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyX,izyA,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixya,iXAa,xy->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixya,iXaA,xy->IAJX', e_val, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXAy,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IJ,ixyz,iXAz,xy->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('i,IJ,ixyz,iXyA,xz->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IJ,ixyz,iXzA,xy->IAJX', e_val, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijyA,xy->IAJX', e_val, np.identity(ncvs), t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,jiyA,xy->IAJX', e_val, np.identity(ncvs), t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijXy,xy->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,jiXy,xy->IAJX', e_val, np.identity(ncvs), t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jiXx,ijyA,xy->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jiXx,jiyA,xy->IAJX', e_val, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IJ,jixA,ijXy,xy->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,IJ,jixA,jiXy,xy->IAJX', e_val, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iyAz,zy->IAJX', h_aa, np.identity(ncvs), t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,ix,iyzA,zy->IAJX', h_aa, np.identity(ncvs), t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAa,iyaz,zy->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAa,iyza,zy->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAy,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaA,iyaz,zy->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixaA,iyza,zy->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyA,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyax,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyax,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxa,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxa,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iA,zy->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwAu,zwyu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwuA,zwyu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iA,zy->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwAu,zwyu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwuA,zwuy->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyzx,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ijxy,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ijxy,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,ix,iyAz,zy->IAJX', h_aa, np.identity(ncvs), t1_va, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,ix,iyzA,zy->IAJX', h_aa, np.identity(ncvs), t1_va, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAa,iyaz,zy->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAa,iyza,zy->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,ixAy,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixAy,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixaA,iyaz,zy->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixaA,iyza,zy->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,IJ,ixyA,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xx,IJ,ixyA,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyax,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyax,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxa,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxa,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iA,zy->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwAu,zwyu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyxz,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwuA,zwyu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyxz,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iA,zy->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwAu,zwyu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,iyzx,iwuA,zwuy->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,iyzx,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyAa,za,yz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IJ,xyAa,zwua,yuwz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxAa,za,yz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IJ,yxAa,zwua,yuwz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,IJ,yzxa,wuAa,yzwu->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XxAa,za,yz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,XxAa,zwua,yuwz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXAx,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXAx,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXAx,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXAx,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxA,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxA,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxA,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxA,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,ijXz,yz->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,jiXz,yz->IAJX', h_aa, np.identity(ncvs), t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,ijXz,yz->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,jiXz,yz->IAJX', h_aa, np.identity(ncvs), t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iXAz,yz->IAJX', h_aa, np.identity(ncvs), t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iXzA,yz->IAJX', h_aa, np.identity(ncvs), t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAa,izXa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAa,izaX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwXu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwXz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwuX,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwzX,yw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXa,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXa,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwAu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwuA,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaA,izXa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaA,izaX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaX,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaX,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwXu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwXz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwuX,yuwz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzA,iwzX,yw->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwAu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwuA,yuwz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzX,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXAu,yuwz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXAz,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXuA,yuwz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iXzA,yw->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iwXu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izAx,iwXy,zw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izAx,iwuX,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izAx,iwyX,zw->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iwAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izXx,iwuA,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iXAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXuA,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwXu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxA,iwXy,zw->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwuX,ywuz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxA,iwyX,zw->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwuA,ywuz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXAu,ywuz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXuA,ywuz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXAx,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,iXAx,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,iXAx,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXAx,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxA,iz,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,iXxA,izwu,yzwu->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,iXxA,izwy,wz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xy,IJ,iXxA,izyw,wz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,ijXz,yz->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,jiXz,yz->IAJX', h_aa, np.identity(ncvs), t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijXx,ijzA,yz->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijXx,jizA,yz->IAJX', h_aa, np.identity(ncvs), t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ijxA,ijXz,yz->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ijxA,jiXz,yz->IAJX', h_aa, np.identity(ncvs), t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,ix,iXAz,yz->IAJX', h_aa, np.identity(ncvs), t1_va, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,ix,iXzA,yz->IAJX', h_aa, np.identity(ncvs), t1_va, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAa,izXa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAa,izaX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwXu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixAz,iwXz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwuX,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixAz,iwzX,yw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXa,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXa,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwAu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixXz,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwuA,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixXz,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaA,izXa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaA,izaX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixaX,izAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaX,izaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixaz,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixaz,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwXu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwXz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzA,iwuX,yuwz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzA,iwzX,yw->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwAu,yuzw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwAz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzX,iwuA,yuwz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzX,iwzA,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixza,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixza,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXAu,yuwz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,ixzw,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXAz,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXuA,yuwz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,ixzw,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,IJ,ixzw,iXzA,yw->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izAx,iwXu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izAx,iwXy,zw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izAx,iwuX,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izAx,iwyX,zw->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izXx,iwAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izXx,iwuA,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izax,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IJ,izax,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izwx,iXAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izwx,iXuA,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IJ,izwx,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iX,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwXu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,izxA,iwXy,zw->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxA,iwuX,ywuz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,IJ,izxA,iwyX,zw->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwAu,ywzu->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxX,iwuA,ywuz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxa,iXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxa,iXaA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXAu,ywuz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,izxw,iXAw,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXuA,ywuz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,izxw,iXwA,yz->IAJX', h_aa, np.identity(ncvs), t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXAa,za,yz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xXAa,zwua,yuwz->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xa,XzAa,yz->IAJX', h_aa, np.identity(ncvs), t1_ae, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xa,zXAa,yz->IAJX', h_aa, np.identity(ncvs), t1_ae, t1_aaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzAa,wuXa,yzwu->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzXa,wuAa,yzwu->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,xzwa,XuAa,yzwu->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,xzwa,uXAa,yzwu->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IJ,zwxa,XuAa,yuzw->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IJ,zwxa,uXAa,yuzw->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxAa,wuXa,yzuw->IAJX', h_aa, np.identity(ncvs), t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxXa,wuAa,yzuw->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IJ,zxwa,XuAa,yzuw->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IJ,zxwa,uXAa,yzuw->IAJX', h_aa, np.identity(ncvs), t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxya,zAaw,wz,xy->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxya,zwAa,zw,xy->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xXya,zAaw,wz,xy->IAJX', np.identity(ncvs), t1_aaae, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xXya,zwAa,zw,xy->IAJX', np.identity(ncvs), t1_aaae, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,ijuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,jiwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,ijwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,jiwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,ijxw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijzw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijyA,jiwu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,jixw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,jizw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiuA,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,jiwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,ijuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,jiwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,ijwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,jiwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,ijxw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijzw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijyA,jiwu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,jixw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,jizw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiuA,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,jiwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwAy,iu,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzusvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuswv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuvsw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwAy,iuvs,xzuvws->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuwsv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuwvs->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuvx,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuvz,xuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,iuxv,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,iuxz,wu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuzv,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuzx,wu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,ix,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iz,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwax,iuAa,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwax,iuaA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwax,izAa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwax,izaA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwaz,iuAa,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwaz,iuaA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,iA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivAs,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivAu,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvswz->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvszw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvwsz->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvwzs->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwux,ivsA,yuvzsw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwux,ivuA,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izAu,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izAv,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwux,izuA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izvA,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,iA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvswx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvsxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwuz,ivAs,yuvwxs->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvxsw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivAu,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivsA,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuz,ivuA,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxa,iuAa,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxa,iuaA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxa,izAa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxa,izaA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivAs,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivAu,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivsA,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivuA,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izAu,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izAv,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izuA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izvA,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iuAv,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxz,iuvA,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyA,iu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyA,iuvs,xzuwvs->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuvx,zuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuvz,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuxv,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuxz,wu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iuzv,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iuzx,wu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,ix,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iz,xw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuAa,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuaA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,iA,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivAs,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivAu,yvxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwzu,ivsA,yuvswx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvsxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvwxs->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvxsw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivuA,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuAv,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuvA,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iwAu,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ix,iwuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ix,izAw,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ix,izwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,ia,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,iwau,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,iwaz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAa,iwua,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAa,iwza,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iu,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvs,yvszwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvw,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvz,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iuwv,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iuwz,yu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuzv,yvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuzw,yu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iw,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,ia,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,iwau,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,iwaz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaA,iwua,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaA,iwza,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iu,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvs,yvszwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvw,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvz,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iuwv,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iuwz,yu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuzv,yvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuzw,yu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iw,yz->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iyaw,iuAa,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iyaw,iuaA,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuAa,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuaA,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,iA,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAs,xzswuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAu,xzwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAw,xzvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsuvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,iywu,ivsA,xzsvuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzswuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzswvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivuA,xzvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iywu,ivwA,xzvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwAu,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,ia,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,iwau,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,iwua,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iu,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsuwx->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvswux->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izAw,iuvs,yvswxu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsxuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsxwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iuvw,yvux->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iuwv,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iw,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaA,ia,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaA,iwau,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaA,iwua,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iu,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iuvs,yvsxwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iuvw,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwA,iuwv,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwA,iw,yx->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,ijuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,jiwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,ijwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,jiwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,ijxw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijzw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijyA,jiwu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,jixw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,jizw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiuA,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,jiwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxa,ijAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxa,jiAa,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxw,ijuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,ijwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxw,jiuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ijxw,jiwA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijxz,ijwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijxz,jiwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,ijxw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,ijzw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijyA,jiwu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,Xxyz,ijyA,jixw,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ijyA,jizw,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijza,ijAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijza,jiAa,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,ijwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ijzw,jiuA,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ijzw,jiwA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwAy,iu,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzusvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuswv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuvsw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwAy,iuvs,xzuvws->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuwsv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwAy,iuvs,xzuwvs->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuvx,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuvz,xuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,iuxv,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,iuxz,wu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuzv,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iuzx,wu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwAy,ix,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwAy,iz,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwax,iuAa,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwax,iuaA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwax,izAa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwax,izaA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwaz,iuAa,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwaz,iuaA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,iA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivAs,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwux,ivAu,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvswz->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvszw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvwsz->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvwzs->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwux,ivsA,yuvzsw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwux,ivsA,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwux,ivuA,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izAu,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izAv,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwux,izuA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwux,izvA,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,iA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvswx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvsxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwuz,ivAs,yuvwxs->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvxsw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwuz,ivAs,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivAu,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwuz,ivsA,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwuz,ivuA,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxa,iuAa,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxa,iuaA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxa,izAa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxa,izaA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,iA,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivAs,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxu,ivAu,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivsA,yuvzws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxu,ivuA,yvzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izAu,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwxu,izAv,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izuA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iwxu,izvA,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,iwxz,iuAv,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwxz,iuvA,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyA,iu,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwyA,iuvs,xzuwvs->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuvx,zuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuvz,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuxv,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,iuxz,wu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iuzv,xuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iuzx,wu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iwyA,ix,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,iwyA,iz,xw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuAa,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwza,iuaA,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,iA,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivAs,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivAu,yvxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,iwzu,ivsA,yuvswx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvsxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvwsx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvwxs->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvxsw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,iwzu,ivsA,yuvxws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzu,ivuA,yvwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuAv,yuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iwzx,iuvA,yuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iA,yz->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,ix,iwAu,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ix,iwuA,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ix,izAw,yw->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ix,izwA,yw->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,ia,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,iwau,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAa,iwaz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAa,iwua,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAa,iwza,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iu,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvs,yvszwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvw,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuvz,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iuwv,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iuwz,yu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuzv,yvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iuzw,yu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixAw,iw,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,ixAw,iz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,ia,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,iwau,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixaA,iwaz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaA,iwua,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixaA,iwza,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iu,yuzw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvs,yvszwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvw,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuvz,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iuwv,yvzu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iuwz,yu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuzv,yvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iuzw,yu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,Xxyz,ixwA,iw,yz->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,ixwA,iz,yw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iyaw,iuAa,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iyaw,iuaA,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuAa,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywa,iuaA,xzuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,iA,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAs,xzswuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAu,xzwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivAw,xzvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsuvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,iywu,ivsA,xzsvuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzsvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzswuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,iywu,ivsA,xzswvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,iywu,ivuA,xzvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,iywu,ivwA,xzvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iA,yx->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwAu,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,iz,iwuA,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,ia,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,iwau,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAa,iwua,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iu,yuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsuwx->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvswux->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,izAw,iuvs,yvswxu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsxuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,izAw,iuvs,yvsxwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iuvw,yvux->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iuwv,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izAw,iw,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaA,ia,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izaA,iwau,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izaA,iwua,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iu,yuxw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iuvs,yvsxwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,izwA,iuvw,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwA,iuwv,yvxu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,Xxyz,izwA,iw,yx->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,Xxyz,wuxa,vsAa,yvszwu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wuxa,vzAa,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wuxa,zvAa,yvwu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsAa,yvsuwx->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsAa,yvsuxw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsAa,yvswux->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,Xxyz,wuza,vsAa,yvswxu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsAa,yvsxuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,Xxyz,wuza,vsAa,yvsxwu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxAa,ua,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxAa,uvsa,ywszvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wxAa,uvza,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsAa,xzwsuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsAa,xzwsvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsAa,xzwusv->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsAa,xzwuvs->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,wyua,vsAa,xzwvsu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wyua,vsAa,xzwvus->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,wzAa,ua,ywux->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzAa,uvsa,ywsuvx->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzAa,uvsa,ywsuxv->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzAa,uvsa,ywsvux->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,Xxyz,wzAa,uvsa,ywsvxu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzAa,uvsa,ywsxuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,Xxyz,wzAa,uvsa,ywsxvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwAa,ua,ywzu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwAa,uvsa,ywszvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xwAa,uvza,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzAa,wa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,Xxyz,xzAa,wuva,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ya,wuAa,xzwu->IAJX', np.identity(ncvs), v_aaaa, t1_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,ywua,vsAa,xzwvus->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwAa,ua,ywxu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zwAa,uvsa,ywsxvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxAa,wa,yw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,Xxyz,zxAa,wuva,yvuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,XxAa,ua,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxAa,uvsa,zvuswy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxAa,uvsa,zvusyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxAa,uvsa,zvuwsy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,XxAa,uvsa,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxAa,uvsa,zvuysw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,XxAa,uvsa,zvuyws->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,XxAa,uvza,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXAx,iu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXAx,iuvs,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuvw,zvuy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuvy,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuwv,zvyu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuwy,zu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iuyv,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iuyw,zu->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iXAx,izuv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxA,iu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iXxA,iuvs,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuvw,zvuy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuvy,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuwv,zvyu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuwy,zu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iuyv,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iuyw,zu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxA,izuv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,ijuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,jiuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,ijXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,ijXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,jiXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,jiXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,ijuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,jiuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,ijXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,ijXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,jiXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,jiXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuAx,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuAx,ivXs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivXw,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivXy,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivsX,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivwX,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivyX,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,izXv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuAx,izvX,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuXx,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuXx,ivAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivsA,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iXsA,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxA,ivXs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivXw,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivXy,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,ivsX,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivwX,zuyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxA,ivyX,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izXv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izvX,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxX,ivAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,ivsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iXAv,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iXvA,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iXAu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iXuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAa,iuXa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAa,iuaX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixAu,ivXs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivXu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivXz,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivsX,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivuX,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivzX,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXa,iuAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXa,iuaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixXu,ivAs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivsA,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaA,iuXa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaA,iuaX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaX,iuAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaX,iuaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuA,ivXs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivXu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivXz,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivsX,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuA,ivuX,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivzX,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuX,ivAs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivsA,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuX,ivuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXAs,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXsA,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iXuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iXAx,iu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXAx,iuvs,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iXAx,iuvs,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuvw,zvuy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuvy,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuwv,zvyu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iuwy,zu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iuyv,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iuyw,zu->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXAx,iw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXAx,iy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iXAx,izuv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iXxA,iu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iXxA,iuvs,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iXxA,iuvs,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuvw,zvuy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuvy,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuwv,zvyu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iuwy,zu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iuyv,zvwu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iuyw,zu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iXxA,iw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('IJ,xyzw,iXxA,iy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iXxA,izuv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,ijuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,jiuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vxaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,ijXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,ijXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,jiXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,jiXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijXx,ijuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijXx,jiuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ijxA,ijXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ijxA,ijXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,ijXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ijxA,jiXu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,ijxA,jiXw,zy->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IJ,xyzw,ijxA,jiXy,zw->IAJX', np.identity(ncvs), v_aaaa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuAx,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuAx,ivXs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivXs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivXw,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuAx,ivXy,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuAx,ivsX,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuAx,ivsX,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivwX,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,ivyX,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuAx,izXv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuAx,izvX,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuXx,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuXx,ivAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuXx,ivsA,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuXx,ivsA,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuax,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuax,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuvx,iXAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuvx,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,iuvx,iXsA,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuvx,iXsA,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('IJ,xyzw,iuvx,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxA,ivXs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxA,ivXs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivXw,zuvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivXy,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxA,ivsX,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,iuxA,ivwX,zuyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,iuxA,ivyX,zuwv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izXv,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,iuxA,izvX,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusvyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,iuxX,ivAs,zuswyv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusyvw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,iuxX,ivAs,zusywv->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxX,ivsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxa,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxa,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXAs,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxv,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXsA,zuswvy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxv,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,iuxz,iXAv,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,iuxz,iXvA,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,ix,iXAu,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,ix,iXuA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_va, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAa,iuXa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAa,iuaX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixAu,ivXs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivXs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivXu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixAu,ivXz,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixAu,ivsX,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixAu,ivsX,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivuX,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixAu,ivzX,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXa,iuAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXa,iuaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('IJ,xyzw,ixXu,ivAs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivAs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixXu,ivAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixXu,ivsA,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixXu,ivsA,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixXu,ivuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaA,iuXa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaA,iuaX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixaX,iuAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixaX,iuaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixau,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixau,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,iX,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuA,ivXs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuA,ivXs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivXu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivXz,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivsX,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuA,ivuX,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuA,ivzX,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,iA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_ve, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvswy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvsyw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IJ,xyzw,ixuX,ivAs,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvysw->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('IJ,xyzw,ixuX,ivAs,zuvyws->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuX,ivsA,zuvwsy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuX,ivuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixua,iXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixua,iXaA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXAs,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXAu,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,ixuv,iXAv,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXsA,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
        temp -= einsum('IJ,xyzw,ixuv,iXuA,zvwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,ixuv,iXvA,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IJ,xyzw,uvxa,XsAa,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('IJ,xyzw,uvxa,sXAa,zuvwys->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsXa,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsXa,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxAa,vsXa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsXa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsXa,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxAa,vsXa,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsAa,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsAa,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,uxXa,vsAa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsAa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsAa,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,uxXa,vsAa,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,uxva,XsAa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,uxva,sXAa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXAa,ua,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXAa,uvsa,zvuswy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXAa,uvsa,zvusyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXAa,uvsa,zvuwsy->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xXAa,uvsa,zvuwys->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXAa,uvsa,zvuysw->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xXAa,uvsa,zvuyws->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xXAa,uvza,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,xa,XuAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xa,uXAa,zuwy->IAJX', np.identity(ncvs), v_aaaa, t1_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuAa,vsXa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xuXa,vsAa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsAa,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsAa,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsAa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IJ,xyzw,xuva,XsAa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsAa,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,XsAa,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXAa,zvsuwy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXAa,zvsuyw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXAa,zvswuy->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('IJ,xyzw,xuva,sXAa,zvswyu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXAa,zvsyuw->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('IJ,xyzw,xuva,sXAa,zvsywu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzAa,uvXa,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,xzXa,uvAa,ywuv->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IJ,xyzw,zxua,XvAa,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('IJ,xyzw,zxua,vXAa,ywvu->IAJX', np.identity(ncvs), v_aaaa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ce, n_ca)
        M_00[s_ce_aa:f_ce_aa, s_ca_aa:f_ca_aa] += temp
        M_00[s_ce_bb:f_ce_bb, s_ca_bb:f_ca_bb] += temp
     
        # Add temp matrix to bottom triangle
        M_00[s_ca_aa:f_ca_aa, s_ce_aa:f_ce_aa] += temp.T
        M_00[s_ca_bb:f_ca_bb, s_ce_bb:f_ce_bb] += temp.T
        del temp
     
        ## aa,bb || bb,aa
        temp  = einsum('Ja,IXAa->IAJX', h_xe, t1_xaee, optimize = einsum_type)
        temp += einsum('Jx,IXAx->IAJX', h_xa, t1_xaea, optimize = einsum_type)
        temp += einsum('IXab,JbAa->IAJX', t1_xaee, v_xeee, optimize = einsum_type)
        temp += einsum('IXax,JxAa->IAJX', t1_xaea, v_xaee, optimize = einsum_type)
        temp += einsum('IXxa,JaAx->IAJX', t1_xaae, v_xeea, optimize = einsum_type)
        temp += einsum('IXxy,JyAx->IAJX', t1_xaaa, v_xaea, optimize = einsum_type)
        temp += einsum('Ia,JXAa->IAJX', t1_xe, v_xaee, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JXia->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp -= einsum('IiAa,iXJa->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp -= einsum('IixA,JXix->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp += 2 * einsum('IiAa,JXia->IAJX', t1_xvee, v_xave, optimize = einsum_type)
        temp -= einsum('IiAa,iXJa->IAJX', t1_xvee, v_vaxe, optimize = einsum_type)
        temp -= einsum('IixA,JXix->IAJX', t1_xvae, v_xava, optimize = einsum_type)
        temp += einsum('Ix,JXAx->IAJX', t1_xa, v_xaea, optimize = einsum_type)
        temp += einsum('Ja,IAXa->IAJX', t1_xe, v_xeae, optimize = einsum_type)
        temp += 2 * einsum('JiXa,IAia->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp -= einsum('JiXa,iAIa->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp -= einsum('JiXx,IxiA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiXx,ixIA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp -= einsum('JixX,ixIA->IAJX', t1_xxaa, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('JiXa,IAia->IAJX', t1_xvae, v_xeve, optimize = einsum_type)
        temp -= einsum('JiXa,iAIa->IAJX', t1_xvae, v_vexe, optimize = einsum_type)
        temp -= einsum('JiXx,IxiA->IAJX', t1_xvaa, v_xave, optimize = einsum_type)
        temp += 2 * einsum('JiXx,ixIA->IAJX', t1_xvaa, v_vaxe, optimize = einsum_type)
        temp -= einsum('JixX,ixIA->IAJX', t1_xvaa, v_vaxe, optimize = einsum_type)
        temp += einsum('Jx,IAXx->IAJX', t1_xa, v_xeaa, optimize = einsum_type)
        temp += einsum('Xa,IAaJ->IAJX', t1_ae, v_xeex, optimize = einsum_type)
        temp -= einsum('iA,iIJX->IAJX', t1_xe, v_xxxa, optimize = einsum_type)
        temp -= einsum('iIAa,JXia->IAJX', t1_xxee, v_xaxe, optimize = einsum_type)
        temp += 2 * einsum('iIxA,JXix->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= einsum('iIxA,JxiX->IAJX', t1_xxae, v_xaxa, optimize = einsum_type)
        temp -= einsum('iJXa,IAia->IAJX', t1_xxae, v_xexe, optimize = einsum_type)
        temp -= einsum('iX,iJIA->IAJX', t1_xa, v_xxxe, optimize = einsum_type)
        temp -= einsum('iXAa,iIJa->IAJX', t1_xaee, v_xxxe, optimize = einsum_type)
        temp -= einsum('iXAx,iIJx->IAJX', t1_xaea, v_xxxa, optimize = einsum_type)
        temp -= einsum('iA,iIJX->IAJX', t1_ve, v_vxxa, optimize = einsum_type)
        temp -= einsum('iIAa,JXia->IAJX', t1_vxee, v_xave, optimize = einsum_type)
        temp += 2 * einsum('iIxA,JXix->IAJX', t1_vxae, v_xava, optimize = einsum_type)
        temp -= einsum('iIxA,JxiX->IAJX', t1_vxae, v_xava, optimize = einsum_type)
        temp -= einsum('iJXa,IAia->IAJX', t1_vxae, v_xeve, optimize = einsum_type)
        temp -= einsum('iX,iJIA->IAJX', t1_va, v_vxxe, optimize = einsum_type)
        temp -= einsum('iXAa,iIJa->IAJX', t1_vaee, v_vxxe, optimize = einsum_type)
        temp -= einsum('iXAx,iIJx->IAJX', t1_vaea, v_vxxa, optimize = einsum_type)
        temp -= einsum('xA,IxXJ->IAJX', t1_ae, v_xaax, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAa,Ja->IAJX', e_extern, t1_xaee, t1_xe, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAx,Jx->IAJX', e_extern, t1_xaea, t1_xa, optimize = einsum_type)
        temp += einsum('A,IiAa,JiXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,JiXx->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += einsum('A,IiAa,JiXa->IAJX', e_extern, t1_xvee, t1_xvae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,iJXa->IAJX', e_extern, t1_xvee, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IixA,JiXx->IAJX', e_extern, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiXa->IAJX', e_extern, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += einsum('A,iIxA,JiXx->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixX->IAJX', e_extern, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIAa,JiXa->IAJX', e_extern, t1_vxee, t1_xvae, optimize = einsum_type)
        temp += einsum('A,iIxA,JiXx->IAJX', e_extern, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JixX->IAJX', e_extern, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAa,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAx,Jx->IAJX', e_cvs, t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('I,IiAa,JiXa->IAJX', e_cvs, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,iJXa->IAJX', e_cvs, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('I,IixA,JiXx->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('I,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIAa,JiXa->IAJX', e_cvs, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= einsum('I,iIxA,JiXx->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JixX->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAa,Ja->IAJX', e_cvs, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAx,Jx->IAJX', e_cvs, t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('J,IiAa,JiXa->IAJX', e_cvs, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,iJXa->IAJX', e_cvs, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('J,IixA,JiXx->IAJX', e_cvs, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('J,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIAa,JiXa->IAJX', e_cvs, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= einsum('J,iIxA,JiXx->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JixX->IAJX', e_cvs, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('a,Ja,IXAa->IAJX', e_extern, t1_xe, t1_xaee, optimize = einsum_type)
        temp += 2 * einsum('a,JiXa,IiAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,JiXa,iIAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 2 * einsum('a,JiXa,IiAa->IAJX', e_extern, t1_xvae, t1_xvee, optimize = einsum_type)
        temp -= einsum('a,JiXa,iIAa->IAJX', e_extern, t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= einsum('a,iJXa,IiAa->IAJX', e_extern, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('a,iJXa,IiAa->IAJX', e_extern, t1_vxae, t1_xvee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('i,JiXa,IiAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXa,iIAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXx,IixA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,JiXx,iIxA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixX,iIxA->IAJX', e_cvs, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiXa->IAJX', e_cvs, t1_xxee, t1_xxae, optimize = einsum_type)
        temp -= einsum('i,iIxA,JiXx->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixX->IAJX', e_cvs, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJXa,IiAa->IAJX', e_cvs, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= einsum('i,IiAa,JiXa->IAJX', e_val, t1_xvee, t1_xvae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,iJXa->IAJX', e_val, t1_xvee, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,IixA,JiXx->IAJX', e_val, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('i,JiXa,IiAa->IAJX', e_val, t1_xvae, t1_xvee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXa,iIAa->IAJX', e_val, t1_xvae, t1_vxee, optimize = einsum_type)
        temp += 1/2 * einsum('i,JiXx,IixA->IAJX', e_val, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,JiXx,iIxA->IAJX', e_val, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,JixX,iIxA->IAJX', e_val, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIAa,JiXa->IAJX', e_val, t1_vxee, t1_xvae, optimize = einsum_type)
        temp -= einsum('i,iIxA,JiXx->IAJX', e_val, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,JixX->IAJX', e_val, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,iJXa,IiAa->IAJX', e_val, t1_vxae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IxAa,Xx->IAJX', h_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IyAx,Xy->IAJX', h_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAa,Ja->IAJX', h_aa, t1_xaee, t1_xe, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAy,Jy->IAJX', h_aa, t1_xaea, t1_xa, optimize = einsum_type)
        temp += einsum('Xx,Jixa,IiAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixa,iIAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,IiyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Jixy,iIyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jiyx,iIyA->IAJX', h_aa, t1_xxaa, t1_xxae, optimize = einsum_type)
        temp += einsum('Xx,Jixa,IiAa->IAJX', h_aa, t1_xvae, t1_xvee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixa,iIAa->IAJX', h_aa, t1_xvae, t1_vxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,IiyA->IAJX', h_aa, t1_xvaa, t1_xvae, optimize = einsum_type)
        temp += einsum('Xx,Jixy,iIyA->IAJX', h_aa, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jiyx,iIyA->IAJX', h_aa, t1_xvaa, t1_vxae, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iJxa,IiAa->IAJX', h_aa, t1_xxae, t1_xxee, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,iJxa,IiAa->IAJX', h_aa, t1_vxae, t1_xvee, optimize = einsum_type)
        temp += einsum('xy,IXAx,Jy->IAJX', h_aa, t1_xaea, t1_xa, optimize = einsum_type)
        temp -= einsum('xy,IixA,JiXy->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,IixA,JiXy->IAJX', h_aa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,JiXy->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyX->IAJX', h_aa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('xy,iIxA,JiXy->IAJX', h_aa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,JiyX->IAJX', h_aa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += einsum('IXAa,Jaxy,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXAa,Jxya,yx->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += einsum('IXAx,Jxyz,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXAx,Jyzx,zy->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXax,JyAa,xy->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxa,JaAy,xy->IAJX', t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxy,JyAz,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IXxy,JzAx,yz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ia,JxAa,Xx->IAJX', t1_xe, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IiAa,Jxia,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiAa,ixJa,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,JXiy,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,Jyix,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('IixA,Jyiz,Xxyz->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IixA,Jyiz,Xxzy->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IiAa,Jxia,Xx->IAJX', t1_xvee, v_xave, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IiAa,ixJa,Xx->IAJX', t1_xvee, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,JXiy,xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IixA,Jyix,Xy->IAJX', t1_xvae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('IixA,Jyiz,Xxyz->IAJX', t1_xvae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IixA,Jyiz,Xxzy->IAJX', t1_xvae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ix,JyAx,Xy->IAJX', t1_xa, v_xaea, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAa,JXya,xy->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,JayX,xy->IAJX', t1_xaee, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,Jayz,Xyxz->IAJX', t1_xaee, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAa,Jyza,Xzyx->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('IxAy,JXxz,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IxAy,JXzy,xz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,JyzX,xz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,Jyzw,Xzxw->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxAy,Jzwy,Xwzx->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,JzxX,yz->IAJX', t1_xaea, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('IxAy,Jzxw,Xyzw->IAJX', t1_xaea, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('IxaA,JXya,xy->IAJX', t1_xaee, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxaA,Jyza,Xzxy->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IxaA,Jyza,Xzyx->IAJX', t1_xaee, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixab,JbAa,Xx->IAJX', t1_xaee, v_xeee, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixay,JXAa,xy->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JyAa,Xx->IAJX', t1_xaea, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,JzAa,Xyzx->IAJX', t1_xaea, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxyA,JXxz,yz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('IxyA,JXzy,xz->IAJX', t1_xaae, v_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('IxyA,Jzwy,Xwxz->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('IxyA,Jzwy,Xwzx->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('IxyA,Jzxw,Xywz->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('IxyA,Jzxw,Xyzw->IAJX', t1_xaae, v_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JXAa,xy->IAJX', t1_xaae, v_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,JaAy,Xx->IAJX', t1_xaae, v_xeea, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,JaAz,Xyxz->IAJX', t1_xaae, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JaAz,Xyzx->IAJX', t1_xaae, v_xeea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixya,JzAa,Xyxz->IAJX', t1_xaae, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixya,JzAa,Xyzx->IAJX', t1_xaae, v_xaee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Ixyz,JXAy,xz->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JXAz,xy->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JwAy,Xzwx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,JwAz,Xywx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JwAz,Xyxw->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Ixyz,JzAw,Xywx->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Ixyz,JzAw,Xyxw->IAJX', t1_xaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixyz,JzAy,Xx->IAJX', t1_xaaa, v_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ja,IAxa,Xx->IAJX', t1_xe, v_xeae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JiXx,IyiA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiXx,iyIA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixX,iyIA,xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixa,IAia,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iAIa,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiA,Xx->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,IziA,Xzxy->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziA,Xzyx->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,ixIA,Xy->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,iyIA,Xx->IAJX', t1_xxaa, v_xaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,izIA,Xzxy->IAJX', t1_xxaa, v_xaxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JiXx,IyiA,xy->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('JiXx,iyIA,xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JixX,iyIA,xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixa,IAia,Xx->IAJX', t1_xvae, v_xeve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixa,iAIa,Xx->IAJX', t1_xvae, v_vexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,IyiA,Xx->IAJX', t1_xvaa, v_xave, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('Jixy,IziA,Xzxy->IAJX', t1_xvaa, v_xave, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jixy,IziA,Xzyx->IAJX', t1_xvaa, v_xave, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,ixIA,Xy->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('Jixy,iyIA,Xx->IAJX', t1_xvaa, v_vaxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Jixy,izIA,Xzxy->IAJX', t1_xvaa, v_vaxe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jx,IAyx,Xy->IAJX', t1_xa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxXa,IAya,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxXa,IayA,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= einsum('JxXy,IAxz,yz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp += einsum('JxXy,IAzy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxXy,IyzA,xz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('JxXy,IzxA,yz->IAJX', t1_xaaa, v_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxaX,IAya,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp += einsum('Jxay,IAXa,xy->IAJX', t1_xaea, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxay,IAza,Xxzy->IAJX', t1_xaea, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('JxyX,IAxz,yz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('JxyX,IAzy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IAXa,xy->IAJX', t1_xaae, v_xeae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxya,IAza,Xxyz->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxya,IazA,Xxyz->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxya,IazA,Xxzy->IAJX', t1_xaae, v_xeae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Jxyz,IAXy,xz->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAXz,xy->IAJX', t1_xaaa, v_xeaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAwy,Xxwz->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Jxyz,IAwz,Xxyw->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Jxyz,IAxw,Xwyz->IAJX', t1_xaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Jxyz,IwxA,Xwyz->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Jxyz,IwxA,Xwzy->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Jxyz,IzwA,Xxwy->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Jxyz,IzwA,Xxyw->IAJX', t1_xaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('XxyA,IxzJ,yz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('XxyA,IzyJ,xz->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxya,IAaJ,xy->IAJX', t1_aaae, v_xeex, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iA,iIJx,Xx->IAJX', t1_xe, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIAa,Jxia,Xx->IAJX', t1_xxee, v_xaxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,JXiy,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jxiy,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiX,xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,Jyix,Xy->IAJX', t1_xxae, v_xaxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jyiz,Xxyz->IAJX', t1_xxae, v_xaxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IAia,Xx->IAJX', t1_xxae, v_xexe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXAx,iIJy,xy->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIA,Xx->IAJX', t1_xa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iIJa,Xx->IAJX', t1_xaee, v_xxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJX,yx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJy,Xx->IAJX', t1_xaea, v_xxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJz,Xyzx->IAJX', t1_xaea, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixXy,iJIA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJX,yx->IAJX', t1_xaae, v_xxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyA,iIJz,Xyxz->IAJX', t1_xaae, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyA,iIJz,Xyzx->IAJX', t1_xaae, v_xxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iJIA,yx->IAJX', t1_xaaa, v_xxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIA,Xxyz->IAJX', t1_xaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iA,iIJx,Xx->IAJX', t1_ve, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIAa,Jxia,Xx->IAJX', t1_vxee, v_xave, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,JXiy,xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jxiy,Xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,JyiX,xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp -= einsum('iIxA,Jyix,Xy->IAJX', t1_vxae, v_xava, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iIxA,Jyiz,Xxyz->IAJX', t1_vxae, v_xava, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('iJxa,IAia,Xx->IAJX', t1_vxae, v_xeve, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('iXAx,iIJy,xy->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ix,iJIA,Xx->IAJX', t1_va, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iIJa,Xx->IAJX', t1_vaee, v_vxxe, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixAy,iIJX,yx->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJy,Xx->IAJX', t1_vaea, v_vxxa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAy,iIJz,Xyzx->IAJX', t1_vaea, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixXy,iJIA,yx->IAJX', t1_vaaa, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyA,iIJX,yx->IAJX', t1_vaae, v_vxxa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('ixyA,iIJz,Xyxz->IAJX', t1_vaae, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('ixyA,iIJz,Xyzx->IAJX', t1_vaae, v_vxxa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixyX,iJIA,yx->IAJX', t1_vaaa, v_vxxe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixyz,iJIA,Xxyz->IAJX', t1_vaaa, v_vxxe, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xA,IxyJ,Xy->IAJX', t1_ae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xXAa,IyaJ,xy->IAJX', t1_aaee, v_xaex, rdm_ca, optimize = einsum_type)
        temp += einsum('xXya,IAaJ,xy->IAJX', t1_aaae, v_xeex, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xa,IAaJ,Xx->IAJX', t1_ae, v_xeex, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xyAa,IzaJ,Xzxy->IAJX', t1_aaee, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyAa,IzaJ,Xzyx->IAJX', t1_aaee, v_xaex, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzA,IwzJ,Xwxy->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzA,IwzJ,Xwyx->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IxXJ,zy->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzA,IxwJ,Xzwy->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzA,IxwJ,Xzyw->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzA,IyXJ,zx->IAJX', t1_aaae, v_xaax, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzA,IywJ,Xzwx->IAJX', t1_aaae, v_xaax, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,IAaJ,Xzyx->IAJX', t1_aaae, v_xeex, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Xxyz,IiyA,Jixz->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,IiyA,Jixz->IAJX', v_aaaa, t1_xvae, t1_xvaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,iIyA,Jixz->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jizx->IAJX', v_aaaa, t1_xxae, t1_xxaa, optimize = einsum_type)
        temp += 2 * einsum('Xxyz,iIyA,Jixz->IAJX', v_aaaa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jizx->IAJX', v_aaaa, t1_vxae, t1_xvaa, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAa,Jxay,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IXAa,Jxya,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IXAx,Jyxz,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IXAx,Jyzx,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,Jixa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IiAa,iJxa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,JiXy,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,Jiyx,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('A,IixA,Jiyz,Xxyz->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IixA,Jiyz,Xxzy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IiAa,Jixa,Xx->IAJX', e_extern, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IiAa,iJxa,Xx->IAJX', e_extern, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,JiXy,xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IixA,Jiyx,Xy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('A,IixA,Jiyz,Xxyz->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IixA,Jiyz,Xxzy->IAJX', e_extern, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Ja,Xx->IAJX', e_extern, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAa,JyXa,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,JyaX,xy->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Jyaz,Xyxz->IAJX', e_extern, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAa,Jyza,Xyzx->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IxAy,JxXz,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,JxzX,yz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxAy,Jxzw,Xyzw->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jy,Xx->IAJX', e_extern, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IxAy,JzXy,xz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jzwy,Xzwx->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,JzyX,xz->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxAy,Jzyw,Xzxw->IAJX', e_extern, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxaA,JyXa,xy->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('A,IxaA,Jyza,Xyxz->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('A,IxaA,Jyza,Xyzx->IAJX', e_extern, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxyA,JxXz,yz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('A,IxyA,Jxzw,Xywz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('A,IxyA,Jxzw,Xyzw->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('A,IxyA,JzXy,xz->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('A,IxyA,Jzwy,Xzwx->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('A,IxyA,Jzwy,Xzxw->IAJX', e_extern, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIAa,Jixa,Xx->IAJX', e_extern, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JiXy,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jixy,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyX,xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,Jiyx,Xy->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jiyz,Xxyz->IAJX', e_extern, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIAa,Jixa,Xx->IAJX', e_extern, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,JiXy,xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jixy,Xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,JiyX,xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,iIxA,Jiyx,Xy->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,iIxA,Jiyz,Xxyz->IAJX', e_extern, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAa,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IXAa,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IXAx,Jyxz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IXAx,Jyzx,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,JiXy,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('I,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('I,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAa,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAa,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAy,JxXz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,JxzX,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxAy,Jxzw,Xyzw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jy,Xx->IAJX', e_cvs, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IxAy,JzXy,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jzwy,Xzwx->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,JzyX,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxAy,Jzyw,Xzxw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxaA,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxaA,Jyza,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IxaA,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxyA,JxXz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('I,IxyA,Jxzw,Xywz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('I,IxyA,Jxzw,Xyzw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('I,IxyA,JzXy,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('I,IxyA,Jzwy,Xzwx->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('I,IxyA,Jzwy,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIAa,Jixa,Xx->IAJX', e_cvs, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,JiXy,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jixy,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,JiyX,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAa,Jxay,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IXAa,Jxya,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IXAx,Jyxz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IXAx,Jyzx,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,JiXy,xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('J,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('J,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Ja,Xx->IAJX', e_cvs, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAa,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,JyaX,xy->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Jyaz,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAa,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('J,IxAy,JxXz,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,JxzX,yz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxAy,Jxzw,Xyzw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jy,Xx->IAJX', e_cvs, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('J,IxAy,JzXy,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jzwy,Xzwx->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,JzyX,xz->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxAy,Jzyw,Xzxw->IAJX', e_cvs, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxaA,JyXa,xy->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxaA,Jyza,Xyxz->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IxaA,Jyza,Xyzx->IAJX', e_cvs, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,IxyA,JxXz,yz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/12 * einsum('J,IxyA,Jxzw,Xywz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('J,IxyA,Jxzw,Xyzw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('J,IxyA,JzXy,xz->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('J,IxyA,Jzwy,Xzwx->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('J,IxyA,Jzwy,Xzxw->IAJX', e_cvs, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIAa,Jixa,Xx->IAJX', e_cvs, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,JiXy,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jixy,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,JiyX,xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('J,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('J,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Ja,IxAa,Xx->IAJX', e_extern, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Jixa,IiAa,Xx->IAJX', e_extern, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Jixa,iIAa,Xx->IAJX', e_extern, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,JxXa,IyAa,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxXa,IyaA,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,JxaX,IyAa,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,Jxay,IXAa,xy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxay,IzAa,Xxzy->IAJX', e_extern, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IXAa,xy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,Jxya,IzAa,Xxyz->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('a,Jxya,IzaA,Xxyz->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('a,Jxya,IzaA,Xxzy->IAJX', e_extern, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiAa,Xx->IAJX', e_extern, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,iJxa,IiAa,Xx->IAJX', e_extern, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiAa,iJxa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('i,IixA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixA,Jiyz,Xxzy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyA,Xx->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,iIxA,Xy->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,iIyA,Xx->IAJX', e_cvs, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIAa,Jixa,Xx->IAJX', e_cvs, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,JiXy,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxA,Jixy,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyX,xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,Jiyx,Xy->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,Jiyz,Xxyz->IAJX', e_cvs, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiAa,Xx->IAJX', e_cvs, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,IiAa,Jixa,Xx->IAJX', e_val, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IiAa,iJxa,Xx->IAJX', e_val, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IixA,JiXy,xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,IixA,Jiyx,Xy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('i,IixA,Jiyz,Xxyz->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('i,IixA,Jiyz,Xxzy->IAJX', e_val, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixa,IiAa,Xx->IAJX', e_val, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixa,iIAa,Xx->IAJX', e_val, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,IiyA,Xx->IAJX', e_val, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,Jixy,iIxA,Xy->IAJX', e_val, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,Jixy,iIyA,Xx->IAJX', e_val, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIAa,Jixa,Xx->IAJX', e_val, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,iIxA,JiXy,xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iIxA,Jixy,Xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,JiyX,xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,iIxA,Jiyx,Xy->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIxA,Jiyz,Xxyz->IAJX', e_val, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,iJxa,IiAa,Xx->IAJX', e_val, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAa,Jyaz,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IxAa,Jyza,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,IxAy,Jzwy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,IxAy,Jzyw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jixy,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jiyx,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jixy,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jixy,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jiyx,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyax,IzAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jyxa,IzAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyxa,IzaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,Jyxz,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyxz,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,Jyxz,IyAw,zw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyxz,IywA,zw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,Jyzx,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xx,Jyzx,IyAw,zw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IXAx,Jzwy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,IXAx,Jzyw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,JiXz,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixA,Jizw,Xywz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IixA,Jizw,Xyzw->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixA,Jizy,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IixA,JiXz,yz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IixA,Jizw,Xywz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IixA,Jizw,Xyzw->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IixA,Jizy,Xz->IAJX', h_aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Ja,Xy->IAJX', h_aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAa,JzXa,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,JzaX,yz->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Jzaw,Xzyw->IAJX', h_aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAa,Jzwa,Xzwy->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JwXz,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jwuz,Xwuy->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,JwzX,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jwzu,Xwyu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IxAz,JyXw,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,JywX,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxAz,Jywu,Xzwu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxAz,Jz,Xy->IAJX', h_aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxaA,JzXa,yz->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxaA,Jzwa,Xzwy->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxaA,Jzwa,Xzyw->IAJX', h_aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IxzA,JwXz,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IxzA,Jwuz,Xwuy->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IxzA,Jwuz,Xwyu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IxzA,JyXw,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IxzA,Jywu,Xzuw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IxzA,Jywu,Xzwu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xy,IzAx,JwXy,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jwuy,Xwuz->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JwyX,zw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jwyu,Xwzu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,Jy,Xz->IAJX', h_aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzAx,JzXw,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,JzwX,yw->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzAx,Jzwu,Xywu->IAJX', h_aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,IzxA,JwXy,zw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/3 * einsum('xy,IzxA,Jwuy,Xwuz->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,IzxA,Jwuy,Xwzu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,IzxA,JzXw,yw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,IzxA,Jzwu,Xyuw->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,IzxA,Jzwu,Xywu->IAJX', h_aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiXx,IizA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiXx,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixX,iIzA,yz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,IiwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,iIwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,iIzA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwA,Xwyz->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,IiwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIwA,Xwzy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIzA,Xy->IAJX', h_aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JiXx,IizA,yz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JiXx,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JixX,iIzA,yz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixa,IiAa,Xy->IAJX', h_aa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixa,iIAa,Xy->IAJX', h_aa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jixz,IiwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jixz,IiwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,IizA,Xy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jixz,iIwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jixz,iIzA,Xy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jizx,IiwA,Xwyz->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jizx,IiwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIwA,Xwzy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jizx,iIzA,Xy->IAJX', h_aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxXa,IzAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxXa,IzaA,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JxXz,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxXz,IwzA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxaX,IzAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxaz,IXAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxaz,IwAa,Xywz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JxzX,IwAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IXAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxza,IwAa,Xyzw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxza,IwaA,Xywz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxza,IwaA,Xyzw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,Jxzw,IXAz,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuAw,Xyzu->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jxzw,IuAz,Xyuw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jxzw,IuwA,Xyuz->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jxzw,IuwA,Xyzu->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,JzXx,IzAw,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzXx,IzwA,yw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzax,IXAa,yz->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzax,IwAa,Xzwy->IAJX', h_aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Jzwx,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzwx,IuAw,Xzuy->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzwx,IzAu,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jzwx,IzuA,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzwx,IzuA,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,JzxX,IzAw,yw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IXAa,yz->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxa,IwAa,Xzyw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxa,IwaA,Xzwy->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxa,IwaA,Xzyw->IAJX', h_aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IXAw,yz->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Jzxw,IuAw,Xzyu->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xy,Jzxw,IuwA,Xzuy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xy,Jzxw,IuwA,Xzyu->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Jzxw,IzAu,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xy,Jzxw,IzuA,Xuwy->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xy,Jzxw,IzuA,Xuyw->IAJX', h_aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,JiXz,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,iIxA,Jiyz,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizX,yz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,Jizw,Xyzw->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,Jizy,Xz->IAJX', h_aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiAa,Xy->IAJX', h_aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,iIxA,JiXz,yz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,iIxA,Jiyz,Xz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,JizX,yz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iIxA,Jizw,Xyzw->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xy,iIxA,Jizy,Xz->IAJX', h_aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,iJxa,IiAa,Xy->IAJX', h_aa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IiyA,Jiwu,xzuw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IiyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jiwz,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jixw,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IiyA,Jiwu,xzuw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IiyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jiwz,xw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IiyA,Jixw,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juvx,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juvz,xuvw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Juxv,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Juxz,wu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juzv,xuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Juzx,wu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IwAy,Jwuv,xzuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,IwAy,Jx,zw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwAy,Jz,xw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IwyA,Juvx,zuvw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,IwyA,Juvx,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,IwyA,Juvz,xuvw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,IwyA,Juvz,xuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Juxv,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Juxz,wu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IwyA,Jwuv,xzuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IwyA,Jwuv,xzvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IwyA,Jx,zw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Ja,yz->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Jwau,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAa,Jwaz,yw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAa,Jwua,yuzw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAa,Jwza,yw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAw,Juvw,yvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Juvz,yvuw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Juwv,yvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Juwz,yu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Juzv,yvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IxAw,Juzw,yu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,IxAw,Jw,yz->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,IxAw,Jz,yw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Ja,yx->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Jwau,yuxw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAa,Jwua,yuwx->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Juvw,yvux->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Juwv,yvxu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,IzAw,Jw,yx->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IzaA,Jwua,yuwx->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IzaA,Jwua,yuxw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,IzwA,Juvw,yvux->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,IzwA,Juvw,yvxu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwx,iIuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwx,iIwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwz,IiuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwz,IiuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jixa,IiAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixa,iIAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixw,IiuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,IiwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,iIuA,ywzu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jixw,iIwA,yz->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixz,IiwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixz,iIwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiza,IiAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiza,iIAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jizw,IiuA,ywux->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jizw,IiuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,IiwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,iIuA,ywxu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jizw,iIwA,yx->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizx,iIwA,yw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwx,iIuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiwx,iIwA,yz->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jiwz,IiuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jiwz,IiuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiwz,iIwA,yx->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,Jixa,IiAa,yz->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixa,iIAa,yz->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixw,IiuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,IiwA,yz->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixw,iIuA,ywzu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += einsum('Xxyz,Jixw,iIwA,yz->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jixz,IiwA,yw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jixz,iIwA,yw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jiza,IiAa,yx->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jiza,iIAa,yx->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ca, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jizw,IiuA,ywux->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jizw,IiuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,IiwA,yx->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizw,iIuA,ywxu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jizw,iIwA,yx->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jizx,iIwA,yw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwax,IuAa,yuzw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwax,IzAa,yw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwaz,IuAa,yuwx->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwux,IvAu,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwux,IwAv,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwux,IzAu,yw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwux,IzAv,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('Xxyz,Jwux,IzvA,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwux,IzvA,yuwv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwuz,IvAu,yvwx->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwuz,IwAv,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwuz,IwvA,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwuz,IwvA,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxa,IuAa,yuzw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwxa,IuaA,yuzw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxa,IzAa,yw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxa,IzaA,yw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxu,IvAu,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwxu,IvuA,yvzw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxu,IwAv,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxu,IwvA,yuzv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxu,IzAu,yw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jwxu,IzAv,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxu,IzuA,yw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jwxu,IzvA,yuvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jwxz,IwAu,yu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwxz,IwuA,yu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwza,IuAa,yuxw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwza,IuaA,yuwx->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwza,IuaA,yuxw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Jwzu,IvAu,yvxw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('Xxyz,Jwzu,IvuA,yvwx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jwzu,IvuA,yvxw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwzu,IwAv,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jwzu,IwvA,yuvx->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jwzu,IwvA,yuxv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jwzx,IwAu,yu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,Jx,IzAw,yw->IAJX', v_aaaa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,Jx,IzwA,yw->IAJX', v_aaaa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jyaw,IuAa,xzuw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywa,IuAa,xzwu->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jywa,IuaA,xzuw->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jywa,IuaA,xzwu->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywu,IvAu,xzwv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,Jywu,IvAw,xzvu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Xxyz,Jywu,IvuA,xzvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('Xxyz,Jywu,IvuA,xzwv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jywu,IxAv,zvuw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,Jywu,IzAv,xvwu->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('Xxyz,Jywu,IzvA,xvuw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('Xxyz,Jywu,IzvA,xvwu->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIyA,Jiwu,xzwu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jiwx,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jiwz,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jixw,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jizw,xw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJxa,IiAa,yz->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iJza,IiAa,yx->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iIyA,Jiwu,xzwu->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jiwx,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jiwz,xw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('Xxyz,iIyA,Jixw,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,iIyA,Jizw,xw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,iJxa,IiAa,yz->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,iJza,IiAa,yx->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juvw,zvuy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juvy,zvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juwv,zvyu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Juwy,zu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Juyv,zvwu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Juyw,zu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IXAx,Jw,zy->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += einsum('xyzw,IXAx,Jy,zw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IXAx,Jzuv,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,JiXu,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,JiXw,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,JiXy,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixA,Jiuv,Xywvuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuw,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiwu,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiwy,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IixA,JiXu,zuwy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,JiXw,zy->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,IixA,JiXy,zw->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IixA,Jiuv,Xywvuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiuw,Xyzu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IixA,Jiwu,Xyuz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IixA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IixA,Jiwy,Xz->IAJX', v_aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JuXv,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,JuvX,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuAx,Juvs,Xywvsz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvXw,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IuAx,JvXy,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuAx,Jvsw,Xyvsuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvusz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvuzs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvzsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvsw,Xyvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvsy,Xwvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvwX,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvws,Xyvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvwy,Xvzu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,JvyX,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvsuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvszu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvusz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuAx,Jvys,Xwvuzs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvzsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuAx,Jvys,Xwvzus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jvyw,Xvuz->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jw,Xyzu->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuAx,Jy,Xwuz->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IuAx,JzXv,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuAx,JzvX,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywsuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywsvu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywusv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywuvs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuAx,Jzvs,Xywvsu->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuAx,Jzvs,Xywvus->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IuxA,JuXv,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IuxA,Juvs,Xywsvz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Juvs,Xywvsz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvXw,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IuxA,JvXy,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvsuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvszu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvzsu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jvsw,Xyvzus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,Jvsy,Xwvszu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvsy,Xwvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,JvwX,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,JvwX,zuyv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvws,Xyvuzs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,Jvws,Xyvzus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jvwy,Xvuz->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,Jvwy,Xvzu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jw,Xyuz->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IuxA,Jw,Xyzu->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IuxA,JzXv,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IuxA,JzvX,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,JzvX,ywvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jzvs,Xywsuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jzvs,Xywsvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jzvs,Xywusv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IuxA,Jzvs,Xywvsu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IuxA,Jzvs,Xywvus->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Ja,Xzyw->IAJX', v_aaaa, t1_xaee, t1_xe, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAa,JuXa,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,JuaX,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juav,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juaz,Xuyw->IAJX', v_aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAa,Juva,Xzuvwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuvyw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuwvy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuwyv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuyvw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAa,Juva,Xzuywv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAa,Juza,Xuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Ju,Xzyw->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JvXu,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,IxAu,JvXz,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jvsu,Xzvswy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvwsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvwys->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvysw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxAu,Jvsu,Xzvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,Jvsz,Xuvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,JvuX,zvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvus,Xzvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvuz,Xvyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,JvzX,ywuv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvswy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvsyw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvwsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxAu,Jvzs,Xuvwys->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvysw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAu,Jvzs,Xuvyws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxAu,Jvzu,Xvwy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JwXv,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JwvX,zuvy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,Jwvs,Xzuvsy->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += einsum('xyzw,IxAu,JyXv,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxAu,JyvX,zuwv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzusvw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuswv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuvsw->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxAu,Jyvs,Xzuvws->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuwsv->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxAu,Jyvs,Xzuwvs->IAJX', v_aaaa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAu,Jz,Xuwy->IAJX', v_aaaa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxaA,JuXa,zuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaA,Juva,Xzuvwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juva,Xzuvyw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juva,Xzuwvy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juva,Xzuwyv->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,Juva,Xzuyvw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxaA,Juza,Xuwy->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxaA,Juza,Xuyw->IAJX', v_aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,IxuA,JvXu,zvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxuA,JvXz,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvswy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvsyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvwsy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvwys->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxuA,Jvsu,Xzvysw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuA,Jvsz,Xuvsyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jvsz,Xuvysw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuA,JvzX,ywuv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,JvzX,ywvu->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvswy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvsyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvwsy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvwys->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jvzs,Xuvysw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jvzu,Xvwy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,IxuA,Jvzu,Xvyw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JwXv,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxuA,JwvX,zuvy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,JwvX,zuyv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxuA,Jwvs,Xzuvsy->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jwvs,Xzuysv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,IxuA,JyXv,zuwv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jyvs,Xzusvw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuvsw->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuvws->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuwsv->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jyvs,Xzuwvs->IAJX', v_aaaa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,IxuA,Jz,Xuwy->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxuA,Jz,Xuyw->IAJX', v_aaaa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiXx,IiuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiXx,iIuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvwuy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvwyu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvyuw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,iIuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,iIvA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwuy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwyu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvyuw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixX,iIuA,zuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivA,Xzvuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,IivA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,iIuA,Xzyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,iIvA,Xzvywu->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuA,Xuwy->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixz,IiuA,Xuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,iIuA,Xuyw->IAJX', v_aaaa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JiXx,IiuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JiXx,iIuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,IivA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvuyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvwuy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvwyu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Jiux,IivA,Xzvyuw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jiux,iIuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jiux,iIvA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvuyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwuy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvwyu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvyuw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jiux,iIvA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JixX,iIuA,zuwy->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixa,IiAa,Xzyw->IAJX', v_aaaa, t1_xvae, t1_xvee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixa,iIAa,Xzyw->IAJX', v_aaaa, t1_xvae, t1_vxee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,IiuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixu,IivA,Xzvuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixu,IivA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jixu,iIuA,Xzyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixu,iIvA,Xzvywu->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jixz,IiuA,Xuwy->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jixz,IiuA,Xuyw->IAJX', v_aaaa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jixz,iIuA,Xuyw->IAJX', v_aaaa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JuXx,IuAv,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuXx,IuvA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juax,IXAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juax,IvAa,Xzuvwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuvyw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuwvy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuwyv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuyvw->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juax,IvAa,Xzuywv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Juvx,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juvx,IsAv,Xzuswy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzusyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuwsy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuwys->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuysw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IsAv,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juvx,IuAs,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsvyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzswvy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzswyv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsyvw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IuAs,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juvx,IusA,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusA,Xzsvyw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusA,Xzswvy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusA,Xzswyv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juvx,IusA,Xzsyvw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JuxX,IuAv,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IXAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxa,IvAa,Xzuywv->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxa,IvaA,Xzuvwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxa,IvaA,Xzuywv->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Juxv,IsAv,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,Juxv,IsvA,Xzuswy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Juxv,IsvA,Xzuyws->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxv,IuAs,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxv,IusA,Xzsvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxv,IusA,Xzsywv->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Juxz,IuAv,Xvyw->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Juxz,IuvA,Xvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Juxz,IuvA,Xvyw->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxXa,IuAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxXa,IuaA,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,JxXu,IvAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxXu,IvuA,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxaX,IuAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxau,IXAa,zuwy->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywuvz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywuzv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxau,IvAa,Xywvuz->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywvzu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywzuv->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxau,IvAa,Xywzvu->IAJX', v_aaaa, t1_xaea, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,JxuX,IvAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IXAa,zuwy->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxua,IvAa,Xywuvz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxua,IvaA,Xywuvz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxua,IvaA,Xywvuz->IAJX', v_aaaa, t1_xaae, t1_xaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,Jxuv,IXAu,zvwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IXAv,zuwy->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,Jxuv,IsAu,Xywsvz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywszv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywvsz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywvzs->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywzsv->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsAu,Xywzvs->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Jxuv,IsAv,Xywusz->IAJX', v_aaaa, t1_xaaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,Jxuv,IsvA,Xywsuz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,Jxuv,IsvA,Xywusz->IAJX', v_aaaa, t1_xaaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,JiXu,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiXw,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,JiXy,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuX,zuwy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiuw,Xyuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiuy,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwX,zy->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiwu,Xyzu->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiwy,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyX,zw->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyu,Xwuz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyw,Xz->IAJX', v_aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiAa,Xzyw->IAJX', v_aaaa, t1_xxae, t1_xxee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,iIxA,JiXu,zuwy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiXw,zy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 2 * einsum('xyzw,iIxA,JiXy,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,JiuX,zuwy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iIxA,Jiuv,Xywuvz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiuw,Xyuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiuy,Xwuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,JiwX,zy->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiwu,Xyzu->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,Jiwy,Xz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iIxA,JiyX,zw->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyu,Xwuz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iIxA,Jiyw,Xz->IAJX', v_aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iJxa,IiAa,Xzyw->IAJX', v_aaaa, t1_vxae, t1_xvee, rdm_ccaa, optimize = einsum_type)
     
        temp = np.ascontiguousarray(temp)
        temp.shape = (n_ce, n_ca)
        M_00[s_ce_aa:f_ce_aa, s_ca_bb:f_ca_bb] += temp
        M_00[s_ce_bb:f_ce_bb, s_ca_aa:f_ca_aa] += temp
     
        # Add temp matrix to bottom triangle
        M_00[s_ca_bb:f_ca_bb, s_ce_aa:f_ce_aa] += temp.T
        M_00[s_ca_aa:f_ca_aa, s_ce_bb:f_ce_bb] += temp.T
        del temp

    mr_adc.M_00 = np.ascontiguousarray(M_00)

    print("Time for computing M(h0-h0) block:              %f sec\n" % (time.time() - start_time))
    sys.stdout.flush()

    return M_00

def compute_preconditioner(mr_adc, M_00):

    start_time = time.time()

    print ("Computing pre-conditioner...")
    sys.stdout.flush()
 
    # Matrix Blocks
    M_00 = mr_adc.M_00
    
    # Variables from kernel
    ncvs    = mr_adc.ncvs
    nval    = mr_adc.nval
    ncas    = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Non-orthogonal Excitation Manifolds
    s_ce__aa = mr_adc.h0.s_ce_aa 
    f_ce__aa = mr_adc.h0.f_ce_aa 
    s_ce__bb = mr_adc.h0.s_ce_bb 
    f_ce__bb = mr_adc.h0.f_ce_bb 
    s_ca__aa = mr_adc.h0.s_ca_aa 
    f_ca__aa = mr_adc.h0.f_ca_aa 
    s_ca__bb = mr_adc.h0.s_ca_bb 
    f_ca__bb = mr_adc.h0.f_ca_bb 

    ## Indices
    cc_tril_ind = np.tril_indices(ncvs, k = -1)
    ee_tril_ind = np.tril_indices(nextern, k = -1)

    # Build the empty preconditioner
    precond = np.zeros(mr_adc.h_orth.dim) 

    # Define functions to compute preconditioner diagonal blocks
    ## CA
    def compute_preconditioner__CA(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        ncas = mr_adc.ncas

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        ## Overlap Matrices
        S12_ca = mr_adc.S12.ca

        precond_ca  = einsum('XY,IJ->IXJY', h_aa, np.identity(ncvs), optimize = einsum_type)
        precond_ca -= einsum('J,IJ,XY->IXJY', e_cvs, np.identity(ncvs), np.identity(ncas), optimize = einsum_type)
        precond_ca += 1/2 * einsum('J,IJ,XY->IXJY', e_cvs, np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ca -= 1/2 * einsum('Yx,IJ,Xx->IXJY', h_aa, np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ca += einsum('IJ,XYxy,xy->IXJY', np.identity(ncvs), v_aaaa, rdm_ca, optimize = einsum_type)
        precond_ca -= 1/2 * einsum('IJ,XxyY,yx->IXJY', np.identity(ncvs), v_aaaa, rdm_ca, optimize = einsum_type)
        precond_ca -= 1/2 * einsum('IJ,Yxyz,Xyxz->IXJY', np.identity(ncvs), v_aaaa, rdm_ccaa, optimize = einsum_type)

        precond_ca = einsum('IXIY,XP,YP->IP', precond_ca, S12_ca, S12_ca, optimize = einsum_type)

        return precond_ca

    ## CE
    def compute_preconditioner__CE(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        nextern = mr_adc.nextern

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        precond_ce  = einsum('A,AA,II->IA', e_extern, np.identity(nextern), np.identity(ncvs), optimize = einsum_type)
        precond_ce -= einsum('I,AA,II->IA', e_cvs, np.identity(nextern), np.identity(ncvs), optimize = einsum_type)
 
        return precond_ce

    ## CCAA
    ## CVAA

    ## CCEA
    def compute_preconditioner__CCEA(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        ncas = mr_adc.ncas
        nextern = mr_adc.nextern

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        precond_ccea  = einsum('XX,AA,II,JJ->IJAX', h_aa, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), optimize = einsum_type) 
        precond_ccea += einsum('A,AA,II,JJ,XX->IJAX', e_extern, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), np.identity(ncas), optimize = einsum_type)
        precond_ccea -= einsum('I,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), np.identity(ncas), optimize = einsum_type)
        precond_ccea -= einsum('J,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), np.identity(ncas), optimize = einsum_type)
        precond_ccea -= 1/2 * einsum('A,AA,II,JJ,XX->IJAX', e_extern, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea += 1/2 * einsum('I,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea += 1/2 * einsum('J,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea -= 1/2 * einsum('Xx,AA,II,JJ,Xx->IJAX', h_aa, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea += einsum('XXxy,AA,II,JJ,xy->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea -= 1/2 * einsum('XxyX,AA,II,JJ,yx->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ca, optimize = einsum_type)
        precond_ccea -= 1/2 * einsum('Xxyz,AA,II,JJ,Xyxz->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(ncvs), rdm_ccaa, optimize = einsum_type)

        return precond_ccea

    ## CVEA
    def compute_preconditioner__CVEA(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        nval = mr_adc.nval
        ncas = mr_adc.ncas
        nextern = mr_adc.nextern

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_val = mr_adc.mo_energy.v
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        precond_cvea  = einsum('XX,AA,II,JJ->IJAX', h_aa, np.identity(nextern), np.identity(ncvs), np.identity(nval), optimize = einsum_type)
        precond_cvea += einsum('A,AA,II,JJ,XX->IJAX', e_extern, np.identity(nextern), np.identity(ncvs), np.identity(nval), np.identity(ncas), optimize = einsum_type)
        precond_cvea -= einsum('I,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(nval), np.identity(ncas), optimize = einsum_type)
        precond_cvea -= einsum('J,AA,II,JJ,XX->IJAX', e_val, np.identity(nextern), np.identity(ncvs), np.identity(nval), np.identity(ncas), optimize = einsum_type)
        precond_cvea -= 1/2 * einsum('A,AA,II,JJ,XX->IJAX', e_extern, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea += 1/2 * einsum('I,AA,II,JJ,XX->IJAX', e_cvs, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea += 1/2 * einsum('J,AA,II,JJ,XX->IJAX', e_val, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea -= 1/2 * einsum('Xx,AA,II,JJ,Xx->IJAX', h_aa, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea += einsum('XXxy,AA,II,JJ,xy->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea -= 1/2 * einsum('XxyX,AA,II,JJ,yx->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ca, optimize = einsum_type)
        precond_cvea -= 1/2 * einsum('Xxyz,AA,II,JJ,Xyxz->IJAX', v_aaaa, np.identity(nextern), np.identity(ncvs), np.identity(nval), rdm_ccaa, optimize = einsum_type)

        return precond_cvea
    

    ## CCEE
    def compute_preconditioner__CCEE(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        nextern = mr_adc.nextern

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        precond_ccee  = einsum('A,AB,BA,II,JJ->IJAB', e_extern, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(ncvs), optimize = einsum_type)
        precond_ccee += einsum('B,AB,BA,II,JJ->IJAB', e_extern, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(ncvs), optimize = einsum_type)
        precond_ccee -= einsum('I,AB,BA,II,JJ->IJAB', e_cvs, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(ncvs), optimize = einsum_type)
        precond_ccee -= einsum('J,AB,BA,II,JJ->IJAB', e_cvs, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(ncvs), optimize = einsum_type)
    
        return precond_ccee

    ## CVEE
    def compute_preconditioner__CVEE(mr_adc):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs = mr_adc.ncvs
        nval = mr_adc.nval
        nextern = mr_adc.nextern

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_val = mr_adc.mo_energy.v
        e_extern = mr_adc.mo_energy.e

        precond_cvee  = einsum('A,AB,BA,II,JJ->IJAB', e_extern, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(nval), optimize = einsum_type)
        precond_cvee += einsum('B,AB,BA,II,JJ->IJAB', e_extern, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(nval), optimize = einsum_type)
        precond_cvee -= einsum('I,AB,BA,II,JJ->IJAB', e_cvs, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(nval), optimize = einsum_type)
        precond_cvee -= einsum('J,AB,BA,II,JJ->IJAB', e_val, np.identity(nextern), np.identity(nextern), np.identity(ncvs), np.identity(nval), optimize = einsum_type)

        return precond_cvee

    ## CAEE
    ## CAAA
    ## CAEA
 
    # Compute preconditioner diagonal blocks
    ## Zeroeth-order manifold
    if mr_adc.method in ("mr-adc(0)", "mr-adc(1)"):

        # Orthogonal excitation manifolds
        ho_s_ce_caea__aa = mr_adc.h_orth.s_ce_caea_aa  
        ho_f_ce_caea__aa = mr_adc.h_orth.f_ce_caea_aa
        ho_s_ce_caea__bb = mr_adc.h_orth.s_ce_caea_bb  
        ho_f_ce_caea__bb = mr_adc.h_orth.f_ce_caea_bb
        ho_s_ca_caaa__aa = mr_adc.h_orth.s_ca_caaa_aa
        ho_f_ca_caaa__aa = mr_adc.h_orth.f_ca_caaa_aa
        ho_s_ca_caaa__bb = mr_adc.h_orth.s_ca_caaa_bb
        ho_f_ca_caaa__bb = mr_adc.h_orth.f_ca_caaa_bb

        # Fill preconditioner matrix
        ## CA preconditioner 
        precond_ca = compute_preconditioner__CA(mr_adc)
        precond[ho_s_ca_caaa__aa:ho_f_ca_caaa__aa] = precond_ca.reshape(-1).copy() 
        precond[ho_s_ca_caaa__bb:ho_f_ca_caaa__bb] = precond_ca.reshape(-1).copy()

        ## CE preconditioner
        precond_ce = compute_preconditioner__CE(mr_adc)
        precond[ho_s_ce_caea__aa:ho_f_ce_caea__aa] = precond_ce.reshape(-1).copy() 
        precond[ho_s_ce_caea__bb:ho_f_ce_caea__bb] = precond_ce.reshape(-1).copy()

    ## Zeroeth- and first-order manifolds
    elif mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x"):

        ## Excitation manifolds
        ho_s_ccee__aaaa = mr_adc.h_orth.s_ccee__aaaa
        ho_f_ccee__aaaa = mr_adc.h_orth.f_ccee__aaaa
        ho_s_ccee__abab = mr_adc.h_orth.s_ccee__abab
        ho_f_ccee__abab = mr_adc.h_orth.f_ccee__abab
        ho_s_ccea__aaaa = mr_adc.h_orth.s_ccea__aaaa
        ho_f_ccea__aaaa = mr_adc.h_orth.f_ccea__aaaa
        ho_s_ccea__abab = mr_adc.h_orth.s_ccea__abab
        ho_f_ccea__abab = mr_adc.h_orth.f_ccea__abab
        ho_s_ccea__bbbb = mr_adc.h_orth.s_ccea__bbbb
        ho_f_ccea__bbbb = mr_adc.h_orth.f_ccea__bbbb

        ## CCAA preconditioner (WiP)
    
        ## CCEA preconditioner
        precond_ccea = compute_preconditioner__CCEA(mr_adc)
        precond[ho_s_ccea__aaaa:ho_f_ccea__aaaa] = precond_ccea[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1)
        precond[ho_s_ccea__abab:ho_f_ccea__abab] = precond_ccea.reshape(-1)
        precond[ho_s_ccea__bbbb:ho_f_ccea__bbbb] = precond_ccea[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1)

        ## CCEE preconditioner
        precond_ccee = compute_preconditioner__CCEE(mr_adc)
        d_ccee = precond_ccee[:, :, ee_tril_ind[0], ee_tril_ind[1]]
        precond[ho_s_ccee__aaaa:ho_f_ccee__aaaa] = d_ccee[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1)
        precond[ho_s_ccee__abab:ho_f_ccee__abab] = precond_ccee.reshape(-1)

        ## CAEE preconditioner
        ## CAAA preconditioner
        ## CAEA preconditioner

        if nval > 0:
            ## Excitation Manifolds
            ho_s_cvee__aaaa = mr_adc.h_orth.s_cvee__aaaa
            ho_f_cvee__aaaa = mr_adc.h_orth.f_cvee__aaaa 
            ho_s_cvee__abab = mr_adc.h_orth.s_cvee__abab 
            ho_f_cvee__abab = mr_adc.h_orth.f_cvee__abab 
            
            ho_s_cvea__aaaa = mr_adc.h_orth.s_cvea__aaaa
            ho_f_cvea__aaaa = mr_adc.h_orth.f_cvea__aaaa 
            ho_s_cvea__abab = mr_adc.h_orth.s_cvea__abab
            ho_f_cvea__abab = mr_adc.h_orth.f_cvea__abab 
            ho_s_cvea__bbbb = mr_adc.h_orth.s_cvea__bbbb
            ho_f_cvea__bbbb = mr_adc.h_orth.f_cvea__bbbb 
    
            # Compute preconditioner diagonal blocks
#            ## CVAA preconditioner
#            precond_cvaa = compute_preconditioner__CVAA(mr_adc)

            ## CVEA preconditioner
            precond_cvea = compute_preconditioner__CVEA(mr_adc)
            precond[ho_s_cvea__aaaa:ho_f_cvea__aaaa] = precond_cvea.reshape(-1)
            precond[ho_s_cvea__abab:ho_f_cvea__abab] = precond_cvea.reshape(-1)
            precond[ho_s_cvea__bbbb:ho_f_cvea__bbbb] = precond_cvea.reshape(-1)

            ## CVEE preconditioner
            precond_cvee = compute_preconditioner__CVEE(mr_adc)
            precond[ho_s_cvee__aaaa:ho_f_cvee__aaaa] = precond_cvee[:, :, ee_tril_ind[0], ee_tril_ind[1]].reshape(-1)
            precond[ho_s_cvee__abab:ho_f_cvee__abab] = precond_cvee.reshape(-1)
    
    print("Time for computing preconditioner:                 %f sec\n" % (time.time() - start_time))
    sys.stdout.flush()

    return np.ascontiguousarray(precond)

def define_effective_hamiltonian(mr_adc, M_00):

    apply_M = None

    if mr_adc.method in ("mr-adc(0)", "mr-adc(1)"):
        # Effective Hamiltonian for MR-ADC(0) and MR-ADC(1)
        def apply_M(X):
            
            # Xt = S_12 X
            Xt = apply_S_12(mr_adc, X)            

            # Apply M: Sigma = M Xt
            sigma = np.dot(M_00, X)

            # X_new = S_12.T Sigma
            X_new = apply_S_12(mr_adc, sigma, transpose = True)

            return X_new

    else:
        # Effective Hamiltonian for MR-ADC(2) and MR-ADC(2)-X

#        ## Create intermediates for MR-ADC(2)-X
#        ints = None
#
#        if mr_adc.method == 'mr-adc(2)-x':
#            ints = compute_sigma_vector_intermediates(mr_adc, t_amp)
#        else:
#            ints = mr_adc_intermediates.compute_4rdm_v_3ind_int(mr_adc)

        def apply_M(X):
            ## Xt = S_12 X
            Xt = apply_S_12(mr_adc, X)

            ## Apply M: Sigma = M Xt
            sigma = compute_sigma_vector(mr_adc, Xt)

            ## X_new = S_12.T Sigma
            X_new = apply_S_12(mr_adc, sigma, transpose = True)

            return X_new

    return apply_M

def apply_S_12(mr_adc, X, transpose = False):

    if (len(X.shape) > 1):
        raise Exception("Input vector must be one-dimensional array")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncvs    = mr_adc.ncvs
    nval    = mr_adc.nval
    ncas    = mr_adc.ncas
    nextern = mr_adc.nextern    

    # Compound indices
    n_ce = mr_adc.h0.n_ce
    n_ca = mr_adc.h0.n_ca

    # Non-orthogonal dimension indices
    s_ce__aa = mr_adc.h0.s_ce_aa
    f_ce__aa = mr_adc.h0.f_ce_aa
    s_ce__bb = mr_adc.h0.s_ce_bb
    f_ce__bb = mr_adc.h0.f_ce_bb
    s_ca__aa = mr_adc.h0.s_ca_aa
    f_ca__aa = mr_adc.h0.f_ca_aa
    s_ca__bb = mr_adc.h0.s_ca_bb
    f_ca__bb = mr_adc.h0.f_ca_bb

    Xt = None

    # MR-ADC(0) and MR-ADC(1)
    if mr_adc.method in ("mr-adc(0)", "mr-adc(1)"):

        # Orthogonal dimension indices
        ho_s_ce_caea__aa = mr_adc.h_orth.s_ce_caea_aa
        ho_f_ce_caea__aa = mr_adc.h_orth.f_ce_caea_aa
        ho_s_ce_caea__bb = mr_adc.h_orth.s_ce_caea_bb
        ho_f_ce_caea__bb = mr_adc.h_orth.f_ce_caea_bb
        ho_s_ca_caaa__aa = mr_adc.h_orth.s_ca_caaa_aa
        ho_f_ca_caaa__aa = mr_adc.h_orth.f_ca_caaa_aa
        ho_s_ca_caaa__bb = mr_adc.h_orth.s_ca_caaa_bb
        ho_f_ca_caaa__bb = mr_adc.h_orth.f_ca_caaa_bb

        # Overlap matrix
        S12_ca = mr_adc.S12.ca

        # Transformation to orthogonal basis
        if transpose:
            if (X.shape[0] != mr_adc.h0.dim):
                raise Exception("Dimensions do not match when applying S_12 transpose")

            Xt = np.zeros(mr_adc.h_orth.dim)

            # CA
            # aa,aa
            temp = X[s_ca__aa:f_ca__aa].reshape(ncvs, ncas).copy()
            Xt[ho_s_ca_caaa__aa:ho_f_ca_caaa__aa] = np.dot(temp, S12_ca).reshape(-1)

            # bb,bb
            temp = X[s_ca__bb:f_ca__bb].reshape(ncvs, ncas).copy()
            Xt[ho_s_ca_caaa__bb:ho_f_ca_caaa__bb] = np.dot(temp, S12_ca).reshape(-1)

            # CE
            Xt[ho_s_ce_caea__aa:ho_f_ce_caea__bb] = X[s_ce__aa:f_ce__bb].copy()

        # Transformation to non-orthogonal basis
        else:
            if (X.shape[0] != (mr_adc.h_orth.dim)):
                raise Exception("Dimensions do not match when applying S_12")

            Xt = np.zeros(mr_adc.h0.dim)

            # CA
            # aa,aa
            temp = X[ho_s_ca_caaa__aa:ho_f_ca_caaa__aa].reshape(ncvs, S12_ca.shape[1]).copy()
            Xt[s_ca__aa:f_ca__aa] = np.dot(temp, S12_ca.T).reshape(-1)

            # bb,bb
            temp = X[ho_s_ca_caaa__bb:ho_f_ca_caaa__bb].reshape(ncvs, S12_ca.shape[1]).copy()
            Xt[s_ca__bb:f_ca__bb] = np.dot(temp, S12_ca.T).reshape(-1)

            # CE
            Xt[s_ce__aa:f_ce__bb] = X[ho_s_ce_caea__aa:ho_f_ce_caea__bb].copy()

    # MR-ADC(2) and MR-ADC(2)-X
    else:
        # Compound Indices
        n_aa = ncas * (ncas - 1) // 2
        n_cc = ncvs * (ncvs - 1) // 2
        n_ee = nextern * (nextern - 1) // 2

        # Excitation Quantities
        n_caee = mr_adc.h1.n_caee
        n_caaa = mr_adc.h1.n_caaa
        n_caea = mr_adc.h1.n_caea    

        # Non-orthogonal Excitation Manifolds
        s_ccaa__aaaa = mr_adc.h1.s_ccaa__aaaa      
        f_ccaa__aaaa = mr_adc.h1.f_ccaa__aaaa
        s_ccaa__abab = mr_adc.h1.s_ccaa__abab
        f_ccaa__abab = mr_adc.h1.f_ccaa__abab
        s_ccaa__bbbb = mr_adc.h1.s_ccaa__bbbb
        f_ccaa__bbbb = mr_adc.h1.f_ccaa__bbbb

        s_ccea__aaaa =  mr_adc.h1.s_ccea__aaaa
        f_ccea__aaaa =  mr_adc.h1.f_ccea__aaaa
        s_ccea__abab =  mr_adc.h1.s_ccea__abab
        f_ccea__abab =  mr_adc.h1.f_ccea__abab
        s_ccea__bbbb =  mr_adc.h1.s_ccea__bbbb
        f_ccea__bbbb =  mr_adc.h1.f_ccea__bbbb
        
        s_ccee__aaaa =  mr_adc.h1.s_ccee__aaaa
        f_ccee__aaaa =  mr_adc.h1.f_ccee__aaaa
        s_ccee__abab =  mr_adc.h1.s_ccee__abab
        f_ccee__abab =  mr_adc.h1.f_ccee__abab
        
        s_caee__aaaa = mr_adc.h1.s_caee__aaaa
        f_caee__aaaa = mr_adc.h1.f_caee__aaaa
        s_caee__abab = mr_adc.h1.s_caee__abab
        f_caee__abab = mr_adc.h1.f_caee__abab
        s_caee__bbbb = mr_adc.h1.s_caee__bbbb
        f_caee__bbbb = mr_adc.h1.f_caee__bbbb
        
        s_caaa__aaaa = mr_adc.h1.s_caaa__aaaa
        f_caaa__aaaa = mr_adc.h1.f_caaa__aaaa
        s_caaa__abab = mr_adc.h1.s_caaa__abab
        f_caaa__abab = mr_adc.h1.f_caaa__abab
        s_caaa__bbbb = mr_adc.h1.s_caaa__bbbb
        f_caaa__bbbb = mr_adc.h1.f_caaa__bbbb
        
        s_caea__aaaa = mr_adc.h1.s_caea__aaaa
        f_caea__aaaa = mr_adc.h1.f_caea__aaaa
        s_caea__abab = mr_adc.h1.s_caea__abab
        f_caea__abab = mr_adc.h1.f_caea__abab
        s_caea__bbbb = mr_adc.h1.s_caea__bbbb
        f_caea__bbbb = mr_adc.h1.f_caea__bbbb

        if nval is not None:
            s_cvaa__aaaa = mr_adc.h1.s_cvaa__aaaa      
            f_cvaa__aaaa = mr_adc.h1.f_cvaa__aaaa
            s_cvaa__abab = mr_adc.h1.s_cvaa__abab
            f_cvaa__abab = mr_adc.h1.f_cvaa__abab
            s_cvaa__bbbb = mr_adc.h1.s_cvaa__bbbb
            f_cvaa__bbbb = mr_adc.h1.f_cvaa__bbbb
    
            s_cvea__aaaa = mr_adc.h1.s_cvea__aaaa
            f_cvea__aaaa = mr_adc.h1.f_cvea__aaaa
            s_cvea__abab = mr_adc.h1.s_cvea__abab
            f_cvea__abab = mr_adc.h1.f_cvea__abab
            s_cvea__bbbb = mr_adc.h1.s_cvea__bbbb
            f_cvea__bbbb = mr_adc.h1.f_cvea__bbbb
            
            s_cvee__aaaa = mr_adc.h1.s_cvee__aaaa
            f_cvee__aaaa = mr_adc.h1.f_cvee__aaaa
            s_cvee__abab = mr_adc.h1.s_cvee__abab
            f_cvee__abab = mr_adc.h1.f_cvee__abab
 
        # Orthogonal Excitation Manifolds
        ho_s_ca_caaa = mr_adc.h_orth.s_ca_caaa
        ho_f_ca_caaa = mr_adc.h_orth.f_ca_caaa
        ho_s_ce_caea = mr_adc.h_orth.s_ce_caea
        ho_f_ce_caea = mr_adc.h_orth.f_ce_caea

        ho_s_ccaa__aaaa = mr_adc.h_orth.s_ccaa__aaaa      
        ho_f_ccaa__aaaa = mr_adc.h_orth.f_ccaa__aaaa
        ho_s_ccaa__abab = mr_adc.h_orth.s_ccaa__abab
        ho_f_ccaa__abab = mr_adc.h_orth.f_ccaa__abab
        ho_s_ccaa__bbbb = mr_adc.h_orth.s_ccaa__bbbb
        ho_f_ccaa__bbbb = mr_adc.h_orth.f_ccaa__bbbb

        ho_s_ccea__aaaa = mr_adc.h_orth.s_ccea__aaaa
        ho_f_ccea__aaaa = mr_adc.h_orth.f_ccea__aaaa
        ho_s_ccea__abab = mr_adc.h_orth.s_ccea__abab
        ho_f_ccea__abab = mr_adc.h_orth.f_ccea__abab
        ho_s_ccea__bbbb = mr_adc.h_orth.s_ccea__bbbb
        ho_f_ccea__bbbb = mr_adc.h_orth.f_ccea__bbbb
        
        ho_s_ccee__aaaa = mr_adc.h_orth.s_ccee__aaaa
        ho_f_ccee__aaaa = mr_adc.h_orth.f_ccee__aaaa
        ho_s_ccee__abab = mr_adc.h_orth.s_ccee__abab
        ho_f_ccee__abab = mr_adc.h_orth.f_ccee__abab
    
        ho_s_caee__aaaa = mr_adc.h_orth.s_caee__aaaa
        ho_f_caee__aaaa = mr_adc.h_orth.f_caee__aaaa
        ho_s_caee__abab = mr_adc.h_orth.s_caee__abab
        ho_f_caee__abab = mr_adc.h_orth.f_caee__abab
        ho_s_caee__bbbb = mr_adc.h_orth.s_caee__bbbb
        ho_f_caee__bbbb = mr_adc.h_orth.f_caee__bbbb

        if nval is not None:
            ho_s_cvaa__aaaa = mr_adc.h_orth.s_cvaa__aaaa      
            ho_f_cvaa__aaaa = mr_adc.h_orth.f_cvaa__aaaa
            ho_s_cvaa__abab = mr_adc.h_orth.s_cvaa__abab
            ho_f_cvaa__abab = mr_adc.h_orth.f_cvaa__abab
            ho_s_cvaa__bbbb = mr_adc.h_orth.s_cvaa__bbbb
            ho_f_cvaa__bbbb = mr_adc.h_orth.f_cvaa__bbbb
    
            ho_s_cvea__aaaa = mr_adc.h_orth.s_cvea__aaaa
            ho_f_cvea__aaaa = mr_adc.h_orth.f_cvea__aaaa
            ho_s_cvea__abab = mr_adc.h_orth.s_cvea__abab
            ho_f_cvea__abab = mr_adc.h_orth.f_cvea__abab
            ho_s_cvea__bbbb = mr_adc.h_orth.s_cvea__bbbb
            ho_f_cvea__bbbb = mr_adc.h_orth.f_cvea__bbbb
            
            ho_s_cvee__aaaa = mr_adc.h_orth.s_cvee__aaaa
            ho_f_cvee__aaaa = mr_adc.h_orth.f_cvee__aaaa
            ho_s_cvee__abab = mr_adc.h_orth.s_cvee__abab
            ho_f_cvee__abab = mr_adc.h_orth.f_cvee__abab
         
        # Overlap matrices
        S12_ccaa = mr_adc.S12.ccaa
        S12_ccea = mr_adc.S12.ccea
        S12_caee = mr_adc.S12.caee
        S12_ca_caaa = mr_adc.S12.ca_caaa
        S12_ce_caea = mr_adc.S12.ce_caea

        # Transformation to orthonormal basis
        if transpose:
            if (X.shape[0] != (mr_adc.h0.dim + mr_adc.h1.dim)):
                raise Exception("Dimensions do not match when applying S_12 transpose")

            Xt = np.zeros(mr_adc.h_orth.dim)
           
#            # CCAA
#            if ncvs_so > 0:
#
#                temp = X[s_ccaa:f_ccaa].reshape(n_cc, -1).copy()
#                Xt[ho_s_ccaa:ho_f_ccaa] = np.einsum("IX,XP->IP", temp, S12_ccaa).reshape(-1)
# 
#            # CVAA
#            if nval_so > 0 and ncore_so > 0:
#
#                temp = X[s_cvaa:f_cvaa].reshape(ncvs_so * nval_so, -1).copy()
#                Xt[ho_s_cvaa:ho_f_cvaa] = np.einsum("IX,XP->IP", temp, S12_ccaa).reshape(-1)
 
            # CCEA
            if nextern > 0 and ncas > 0:
    
                temp = X[s_ccea__aaaa:f_ccea__aaaa].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_ccea__aaaa:ho_f_ccea__aaaa] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

                temp = X[s_ccea__abab:f_ccea__abab].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_ccea__abab:ho_f_ccea__abab] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

                temp = X[s_ccea__bbbb:f_ccea__bbbb].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_ccea__bbbb:ho_f_ccea__bbbb] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

            # CVEA
            if nval > 0 and nextern > 0 and ncas > 0:

                temp = X[s_cvea__aaaa:f_cvea__aaaa].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_cvea__aaaa:ho_f_cvea__aaaa] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

                temp = X[s_cvea__abab:f_cvea__abab].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_cvea__abab:ho_f_cvea__abab] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

                temp = X[s_cvea__bbbb:f_cvea__bbbb].reshape(-1, nextern, S12_ccea.shape[0]).copy()
                Xt[ho_s_cvea__bbbb:ho_f_cvea__bbbb] = np.einsum("IAX,XP->IPA", temp, S12_ccea).reshape(-1).copy()

            # CCEE
            Xt[ho_s_ccee__aaaa:ho_f_ccee__aaaa] = X[s_ccee__aaaa:f_ccee__aaaa].copy()
            Xt[ho_s_ccee__abab:ho_f_ccee__abab] = X[s_ccee__abab:f_ccee__abab].copy()

            # CVEE
            if nval > 0:

                Xt[ho_s_cvee__aaaa:ho_f_cvee__aaaa] = X[s_cvee__aaaa:f_cvee__aaaa].copy()
                Xt[ho_s_cvee__abab:ho_f_cvee__abab] = X[s_cvee__abab:f_cvee__abab].copy()

#            # CAEE
#            if ncvs_so > 0 and ncas_so > 0 and nextern_so > 0:
#
#                temp = X[s_caee:f_caee].reshape(ncvs_so, S12_caee.shape[0], -1).copy()
#                Xt[ho_s_caee:ho_f_caee] = np.einsum("IXA,XP->IPA", temp, S12_caee).reshape(-1)
#
#            # CE and CAEA -> CE_CAEA
#            if ncvs_so > 0 and nextern_so > 0:
#
#                temp = np.zeros((ncvs_so, nextern_so, S12_ce_caea.shape[0]))
#                temp[:,:,0] = X[s_ce:f_ce].reshape(ncvs_so, nextern_so)
#                temp[:,:,1:] = X[s_caea:f_caea].reshape(ncvs_so, ncas_so, nextern_so, ncas_so).transpose(0,2,1,3).reshape(ncvs_so, nextern_so, -1)
#                Xt[ho_s_ce_caea:ho_f_ce_caea] = np.einsum("IAX,XP->IPA", temp, S12_ce_caea).reshape(-1)
#
#            # CA and CAAA -> CA_CAAA
#            if ncvs_so > 0 and ncas_so > 0:
#
#                temp = np.zeros((ncvs_so, n_xy))
#                temp[:,:ncas_so] = X[s_ca:f_ca].reshape(ncvs_so, ncas_so)
#                temp[:,ncas_so:] = X[s_caaa:f_caaa].reshape(ncvs_so, ncas_so, -1).reshape(ncvs_so, -1)
#                Xt[ho_s_ca_caaa:ho_f_ca_caaa] = np.dot(temp, S12_ca_caaa).reshape(-1)


        # Transformation to non-orthogonal basis
        else:
            if (X.shape[0] != (mr_adc.h_orth.dim)):
                raise Exception("Dimensions do not match when applying S_12")

            Xt = np.zeros(mr_adc.h0.dim + mr_adc.h1.dim)
            
#            # CCAA
#            if ncvs_so > 0:            
#
#                temp = X[ho_s_ccaa:ho_f_ccaa].reshape(n_cc, -1).copy()
#                Xt[s_ccaa:f_ccaa] = np.einsum("IP,XP->IX", temp, S12_ccaa).reshape(-1)
#            
#            # CVAA
#            if nval_so > 0 and ncore_so > 0:            
#
#                temp = X[ho_s_cvaa:ho_f_cvaa].reshape(ncvs_so * nval_so, -1).copy()
#                Xt[s_cvaa:f_cvaa] = np.einsum("IP,XP->IX", temp, S12_ccaa).reshape(-1)
            
            # CCEA
            if nextern > 0 and ncas > 0:            

                temp = X[ho_s_ccea__aaaa:ho_f_ccea__aaaa].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_ccea__aaaa:f_ccea__aaaa] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

                temp = X[ho_s_ccea__abab:ho_f_ccea__abab].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_ccea__abab:f_ccea__abab] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

                temp = X[ho_s_ccea__bbbb:ho_f_ccea__bbbb].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_ccea__bbbb:f_ccea__bbbb] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

            # CVEA
            if nval > 0 and nextern > 0 and ncas > 0:            
            
                temp = X[ho_s_cvea__aaaa:ho_f_cvea__aaaa].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_cvea__aaaa:f_cvea__aaaa] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

                temp = X[ho_s_cvea__abab:ho_f_cvea__abab].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_cvea__abab:f_cvea__abab] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

                temp = X[ho_s_cvea__bbbb:ho_f_cvea__bbbb].reshape(-1, S12_ccea.shape[1], nextern).copy()
                Xt[s_cvea__bbbb:f_cvea__bbbb] = np.einsum("IPA,XP->IAX", temp, S12_ccea).reshape(-1)

            # CCEE
            Xt[s_ccee__aaaa:f_ccee__aaaa] = X[ho_s_ccee__aaaa:ho_f_ccee__aaaa].copy()
            Xt[s_ccee__abab:f_ccee__abab] = X[ho_s_ccee__abab:ho_f_ccee__abab].copy()

            # CVEE
            if nval > 0:

                Xt[s_cvee__aaaa:f_cvee__aaaa] = X[ho_s_cvee__aaaa:ho_f_cvee__aaaa].copy()
                Xt[s_cvee__abab:f_cvee__abab] = X[ho_s_cvee__abab:ho_f_cvee__abab].copy()


#            # CAEE
#            if ncvs_so > 0 and ncas_so > 0:            
#
#                temp = X[ho_s_caee:ho_f_caee].reshape(ncvs_so, S12_caee.shape[1], -1).copy()
#                Xt[s_caee:f_caee] = np.einsum("IPA,XP->IXA", temp, S12_caee).reshape(-1)
#
#            # CE and CAEA -> CE_CAEA
#            temp = X[ho_s_ce_caea:ho_f_ce_caea].reshape(ncvs_so, S12_ce_caea.shape[1], nextern_so)
#            temp = np.einsum("IPA,XP->IAX", temp, S12_ce_caea)
#            Xt[s_ce:f_ce] = temp[:, :, 0].reshape(-1)
#            Xt[s_caea:f_caea] = temp[:, :, 1:].reshape(ncvs_so, nextern_so, ncas_so, ncas_so).transpose(0,2,1,3).reshape(-1)
#
#            # CA and CAAA -> CA_CAAA
#            if ncvs_so > 0 and ncas_so > 0:            
#
#                temp = X[ho_s_ca_caaa:ho_f_ca_caaa].reshape(ncvs_so, -1)
#                temp = np.dot(temp, S12_ca_caaa.T)
#                Xt[s_ca:f_ca] = temp[:, :ncas_so].reshape(ncvs_so, ncas_so).reshape(-1)
#                Xt[s_caaa:f_caaa] = temp[:, ncas_so:].reshape(ncvs_so, ncas_so, -1).reshape(-1)

    return Xt

def compute_sigma_vector(mr_adc, Xt):

    # Variables from kernel
    ncvs = mr_adc.ncvs
    nval = mr_adc.nval
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    # Compound Indices
    n_aa = ncas * (ncas - 1) // 2
    n_cc = ncvs * (ncvs - 1) // 2
    n_ee = nextern * (nextern - 1) // 2

    ## Indices
    aa_tril_ind = np.tril_indices(ncas, k = -1)
    cc_tril_ind = np.tril_indices(ncvs, k = -1)
    ee_tril_ind = np.tril_indices(nextern, k = -1)

    # Matrix Block
    M_00 = mr_adc.M_00
 
    ## Amplitudes
    #t1_ce, t1_ca, t1_ae, t1_caea, t1_caaa, t1_aaea, t1_ccee, t1_ccea, t1_caee, t1_ccaa, t1_aaee, t2_ce, t2_ca, t2_ae, t2_caea, t2_caaa, t2_aaea, t2_ccee, t2_ccea, t2_caee, t2_ccaa, t2_aaee, t2_aa = t_amp
    #
    ## Intermediate tensor(s)
    #if mr_adc.method == 'mr-adc(2)':
    #    gen_int = ints
    #elif mr_adc.method == 'mr-adc(2)-x':
    #    gen_int, t_caaa_int1, t_caaa_int2, t_caaa_int3, t_caaa_int4, t_aaea_int1, t_aaea_int2, t_aaea_int3, t_aaea_int4 = ints
   
    ## MO Energies
    #e_core_so   = mr_adc.mo_energy_so.c
    #e_extern_so = mr_adc.mo_energy_so.e
    #
    ## Integrals
    #h_ca_so = mr_adc.h1eff_so[:ncore_so,ncore_so:nocc_so].copy()
    #h_ce_so = mr_adc.h1eff_so[:ncore_so,nocc_so:].copy()
    #h_ae_so = mr_adc.h1eff_so[ncore_so:nocc_so,nocc_so:].copy()
    #h_aa_so = mr_adc.h1eff_act_so
    #
    #v_aaaa_so =  mr_adc.v2e_so.aaaa
    #v_caae_so =  mr_adc.v2e_so.caae
    #v_caaa_so =  mr_adc.v2e_so.caaa
    #v_aaae_so =  mr_adc.v2e_so.aaae
    #v_caca_so =  mr_adc.v2e_so.caca
    #v_aaee_so =  mr_adc.v2e_so.aaee
    #v_caee_so =  mr_adc.v2e_so.caee
    #v_cace_so =  mr_adc.v2e_so.cace
    #v_cece_so =  mr_adc.v2e_so.cece
    #v_aeae_so =  mr_adc.v2e_so.aeae
    #v_ceae_so =  mr_adc.v2e_so.ceae
    #v_ceaa_so =  mr_adc.v2e_so.ceaa
    #v_ceee_so =  mr_adc.v2e_so.ceee
    #v_aeee_so =  mr_adc.v2e_so.aeee
    #v_ccae_so =  mr_adc.v2e_so.ccae
    #v_ccaa_so =  mr_adc.v2e_so.ccaa
    #v_ccca_so =  mr_adc.v2e_so.ccca
    #v_ccce_so =  mr_adc.v2e_so.ccce

    #if mr_adc.method == "mr-adc(2)-x":
    #    v_cccc_so =  mr_adc.v2e_so.cccc
    #    v_caaa_so =  mr_adc.v2e_so.caaa
    #    if mr_adc.use_df:
    #        v_eeL_so =  mr_adc.v2e_so.eeL
    #        v_Lee_so =  mr_adc.v2e_so.Lee
    #    else:
    #        v_eeee_so =  mr_adc.v2e_so.eeee

    ## RDMs
    #rdm_ca_so       = mr_adc.rdm_so.ca
    #rdm_ccaa_so     = mr_adc.rdm_so.ccaa
    #rdm_cccaaa_so   = mr_adc.rdm_so.cccaaa

    ## h0 <- h1 coupling contributions
    # CA <- CCAA
    # CE <- CCAA
    ###
    # CA <- CVAA
    # CE <- CVAA
    ###
    # CA <- CCEA
    

    # CE <- CCEA
    ###
    # CA <- CVEA
    # CE <- CVEA 
    ###
    # CA <- CCEE
    # CE <- CCEE
    ###
    # CA <- CVEE
    # CE <- CVEE
    ###
    # CA <- CAEE
    # CE <- CAEE
    ###
    # CA <- CAAA
    # CE <- CAAA
    ###
    # CA <- CAEA
    # CE <- CAEA

    ## h1 <- h0 coupling contributions
    ## WiP

    ## h1_h1 block
    # CCAA <- CCAA
    def compute_sigma_vector__H0__h1_h1__CCAA(mr_adc, X_aaaa, X_abab, sigma):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x

        ## Excitation Manifolds
        s_ccaa__aaaa = mr_adc.h1.s_ccaa__aaaa
        f_ccaa__aaaa = mr_adc.h1.f_ccaa__aaaa
        s_ccaa__abab = mr_adc.h1.s_ccaa__abab
        f_ccaa__abab = mr_adc.h1.f_ccaa__abab
#        s_ccaa__bbbb = mr_adc.h1.s_ccaa__bbbb
#        f_ccaa__bbbb = mr_adc.h1.f_ccaa__bbbb

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa

        ## Indices
        cc_tril_ind = np.tril_indices(ncvs, k=-1) 
        aa_tril_ind = np.tril_indices(ncas, k=-1) 

        sigma_ccaa =- einsum('KLWZ,K->KLWZ', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_ccaa -= einsum('KLWZ,L->KLWZ', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_ccaa += einsum('KLWx,Zx->KLWZ', X_aaaa, h_aa, optimize = einsum_type)
        sigma_ccaa -= einsum('KLZx,Wx->KLWZ', X_aaaa, h_aa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLWx,K,Zx->KLWZ', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLWx,L,Zx->KLWZ', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLZx,K,Wx->KLWZ', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLZx,L,Wx->KLWZ', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,xy,Zy->KLWZ', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLZx,xy,Wy->KLWZ', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Wy,Zx->KLWZ', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Zy,Wx->KLWZ', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/6 * einsum('KLxy,yz,WZxz->KLWZ', X_aaaa, h_aa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/6 * einsum('KLxy,yz,WZzx->KLWZ', X_aaaa, h_aa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += einsum('KLWx,Zxyz,yz->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,Zyzx,zy->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,xyzw,Zzyw->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= einsum('KLZx,Wxyz,yz->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLZx,Wyzx,zy->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLZx,xyzw,Wzyw->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,WyZz,zx->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Wyzw,Zwxz->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,WzZy,zx->KLWZ', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/6 * einsum('KLxy,Wzwy,Zzwx->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/6 * einsum('KLxy,Wzwy,Zzxw->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Zyzw,Wwxz->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/6 * einsum('KLxy,Zzwy,Wzwx->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += 1/6 * einsum('KLxy,Zzwy,Wzxw->KLWZ', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/24 * einsum('KLxy,yzwu,WZwuxz->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/24 * einsum('KLxy,yzwu,WZwuzx->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/24 * einsum('KLxy,yzwu,WZwxuz->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa += 1/8 * einsum('KLxy,yzwu,WZwxzu->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/24 * einsum('KLxy,yzwu,WZwzux->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 5/24 * einsum('KLxy,yzwu,WZwzxu->KLWZ', X_aaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        d_ccaa = sigma_ccaa[:, :, aa_tril_ind[0], aa_tril_ind[1]].copy()
        sigma[s_ccaa__aaaa:f_ccaa__aaaa] += d_ccaa[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1).copy()

        sigma_ccaa =- einsum('KLWZ,K->KLWZ', X_abab, e_cvs, optimize = einsum_type)
        sigma_ccaa -= einsum('KLWZ,L->KLWZ', X_abab, e_cvs, optimize = einsum_type)
        sigma_ccaa += einsum('KLWx,Zx->KLWZ', X_abab, h_aa, optimize = einsum_type)
        sigma_ccaa += einsum('KLxZ,Wx->KLWZ', X_abab, h_aa, optimize = einsum_type)
        sigma_ccaa += einsum('KLxy,WxZy->KLWZ', X_abab, v_aaaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLWx,K,Zx->KLWZ', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLWx,L,Zx->KLWZ', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxZ,K,Wx->KLWZ', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxZ,L,Wx->KLWZ', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,K,WZyx->KLWZ', X_abab, e_cvs, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,L,WZyx->KLWZ', X_abab, e_cvs, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,xy,Zy->KLWZ', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxZ,xy,Wy->KLWZ', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Wx,Zy->KLWZ', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Zy,Wx->KLWZ', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,xz,WZzy->KLWZ', X_abab, h_aa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,yz,WZxz->KLWZ', X_abab, h_aa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += einsum('KLWx,Zxyz,yz->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,Zyzx,zy->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLWx,xyzw,Zzyw->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += einsum('KLxZ,Wxyz,yz->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxZ,Wyzx,zy->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxZ,xyzw,Wzyw->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,WxZz,zy->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Wxzw,Zwyz->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Wxzy,Zz->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,WzZy,zx->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Wzwx,Zzyw->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Wzwy,Zzwx->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Zyzw,Wwxz->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/2 * einsum('KLxy,Zyzx,Wz->KLWZ', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Zzwx,Wzwy->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,Zzwy,Wzxw->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma_ccaa -= 1/12 * einsum('KLxy,xzwu,WZwuyz->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/12 * einsum('KLxy,xzwu,WZwzuy->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa += 5/12 * einsum('KLxy,xzwu,WZwzyu->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/12 * einsum('KLxy,yzwu,WZwuzx->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa -= 1/12 * einsum('KLxy,yzwu,WZwxuz->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa += 5/12 * einsum('KLxy,yzwu,WZwxzu->KLWZ', X_abab, v_aaaa, rdm_cccaaa, optimize = einsum_type)
        sigma_ccaa += 1/2 * einsum('KLxy,yzxw,WZwz->KLWZ', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_ccaa__abab:f_ccaa__abab] += sigma_ccaa.reshape(-1).copy()

    # CVAA <- CVAA
    # CCEA <- CCEA
    def compute_sigma_vector__H0__h1_h1__CCEA(mr_adc, X_aaaa, X_abab, X_bbbb, sigma):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        ## Excitation Manifolds
        s_ccea__aaaa = mr_adc.h1.s_ccea__aaaa
        f_ccea__aaaa = mr_adc.h1.f_ccea__aaaa
        s_ccea__abab = mr_adc.h1.s_ccea__abab
        f_ccea__abab = mr_adc.h1.f_ccea__abab
        s_ccea__bbbb = mr_adc.h1.s_ccea__bbbb
        f_ccea__bbbb = mr_adc.h1.f_ccea__bbbb

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        ## Indices
        cc_tril_ind = np.tril_indices(ncvs, k=-1) 


        sigma_ccea  = einsum('KLCW,C->KLCW', X_aaaa, e_extern, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,K->KLCW', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,L->KLCW', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wx->KLCW', X_aaaa, h_aa, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,C,Wx->KLCW', X_aaaa, e_extern, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,K,Wx->KLCW', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,L,Wx->KLCW', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xy,Wy->KLCW', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wxyz,yz->KLCW', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,Wyzx,zy->KLCW', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xyzw,Wzyw->KLCW', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_ccea__aaaa:f_ccea__aaaa] += sigma_ccea[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1).copy()

        sigma_ccea  = einsum('KLCW,C->KLCW', X_bbbb, e_extern, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,K->KLCW', X_bbbb, e_cvs, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,L->KLCW', X_bbbb, e_cvs, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wx->KLCW', X_bbbb, h_aa, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,C,Wx->KLCW', X_bbbb, e_extern, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,K,Wx->KLCW', X_bbbb, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,L,Wx->KLCW', X_bbbb, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xy,Wy->KLCW', X_bbbb, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wxyz,yz->KLCW', X_bbbb, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,Wyzx,zy->KLCW', X_bbbb, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xyzw,Wzyw->KLCW', X_bbbb, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_ccea__bbbb:f_ccea__bbbb] += sigma_ccea[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1).copy()

        sigma_ccea  = einsum('KLCW,C->KLCW', X_abab, e_extern, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,K->KLCW', X_abab, e_cvs, optimize = einsum_type)
        sigma_ccea -= einsum('KLCW,L->KLCW', X_abab, e_cvs, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wx->KLCW', X_abab, h_aa, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,C,Wx->KLCW', X_abab, e_extern, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,K,Wx->KLCW', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea += 1/2 * einsum('KLCx,L,Wx->KLCW', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xy,Wy->KLCW', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_ccea += einsum('KLCx,Wxyz,yz->KLCW', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,Wyzx,zy->KLCW', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_ccea -= 1/2 * einsum('KLCx,xyzw,Wzyw->KLCW', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_ccea__abab:f_ccea__abab] += sigma_ccea.reshape(-1).copy()

  
    # CVEA <- CVEA
    def compute_sigma_vector__H0__h1_h1__CVEA(mr_adc, X_aaaa, X_abab, X_bbbb, sigma):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_val = mr_adc.mo_energy.v
        e_extern = mr_adc.mo_energy.e

        ## Excitation Manifolds
        s_cvea__aaaa = mr_adc.h1.s_cvea__aaaa
        f_cvea__aaaa = mr_adc.h1.f_cvea__aaaa
        s_cvea__abab = mr_adc.h1.s_cvea__abab
        f_cvea__abab = mr_adc.h1.f_cvea__abab
        s_cvea__bbbb = mr_adc.h1.s_cvea__bbbb
        f_cvea__bbbb = mr_adc.h1.f_cvea__bbbb

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        sigma_cvea  = einsum('KLCa,C->KLCW', X_aaaa, e_extern, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,K->KLCW', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,L->KLCW', X_aaaa, e_val, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wx->KLCW', X_aaaa, h_aa, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,C,Wx->KLCW', X_aaaa, e_extern, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,K,Wx->KLCW', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,L,Wx->KLCW', X_aaaa, e_val, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xy,Wy->KLCW', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wxyz,yz->KLCW', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,Wxyz,yx->KLCW', X_aaaa, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xyzw,Wzyw->KLCW', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_cvea__aaaa:f_cvea__aaaa] += sigma_cvea.reshape(-1).copy()

        sigma_cvea  = einsum('KLCa,C->KLCW', X_abab, e_extern, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,K->KLCW', X_abab, e_cvs, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,L->KLCW', X_abab, e_val, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wx->KLCW', X_abab, h_aa, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,C,Wx->KLCW', X_abab, e_extern, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,K,Wx->KLCW', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,L,Wx->KLCW', X_abab, e_val, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xy,Wy->KLCW', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wxyz,yz->KLCW', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,Wxyz,yx->KLCW', X_abab, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xyzw,Wzyw->KLCW', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_cvea__abab:f_cvea__abab] += sigma_cvea.reshape(-1).copy()

        sigma_cvea  = einsum('KLCa,C->KLCW', X_bbbb, e_extern, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,K->KLCW', X_bbbb, e_cvs, optimize = einsum_type)
        sigma_cvea -= einsum('KLCa,L->KLCW', X_bbbb, e_val, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wx->KLCW', X_bbbb, h_aa, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,C,Wx->KLCW', X_bbbb, e_extern, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,K,Wx->KLCW', X_bbbb, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_cvea += 1/2 * einsum('KLCa,L,Wx->KLCW', X_bbbb, e_val, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xy,Wy->KLCW', X_bbbb, h_aa, rdm_ca, optimize = einsum_type)
        sigma_cvea += einsum('KLCa,Wxyz,yz->KLCW', X_bbbb, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,Wxyz,yx->KLCW', X_bbbb, v_aaaa, rdm_ca, optimize = einsum_type)
        sigma_cvea -= 1/2 * einsum('KLCa,xyzw,Wzyw->KLCW', X_bbbb, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_cvea__bbbb:f_cvea__bbbb] += sigma_cvea.reshape(-1).copy()

    # CCEE <- CCEE
    def compute_sigma_vector__H0__h1_h1__CCEE(mr_adc, X_aaaa, X_abab, sigma):
        
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        ## Excitation Manifolds
        s_ccee__aaaa = mr_adc.h1.s_ccee__aaaa
        f_ccee__aaaa = mr_adc.h1.f_ccee__aaaa
        s_ccee__abab = mr_adc.h1.s_ccee__abab
        f_ccee__abab = mr_adc.h1.f_ccee__abab

        ## Indices
        cc_tril_ind = np.tril_indices(ncvs, k=-1)
        ee_tril_ind = np.tril_indices(nextern, k=-1) 

        sigma_ccee  = einsum('KLCD,C->KLCD', X_aaaa, e_extern, optimize = einsum_type)
        sigma_ccee += einsum('KLCD,D->KLCD', X_aaaa, e_extern, optimize = einsum_type)
        sigma_ccee -= einsum('KLCD,K->KLCD', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_ccee -= einsum('KLCD,L->KLCD', X_aaaa, e_cvs, optimize = einsum_type)
        d_ccee = sigma_ccee[:, :, ee_tril_ind[0], ee_tril_ind[1]].copy()
        sigma[s_ccee__aaaa:f_ccee__aaaa] += d_ccee[cc_tril_ind[0], cc_tril_ind[1]].reshape(-1).copy()

        sigma_ccee  = einsum('KLCD,C->KLCD', X_abab, e_extern, optimize = einsum_type)
        sigma_ccee += einsum('KLCD,D->KLCD', X_abab, e_extern, optimize = einsum_type)
        sigma_ccee -= einsum('KLCD,K->KLCD', X_abab, e_cvs, optimize = einsum_type)
        sigma_ccee -= einsum('KLCD,L->KLCD', X_abab, e_cvs, optimize = einsum_type)
        sigma[s_ccee__abab:f_ccee__abab] += sigma_ccee.reshape(-1).copy() 

    # CVEE <- CVEE
    def compute_sigma_vector__H0__h1_h1__CVEE(mr_adc, X_aaaa, X_abab, sigma):
        
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_val = mr_adc.mo_energy.v
        e_extern = mr_adc.mo_energy.e

        ## Excitation Manifolds
        s_cvee__aaaa = mr_adc.h1.s_cvee__aaaa
        f_cvee__aaaa = mr_adc.h1.f_cvee__aaaa
        s_cvee__abab = mr_adc.h1.s_cvee__abab
        f_cvee__abab = mr_adc.h1.f_cvee__abab

        ## Indices
        ee_tril_ind = np.tril_indices(nextern, k=-1) 

        sigma_cvee  = einsum('KLCD,C->KLCD', X_aaaa, e_extern, optimize = einsum_type)
        sigma_cvee += einsum('KLCD,D->KLCD', X_aaaa, e_extern, optimize = einsum_type)
        sigma_cvee -= einsum('KLCD,K->KLCD', X_aaaa, e_cvs, optimize = einsum_type)
        sigma_cvee -= einsum('KLCD,L->KLCD', X_aaaa, e_val, optimize = einsum_type)
        sigma[s_cvee__aaaa:f_cvee__aaaa] += sigma_cvee[:, :, ee_tril_ind[0], ee_tril_ind[1]].reshape(-1).copy()

        sigma_cvee  = einsum('KLCD,C->KLCD', X_abab, e_extern, optimize = einsum_type)
        sigma_cvee += einsum('KLCD,D->KLCD', X_abab, e_extern, optimize = einsum_type)
        sigma_cvee -= einsum('KLCD,K->KLCD', X_abab, e_cvs, optimize = einsum_type)
        sigma_cvee -= einsum('KLCD,L->KLCD', X_abab, e_val, optimize = einsum_type)
        sigma[s_cvee__abab:f_cvee__abab] += sigma_cvee.reshape(-1).copy() 

    # CAEE <- CAEE
    def compute_sigma_vector__H0__h1_h1__CAEE(mr_adc, X_aaaa, X_abab, X_bbbb, sigma):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_cvs = mr_adc.mo_energy.x
        e_extern = mr_adc.mo_energy.e

        ## Excitation Manifolds
        s_caee__aaaa = mr_adc.h1.s_caee__aaaa
        f_caee__aaaa = mr_adc.h1.f_caee__aaaa
        s_caee__abab = mr_adc.h1.s_caee__abab
        f_caee__abab = mr_adc.h1.f_caee__abab
        s_caee__bbbb = mr_adc.h1.s_caee__bbbb
        f_caee__bbbb = mr_adc.h1.f_caee__bbbb

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        sigma_caee  = 1/2 * einsum('KxCD,C,Wx->KWCD', X_aaaa, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee += 1/2 * einsum('KxCD,D,Wx->KWCD', X_aaaa, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,K,Wx->KWCD', X_aaaa, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yz,Wz->KWCD', X_aaaa, h_aa, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yzwu,Wwzu->KWCD', X_aaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_caee__aaaa:f_caee__aaaa] += sigma_caee[:, :, ee_tril_ind[0], ee_tril_ind[1]].reshape(-1).copy()

        sigma_caee  = 1/2 * einsum('KxCD,C,Wx->KWCD', X_abab, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee += 1/2 * einsum('KxCD,D,Wx->KWCD', X_abab, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,K,Wx->KWCD', X_abab, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yz,Wz->KWCD', X_abab, h_aa, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yzwu,Wwzu->KWCD', X_abab, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_caee__abab:f_caee__abab] += sigma_caee.reshape(-1).copy()

        sigma_caee  = 1/2 * einsum('KxCD,C,Wx->KWCD', X_bbbb, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee += 1/2 * einsum('KxCD,D,Wx->KWCD', X_bbbb, e_extern, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,K,Wx->KWCD', X_bbbb, e_cvs, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yz,Wz->KWCD', X_bbbb, h_aa, rdm_ca, optimize = einsum_type)
        sigma_caee -= 1/2 * einsum('KxCD,yzwu,Wwzu->KWCD', X_bbbb, v_aaaa, rdm_ccaa, optimize = einsum_type)
        sigma[s_caee__bbbb:f_caee__bbbb] += sigma_caee[:, :, ee_tril_ind[0], ee_tril_ind[1]].reshape(-1).copy()


    # CAAA <- CAAA
    # CAEA <- CAEA

    if mr_adc.method == "mr-adc(2)-x": 
        print("sigma h1-h1 for 1st-order hamiltonian has not been implemented.")
        exit()

    # Compute sigma vector blocks
    ## Create empty sigma vector
    sigma = np.zeros_like(Xt)

    ## h0-h0 contributions
    sigma[:mr_adc.h0.dim] = np.dot(M_00, Xt[:mr_adc.h0.dim])

    # Non-orthogonal dimension indices
    s_ca__aa = mr_adc.h0.s_ca_aa
    f_ca__aa = mr_adc.h0.f_ca_aa
    s_ca__bb = mr_adc.h0.s_ca_bb
    f_ca__bb = mr_adc.h0.f_ca_bb
    s_ce__aa = mr_adc.h0.s_ce_aa
    f_ce__aa = mr_adc.h0.f_ce_aa
    s_ce__bb = mr_adc.h0.s_ce_bb
    f_ce__bb = mr_adc.h0.f_ce_bb

    s_ccaa__aaaa = mr_adc.h1.s_ccaa__aaaa
    f_ccaa__aaaa = mr_adc.h1.f_ccaa__aaaa
    s_ccaa__abab = mr_adc.h1.s_ccaa__abab
    f_ccaa__abab = mr_adc.h1.f_ccaa__abab
    s_ccaa__bbbb = mr_adc.h1.s_ccaa__bbbb
    f_ccaa__bbbb = mr_adc.h1.f_ccaa__bbbb
    
    s_ccea__aaaa = mr_adc.h1.s_ccea__aaaa
    f_ccea__aaaa = mr_adc.h1.f_ccea__aaaa
    s_ccea__abab = mr_adc.h1.s_ccea__abab
    f_ccea__abab = mr_adc.h1.f_ccea__abab
    s_ccea__bbbb = mr_adc.h1.s_ccea__bbbb
    f_ccea__bbbb = mr_adc.h1.f_ccea__bbbb
    
    s_ccee__aaaa = mr_adc.h1.s_ccee__aaaa
    f_ccee__aaaa = mr_adc.h1.f_ccee__aaaa
    s_ccee__abab = mr_adc.h1.s_ccee__abab
    f_ccee__abab = mr_adc.h1.f_ccee__abab
    
    s_caee__aaaa = mr_adc.h1.s_caee__aaaa
    f_caee__aaaa = mr_adc.h1.f_caee__aaaa
    s_caee__abab = mr_adc.h1.s_caee__abab
    f_caee__abab = mr_adc.h1.f_caee__abab
    s_caee__bbbb = mr_adc.h1.s_caee__bbbb
    f_caee__bbbb = mr_adc.h1.f_caee__bbbb
                          
    s_caaa__aaaa = mr_adc.h1.s_caaa__aaaa
    f_caaa__aaaa = mr_adc.h1.f_caaa__aaaa
    s_caaa__abab = mr_adc.h1.s_caaa__abab
    f_caaa__abab = mr_adc.h1.f_caaa__abab
    s_caaa__bbbb = mr_adc.h1.s_caaa__bbbb
    f_caaa__bbbb = mr_adc.h1.f_caaa__bbbb
                                         
    s_caea__aaaa = mr_adc.h1.s_caea__aaaa
    f_caea__aaaa = mr_adc.h1.f_caea__aaaa
    s_caea__abab = mr_adc.h1.s_caea__abab
    f_caea__abab = mr_adc.h1.f_caea__abab
    s_caea__bbbb = mr_adc.h1.s_caea__bbbb
    f_caea__bbbb = mr_adc.h1.f_caea__bbbb

    if nval is not None:
        s_cvaa__aaaa = mr_adc.h1.s_cvaa__aaaa
        f_cvaa__aaaa = mr_adc.h1.f_cvaa__aaaa
        s_cvaa__abab = mr_adc.h1.s_cvaa__abab
        f_cvaa__abab = mr_adc.h1.f_cvaa__abab
        s_cvaa__bbbb = mr_adc.h1.s_cvaa__bbbb
        f_cvaa__bbbb = mr_adc.h1.f_cvaa__bbbb
    
        s_cvea__aaaa = mr_adc.h1.s_cvea__aaaa
        f_cvea__aaaa = mr_adc.h1.f_cvea__aaaa
        s_cvea__abab = mr_adc.h1.s_cvea__abab
        f_cvea__abab = mr_adc.h1.f_cvea__abab
        s_cvea__bbbb = mr_adc.h1.s_cvea__bbbb
        f_cvea__bbbb = mr_adc.h1.f_cvea__bbbb
        
        s_cvee__aaaa = mr_adc.h1.s_cvee__aaaa
        f_cvee__aaaa = mr_adc.h1.f_cvee__aaaa
        s_cvee__abab = mr_adc.h1.s_cvee__abab
        f_cvee__abab = mr_adc.h1.f_cvee__abab
 

    ## h0-h1 and h1-h0 contributions
    ##WiP: all

    ## h1-h1 contributions
    ## WiP: CAEE, CAAA, CAEA
    # CCAA
    X_aaaa = np.zeros((ncvs, ncvs, ncas, ncas))
    temp = np.zeros((n_cc, ncas, ncas)) 

    temp[:,aa_tril_ind[0], aa_tril_ind[1]] +=  Xt[s_ccaa__aaaa:f_ccaa__aaaa].reshape(n_cc, n_aa)
    temp[:,aa_tril_ind[1], aa_tril_ind[0]] += -Xt[s_ccaa__aaaa:f_ccaa__aaaa].reshape(n_cc, n_aa)

    X_aaaa[cc_tril_ind[0], cc_tril_ind[1]] +=  temp
    X_aaaa[cc_tril_ind[1], cc_tril_ind[0]] += -temp

    X_abab = np.ascontiguousarray(Xt[s_ccaa__abab:f_ccaa__abab].reshape(ncvs, ncvs, ncas, ncas))

    compute_sigma_vector__H0__h1_h1__CCAA(mr_adc, X_aaaa, X_abab, sigma)

#    if mr_adc.method == "mr-adc(2)-x":
#        compute_sigma_vector__H1__h1_h1__CCAA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEE_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEE_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAAA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#        if nval is not None:
#            compute_sigma_vector__H1__h1_h1__CVAA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEA_CCAA(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEE_CCAA(mr_adc, X_aaaa, X_abab, sigma)
 
    # CCEA
    X_aaaa = np.zeros((ncvs, ncvs, nextern, ncas))
    X_aaaa[cc_tril_ind[0], cc_tril_ind[1]] =   Xt[s_ccea__aaaa:f_ccea__aaaa].reshape(-1, nextern, ncas).copy()
    X_aaaa[cc_tril_ind[1], cc_tril_ind[0]] =-  Xt[s_ccea__aaaa:f_ccea__aaaa].reshape(-1, nextern, ncas).copy()
   
    X_bbbb = np.zeros((ncvs, ncvs, nextern, ncas))
    X_bbbb[cc_tril_ind[0], cc_tril_ind[1]] =   Xt[s_ccea__bbbb:f_ccea__bbbb].reshape(-1, nextern, ncas).copy()
    X_bbbb[cc_tril_ind[1], cc_tril_ind[0]] =-  Xt[s_ccea__bbbb:f_ccea__bbbb].reshape(-1, nextern, ncas).copy()
 
    X_abab = np.ascontiguousarray(Xt[s_ccea__abab:f_ccea__abab].reshape(ncvs, ncvs, nextern, ncas))

    compute_sigma_vector__H0__h1_h1__CCEA(mr_adc, X_aaaa, X_abab, X_bbbb, sigma)

#    if mr_adc.method == "mr-adc(2)-x":
#        compute_sigma_vector__H1__h1_h1__CCAA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEE_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEE_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAAA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#        if nval is not None:
#            compute_sigma_vector__H1__h1_h1__CVAA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEA_CCEA(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEE_CCEA(mr_adc, X_aaaa, X_abab, sigma)
 
    # CCEE
    X_aaaa = np.zeros((ncvs, ncvs, nextern, nextern))
    temp = np.zeros((n_cc, nextern, nextern)) 

    temp[:,ee_tril_ind[0], ee_tril_ind[1]] +=  Xt[s_ccee__aaaa:f_ccee__aaaa].reshape(n_cc, n_ee)
    temp[:,ee_tril_ind[1], ee_tril_ind[0]] += -Xt[s_ccee__aaaa:f_ccee__aaaa].reshape(n_cc, n_ee)

    X_aaaa[cc_tril_ind[0], cc_tril_ind[1]] +=  temp
    X_aaaa[cc_tril_ind[1], cc_tril_ind[0]] += -temp

    X_abab = np.ascontiguousarray(Xt[s_ccee__abab:f_ccee__abab].reshape(ncvs, ncvs, nextern, nextern))
 
    compute_sigma_vector__H0__h1_h1__CCEE(mr_adc, X_aaaa, X_abab, sigma)

#    if mr_adc.method == "mr-adc(2)-x":
#        compute_sigma_vector__H1__h1_h1__CCAA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CCEE_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEE_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAAA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        compute_sigma_vector__H1__h1_h1__CAEA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#        if nval is not None:
#            compute_sigma_vector__H1__h1_h1__CVAA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEA_CCEE(mr_adc, X_aaaa, X_abab, sigma)
#            compute_sigma_vector__H1__h1_h1__CVEE_CCEE(mr_adc, X_aaaa, X_abab, sigma)
             
    return sigma

def compute_trans_moments(mr_adc):

    # Define functions to compute T blocks
    def compute_T__q0_h0__CA_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb

        # Compound indices
        n_ca = mr_adc.h0.n_ca

        T_ca_ca  = einsum('IP,QX->PQIX', np.identity(ncore)[:ncvs], np.identity(ncas), optimize = einsum_type)
        T_ca_ca -= 1/2 * einsum('IP,QX->PQIX', np.identity(ncore)[:ncvs], rdm_ca, optimize = einsum_type)

        T_ca_ca = T_ca_ca.reshape(T_ca_ca.shape[0], T_ca_ca.shape[1], n_ca)

        T[:ncore, ncore:ncore + ncas, s_ca_aa:f_ca_aa] += T_ca_ca
        T[:ncore, ncore:ncore + ncas, s_ca_bb:f_ca_bb] += T_ca_ca

    def compute_T__q0_h0__CE_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        T_ce_ce  = einsum('AQ,IP->PQIA', np.identity(nextern), np.identity(ncore)[:ncvs], optimize = einsum_type)
        
        T_ce_ce = T_ce_ce.reshape(T_ce_ce.shape[0], T_ce_ce.shape[1], n_ce)

        T[:ncore, ncore + ncas:ncore + ncas + nextern, s_ce_aa:f_ce_aa] += T_ce_ce
        T[:ncore, ncore + ncas:ncore + ncas + nextern, s_ce_bb:f_ce_bb] += T_ce_ce

    def compute_T__q1_h0__AA_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        
        ## Amplitudes
        t1_xa = mr_adc.t1.xa

        t1_xaaa = mr_adc.t1.xaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_aa_ca  = einsum('QX,IP->PQIX', np.identity(ncas), t1_xa, optimize = einsum_type)
        T_aa_ca -= 1/2 * einsum('IP,QX->PQIX', t1_xa, rdm_ca, optimize = einsum_type)
        T_aa_ca -= 1/2 * einsum('IQXx,Px->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca += 1/2 * einsum('IQxX,Px->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca -= 1/6 * einsum('IQxy,PXxy->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca += 1/6 * einsum('IQxy,PXyx->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca -= 1/2 * einsum('IxPX,Qx->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca -= 1/2 * einsum('IxPy,QyXx->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca += 1/2 * einsum('IxXP,Qx->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca += 1/6 * einsum('IxyP,QyXx->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca -= 1/6 * einsum('IxyP,QyxX->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca += einsum('QX,IxPy,xy->PQIX', np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca -= 1/2 * einsum('QX,IxyP,xy->PQIX', np.identity(ncas), t1_xaaa, rdm_ca, optimize = einsum_type)
        
        T_aa_ca = T_aa_ca.reshape(T_aa_ca.shape[0], T_aa_ca.shape[1], n_ca)

        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ca_aa:f_ca_aa] += T_aa_ca
        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ca_bb:f_ca_bb] += T_aa_ca

        # Delete block before making other spin case
        del T_aa_ca

        ## aa,bb || bb,aa
        T_aa_ca =- 1/2 * einsum('IQXx,Px->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca += 1/6 * einsum('IQxy,PXxy->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca += 1/3 * einsum('IQxy,PXyx->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca += 1/2 * einsum('IxXP,Qx->PQIX', t1_xaaa, rdm_ca, optimize = einsum_type)
        T_aa_ca -= 1/6 * einsum('IxyP,QyXx->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        T_aa_ca -= 1/3 * einsum('IxyP,QyxX->PQIX', t1_xaaa, rdm_ccaa, optimize = einsum_type)
        
        T_aa_ca = T_aa_ca.reshape(T_aa_ca.shape[0], T_aa_ca.shape[1], n_ca)

        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ca_aa:f_ca_aa] += T_aa_ca
        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ca_bb:f_ca_bb] += T_aa_ca

    def compute_T__q1_h0__AC_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        
        ## Amplitudes
        t1_xxaa = mr_adc.t1.xxaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_ac_ca =- einsum('IQPX->PQIX', t1_xxaa, optimize = einsum_type).copy()
        T_ac_ca += einsum('IQXP->PQIX', t1_xxaa, optimize = einsum_type).copy()
        T_ac_ca += 1/2 * einsum('IQPx,Xx->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca -= 1/2 * einsum('IQXx,Px->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca -= 1/2 * einsum('IQxP,Xx->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca += 1/2 * einsum('IQxX,Px->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca -= 1/6 * einsum('IQxy,PXxy->PQIX', t1_xxaa, rdm_ccaa, optimize = einsum_type)
        T_ac_ca += 1/6 * einsum('IQxy,PXyx->PQIX', t1_xxaa, rdm_ccaa, optimize = einsum_type)
        
        T_ac_ca = T_ac_ca.reshape(T_ac_ca.shape[0], T_ac_ca.shape[1], n_ca)

        T[ncore:ncore + ncas, :ncvs, s_ca_aa:f_ca_aa] += T_ac_ca
        T[ncore:ncore + ncas, :ncvs, s_ca_bb:f_ca_bb] += T_ac_ca

        # Delete block before making other spin case
        del T_ac_ca

        ## aa,bb || bb,aa
        T_ac_ca  = einsum('IQXP->PQIX', t1_xxaa, optimize = einsum_type).copy()
        T_ac_ca -= 1/2 * einsum('IQXx,Px->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca -= 1/2 * einsum('IQxP,Xx->PQIX', t1_xxaa, rdm_ca, optimize = einsum_type)
        T_ac_ca += 1/6 * einsum('IQxy,PXxy->PQIX', t1_xxaa, rdm_ccaa, optimize = einsum_type)
        T_ac_ca += 1/3 * einsum('IQxy,PXyx->PQIX', t1_xxaa, rdm_ccaa, optimize = einsum_type)
        
        T_ac_ca = T_ac_ca.reshape(T_ac_ca.shape[0], T_ac_ca.shape[1], n_ca)

        T[ncore:ncore + ncas, :ncvs, s_ca_aa:f_ca_aa] += T_ac_ca
        T[ncore:ncore + ncas, :ncvs, s_ca_bb:f_ca_bb] += T_ac_ca

    def compute_T__q1_h0__CC_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        
        ## Amplitudes
        t1_xa = mr_adc.t1.xa

        t1_xaaa = mr_adc.t1.xaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_cc_ca =- einsum('IP,QX->PQIX', np.identity(ncore)[:ncvs], t1_xa, optimize = einsum_type)
        T_cc_ca += 1/2 * einsum('IP,Qx,Xx->PQIX', np.identity(ncore)[:ncvs], t1_xa, rdm_ca, optimize = einsum_type)
        T_cc_ca -= einsum('IP,QxXy,xy->PQIX', np.identity(ncore)[:ncvs], t1_xaaa, rdm_ca, optimize = einsum_type)
        T_cc_ca += 1/2 * einsum('IP,QxyX,xy->PQIX', np.identity(ncore)[:ncvs], t1_xaaa, rdm_ca, optimize = einsum_type)
        T_cc_ca += 1/2 * einsum('IP,Qxyz,Xxyz->PQIX', np.identity(ncore)[:ncvs], t1_xaaa, rdm_ccaa, optimize = einsum_type)
        
        T_cc_ca = T_cc_ca.reshape(T_cc_ca.shape[0], T_cc_ca.shape[1], n_ca)

        T[:ncore, :ncvs, s_ca_aa:f_ca_aa] += T_cc_ca
        T[:ncore, :ncvs, s_ca_bb:f_ca_bb] += T_cc_ca

    def compute_T__q1_h0__CE_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_ae = mr_adc.t1.ae

        t1_aaae = mr_adc.t1.aaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_ce_ca  = einsum('IP,XQ->PQIX', np.identity(ncore)[:ncvs], t1_ae, optimize = einsum_type)
        T_ce_ca -= 1/2 * einsum('IP,XxyQ,yx->PQIX', np.identity(ncore)[:ncvs], t1_aaae, rdm_ca, optimize = einsum_type)
        T_ce_ca -= 1/2 * einsum('IP,xQ,Xx->PQIX', np.identity(ncore)[:ncvs], t1_ae, rdm_ca, optimize = einsum_type)
        T_ce_ca += einsum('IP,xXyQ,yx->PQIX', np.identity(ncore)[:ncvs], t1_aaae, rdm_ca, optimize = einsum_type)
        T_ce_ca -= 1/2 * einsum('IP,xyzQ,Xzyx->PQIX', np.identity(ncore)[:ncvs], t1_aaae, rdm_ccaa, optimize = einsum_type)
        
        T_ce_ca = T_ce_ca.reshape(T_ce_ca.shape[0], T_ce_ca.shape[1], n_ca)

        T[:ncore, ncore + ncas:ncore + ncas + nextern, s_ca_aa:f_ca_aa] += T_ce_ca
        T[:ncore, ncore + ncas:ncore + ncas + nextern, s_ca_bb:f_ca_bb] += T_ce_ca

    def compute_T__q1_h0__EA_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xe = mr_adc.t1.xe

        t1_xaea = mr_adc.t1.xaea
        t1_xaae = mr_adc.t1.xaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca
        rdm_ccaa = mr_adc.rdm.ccaa

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_ea_ca  = einsum('QX,IP->PQIX', np.identity(ncas), t1_xe, optimize = einsum_type)
        T_ea_ca -= 1/2 * einsum('IP,QX->PQIX', t1_xe, rdm_ca, optimize = einsum_type)
        T_ea_ca -= 1/2 * einsum('IxPX,Qx->PQIX', t1_xaea, rdm_ca, optimize = einsum_type)
        T_ea_ca -= 1/2 * einsum('IxPy,QyXx->PQIX', t1_xaea, rdm_ccaa, optimize = einsum_type)
        T_ea_ca += 1/2 * einsum('IxXP,Qx->PQIX', t1_xaae, rdm_ca, optimize = einsum_type)
        T_ea_ca += 1/6 * einsum('IxyP,QyXx->PQIX', t1_xaae, rdm_ccaa, optimize = einsum_type)
        T_ea_ca -= 1/6 * einsum('IxyP,QyxX->PQIX', t1_xaae, rdm_ccaa, optimize = einsum_type)
        T_ea_ca += einsum('QX,IxPy,xy->PQIX', np.identity(ncas), t1_xaea, rdm_ca, optimize = einsum_type)
        T_ea_ca -= 1/2 * einsum('QX,IxyP,xy->PQIX', np.identity(ncas), t1_xaae, rdm_ca, optimize = einsum_type)
        
        T_ea_ca = T_ea_ca.reshape(T_ea_ca.shape[0], T_ea_ca.shape[1], n_ca)

        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ca_aa:f_ca_aa] += T_ea_ca
        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ca_bb:f_ca_bb] += T_ea_ca

        # Delete block before making other spin case
        del T_ea_ca

        ## aa,bb || bb,aa
        T_ea_ca  = 1/2 * einsum('IxXP,Qx->PQIX', t1_xaae, rdm_ca, optimize = einsum_type)
        T_ea_ca -= 1/6 * einsum('IxyP,QyXx->PQIX', t1_xaae, rdm_ccaa, optimize = einsum_type)
        T_ea_ca -= 1/3 * einsum('IxyP,QyxX->PQIX', t1_xaae, rdm_ccaa, optimize = einsum_type)
        
        T_ea_ca = T_ea_ca.reshape(T_ea_ca.shape[0], T_ea_ca.shape[1], n_ca)

        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ca_aa:f_ca_aa] += T_ea_ca
        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ca_bb:f_ca_bb] += T_ea_ca
        
    def compute_T__q1_h0__EC_CA(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xxae = mr_adc.t1.xxae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ca_aa = mr_adc.h0.s_ca_aa
        f_ca_aa = mr_adc.h0.f_ca_aa
        s_ca_bb = mr_adc.h0.s_ca_bb
        f_ca_bb = mr_adc.h0.f_ca_bb
        
        # Compound indices
        n_ca = mr_adc.h0.n_ca

        ## aa,aa || bb,bb
        T_ec_ca  = einsum('IQXP->PQIX', t1_xxae, optimize = einsum_type).copy()
        T_ec_ca -= einsum('QIXP->PQIX', t1_xxae, optimize = einsum_type).copy()
        T_ec_ca -= 1/2 * einsum('IQxP,Xx->PQIX', t1_xxae, rdm_ca, optimize = einsum_type)
        T_ec_ca += 1/2 * einsum('QIxP,Xx->PQIX', t1_xxae, rdm_ca, optimize = einsum_type)
        
        T_ec_ca = T_ec_ca.reshape(T_ec_ca.shape[0], T_ec_ca.shape[1], n_ca)

        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ca_aa:f_ca_aa] += T_ec_ca
        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ca_bb:f_ca_bb] += T_ec_ca

        # Delete block before making other spin case
        del T_ec_ca

        ## aa,bb || bb,aa
        T_ec_ca  = einsum('IQXP->PQIX', t1_xxae, optimize = einsum_type).copy()
        T_ec_ca -= 1/2 * einsum('IQxP,Xx->PQIX', t1_xxae, rdm_ca, optimize = einsum_type)
        
        T_ec_ca = T_ec_ca.reshape(T_ec_ca.shape[0], T_ec_ca.shape[1], n_ca)

        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ca_aa:f_ca_aa] += T_ec_ca
        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ca_bb:f_ca_bb] += T_ec_ca
        
    def compute_T__q1_h0__AA_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xaea = mr_adc.t1.xaea
        t1_xaae = mr_adc.t1.xaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_aa_ce =- 1/2 * einsum('IQAx,Px->PQIA', t1_xaea, rdm_ca, optimize = einsum_type)
        T_aa_ce += 1/2 * einsum('IQxA,Px->PQIA', t1_xaae, rdm_ca, optimize = einsum_type)
        T_aa_ce += 1/2 * einsum('IxAP,Qx->PQIA', t1_xaea, rdm_ca, optimize = einsum_type)
        T_aa_ce -= 1/2 * einsum('IxPA,Qx->PQIA', t1_xaae, rdm_ca, optimize = einsum_type)
        
        T_aa_ce = T_aa_ce.reshape(T_aa_ce.shape[0], T_aa_ce.shape[1], n_ce)

        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ce_aa:f_ce_aa] += T_aa_ce
        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ce_bb:f_ce_bb] += T_aa_ce

        # Delete block before making other spin case
        del T_aa_ce

        ## aa,bb || bb,aa
        T_aa_ce =- 1/2 * einsum('IQAx,Px->PQIA', t1_xaea, rdm_ca, optimize = einsum_type)
        T_aa_ce += 1/2 * einsum('IxAP,Qx->PQIA', t1_xaea, rdm_ca, optimize = einsum_type)
        
        T_aa_ce = T_aa_ce.reshape(T_aa_ce.shape[0], T_aa_ce.shape[1], n_ce)

        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ce_aa:f_ce_aa] += T_aa_ce
        T[ncore:ncore + ncas, ncore:ncore + ncas, s_ce_bb:f_ce_bb] += T_aa_ce
        
    def compute_T__q1_h0__AC_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xxae = mr_adc.t1.xxae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ac_ce =- einsum('IQPA->PQIA', t1_xxae, optimize = einsum_type).copy()
        T_ac_ce += einsum('QIPA->PQIA', t1_xxae, optimize = einsum_type).copy()
        T_ac_ce += 1/2 * einsum('IQxA,Px->PQIA', t1_xxae, rdm_ca, optimize = einsum_type)
        T_ac_ce -= 1/2 * einsum('QIxA,Px->PQIA', t1_xxae, rdm_ca, optimize = einsum_type)
        
        T_ac_ce = T_ac_ce.reshape(T_ac_ce.shape[0], T_ac_ce.shape[1], n_ce)

        T[ncore:ncore + ncas, :ncvs, s_ce_aa:f_ce_aa] += T_ac_ce
        T[ncore:ncore + ncas, :ncvs, s_ce_bb:f_ce_bb] += T_ac_ce

        # Delete block before making other spin case
        del T_ac_ce

        ## aa,bb || bb,aa
        T_ac_ce  = einsum('QIPA->PQIA', t1_xxae, optimize = einsum_type).copy()
        T_ac_ce -= 1/2 * einsum('QIxA,Px->PQIA', t1_xxae, rdm_ca, optimize = einsum_type)
        
        T_ac_ce = T_ac_ce.reshape(T_ac_ce.shape[0], T_ac_ce.shape[1], n_ce)

        T[ncore:ncore + ncas, :ncvs, s_ce_aa:f_ce_aa] += T_ac_ce
        T[ncore:ncore + ncas, :ncvs, s_ce_bb:f_ce_bb] += T_ac_ce
        
    def compute_T__q1_h0__AE_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xa = mr_adc.t1.xa

        t1_xaaa = mr_adc.t1.xaaa

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ae_ce  = einsum('AQ,IP->PQIA', np.identity(nextern), t1_xa, optimize = einsum_type)
        T_ae_ce += einsum('AQ,IxPy,xy->PQIA', np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        T_ae_ce -= 1/2 * einsum('AQ,IxyP,xy->PQIA', np.identity(nextern), t1_xaaa, rdm_ca, optimize = einsum_type)
        
        T_ae_ce = T_ae_ce.reshape(T_ae_ce.shape[0], T_ae_ce.shape[1], n_ce)

        T[ncore:ncore + ncas, ncore + ncas:ncore + ncas + nextern, s_ce_aa:f_ce_aa] += T_ae_ce
        T[ncore:ncore + ncas, ncore + ncas:ncore + ncas + nextern, s_ce_bb:f_ce_bb] += T_ae_ce
        
    def compute_T__q1_h0__CA_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_ae = mr_adc.t1.ae

        t1_aaae = mr_adc.t1.aaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ca_ce =- einsum('IP,QA->PQIA', np.identity(ncore)[:ncvs], t1_ae, optimize = einsum_type)
        T_ca_ce += 1/2 * einsum('IP,QxyA,yx->PQIA', np.identity(ncore)[:ncvs], t1_aaae, rdm_ca, optimize = einsum_type)
        T_ca_ce -= einsum('IP,xQyA,yx->PQIA', np.identity(ncore)[:ncvs], t1_aaae, rdm_ca, optimize = einsum_type)
        
        T_ca_ce = T_ca_ce.reshape(T_ca_ce.shape[0], T_ca_ce.shape[1], n_ce)

        T[:ncore, ncore:ncore + ncas, s_ce_aa:f_ce_aa] += T_ca_ce
        T[:ncore, ncore:ncore + ncas, s_ce_bb:f_ce_bb] += T_ca_ce
        
    def compute_T__q1_h0__CC_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xe = mr_adc.t1.xe

        t1_xaea = mr_adc.t1.xaea
        t1_xaae = mr_adc.t1.xaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_cc_ce =- einsum('IP,QA->PQIA', np.identity(ncore)[:ncvs], t1_xe, optimize = einsum_type)
        T_cc_ce -= einsum('IP,QxAy,yx->PQIA', np.identity(ncore)[:ncvs], t1_xaea, rdm_ca, optimize = einsum_type)
        T_cc_ce += 1/2 * einsum('IP,QxyA,yx->PQIA', np.identity(ncore)[:ncvs], t1_xaae, rdm_ca, optimize = einsum_type)
        
        T_cc_ce = T_cc_ce.reshape(T_cc_ce.shape[0], T_cc_ce.shape[1], n_ce)

        T[:ncore, :ncvs, s_ce_aa:f_ce_aa] += T_cc_ce
        T[:ncore, :ncvs, s_ce_bb:f_ce_bb] += T_cc_ce
        
    def compute_T__q1_h0__EA_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xaee = mr_adc.t1.xaee

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ea_ce  = 1/2 * einsum('IxAP,Qx->PQIA', t1_xaee, rdm_ca, optimize = einsum_type)
        T_ea_ce -= 1/2 * einsum('IxPA,Qx->PQIA', t1_xaee, rdm_ca, optimize = einsum_type)
        
        T_ea_ce = T_ea_ce.reshape(T_ea_ce.shape[0], T_ea_ce.shape[1], n_ce)

        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ce_aa:f_ce_aa] += T_ea_ce
        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ce_bb:f_ce_bb] += T_ea_ce

        # Delete block before making other spin case
        del T_ea_ce

        ## aa,bb || bb,aa
        T_ea_ce  = 1/2 * einsum('IxAP,Qx->PQIA', t1_xaee, rdm_ca, optimize = einsum_type)
        
        T_ea_ce = T_ea_ce.reshape(T_ea_ce.shape[0], T_ea_ce.shape[1], n_ce)

        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ce_aa:f_ce_aa] += T_ea_ce
        T[ncore + ncas:ncore + ncas + nextern, ncore:ncore + ncas, s_ce_bb:f_ce_bb] += T_ea_ce
        
    def compute_T__q1_h0__EC_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xxee = mr_adc.t1.xxee

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ec_ce  = einsum('IQAP->PQIA', t1_xxee, optimize = einsum_type).copy()
        T_ec_ce -= einsum('QIAP->PQIA', t1_xxee, optimize = einsum_type).copy()
        
        T_ec_ce = T_ec_ce.reshape(T_ec_ce.shape[0], T_ec_ce.shape[1], n_ce)

        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ce_aa:f_ce_aa] += T_ec_ce
        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ce_bb:f_ce_bb] += T_ec_ce

        # Delete block before making other spin case
        del T_ec_ce

        ## aa,bb || bb,aa
        T_ec_ce  = einsum('IQAP->PQIA', t1_xxee, optimize = einsum_type).copy()
        
        T_ec_ce = T_ec_ce.reshape(T_ec_ce.shape[0], T_ec_ce.shape[1], n_ce)

        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ce_aa:f_ce_aa] += T_ec_ce
        T[ncore + ncas:ncore + ncas + nextern, :ncvs, s_ce_bb:f_ce_bb] += T_ec_ce
        
    def compute_T__q1_h0__EE_CE(mr_adc, T):

        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        # Variables from kernel
        ncvs    = mr_adc.ncvs
        ncore   = mr_adc.ncore
        ncas    = mr_adc.ncas
        nextern = mr_adc.nextern
        
        ## Amplitudes
        t1_xe = mr_adc.t1.xe

        t1_xaea = mr_adc.t1.xaea
        t1_xaae = mr_adc.t1.xaae

        # Reduced Density Matrices
        rdm_ca = mr_adc.rdm.ca

        # Dimensions
        s_ce_aa = mr_adc.h0.s_ce_aa
        f_ce_aa = mr_adc.h0.f_ce_aa
        s_ce_bb = mr_adc.h0.s_ce_bb
        f_ce_bb = mr_adc.h0.f_ce_bb
        
        # Compound indices
        n_ce = mr_adc.h0.n_ce

        ## aa,aa || bb,bb
        T_ee_ce  = einsum('AQ,IP->PQIA', np.identity(nextern), t1_xe, optimize = einsum_type)
        T_ee_ce += einsum('AQ,IxPy,xy->PQIA', np.identity(nextern), t1_xaea, rdm_ca, optimize = einsum_type)
        T_ee_ce -= 1/2 * einsum('AQ,IxyP,xy->PQIA', np.identity(nextern), t1_xaae, rdm_ca, optimize = einsum_type)
        
        T_ee_ce = T_ee_ce.reshape(T_ee_ce.shape[0], T_ee_ce.shape[1], n_ce)

        T[ncore + ncas:ncore + ncas + nextern, ncore + ncas:ncore + ncas + nextern, s_ce_aa:f_ce_aa] += T_ee_ce
        T[ncore + ncas:ncore + ncas + nextern, ncore + ncas:ncore + ncas + nextern, s_ce_bb:f_ce_bb] += T_ee_ce

    # Variables from kernel
    nmo = mr_adc.nmo

    # MR-ADC(0) terms
    if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x"):
        dim = mr_adc.h0.dim + mr_adc.h1.dim
    else:
        dim = mr_adc.h0.dim

    T = np.zeros((nmo, nmo, dim))

    # MR-ADC(0) terms
    ## < [ q^(0), h^(0)^\dag ] >
    ### CA(0) - CA
    compute_T__q0_h0__CA_CA(mr_adc, T)

    ### CE(0) - CE
    compute_T__q0_h0__CE_CE(mr_adc, T)

    # MR-ADC(1) terms
    ## < [ q^(1), h^(0)^\dag ] >
    ### AA(1) - CA
    compute_T__q1_h0__AA_CA(mr_adc, T)

    ### AC(1) - CA
    compute_T__q1_h0__AC_CA(mr_adc, T)

    ### CC(1) - CA
    compute_T__q1_h0__CC_CA(mr_adc, T)

    ### CE(1) - CA
    compute_T__q1_h0__CE_CA(mr_adc, T)

    ### EA(1) - CA
    compute_T__q1_h0__EA_CA(mr_adc, T)

    ### EC(1) - CA
    compute_T__q1_h0__EC_CA(mr_adc, T)

    ### AA(1) - CE
    compute_T__q1_h0__AA_CE(mr_adc, T)

    ### AC(1) - CE
    compute_T__q1_h0__AC_CE(mr_adc, T)

    ### AE(1) - CE
    compute_T__q1_h0__AE_CE(mr_adc, T)

    ### CA(1) - CE
    compute_T__q1_h0__CA_CE(mr_adc, T)

    ### CC(1) - CE
    compute_T__q1_h0__CC_CE(mr_adc, T)

    ### EA(1) - CE
    compute_T__q1_h0__EA_CE(mr_adc, T)

    ### EC(1) - CE
    compute_T__q1_h0__EC_CE(mr_adc, T)

    ### EE(1) - CE
    compute_T__q1_h0__EE_CE(mr_adc, T)
    
    # Reshape T tensor
    T = T.reshape(nmo ** 2, dim)

    # Transform to the orthogonal basis
    if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x"):
        T_ortho = np.zeros((T.shape[0], mr_adc.h_orth.dim))
        for p in range(T.shape[0]):
            T_ortho[p] = apply_S_12(mr_adc, T[p], transpose = True)
        T = T_ortho

    return T

def analyze_eigenvectors(mr_adc, E, spec_intensity, X):
  
    ##################################################
    ## WIP IN PROGRESS - NEEDS COMPLETION AND TESTING
    ##################################################

    # Definitions
    nmo     = mr_adc.nmo
    ncore   = mr_adc.ncore
    ncas    = mr_adc.ncas
    nextern = mr_adc.nextern
 
    # Define a threshold to display eigenvector contributions
    evec_thresh = 1e-5

    #### Loop through amount of roots requested
    for root in range(mr_adc.nroots):

        # List of relevant CAS MOs
        inds_cas_to_hf = []

        # Print header and excitation energy for each root
        print ('\n*******************************************')
        print ('                 Root #%s' % (root + 1)) 
        print ('*******************************************')
        print ('excitation energy:  %.8f a.u.' % E[root])
        print ('                   %.8f eV' % (E[root] * 27.2114))
        print ('\n    osc. strength:   %.8f' % ((2.0/3.0) * E[root] * spec_intensity[root]))

        X_root = X[root].copy()
        X_root = X_root ** 2

        # Obtain list to sort X_roots elements in descending order
        sorted_cont = np.argsort(-X_root)
        X_root = X_root[sorted_cont]

        # Only keep values above the threshold
        keep = X_root > evec_thresh

        # Slice
        X_root = X_root[keep]
        sorted_cont = sorted_cont[keep]

        for num, val in enumerate(sorted_cont):

            # Spin indices
            ind_one = val // nmo    
            ind_two = val % nmo

            # spatial (1-counting)
            ind_one_spat = ind_one + 1
            ind_two_spat = ind_two + 1

            if ind_one_spat not in inds_cas_to_hf:
                inds_cas_to_hf.append(ind_one_spat)
            elif ind_two_spat not in inds_cas_to_hf:
                inds_cas_to_hf.append(ind_two_spat)

            print ('\nMO %i -> MO %i' % (ind_one_spat, ind_two_spat))
            print ('Contribution weight: %.3f' % X_root[num])

        # Print HF contributions to CAS MOs
        if len(inds_cas_to_hf) > 0:
            cas_mo_to_hf_mo(mr_adc, inds_cas_to_hf)


def cas_mo_to_hf_mo(mr_adc, inds_cas_to_hf):

    from functools import reduce

    # Sort in order of increasing MO number
    inds_cas_to_hf.sort()

    # Overlap of CASSCF and HF spatial MO
    cas_hf_ovlp = reduce(np.dot, (mr_adc.mo.T, mr_adc.ovlp, mr_adc.mo_hf))
 
    # Threshold to print HF MO contributions to CASSCF MOs
    hf_print_thresh = 0.1

    # Print contributions of HF MOs to relevant CAS MOs 
    print ('\n-------------')
    for p in inds_cas_to_hf:
    
        hf_ovlp = cas_hf_ovlp[p-1]**2
        hf_ovlp_ind = np.argsort(hf_ovlp)[::-1]
        hf_ovlp_sorted = hf_ovlp[hf_ovlp_ind]
    
        print ("\nCASSCF MO #%d:" % (p))
    
        for hf_p in range(mr_adc.mo_hf.shape[1]):
            if (hf_ovlp_sorted[hf_p] > hf_print_thresh):
                print ("%.3f HF MO #%d" % (hf_ovlp_sorted[hf_p], hf_ovlp_ind[hf_p] + 1))
    print ('\n-------------')
