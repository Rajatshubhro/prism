import numpy as np

def compute_K_ac(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    K_ac  = einsum('XY->XY', h_aa, optimize = einsum_type).copy()
    K_ac += 2 * einsum('iYiX->XY', v_caca, optimize = einsum_type).copy()
    K_ac -= einsum('iYXi->XY', v_caac, optimize = einsum_type).copy()
    # K_ac -= 1/2 * einsum('Yx,Xx->XY', h_aa, rdm_ca, optimize = einsum_type)
    K_ac += einsum('xXyY,xy->XY', v_aaaa, rdm_ca, optimize = einsum_type)
    K_ac -= 1/2 * einsum('xXYy,xy->XY', v_aaaa, rdm_ca, optimize = einsum_type)
    K_ac -= 1/2 * einsum('xYzy,Xxyz->XY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K_ac += 1/2 * einsum('iYxi,Xx->XY', v_caac, rdm_ca, optimize = einsum_type)
    # K_ac -= einsum('iYix,Xx->XY', v_caca, rdm_ca, optimize = einsum_type)

    return K_ac

def compute_K_ca(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    K_ca =- 1/2 * einsum('Yx,Xx->XY', h_aa, rdm_ca, optimize = einsum_type)
    K_ca -= 1/2 * einsum('xYzy,Xxyz->XY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_ca += 1/2 * einsum('iYxi,Xx->XY', v_caac, rdm_ca, optimize = einsum_type)
    K_ca -= einsum('iYix,Xx->XY', v_caca, rdm_ca, optimize = einsum_type)

    return K_ca

def compute_K_aacc(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    K_aacc  = einsum('ZWYX->ZWYX', v_aaaa, optimize = einsum_type).copy()
    K_aacc += einsum('WX,YZ->ZWYX', h_aa, np.identity(ncas), optimize = einsum_type)
    K_aacc += einsum('YZ,WX->ZWYX', h_aa, np.identity(ncas), optimize = einsum_type)
    K_aacc -= 1/2 * einsum('WX,YZ->ZWYX', h_aa, rdm_ca, optimize = einsum_type)
    K_aacc += 1/6 * einsum('Xx,WZYx->ZWYX', h_aa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('Xx,WZxY->ZWYX', h_aa, rdm_ccaa, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('YZ,WX->ZWYX', h_aa, rdm_ca, optimize = einsum_type)
    K_aacc += 1/3 * einsum('Yx,WZXx->ZWYX', h_aa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('Yx,WZxX->ZWYX', h_aa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 2 * einsum('WX,iYiZ->ZWYX', np.identity(ncas), v_caca, optimize = einsum_type)
    K_aacc -= einsum('WX,iYZi->ZWYX', np.identity(ncas), v_caac, optimize = einsum_type)
    K_aacc += 2 * einsum('YZ,iXiW->ZWYX', np.identity(ncas), v_caca, optimize = einsum_type)
    K_aacc -= einsum('YZ,iXWi->ZWYX', np.identity(ncas), v_caac, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('ZWxX,Yx->ZWYX', v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('ZWYx,Xx->ZWYX', v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('xWYX,Zx->ZWYX', v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('xWyX,YxZy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('xWXy,YxZy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('xWXy,YxyZ->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('xWYy,XxZy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('xWYy,XxyZ->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc -= einsum('iWiX,YZ->ZWYX', v_caca, rdm_ca, optimize = einsum_type)
    K_aacc += 1/2 * einsum('iWXi,YZ->ZWYX', v_caac, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('YXZx,Wx->ZWYX', v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc += 1/3 * einsum('YXyx,WZxy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('YXyx,WZyx->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('xXZy,WxYy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('xXZy,WxyY->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/12 * einsum('xXzy,WZxYyz->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xXzy,WZxYzy->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc += 1/4 * einsum('xXzy,WZxyYz->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xXzy,WZxyzY->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xXzy,WZxzYy->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xXzy,WZxzyY->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/6 * einsum('iXxi,WZYx->ZWYX', v_caac, rdm_ccaa, optimize = einsum_type)
    K_aacc -= 1/3 * einsum('iXxi,WZxY->ZWYX', v_caac, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('iXix,WZYx->ZWYX', v_caca, rdm_ccaa, optimize = einsum_type)
    K_aacc += 2/3 * einsum('iXix,WZxY->ZWYX', v_caca, rdm_ccaa, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('xYyZ,WxXy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('xYZy,WxXy->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/6 * einsum('xYZy,WxyX->ZWYX', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/4 * einsum('xYzy,WZxXyz->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xYzy,WZxXzy->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc += 1/12 * einsum('xYzy,WZxyXz->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xYzy,WZxyzX->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xYzy,WZxzXy->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= 1/12 * einsum('xYzy,WZxzyX->ZWYX', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_aacc -= einsum('iYiZ,WX->ZWYX', v_caca, rdm_ca, optimize = einsum_type)
    K_aacc += 1/2 * einsum('iYZi,WX->ZWYX', v_caac, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/3 * einsum('iYxi,WZXx->ZWYX', v_caac, rdm_ccaa, optimize = einsum_type)
    K_aacc -= 1/6 * einsum('iYxi,WZxX->ZWYX', v_caac, rdm_ccaa, optimize = einsum_type)
    K_aacc += 2/3 * einsum('iYix,WZXx->ZWYX', v_caca, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/3 * einsum('iYix,WZxX->ZWYX', v_caca, rdm_ccaa, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('Xx,YZ,Wx->ZWYX', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('Yx,WX,Zx->ZWYX', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K_aacc += einsum('WX,xYyZ,xy->ZWYX', np.identity(ncas), v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('WX,xYZy,xy->ZWYX', np.identity(ncas), v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('WX,xYzy,Zxyz->ZWYX', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/2 * einsum('WX,iYxi,Zx->ZWYX', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K_aacc -= einsum('WX,iYix,Zx->ZWYX', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K_aacc += einsum('YZ,xWyX,xy->ZWYX', np.identity(ncas), v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('YZ,xWXy,xy->ZWYX', np.identity(ncas), v_aaaa, rdm_ca, optimize = einsum_type)
    K_aacc -= 1/2 * einsum('YZ,xXzy,Wxyz->ZWYX', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_aacc += 1/2 * einsum('YZ,iXxi,Wx->ZWYX', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K_aacc -= einsum('YZ,iXix,Wx->ZWYX', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)

    return K_aacc

def compute_K_ccaa(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac
    v_aaaa = mr_adc.v2e.aaaa

    K_ccaa =- 1/6 * einsum('Wx,XYZx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/3 * einsum('Wx,XYxZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/3 * einsum('Zx,WxXY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/6 * einsum('Zx,WxYX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/3 * einsum('ZWyx,XYxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/6 * einsum('ZWyx,XYyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/12 * einsum('xWzy,XYxZyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xWzy,XYxZzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa -= 1/4 * einsum('xWzy,XYxyZz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xWzy,XYxyzZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xWzy,XYxzZy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xWzy,XYxzyZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/6 * einsum('iWxi,XYZx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_ccaa += 1/3 * einsum('iWxi,XYxZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/3 * einsum('iWix,XYZx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 2/3 * einsum('iWix,XYxZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/4 * einsum('xZzy,WyzXYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xZzy,WyzXxY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa -= 1/12 * einsum('xZzy,WyzYXx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xZzy,WyzYxX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xZzy,WyzxXY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/12 * einsum('xZzy,WyzxYX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_ccaa += 1/3 * einsum('iZxi,WxXY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_ccaa += 1/6 * einsum('iZxi,WxYX->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 2/3 * einsum('iZix,WxXY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_ccaa -= 1/3 * einsum('iZix,WxYX->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)

    return K_ccaa

def compute_K_caca(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_caca = mr_adc.v2e.caca
    v_aaaa = mr_adc.v2e.aaaa

    import prism.mr_adc_integrals as mr_adc_integrals
    mo_c = mr_adc.mo[:, :mr_adc.ncore].copy()
    mo_a = mr_adc.mo[:, mr_adc.ncore:mr_adc.nocc].copy()
    v_acca = mr_adc_integrals.transform_2e_phys_incore(mr_adc.interface, mo_a, mo_c, mo_c, mo_a)

    # K_caca  = 1/3 * einsum('Wu,XuYZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/6 * einsum('Wu,XuZY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/3 * einsum('Zu,XWYu->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/6 * einsum('Zu,XWuY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/3 * einsum('Wiiu,XuYZ->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/6 * einsum('Wiiu,XuZY->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/12 * einsum('Wuvs,XvsYZu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/24 * einsum('Wuvs,XvsYuZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/24 * einsum('Wuvs,XvsZYu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/24 * einsum('Wuvs,XvsuZY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/3 * einsum('YZuv,XWuv->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/6 * einsum('YZuv,XWvu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/3 * einsum('Ziiu,XWYu->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/6 * einsum('Ziiu,XWuY->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/24 * einsum('Zuvs,WXuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/12 * einsum('Zuvs,WXusYv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/24 * einsum('Zuvs,WXusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/24 * einsum('Zuvs,WXuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 2/3 * einsum('iWiu,XuYZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/3 * einsum('iWiu,XuZY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 2/3 * einsum('iZiu,XWYu->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/3 * einsum('iZiu,XWuY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/6 * einsum('uWYv,XvZu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K_caca += 1/3 * einsum('uWYv,XvuZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K_caca -= 1/12 * einsum('uWvs,XvsYZu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/8 * einsum('uWvs,XvsYuZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/8 * einsum('uWvs,XvsZYu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/6 * einsum('uWvs,XvsuYZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/8 * einsum('uWvs,XvsuZY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/8 * einsum('uZvs,WXuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/4 * einsum('uZvs,WXusYv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca += 1/24 * einsum('uZvs,WXusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # K_caca -= 1/24 * einsum('uZvs,WXuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    # if mr_adc.debug_mode:
    #     print ("\n>>> SA K_caca norm: {:}".format(np.linalg.norm(K_caca)))
    #     print ("\n>> SA K_caca:\n{:}".format(K_caca))

    # Spin-summed
    K_caca  = 1/2 * einsum('WY,XZ->XYWZ', h_aa, rdm_ca, optimize = einsum_type)
    K_caca += 1/2 * einsum('Wu,XuYZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('Zu,WXYu->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('Zu,WXuY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/3 * einsum('Zu,XWYu->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('Zu,XWuY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/2 * einsum('WiiY,XZ->XYWZ', v_acca, rdm_ca, optimize = einsum_type)
    K_caca -= 1/2 * einsum('Wiiu,XuYZ->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('WuYv,XvZu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('WuYv,XvuZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/12 * einsum('Wuvs,XvsYZu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('Wuvs,XvsYuZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/12 * einsum('YZuv,WXuv->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('YZuv,WXvu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/3 * einsum('YZuv,XWuv->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('YZuv,XWvu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('YuvW,XuZv->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/3 * einsum('YuvW,XuvZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('ZYuv,WXuv->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/12 * einsum('ZYuv,WXvu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('Ziiu,WXYu->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('Ziiu,WXuY->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/3 * einsum('Ziiu,XWYu->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('Ziiu,XWuY->XYWZ', v_acca, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('Zuvs,WXuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('Zuvs,WXusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('Zuvs,WXuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/24 * einsum('Zuvs,XWuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('Zuvs,XWuYvs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('Zuvs,XWusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('Zuvs,XWuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += einsum('iWiY,XZ->XYWZ', v_caca, rdm_ca, optimize = einsum_type)
    K_caca += einsum('iWiu,XuYZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/3 * einsum('iZiu,WXYu->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/3 * einsum('iZiu,WXuY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca -= 2/3 * einsum('iZiu,XWYu->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/3 * einsum('iZiu,XWuY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uWYv,XvZu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('uWYv,XvuZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('uWvY,vXZu->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/3 * einsum('uWvY,vXuZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('uWvs,XvsYZu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/4 * einsum('uWvs,XvsYuZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uWvs,XvsZYu->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uWvs,XvsZuY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uWvs,XvsuYZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uWvs,XvsuZY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/8 * einsum('uZvs,WXuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('uZvs,WXusYv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('uZvs,WXusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/24 * einsum('uZvs,WXuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/8 * einsum('uZvs,XWuYsv->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/12 * einsum('uZvs,XWuYvs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/8 * einsum('uZvs,XWusvY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/8 * einsum('uZvs,XWuvYs->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca += 1/6 * einsum('uZvs,XWuvsY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca -= 1/2 * einsum('Zu,WY,Xu->XYWZ', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K_caca += 1/2 * einsum('WY,Ziiu,Xu->XYWZ', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K_caca += 1/12 * einsum('WY,Zuvs,Xusv->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/12 * einsum('WY,Zuvs,Xuvs->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= einsum('WY,iZiu,Xu->XYWZ', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K_caca -= 1/12 * einsum('WY,uZvs,Xusv->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca += 1/12 * einsum('WY,uZvs,Xuvs->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/6 * einsum('WY,uZvs,uXsv->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca -= 1/3 * einsum('WY,uZvs,uXvs->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    if mr_adc.debug_mode:
        print ("\n>>> SA K_caca norm: {:}".format(np.linalg.norm(K_caca)))
        print ("\n>> SA K_caca:\n{:}".format(K_caca))

    return K_caca

def compute_K_p1p(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas
    e_core = mr_adc.mo_energy.c

    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa

    import prism.mr_adc_integrals as mr_adc_integrals
    mo_c = mr_adc.mo[:, :mr_adc.ncore].copy()
    mo_a = mr_adc.mo[:, mr_adc.ncore:mr_adc.nocc].copy()
    v_acca = mr_adc_integrals.transform_2e_phys_incore(mr_adc.interface, mo_a, mo_c, mo_c, mo_a)
    v_caca = mr_adc_integrals.transform_2e_phys_incore(mr_adc.interface, mo_c, mo_a, mo_c, mo_a)

    n_x = ncas
    n_zwy = ncas**3
    dim_act = n_x + n_zwy

    K11  = 2 * einsum('yx->xy', h_aa, optimize = einsum_type).copy()
    K11 -= 2 * einsum('yiix->xy', v_acca, optimize = einsum_type).copy()
    K11 += 4 * einsum('iyix->xy', v_caca, optimize = einsum_type).copy()
    # K11 -= einsum('yz,zx->xy', h_aa, rdm_ca, optimize = einsum_type)
    K11 += 3/2 * einsum('xzyw,zw->xy', v_aaaa, rdm_ca, optimize = einsum_type)
    # K11 += einsum('yiiz,zx->xy', v_acca, rdm_ca, optimize = einsum_type)
    K11 -= 1/2 * einsum('yzwu,wuxz->xy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K11 -= 2 * einsum('iyiz,zx->xy', v_caca, rdm_ca, optimize = einsum_type)
    K11 -= einsum('zxyw,zw->xy', v_aaaa, rdm_ca, optimize = einsum_type)
    K11 += 1/2 * einsum('zxwy,zw->xy', v_aaaa, rdm_ca, optimize = einsum_type)
    K11 -= 1/2 * einsum('zywu,wuzx->xy', v_aaaa, rdm_ccaa, optimize = einsum_type)

    K12 =- einsum('wx,yz->xzwy', h_aa, rdm_ca, optimize = einsum_type)
    K12 -= einsum('wu,yuxz->xzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K12 += 2 * einsum('xy,wz->xzwy', h_aa, rdm_ca, optimize = einsum_type)
    K12 -= einsum('yu,wuzx->xzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K12 += einsum('zu,wyux->xzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K12 -= einsum('wyxu,uz->xzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K12 += 1/2 * einsum('wyux,uz->xzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K12 -= 1/2 * einsum('wyuv,uvzx->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += einsum('wiix,yz->xzwy', v_acca, rdm_ca, optimize = einsum_type)
    K12 += einsum('wiiu,yuxz->xzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K12 -= 2/3 * einsum('wuxv,yvzu->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 1/6 * einsum('wuxv,yvuz->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('wuvx,yvzu->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/3 * einsum('wuvx,yvuz->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/2 * einsum('wuvs,yvsxzu->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/2 * einsum('xzuv,wyvu->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 2 * einsum('xiiy,wz->xzwy', v_acca, rdm_ca, optimize = einsum_type)
    K12 += 3/2 * einsum('xuyv,wuzv->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 3/2 * einsum('ywxu,uz->xzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K12 -= 1/2 * einsum('ywuv,uvxz->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += einsum('yiiu,wuzx->xzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K12 += 1/6 * einsum('yuvs,wvsxzu->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('yuvs,wvsxuz->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/3 * einsum('yuvs,wvszxu->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('yuvs,wvszux->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('yuvs,wvsuxz->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('yuvs,wvsuzx->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/2 * einsum('zxuv,wyuv->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= einsum('ziiu,wyux->xzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('zuvs,wyuxsv->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('zuvs,wyuxvs->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('zuvs,wyusxv->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('zuvs,wyusvx->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/3 * einsum('zuvs,wyuvxs->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('zuvs,wyuvsx->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 2 * einsum('iwix,yz->xzwy', v_caca, rdm_ca, optimize = einsum_type)
    K12 -= 2 * einsum('iwiu,yuxz->xzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K12 += 4 * einsum('ixiy,wz->xzwy', v_caca, rdm_ca, optimize = einsum_type)
    K12 -= 2 * einsum('iyiu,wuzx->xzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K12 += 2 * einsum('iziu,wyux->xzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwxv,yvzu->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 2/3 * einsum('uwxv,yvuz->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/3 * einsum('uwvx,yvzu->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/6 * einsum('uwvx,yvuz->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwvs,yvsxzu->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= 1/3 * einsum('uwvs,yvsxuz->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwvs,yvszxu->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwvs,yvszux->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwvs,yvsuxz->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/6 * einsum('uwvs,yvsuzx->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 -= einsum('uxyv,wuzv->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 1/2 * einsum('uxvy,wuzv->xzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 1/2 * einsum('uyvs,wvszux->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 1/2 * einsum('uzvs,wyusxv->xzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12 += 2 * einsum('wu,xy,uz->xzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12 -= einsum('yu,wx,uz->xzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12 += einsum('zu,wx,yu->xzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12 -= 2 * einsum('zu,xy,wu->xzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12 += einsum('wx,yiiu,uz->xzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K12 -= 1/2 * einsum('wx,yuvs,vszu->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= einsum('wx,ziiu,yu->xzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K12 += 1/2 * einsum('wx,zuvs,yuvs->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 2 * einsum('wx,iyiu,uz->xzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12 += 2 * einsum('wx,iziu,yu->xzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12 -= 1/2 * einsum('wx,uyvs,vsuz->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 1/2 * einsum('wx,uzvs,yusv->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= 2 * einsum('xy,wiiu,uz->xzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K12 += einsum('xy,wuvs,vszu->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 2 * einsum('xy,ziiu,wu->xzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K12 -= einsum('xy,zuvs,wuvs->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 += 4 * einsum('xy,iwiu,uz->xzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12 -= 4 * einsum('xy,iziu,wu->xzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12 += einsum('xy,uwvs,vsuz->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12 -= einsum('xy,uzvs,wusv->xzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)

    K22 =- einsum('vw,uyzx->uvxzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('vy,uwxz->uvxzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('wx,uyvz->uvxzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('ws,uysvxz->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 2 * einsum('xy,uwvz->uvxzwy', h_aa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ys,uwsvxz->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('ys,uwsvzx->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ys,uwsxvz->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ys,uwsxzv->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ys,uwszvx->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ys,uwszxv->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('zs,uwyvxs->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('zs,uwyvsx->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('zs,uwyxvs->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('zs,uwyxsv->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('zs,uwysvx->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('zs,uwysxv->uvxzwy', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22 += 3/2 * einsum('vxwy,uz->uvxzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K22 -= 2/3 * einsum('vxws,uyzs->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vxws,uysz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('vxys,uwsz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vxsw,uyzs->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vxsw,uysz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vxsy,uwsz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vzst,uwystx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += einsum('viiw,uyzx->uvxzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('viiy,uwxz->uvxzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vswy,usxz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('vswy,uszx->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vswt,uysxzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vswt,uysxtz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('vswt,uyszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vswt,uysztx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('vswt,uystxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vswt,uystzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vsyw,usxz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vsyw,uszx->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('vsyt,uwsxzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vsyt,uwstzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vstw,uyszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vstw,uystxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vsty,uwsxtz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vsty,uwszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vsty,uwsztx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vsty,uwstxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vsty,uwstzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= einsum('wyxs,usvz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('wysx,usvz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wyst,ustvxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('wyst,ustvzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wyst,ustxvz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wyst,ustxzv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wyst,ustzvx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wyst,ustzxv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += einsum('wiix,uyvz->uvxzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('wiis,uysvxz->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('wsxt,uytvzs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wsxt,uytvsz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wstx,uytvsz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wstx,uytzvs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wstx,uytzsv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wstx,uytsvz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wstx,uytszv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('wstr,uytrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 13/60 * einsum('wstr,uytrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,uytrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/120 * einsum('wstr,uytrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,uytrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,uytrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('wstr,uytrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('wstr,uytrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/24 * einsum('wstr,uytrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,uytrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,uytrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,uytrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,uytrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,uytrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,uytrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('wstr,uytrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,uytrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('wstr,uytrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,uytrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('wstr,uytrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/8 * einsum('wstr,uytrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,uytrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,uytrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,utyrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,utyrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('wstr,utyrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,utyrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('wstr,utyrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,utyrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,utyrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('wstr,utyrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,utyrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,utyrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('wstr,utyrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,utyrsxzv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,utyrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,utyrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,yutrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('wstr,yutrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,yutrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,yutrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('wstr,yutrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('wstr,yutrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,yutrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('wstr,yutrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,yutrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('wstr,yutrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,yutrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('wstr,yutrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,yutrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,yutrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,yturvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('wstr,yturvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,yturvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,yturvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('wstr,yturvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,yturxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,yturxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('wstr,yturxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,yturzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('wstr,ytursvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,ytursvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,ytursxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,yturszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,yturszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,ruytvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,ruytvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('wstr,ruytvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,ruytvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('wstr,ruytvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('wstr,ruytxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,ruytxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,ruytxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,ruytxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('wstr,ruytxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,ruytzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('wstr,ruytzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,ruytzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('wstr,ruytsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,tuyrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,tuyrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,tuyrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('wstr,tuyrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('wstr,tuyrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,tuyrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('wstr,tuyrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,tuyrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('wstr,tuyrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,tuyrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('wstr,tuyrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,tuyrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('wstr,tuyrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('wstr,tuyrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,truyvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('wstr,truyvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,truyvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,truyvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,truyvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('wstr,truyxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('wstr,truyxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('wstr,truyxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,truyxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('wstr,truyxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('wstr,truyzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('wstr,truyzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('wstr,truyzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('wstr,truysvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= einsum('xvwy,uz->uvxzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K22 += 1/6 * einsum('xvws,uyzs->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('xvws,uysz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('xvyw,uz->uvxzwy', v_aaaa, rdm_ca, optimize = einsum_type)
    K22 += 3/2 * einsum('xvys,uwsz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xvsw,uyzs->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xvsw,uysz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xzst,uwyvst->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xzst,uwyvts->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xzst,uwysvt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xzst,uwystv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xzst,uwytvs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('xzst,uwytsv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2 * einsum('xiiy,uwvz->uvxzwy', v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += 3/2 * einsum('xsyt,uwsvzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 3/2 * einsum('ywxs,usvz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('ywst,ustvxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('yiis,uwsvxz->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('yiis,uwsvzx->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('yiis,uwsxvz->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('yiis,uwsxzv->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('yiis,uwszvx->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('yiis,uwszxv->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,uwtrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 23/120 * einsum('ystr,uwtrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,uwtrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,uwtrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,uwtrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,uwtrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,uwtrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,uwtrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/12 * einsum('ystr,uwtrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,uwtrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('ystr,uwtrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,uwtrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,uwtrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,uwtrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/40 * einsum('ystr,uwtrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('ystr,uwtrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,uwtrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,uwtrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('ystr,uwtrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,uwtrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('ystr,uwtrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('ystr,uwtrsxzv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('ystr,uwtrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,uwtrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('ystr,utwrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,utwrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,utwrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,utwrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,utwrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('ystr,utwrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,utwrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,utwrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('ystr,utwrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,utwrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,utwrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,utwrsxzv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,utwrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,utwrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,wutrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wutrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,wutrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('ystr,wutrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('ystr,wutrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wutrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('ystr,wutrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,wutrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,wutrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,wutrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('ystr,wutrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wutrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('ystr,wutrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wutrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('ystr,wturvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('ystr,wturvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('ystr,wturvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,wturvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('ystr,wturvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('ystr,wturxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,wturxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('ystr,wturxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wturzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,wtursvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,wtursvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,wtursxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('ystr,wturszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,wturszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,ruwtvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,ruwtvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('ystr,ruwtvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,ruwtvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('ystr,ruwtvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('ystr,ruwtxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,ruwtxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,ruwtxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,ruwtxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,ruwtxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,ruwtzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('ystr,ruwtzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,ruwtzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('ystr,ruwtsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,tuwrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('ystr,tuwrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,tuwrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,tuwrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('ystr,tuwrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('ystr,tuwrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,tuwrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('ystr,tuwrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,tuwrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('ystr,tuwrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,tuwrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('ystr,tuwrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,tuwrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('ystr,tuwrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,truwvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,truwvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('ystr,truwvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,truwvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,truwvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('ystr,truwxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,truwxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('ystr,truwxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('ystr,truwzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('ystr,truwzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('ystr,truwzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('ystr,truwzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('ystr,truwzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('ystr,truwsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('zvst,uwyxst->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('zvst,uwyxts->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('zvst,uwysxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('zvst,uwystx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('zvst,uwytxs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('zvst,uwytsx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('zxst,uwyvst->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ziis,uwyvxs->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('ziis,uwyvsx->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ziis,uwyxvs->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ziis,uwyxsv->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ziis,uwysvx->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('ziis,uwysxv->uvxzwy', v_acca, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('zstr,uwysvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('zstr,uwysvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,uwysvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,uwysvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('zstr,uwysvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,uwysvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,uwysxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,uwysxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/12 * einsum('zstr,uwysxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,uwysxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 11/60 * einsum('zstr,uwysxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('zstr,uwysxtrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,uwysrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('zstr,uwysrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/12 * einsum('zstr,uwysrxtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,uwysrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,uwysrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,uwystvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,uwystvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,uwystxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('zstr,uwystxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,uwystrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,uwystrxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,uywsvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,uywsvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('zstr,uywsvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('zstr,uywsxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('zstr,uywsrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('zstr,uywsrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,uywsrxtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,uywsrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,uywsrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,uywstvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,uywstxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,uywstxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,uywstrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,uywstrxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wuysvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,wuysvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('zstr,wuysvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,wuysvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('zstr,wuysvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('zstr,wuysxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wuysxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,wuysxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,wuysxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,wuysxtrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wuysrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('zstr,wuysrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wuysrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('zstr,wuystvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('zstr,wyusvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,wyusvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('zstr,wyusvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('zstr,wyusvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('zstr,wyusvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wyusxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('zstr,wyusxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('zstr,wyusxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,wyusrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,wyusrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wyusrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('zstr,wyusrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wyusrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,wyustvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,wsuyvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,wsuyvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wsuyvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,wsuyvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wsuyvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,wsuyxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,wsuyxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wsuyxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('zstr,wsuyxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('zstr,wsuyxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('zstr,wsuyrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('zstr,wsuytvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,wsuytvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('zstr,wsuytrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('zstr,yuwsvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,yuwsvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('zstr,yuwsvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,yuwsvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,yuwsvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('zstr,yuwsxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('zstr,yuwsrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,yuwsrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,yuwsrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('zstr,yuwstvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('zstr,yuwstvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,yuwstxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,yuwstxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,yuwstrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('zstr,suwyvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,suwyvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,suwyvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('zstr,suwyvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('zstr,suwyvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,suwyxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('zstr,suwyxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('zstr,suwyxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('zstr,suwyxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('zstr,suwyxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('zstr,suwyrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,suwytvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('zstr,suwytvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('zstr,suwytrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2 * einsum('iviw,uyzx->uvxzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('iviy,uwxz->uvxzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('iwix,uyvz->uvxzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('iwis,uysvxz->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 4 * einsum('ixiy,uwvz->uvxzwy', v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 2/3 * einsum('iyis,uwsvxz->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 4/3 * einsum('iyis,uwsvzx->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('iyis,uwsxvz->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('iyis,uwsxzv->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('iyis,uwszvx->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('iyis,uwszxv->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('izis,uwyvxs->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 += 4/3 * einsum('izis,uwyvsx->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('izis,uwyxvs->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('izis,uwyxsv->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('izis,uwysvx->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('izis,uwysxv->uvxzwy', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('svwy,usxz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svwy,uszx->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svwt,uyszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('svwt,uystxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('svyw,usxz->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('svyw,uszx->uvxzwy', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/3 * einsum('svyt,uwsxzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svyt,uwsxtz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svyt,uwszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svyt,uwsztx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svyt,uwstxz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('svyt,uwstzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svtw,uysxzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svtw,uysxtz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('svtw,uyszxt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svtw,uysztx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('svtw,uystzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('svty,uwsxzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('svty,uwstzx->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('swxt,uytvzs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('swxt,uytvsz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('swxt,uytzvs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('swxt,uytzsv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('swxt,uytsvz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('swxt,uytszv->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('swtx,uytvzs->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('swtx,uytvsz->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('swtr,uytrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 13/60 * einsum('swtr,uytrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,uytrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/120 * einsum('swtr,uytrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,uytrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,uytrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('swtr,uytrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,uytrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/24 * einsum('swtr,uytrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,uytrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,uytrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,uytrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('swtr,uytrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,uytrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,uytrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('swtr,uytrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,uytrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('swtr,uytrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,uytrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('swtr,uytrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/8 * einsum('swtr,uytrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,uytrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,uytrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,utyrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,utyrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('swtr,utyrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,utyrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,utyrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('swtr,utyrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('swtr,utyrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,utyrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,utyrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,utyrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,utyrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,utyrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,utyrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,utyrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,yutrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('swtr,yutrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,yutrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,yutrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('swtr,yutrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('swtr,yutrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,yutrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('swtr,yutrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,yutrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,yutrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,yutrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('swtr,yutrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,yutrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,yutrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,yturvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,yturvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('swtr,yturvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('swtr,yturvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,yturvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,yturxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,yturxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('swtr,yturxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,yturzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,yturzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,yturzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('swtr,yturzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,yturzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('swtr,ytursvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,ruytvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,ruytvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,ruytvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('swtr,ruytvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('swtr,ruytvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,ruytxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('swtr,ruytxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,ruytxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,ruytxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,ruytxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('swtr,ruytzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,ruytsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('swtr,ruytsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,ruytszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,tuyrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,tuyrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('swtr,tuyrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,tuyrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('swtr,tuyrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('swtr,tuyrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,tuyrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('swtr,tuyrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,tuyrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,tuyrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,tuyrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('swtr,tuyrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,tuyrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('swtr,tuyrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,truyvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('swtr,truyvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,truyvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,truyvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('swtr,truyvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('swtr,truyxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('swtr,truyxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('swtr,truyxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,truyxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('swtr,truyxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('swtr,truyzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('swtr,truyzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('swtr,truyzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('swtr,truysvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= einsum('sxyt,uwsvzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('sxty,uwsvzt->uvxzwy', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,uwtrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 23/120 * einsum('sytr,uwtrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,uwtrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,uwtrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,uwtrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,uwtrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,uwtrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,uwtrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/12 * einsum('sytr,uwtrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,uwtrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sytr,uwtrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,uwtrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,uwtrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,uwtrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/40 * einsum('sytr,uwtrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('sytr,uwtrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,uwtrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,uwtrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sytr,uwtrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,uwtrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('sytr,uwtrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sytr,uwtrsxzv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sytr,uwtrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,uwtrszxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,utwrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,utwrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sytr,utwrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,utwrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,utwrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sytr,utwrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sytr,utwrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,utwrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,utwrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,utwrzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,utwrzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,utwrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,utwrzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,utwrsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,wutrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wutrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,wutrvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('sytr,wutrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('sytr,wutrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wutrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('sytr,wutrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,wutrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,wutrxzsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,wutrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sytr,wutrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wutrsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('sytr,wutrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wutrszvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,wturvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('sytr,wturvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sytr,wturvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sytr,wturvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sytr,wturvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,wturxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,wturxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,wturxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sytr,wturxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wturxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,wturzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sytr,wturzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sytr,wturzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,wtursvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,ruwtvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('sytr,ruwtvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,ruwtvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,ruwtvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sytr,ruwtvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sytr,ruwtxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,ruwtzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('sytr,ruwtzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,ruwtzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,ruwtzxsv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,ruwtzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('sytr,ruwtsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,ruwtsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,ruwtsxvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,tuwrvxzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,tuwrvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('sytr,tuwrvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,tuwrvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('sytr,tuwrvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('sytr,tuwrxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,tuwrxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,tuwrxzvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,tuwrxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sytr,tuwrxszv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,tuwrzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('sytr,tuwrzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sytr,tuwrzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sytr,tuwrsvzx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,truwvxsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,truwvzxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sytr,truwvzsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,truwvsxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,truwvszx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sytr,truwxvzs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,truwxvsz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sytr,truwxsvz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sytr,truwzvxs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sytr,truwzvsx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sytr,truwzxvs->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sytr,truwzsvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sytr,truwzsxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sytr,truwsvxz->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 13/60 * einsum('sztr,uwysvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,uwysvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,uwysvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,uwysvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,uwysvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uwysxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sztr,uwysxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uwysxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,uwysxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,uwysxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uwysxtrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uwysrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,uwysrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('sztr,uwysrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uwysrxtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,uwystvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,uwystvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uwystxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('sztr,uwystxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,uwystrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,uwystrxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uywsvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uywsvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sztr,uywsvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sztr,uywsxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sztr,uywsrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sztr,uywsrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uywsrxtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,uywsrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,uywsrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uywstvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uywstxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uywstxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,uywstrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,uywstrxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,uswyvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uswyvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sztr,uswyvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uswyxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,uswyxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('sztr,uswyxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sztr,uswyxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uswyxtrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,uswyrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,uswyrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,uswyrxtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uswyrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,uswyrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,uswytxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,wuysvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wuysvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,wuysvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 2/15 * einsum('sztr,wuysvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/15 * einsum('sztr,wuysvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wuysxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 7/60 * einsum('sztr,wuysxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,wuysxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,wuysxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,wuysxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/5 * einsum('sztr,wuysrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wuystvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 3/20 * einsum('sztr,wuystvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wuystrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,wsuyvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,wsuyvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wsuyvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,wsuyvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wsuyvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,wsuyxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,wsuyxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wsuyxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sztr,wsuyxrtv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sztr,wsuyxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/40 * einsum('sztr,wsuyrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/40 * einsum('sztr,wsuytvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,wsuytvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/10 * einsum('sztr,wsuytrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('sztr,yuwsvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,yuwsvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sztr,yuwsvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,yuwsvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,yuwsvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sztr,yuwsxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('sztr,yuwsrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,yuwsrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,yuwsrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,yuwstvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('sztr,yuwstvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,yuwstxvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,yuwstxrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,yuwstrvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sztr,ysuwvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,ysuwvrxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sztr,ysuwvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sztr,ysuwvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sztr,ysuwvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,ysuwxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sztr,ysuwxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sztr,ysuwxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,ysuwrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,ysuwrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/20 * einsum('sztr,ysuwrxvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/10 * einsum('sztr,ysuwrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,ysuwrtxv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,ysuwtvxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,suwyvxrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/60 * einsum('sztr,suwyvxtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/15 * einsum('sztr,suwyvrtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,suwyvtxr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2/15 * einsum('sztr,suwyvtrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 7/60 * einsum('sztr,suwyxvrt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,suwyxvtr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/30 * einsum('sztr,suwyxrvt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 -= 1/60 * einsum('sztr,suwyxtvr->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/30 * einsum('sztr,suwyxtrv->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,suwyrvxt->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 3/20 * einsum('sztr,suwyrvtx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/20 * einsum('sztr,suwyrtvx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 1/5 * einsum('sztr,suwytvrx->uvxzwy', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22 += 2 * einsum('vw,xy,uz->uvxzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('vy,wx,uz->uvxzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('wx,vy,uz->uvxzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('ws,vy,usxz->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('ws,xy,usvz->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('xy,vw,uz->uvxzwy', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('ys,vw,uszx->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('ys,wx,usvz->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += einsum('zs,vw,uysx->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += einsum('zs,vy,uwxs->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += einsum('zs,wx,uyvs->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('zs,xy,uwvs->uvxzwy', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vw,xzst,uyts->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('vw,xiiy,uz->uvxzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K22 += 3/2 * einsum('vw,xsyt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('vw,yiis,uszx->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vw,ystr,utrxzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vw,ystr,utrxsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vw,ystr,utrzxs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vw,ystr,utrzsx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vw,ystr,utrsxz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vw,ystr,utrszx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vw,zxst,uyst->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('vw,ziis,uysx->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vw,zstr,uysxrt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vw,zstr,uysxtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vw,zstr,uysrxt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vw,zstr,uysrtx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('vw,zstr,uystxr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vw,zstr,uystrx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 4 * einsum('vw,ixiy,uz->uvxzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22 -= 2 * einsum('vw,iyis,uszx->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('vw,izis,uysx->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('vw,sxyt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vw,sxty,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('vw,sytr,utrzsx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vw,sztr,uysrxt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += einsum('vy,wiix,uz->uvxzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K22 += einsum('vy,wiis,usxz->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('vy,wsxt,utzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,wsxt,utsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,wstx,utzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vy,wstx,utsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('vy,wstr,utrxzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vy,xzst,uwst->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vy,zxst,uwts->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('vy,ziis,uwxs->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('vy,zstr,uwsxtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2 * einsum('vy,iwix,uz->uvxzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22 -= 2 * einsum('vy,iwis,usxz->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('vy,izis,uwxs->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swxt,utzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('vy,swxt,utsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vy,swtx,utzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,swtx,utsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swtr,utrxzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('vy,swtr,utrxsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swtr,utrzxs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swtr,utrzsx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swtr,utrsxz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('vy,swtr,utrszx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('vy,sztr,uwsxrt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,sztr,uwsxtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,sztr,uwsrxt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,sztr,uwsrtx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,sztr,uwstxr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('vy,sztr,uwstrx->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('wx,vzst,uyst->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('wx,viiy,uz->uvxzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K22 -= 2/3 * einsum('wx,vsyt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,vsyt,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,vsty,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('wx,vsty,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('wx,yiis,usvz->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/2 * einsum('wx,ystr,utrvzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/2 * einsum('wx,zvst,uyts->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('wx,ziis,uyvs->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('wx,zstr,uysvtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2 * einsum('wx,iviy,uz->uvxzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22 -= 2 * einsum('wx,iyis,usvz->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('wx,izis,uyvs->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,svyt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('wx,svyt,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('wx,svty,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,svty,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,sytr,utrvzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('wx,sytr,utrvsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,sytr,utrzvs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,sytr,utrzsv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,sytr,utrsvz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/6 * einsum('wx,sytr,utrszv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('wx,sztr,uysvrt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,sztr,uysvtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,sztr,uysrvt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,sztr,uysrtv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,sztr,uystvr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/6 * einsum('wx,sztr,uystrv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= einsum('xy,vzst,uwst->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('xy,viiw,uz->uvxzwy', np.identity(ncas), v_acca, rdm_ca, optimize = einsum_type)
    K22 += 4/3 * einsum('xy,vswt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,vswt,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,vstw,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 2/3 * einsum('xy,vstw,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 2 * einsum('xy,wiis,usvz->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 += einsum('xy,wstr,utrvzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= einsum('xy,zvst,uwts->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 2 * einsum('xy,ziis,uwvs->uvxzwy', np.identity(ncas), v_acca, rdm_ccaa, optimize = einsum_type)
    K22 -= einsum('xy,zstr,uwsvtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 4 * einsum('xy,iviw,uz->uvxzwy', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22 += 4 * einsum('xy,iwis,usvz->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= 4 * einsum('xy,izis,uwvs->uvxzwy', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,svwt,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 4/3 * einsum('xy,svwt,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 2/3 * einsum('xy,svtw,uszt->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,svtw,ustz->uvxzwy', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,swtr,utrvzs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 2/3 * einsum('xy,swtr,utrvsz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,swtr,utrzvs->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,swtr,utrzsv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,swtr,utrsvz->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 1/3 * einsum('xy,swtr,utrszv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2/3 * einsum('xy,sztr,uwsvrt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,sztr,uwsvtr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,sztr,uwsrvt->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,sztr,uwsrtv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,sztr,uwstvr->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 += 1/3 * einsum('xy,sztr,uwstrv->uvxzwy', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22 -= 2 * einsum('zs,vw,xy,us->uvxzwy', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 += einsum('zs,vy,wx,us->uvxzwy', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 += 2 * einsum('ziis,vw,xy,us->uvxzwy', v_acca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('ziis,vy,wx,us->uvxzwy', v_acca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('zstr,vw,xy,ustr->uvxzwy', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('zstr,vy,wx,ustr->uvxzwy', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 -= 4 * einsum('izis,vw,xy,us->uvxzwy', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 += 2 * einsum('izis,vy,wx,us->uvxzwy', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22 -= einsum('sztr,vw,xy,usrt->uvxzwy', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22 += 1/2 * einsum('sztr,vy,wx,usrt->uvxzwy', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)

    K_p1p = np.zeros((dim_act, dim_act))

    K_p1p[:n_x,:n_x] = K11.copy()
    K_p1p[:n_x,n_x:] = K12.reshape(n_x, n_zwy).copy()
    K_p1p[n_x:,:n_x] = K12.reshape(n_x, n_zwy).T.copy()
    K_p1p[n_x:,n_x:] = K22.reshape(n_zwy, n_zwy).copy()
    if mr_adc.debug_mode:
        print (">>> SA K11 norm: {:}".format(np.linalg.norm(K11)))
        print (">>> SA K12 norm: {:}".format(np.linalg.norm(K12)))
        print (">>> SA K22 norm: {:}".format(np.linalg.norm(K22)))

    return K_p1p

def compute_K_p1p_sanity_check(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas
    e_core = mr_adc.mo_energy.c

    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    n_x = ncas * 2
    n_xzw = ncas * 2 * ncas * 2 * (ncas * 2 - 1) // 2
    dim_act = n_x + n_xzw
    aa_ind = np.tril_indices(ncas * 2, k=-1)

    K11 = np.zeros((ncas * 2, ncas * 2))

    K11_a_a  = einsum('XY->XY', h_aa, optimize = einsum_type).copy()
    K11_a_a += 2 * einsum('iYiX->XY', v_caca, optimize = einsum_type).copy()
    K11_a_a -= einsum('iYXi->XY', v_caac, optimize = einsum_type).copy()
    # K11_a_a -= 1/2 * einsum('Yx,Xx->XY', h_aa, rdm_ca, optimize = einsum_type)
    K11_a_a += einsum('xXyY,xy->XY', v_aaaa, rdm_ca, optimize = einsum_type)
    K11_a_a -= 1/2 * einsum('xXYy,xy->XY', v_aaaa, rdm_ca, optimize = einsum_type)
    K11_a_a -= 1/2 * einsum('xYzy,Xxyz->XY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    # K11_a_a += 1/2 * einsum('iYxi,Xx->XY', v_caac, rdm_ca, optimize = einsum_type)
    # K11_a_a -= einsum('iYix,Xx->XY', v_caca, rdm_ca, optimize = einsum_type)

    K11[::2,::2] = K11_a_a.copy()
    K11[1::2,1::2] = K11_a_a.copy()

    K12 = np.zeros((ncas * 2, ncas * 2, ncas * 2, ncas * 2))

    K12_a_aaa =- 1/2 * einsum('WX,YZ->XZWY', h_aa, rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('Wx,XZYx->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Wx,XZxY->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('XY,WZ->XZWY', h_aa, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Yx,WxXZ->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('Yx,WxZX->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('Zx,WYXx->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Zx,WYxX->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('YWxX,Zx->XZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('YWXx,Zx->XZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('YWyx,XZxy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('YWyx,XZyx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('xWyX,YyZx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xWXy,YyZx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xWXy,YyxZ->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xWzy,XZxYyz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xWzy,XZxyYz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa -= einsum('iWiX,YZ->XZWY', v_caca, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('iWXi,YZ->XZWY', v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iWxi,XZYx->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iWxi,XZxY->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iWix,XZYx->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iWix,XZxY->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('ZXyx,WYxy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('ZXyx,WYyx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('xXyY,WxZy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xXYy,WxZy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xXYy,WxyZ->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += einsum('iXiY,WZ->XZWY', v_caca, rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('iXYi,WZ->XZWY', v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xYzy,WyzXZx->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xYzy,WyzZXx->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iYxi,WxXZ->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iYxi,WxZX->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iYix,WxXZ->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iYix,WxZX->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xZzy,WYxXyz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xZzy,WYxyXz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iZxi,WYXx->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iZxi,WYxX->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iZix,WYXx->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iZix,WYxX->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('Wx,XY,Zx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('Yx,WX,Zx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('Zx,WX,Yx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('Zx,XY,Wx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('WX,xYzy,Zxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('WX,iYxi,Zx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa -= einsum('WX,iYix,Zx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('WX,xZzy,Yxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('WX,iZxi,Yx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa += einsum('WX,iZix,Yx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('XY,xWzy,Zxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('XY,iWxi,Zx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa += einsum('XY,iWix,Zx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12_a_aaa -= 1/2 * einsum('XY,xZzy,Wxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/2 * einsum('XY,iZxi,Wx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_aaa -= einsum('XY,iZix,Wx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)

    K12_a_bba =- 1/3 * einsum('Wx,XZYx->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('Wx,XZxY->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('XY,WZ->XZWY', h_aa, rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('Yx,WxXZ->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('Yx,WxZX->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/6 * einsum('Zx,WYXx->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/3 * einsum('Zx,WYxX->XZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('YWXx,Zx->XZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('YWyx,XZxy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('YWyx,XZyx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('xWXy,YyZx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('xWXy,YyxZ->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/4 * einsum('xWzy,XZxYyz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xWzy,XZxYzy->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xWzy,XZxyYz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xWzy,XZxyzY->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xWzy,XZxzYy->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xWzy,XZxzyY->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/3 * einsum('iWxi,XZYx->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/6 * einsum('iWxi,XZxY->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 2/3 * einsum('iWix,XZYx->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('iWix,XZxY->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/6 * einsum('ZXyx,WYxy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/3 * einsum('ZXyx,WYyx->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('xXyY,WxZy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('xXYy,WxZy->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('xXYy,WxyZ->XZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += einsum('iXiY,WZ->XZWY', v_caca, rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/2 * einsum('iXYi,WZ->XZWY', v_caac, rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xYzy,WyzXZx->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xYzy,WyzXxZ->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/4 * einsum('xYzy,WyzZXx->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xYzy,WyzZxX->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xYzy,WyzxXZ->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xYzy,WyzxZX->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/6 * einsum('iYxi,WxXZ->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/3 * einsum('iYxi,WxZX->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('iYix,WxXZ->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 2/3 * einsum('iYix,WxZX->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/12 * einsum('xZzy,WYxXyz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xZzy,WYxXzy->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba += 1/4 * einsum('xZzy,WYxyXz->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xZzy,WYxyzX->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xZzy,WYxzXy->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/12 * einsum('xZzy,WYxzyX->XZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_bba -= 1/6 * einsum('iZxi,WYXx->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/3 * einsum('iZxi,WYxX->XZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/3 * einsum('iZix,WYXx->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 2/3 * einsum('iZix,WYxX->XZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('Wx,XY,Zx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/2 * einsum('Zx,XY,Wx->XZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('XY,xWzy,Zxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba -= 1/2 * einsum('XY,iWxi,Zx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_bba += einsum('XY,iWix,Zx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K12_a_bba -= 1/2 * einsum('XY,xZzy,Wxyz->XZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_bba += 1/2 * einsum('XY,iZxi,Wx->XZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K12_a_bba -= einsum('XY,iZix,Wx->XZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)

    K12[::2,::2,::2,::2] = K12_a_aaa.copy()
    K12[1::2,1::2,1::2,1::2] = K12_a_aaa.copy()

    K12[::2,1::2,1::2,::2] = K12_a_bba.copy()
    K12[1::2,::2,::2,1::2] = K12_a_bba.copy()

    K12[::2,1::2,::2,1::2] = - K12_a_bba.transpose(0,1,3,2).copy()
    K12[1::2,::2,1::2,::2] = - K12_a_bba.transpose(0,1,3,2).copy()

    K22 = np.zeros((ncas * 2, ncas * 2, ncas * 2, ncas * 2, ncas * 2, ncas * 2))

    K22_aaa_aaa  = 1/6 * einsum('VW,UYXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,UYZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,UWXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,UWZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,UYVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,UYZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UYxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UYxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UYxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,UWVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,UWZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UWxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UWxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UWxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UWYVxX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UWYXVx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UWYxXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('XVYW,UZ->UVXZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XVxW,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XVxW,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('XVWY,UZ->UVXZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XVxY,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XVxY,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XVWx,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XVWx,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XVYx,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XVYx,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZVyx,UWYXxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZVyx,UWYXyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZVyx,UWYxXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZVyx,UWYxyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZVyx,UWYyXx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZVyx,UWYyxX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xVYW,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xVYW,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xVyW,UYxXZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xVyW,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xVWY,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xVWY,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xVyY,UWxXZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xVyY,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVWy,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVWy,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVWy,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xVYy,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xVYy,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xVYy,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('iViW,UYXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('iViW,UYZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('iViY,UWXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('iViY,UWZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iVWi,UYXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iVWi,UYZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iVYi,UWXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iVYi,UWZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('YWxX,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('YWxX,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('YWXx,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('YWXx,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UxyVXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UxyVZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UxyXVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UxyXZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UxyZVX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UxyZXV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xWyX,UYyVZx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xWyX,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xWXy,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xWXy,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xWXy,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xWzy,UYyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xWzy,UYyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 5/24 * einsum('xWzy,UYyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 13/120 * einsum('xWzy,UYyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 19/120 * einsum('xWzy,UYyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('xWzy,UYyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xWzy,UYyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xWzy,UYyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UYyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xWzy,UYyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xWzy,UYyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xWzy,UYyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xWzy,UYyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UYyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xWzy,UYyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xWzy,UYyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('xWzy,UYyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UYyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/30 * einsum('xWzy,UYyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 2/15 * einsum('xWzy,UYyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('iWiX,UYVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('iWiX,UYZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWXi,UYVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iWXi,UYZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UYxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UYxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UYxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UYxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UYxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UYxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZXyx,UWYVxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZXyx,UWYVyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZXyx,UWYxVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZXyx,UWYxyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('ZXyx,UWYyVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('ZXyx,UWYyxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xXyY,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xXyY,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xXYy,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xXYy,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xXYy,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('iXiY,UWVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('iXiY,UWZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iXYi,UWVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iXYi,UWZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/40 * einsum('xYzy,UWyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 3/40 * einsum('xYzy,UWyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 5/24 * einsum('xYzy,UWyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 13/120 * einsum('xYzy,UWyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 19/120 * einsum('xYzy,UWyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('xYzy,UWyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xYzy,UWyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xYzy,UWyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UWyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/15 * einsum('xYzy,UWyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xYzy,UWyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xYzy,UWyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/40 * einsum('xYzy,UWyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UWyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('xYzy,UWyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 3/40 * einsum('xYzy,UWyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('xYzy,UWyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UWyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/30 * einsum('xYzy,UWyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 2/15 * einsum('xYzy,UWyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UWxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UWxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UWxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UWxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UWxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UWxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xZzy,UWYxVXyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xZzy,UWYxVXzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 5/24 * einsum('xZzy,UWYxVyXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/8 * einsum('xZzy,UWYxVyzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 17/120 * einsum('xZzy,UWYxVzXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('xZzy,UWYxVzyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xZzy,UWYxXVyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xZzy,UWYxXVzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xZzy,UWYxXyVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xZzy,UWYxXyzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xZzy,UWYxXzVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xZzy,UWYxXzyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UWYxyVXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UWYxyVzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UWYxyzVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xZzy,UWYxyzXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xZzy,UWYxzVXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/30 * einsum('xZzy,UWYxzVyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UWYxzXyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/20 * einsum('xZzy,UWYxzyVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 2/15 * einsum('xZzy,UWYxzyXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UWYVxX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UWYXVx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UWYxXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UWYVxX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UWYXVx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UWYxXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('VW,XY,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('VY,WX,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('WX,VY,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Wx,VY,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Wx,VY,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Wx,XY,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Wx,XY,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('XY,VW,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Yx,VW,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Yx,VW,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Yx,WX,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Yx,WX,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Zx,VW,UYXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Zx,VW,UYxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Zx,VY,UWXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Zx,VY,UWxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Zx,WX,UYVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Zx,WX,UYxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Zx,XY,UWVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Zx,XY,UWxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,ZXyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,ZXyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('VW,xXyY,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,xXYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,xXYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += einsum('VW,iXiY,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('VW,iXYi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,xYzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,xYzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,iYxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,iYxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VW,iYix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VW,iYix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,xZzy,UYxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,xZzy,UYxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VW,iZxi,UYXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VW,iZxi,UYxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VW,iZix,UYXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VW,iZix,UYxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('VY,xWyX,UyZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,xWXy,UyZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,xWXy,UyxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,xWzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,xWzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= einsum('VY,iWiX,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('VY,iWXi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,iWxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,iWxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VY,iWix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VY,iWix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,ZXyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,ZXyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,xZzy,UWxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,xZzy,UWxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VY,iZxi,UWXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VY,iZxi,UWxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VY,iZix,UWXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VY,iZix,UWxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,ZVyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,ZVyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('WX,xVyY,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,xVYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,xVYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= einsum('WX,iViY,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('WX,iVYi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,xYzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,xYzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,iYxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,iYxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('WX,iYix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('WX,iYix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,xZzy,UYxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,xZzy,UYxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('WX,iZxi,UYVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('WX,iZxi,UYxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('WX,iZix,UYVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('WX,iZix,UYxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,ZVyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,ZVyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('XY,xVyW,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,xVWy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,xVWy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += einsum('XY,iViW,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('XY,iVWi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,xWzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,xWzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,iWxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,iWxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('XY,iWix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('XY,iWix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,xZzy,UWxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,xZzy,UWxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('XY,iZxi,UWVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('XY,iZxi,UWxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('XY,iZix,UWVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('XY,iZix,UWxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('Zx,VW,XY,Ux->UVXZWY', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('Zx,VY,WX,Ux->UVXZWY', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('xZzy,VW,XY,Uxyz->UVXZWY', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('xZzy,VY,WX,Uxyz->UVXZWY', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/2 * einsum('iZxi,VW,XY,Ux->UVXZWY', v_caac, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= 1/2 * einsum('iZxi,VY,WX,Ux->UVXZWY', v_caac, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa -= einsum('iZix,VW,XY,Ux->UVXZWY', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aaa_aaa += einsum('iZix,VY,WX,Ux->UVXZWY', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)

    K22_aaa_bba =- 1/3 * einsum('VY,UWXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('VY,UWZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('Wx,UYxVXZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('Wx,UYxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('Wx,UYxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('Wx,UYxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('XY,UWVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('XY,UWZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('Yx,UWxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('Yx,UWxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('Yx,UWxXZV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('Yx,UWxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('Zx,UWYVxX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('Zx,UWYXVx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('Zx,UWYXxV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('Zx,UWYxXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('XVxY,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('XVxY,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('XVYx,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('XVYx,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('ZVyx,UWYXxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/8 * einsum('ZVyx,UWYXyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('ZVyx,UWYxXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/8 * einsum('ZVyx,UWYxyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('ZVyx,UWYyXx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('ZVyx,UWYyxX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('xVWY,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('xVWY,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('xVyY,UWxXZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('xVyY,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xVWy,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xVWy,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('xVWy,UYxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xVWy,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('xVYy,UWxXZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xVYy,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xVYy,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xVYy,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 2/3 * einsum('iViY,UWXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('iViY,UWZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('iVYi,UWXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iVYi,UWZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('YWXx,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('YWXx,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('YWyx,UxyVXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/8 * einsum('YWyx,UxyVZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('YWyx,UxyXVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/8 * einsum('YWyx,UxyXZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('YWyx,UxyZVX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('YWyx,UxyZXV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xWXy,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xWXy,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('xWXy,UYyxVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xWXy,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/10 * einsum('xWzy,UYyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 3/20 * einsum('xWzy,UYyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/40 * einsum('xWzy,UYyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 9/40 * einsum('xWzy,UYyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 7/60 * einsum('xWzy,UYyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/5 * einsum('xWzy,UYyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/120 * einsum('xWzy,UYyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/40 * einsum('xWzy,UYyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/20 * einsum('xWzy,UYyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/15 * einsum('xWzy,UYyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/10 * einsum('xWzy,UYyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/15 * einsum('xWzy,UYyzZXVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/20 * einsum('xWzy,UYyzZXxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 3/20 * einsum('xWzy,UYyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/60 * einsum('xWzy,UYyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 7/120 * einsum('xWzy,UYyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/40 * einsum('xWzy,UYyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/40 * einsum('xWzy,UYyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/40 * einsum('xWzy,UYyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/10 * einsum('xWzy,UYyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/30 * einsum('xWzy,UYyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iWxi,UYxVXZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('iWxi,UYxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('iWxi,UYxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('iWxi,UYxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('iWix,UYxVXZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iWix,UYxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iWix,UYxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iWix,UYxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('ZXyx,UWYVxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/8 * einsum('ZXyx,UWYVyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('ZXyx,UWYxVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/8 * einsum('ZXyx,UWYxyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('ZXyx,UWYyVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('ZXyx,UWYyxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('xXyY,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('xXyY,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('xXYy,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xXYy,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xXYy,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('xXYy,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 2/3 * einsum('iXiY,UWVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('iXiY,UWZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('iXYi,UWVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iXYi,UWZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 2/15 * einsum('xYzy,UWyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/30 * einsum('xYzy,UWyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 3/10 * einsum('xYzy,UWyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/10 * einsum('xYzy,UWyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/20 * einsum('xYzy,UWyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/10 * einsum('xYzy,UWyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/15 * einsum('xYzy,UWyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/60 * einsum('xYzy,UWyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 11/40 * einsum('xYzy,UWyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/24 * einsum('xYzy,UWyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/8 * einsum('xYzy,UWyzZXVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/24 * einsum('xYzy,UWyzZXxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/40 * einsum('xYzy,UWyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/8 * einsum('xYzy,UWyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('xYzy,UWyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/15 * einsum('xYzy,UWyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/60 * einsum('xYzy,UWyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/60 * einsum('xYzy,UWyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/20 * einsum('xYzy,UWyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/10 * einsum('xYzy,UWyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('iYxi,UWxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('iYxi,UWxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iYxi,UWxXZV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('iYxi,UWxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iYix,UWxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iYix,UWxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('iYix,UWxXZV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iYix,UWxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('xZzy,UWYxVXzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/10 * einsum('xZzy,UWYxVyXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 7/40 * einsum('xZzy,UWYxVyzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 3/20 * einsum('xZzy,UWYxVzXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 7/40 * einsum('xZzy,UWYxVzyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/120 * einsum('xZzy,UWYxXVyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 3/40 * einsum('xZzy,UWYxXVzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 11/120 * einsum('xZzy,UWYxyVXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/10 * einsum('xZzy,UWYxyVzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba += 1/15 * einsum('xZzy,UWYxyXVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/60 * einsum('xZzy,UWYxyXzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/40 * einsum('xZzy,UWYxyzVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 3/40 * einsum('xZzy,UWYxzVXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/10 * einsum('xZzy,UWYxzVyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/60 * einsum('xZzy,UWYxzXVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/60 * einsum('xZzy,UWYxzXyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/40 * einsum('xZzy,UWYxzyVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('iZxi,UWYVxX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('iZxi,UWYXVx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iZxi,UWYXxV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('iZxi,UWYxXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('iZix,UWYVxX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iZix,UWYXVx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('iZix,UWYXxV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('iZix,UWYxXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('Wx,VY,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('Wx,VY,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('Wx,XY,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('Wx,XY,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('Zx,VY,UWXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('Zx,VY,UWxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('Zx,XY,UWVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('Zx,XY,UWxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('VY,xWXy,UyZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('VY,xWXy,UyxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/4 * einsum('VY,xWzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('VY,xWzy,UyzXxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('VY,xWzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('VY,xWzy,UyzZxX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('VY,xWzy,UyzxXZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('VY,xWzy,UyzxZX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('VY,iWxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('VY,iWxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 2/3 * einsum('VY,iWix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('VY,iWix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('VY,ZXyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('VY,ZXyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/4 * einsum('VY,xZzy,UWxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('VY,xZzy,UWxXzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('VY,xZzy,UWxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('VY,xZzy,UWxyzX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('VY,xZzy,UWxzXy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('VY,xZzy,UWxzyX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('VY,iZxi,UWXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('VY,iZxi,UWxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 2/3 * einsum('VY,iZix,UWXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('VY,iZix,UWxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('XY,ZVyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('XY,ZVyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('XY,xVWy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('XY,xVWy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/4 * einsum('XY,xWzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('XY,xWzy,UyzVxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('XY,xWzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('XY,xWzy,UyzZxV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('XY,xWzy,UyzxVZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('XY,xWzy,UyzxZV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('XY,iWxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/6 * einsum('XY,iWxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 2/3 * einsum('XY,iWix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('XY,iWix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/4 * einsum('XY,xZzy,UWxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('XY,xZzy,UWxVzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba -= 1/12 * einsum('XY,xZzy,UWxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('XY,xZzy,UWxyzV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('XY,xZzy,UWxzVy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/12 * einsum('XY,xZzy,UWxzyV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_bba += 1/3 * einsum('XY,iZxi,UWVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba += 1/6 * einsum('XY,iZxi,UWxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 2/3 * einsum('XY,iZix,UWVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_bba -= 1/3 * einsum('XY,iZix,UWxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)

    K22_aab_aab =- 1/6 * einsum('VW,UYXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VW,UYZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Wx,UYxVXZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Wx,UYxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Wx,UYxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Wx,UYxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,UWVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,UWZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Yx,UWxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Yx,UWxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Yx,UWxZVX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Yx,UWxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Zx,UWYVxX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Zx,UWYXVx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Zx,UWYxVX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Zx,UWYxXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('XVYW,UZ->UVXZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('XVxW,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XVxW,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XVYx,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XVYx,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('ZVyx,UWYXxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('ZVyx,UWYXyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('ZVyx,UWYxXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('ZVyx,UWYxyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('ZVyx,UWYyXx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('ZVyx,UWYyxX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xVYW,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('xVYW,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVyW,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xVyW,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVyW,UYxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVyW,UYxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVyW,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xVWy,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xVWy,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xVWy,UYxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xVWy,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xVYy,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xVYy,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVYy,UWxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xVYy,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iViW,UYXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 2/3 * einsum('iViW,UYZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iVWi,UYXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('iVWi,UYZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('YWXx,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('YWXx,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YWyx,UxyVXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('YWyx,UxyVZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YWyx,UxyXVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YWyx,UxyXZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('YWyx,UxyZVX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YWyx,UxyZXV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xWXy,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xWXy,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xWXy,UYyZxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xWXy,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 3/10 * einsum('xWzy,UYyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xWzy,UYyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 2/15 * einsum('xWzy,UYyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xWzy,UYyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xWzy,UYyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/20 * einsum('xWzy,UYyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 11/40 * einsum('xWzy,UYyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('xWzy,UYyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('xWzy,UYyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('xWzy,UYyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xWzy,UYyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('xWzy,UYyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/15 * einsum('xWzy,UYyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xWzy,UYyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/15 * einsum('xWzy,UYyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xWzy,UYyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xWzy,UYyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xWzy,UYyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/60 * einsum('xWzy,UYyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/60 * einsum('xWzy,UYyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iWxi,UYxVXZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iWxi,UYxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iWxi,UYxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iWxi,UYxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iWix,UYxVXZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iWix,UYxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iWix,UYxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iWix,UYxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('ZXyx,UWYVxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('ZXyx,UWYVyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('ZXyx,UWYxVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('ZXyx,UWYxyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('ZXyx,UWYyVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('ZXyx,UWYyxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xXyY,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xXyY,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xXYy,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xXYy,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xXYy,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xXYy,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('iXiY,UWVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iXiY,UWZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iXYi,UWVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iXYi,UWZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xYzy,UWyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 9/40 * einsum('xYzy,UWyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xYzy,UWyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xYzy,UWyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/5 * einsum('xYzy,UWyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 7/60 * einsum('xYzy,UWyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/15 * einsum('xYzy,UWyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xYzy,UWyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/15 * einsum('xYzy,UWyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xYzy,UWyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xYzy,UWyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xYzy,UWyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/120 * einsum('xYzy,UWyzZXVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xYzy,UWyzZXxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xYzy,UWyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xYzy,UWyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 7/120 * einsum('xYzy,UWyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xYzy,UWyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xYzy,UWyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xYzy,UWyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xYzy,UWyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iYxi,UWxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iYxi,UWxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iYxi,UWxZVX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iYxi,UWxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iYix,UWxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iYix,UWxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('iYix,UWxZVX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iYix,UWxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xZzy,UWYxVXyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xZzy,UWYxVXzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/10 * einsum('xZzy,UWYxVyXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xZzy,UWYxVyzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xZzy,UWYxVzXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xZzy,UWYxVzyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 2/15 * einsum('xZzy,UWYxXVyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xZzy,UWYxXVzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 11/40 * einsum('xZzy,UWYxXyVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 7/60 * einsum('xZzy,UWYxXyzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('xZzy,UWYxXzVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xZzy,UWYxXzyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/60 * einsum('xZzy,UWYxyVzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/40 * einsum('xZzy,UWYxyXVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xZzy,UWYxyzVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/20 * einsum('xZzy,UWYxzVXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xZzy,UWYxzVyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 7/120 * einsum('xZzy,UWYxzXVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xZzy,UWYxzXyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/40 * einsum('xZzy,UWYxzyVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xZzy,UWYxzyXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iZxi,UWYVxX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iZxi,UWYXVx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iZxi,UWYxVX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iZxi,UWYxXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iZix,UWYVxX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iZix,UWYXVx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iZix,UWYxVX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iZix,UWYxXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('VW,XY,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Wx,XY,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Wx,XY,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('XY,VW,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Yx,VW,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('Yx,VW,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Zx,VW,UYXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('Zx,VW,UYxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Zx,XY,UWVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Zx,XY,UWxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VW,ZXyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('VW,ZXyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('VW,xXyY,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VW,xXYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VW,xXYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += einsum('VW,iXiY,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/2 * einsum('VW,iXYi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('VW,xYzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('VW,xYzy,UyzXxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/4 * einsum('VW,xYzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('VW,xYzy,UyzZxX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('VW,xYzy,UyzxXZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('VW,xYzy,UyzxZX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VW,iYxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('VW,iYxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VW,iYix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 2/3 * einsum('VW,iYix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('VW,xZzy,UYxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('VW,xZzy,UYxXzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/4 * einsum('VW,xZzy,UYxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('VW,xZzy,UYxyzX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('VW,xZzy,UYxzXy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('VW,xZzy,UYxzyX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VW,iZxi,UYXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VW,iZxi,UYxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('VW,iZix,UYXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 2/3 * einsum('VW,iZix,UYxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,ZVyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,ZVyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('XY,xVyW,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,xVWy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,xVWy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += einsum('XY,iViW,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/2 * einsum('XY,iVWi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,xWzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,xWzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,iWxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,iWxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('XY,iWix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('XY,iWix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,xZzy,UWxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,xZzy,UWxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('XY,iZxi,UWVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('XY,iZxi,UWxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('XY,iZix,UWVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('XY,iZix,UWxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/2 * einsum('Zx,VW,XY,Ux->UVXZWY', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aab_aab -= 1/2 * einsum('xZzy,VW,XY,Uxyz->UVXZWY', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/2 * einsum('iZxi,VW,XY,Ux->UVXZWY', v_caac, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_aab_aab -= einsum('iZix,VW,XY,Ux->UVXZWY', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)

    K22_baa_baa =- 1/6 * einsum('VW,UYXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VW,UYZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VY,UWXZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VY,UWZX->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('WX,UYVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('WX,UYZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Wx,UYxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Wx,UYxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Wx,UYxZVX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Wx,UYxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('XY,UWVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XY,UWZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Yx,UWxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Yx,UWxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Yx,UWxZVX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Yx,UWxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Zx,UWYVxX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Zx,UWYXVx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Zx,UWYxVX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Zx,UWYxXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('XVYW,UZ->UVXZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XVxW,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('XVxW,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('XVWY,UZ->UVXZWY', v_aaaa, rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('XVxY,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('XVxY,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('XVWx,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('XVWx,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XVYx,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('XVYx,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('ZVyx,UWYXxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('ZVyx,UWYXyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('ZVyx,UWYxXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('ZVyx,UWYxyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('ZVyx,UWYyXx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('ZVyx,UWYyxX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVYW,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('xVYW,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyW,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVyW,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyW,UYxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyW,UYxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyW,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVWY,UxXZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('xVWY,UxZX->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVyY,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyY,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVyY,UWxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVyY,UWxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVyY,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xVWy,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xVWy,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVWy,UYxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xVWy,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xVYy,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xVYy,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVYy,UWxZyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xVYy,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iViW,UYXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('iViW,UYZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iViY,UWXZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('iViY,UWZX->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iVWi,UYXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iVWi,UYZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iVYi,UWXZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iVYi,UWZX->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('YWxX,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('YWxX,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('YWXx,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('YWXx,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YWyx,UxyVXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YWyx,UxyVZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YWyx,UxyXVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YWyx,UxyXZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('YWyx,UxyZVX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('YWyx,UxyZXV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xWyX,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xWyX,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xWyX,UYyZxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xWyX,UYyxVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xWyX,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xWXy,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xWXy,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xWXy,UYyZxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xWXy,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/15 * einsum('xWzy,UYyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xWzy,UYyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 11/40 * einsum('xWzy,UYyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('xWzy,UYyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xWzy,UYyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/15 * einsum('xWzy,UYyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 2/15 * einsum('xWzy,UYyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/30 * einsum('xWzy,UYyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('xWzy,UYyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('xWzy,UYyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/60 * einsum('xWzy,UYyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/60 * einsum('xWzy,UYyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 3/10 * einsum('xWzy,UYyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xWzy,UYyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/20 * einsum('xWzy,UYyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xWzy,UYyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/20 * einsum('xWzy,UYyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xWzy,UYyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xWzy,UYyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('xWzy,UYyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iWiX,UYVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('iWiX,UYZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iWXi,UYVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iWXi,UYZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iWxi,UYxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iWxi,UYxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iWxi,UYxZVX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iWxi,UYxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iWix,UYxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iWix,UYxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iWix,UYxZVX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iWix,UYxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('ZXyx,UWYVxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('ZXyx,UWYVyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('ZXyx,UWYxVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('ZXyx,UWYxyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('ZXyx,UWYyVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('ZXyx,UWYyxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xXyY,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xXyY,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xXyY,UWxZyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xXyY,UWxyVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xXyY,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xXYy,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xXYy,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xXYy,UWxZyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xXYy,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iXiY,UWVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('iXiY,UWZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iXYi,UWVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iXYi,UWZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/15 * einsum('xYzy,UWyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/60 * einsum('xYzy,UWyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 11/40 * einsum('xYzy,UWyzVZXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('xYzy,UWyzVZxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xYzy,UWyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/15 * einsum('xYzy,UWyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 2/15 * einsum('xYzy,UWyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/30 * einsum('xYzy,UWyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('xYzy,UWyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('xYzy,UWyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xYzy,UWyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xYzy,UWyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/10 * einsum('xYzy,UWyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xYzy,UWyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/20 * einsum('xYzy,UWyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xYzy,UWyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/20 * einsum('xYzy,UWyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xYzy,UWyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/40 * einsum('xYzy,UWyzxZVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('xYzy,UWyzxZXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iYxi,UWxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iYxi,UWxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iYxi,UWxZVX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iYxi,UWxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iYix,UWxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iYix,UWxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iYix,UWxZVX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iYix,UWxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/120 * einsum('xZzy,UWYxVXyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/40 * einsum('xZzy,UWYxVXzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 11/120 * einsum('xZzy,UWYxVyXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xZzy,UWYxVyzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/40 * einsum('xZzy,UWYxVzXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xZzy,UWYxVzyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xZzy,UWYxXVzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/15 * einsum('xZzy,UWYxXyVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xZzy,UWYxXyzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xZzy,UWYxXzVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xZzy,UWYxXzyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xZzy,UWYxyVXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 7/40 * einsum('xZzy,UWYxyVzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xZzy,UWYxyzVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/20 * einsum('xZzy,UWYxzVXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 7/40 * einsum('xZzy,UWYxzVyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xZzy,UWYxzyVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iZxi,UWYVxX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iZxi,UWYXVx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iZxi,UWYxVX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iZxi,UWYxXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iZix,UWYVxX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iZix,UWYXVx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iZix,UWYxVX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iZix,UWYxXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('VW,XY,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('VY,WX,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('WX,VY,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Wx,VY,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('Wx,VY,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Wx,XY,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Wx,XY,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('XY,VW,UZ->UVXZWY', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Yx,VW,UxXZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Yx,VW,UxZX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Yx,WX,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('Yx,WX,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Zx,VW,UYXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('Zx,VW,UYxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Zx,VY,UWXx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Zx,VY,UWxX->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Zx,WX,UYVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Zx,WX,UYxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Zx,XY,UWVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('Zx,XY,UWxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VW,ZXyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VW,ZXyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('VW,xXyY,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VW,xXYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('VW,xXYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += einsum('VW,iXiY,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('VW,iXYi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VW,xYzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VW,xYzy,UyzXxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('VW,xYzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VW,xYzy,UyzZxX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VW,xYzy,UyzxXZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VW,xYzy,UyzxZX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VW,iYxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VW,iYxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VW,iYix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('VW,iYix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VW,xZzy,UYxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VW,xZzy,UYxXzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/4 * einsum('VW,xZzy,UYxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VW,xZzy,UYxyzX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VW,xZzy,UYxzXy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VW,xZzy,UYxzyX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('VW,iZxi,UYXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VW,iZxi,UYxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VW,iZix,UYXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('VW,iZix,UYxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('VY,xWyX,UyZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VY,xWXy,UyZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VY,xWXy,UyxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VY,xWzy,UyzXZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VY,xWzy,UyzXxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/4 * einsum('VY,xWzy,UyzZXx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VY,xWzy,UyzZxX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VY,xWzy,UyzxXZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VY,xWzy,UyzxZX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= einsum('VY,iWiX,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('VY,iWXi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('VY,iWxi,UxXZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VY,iWxi,UxZX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VY,iWix,UxXZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('VY,iWix,UxZX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('VY,ZXyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VY,ZXyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VY,xZzy,UWxXyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VY,xZzy,UWxXzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('VY,xZzy,UWxyXz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VY,xZzy,UWxyzX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VY,xZzy,UWxzXy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VY,xZzy,UWxzyX->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VY,iZxi,UWXx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VY,iZxi,UWxX->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VY,iZix,UWXx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('VY,iZix,UWxX->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('WX,ZVyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('WX,ZVyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('WX,xVyY,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('WX,xVYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('WX,xVYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= einsum('WX,iViY,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('WX,iVYi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('WX,xYzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('WX,xYzy,UyzVxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/4 * einsum('WX,xYzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('WX,xYzy,UyzZxV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('WX,xYzy,UyzxVZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('WX,xYzy,UyzxZV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('WX,iYxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('WX,iYxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('WX,iYix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('WX,iYix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('WX,xZzy,UYxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('WX,xZzy,UYxVzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('WX,xZzy,UYxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('WX,xZzy,UYxyzV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('WX,xZzy,UYxzVy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('WX,xZzy,UYxzyV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('WX,iZxi,UYVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('WX,iZxi,UYxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('WX,iZix,UYVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('WX,iZix,UYxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('XY,ZVyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('XY,ZVyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('XY,xVyW,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XY,xVWy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('XY,xVWy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += einsum('XY,iViW,UZ->UVXZWY', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('XY,iVWi,UZ->UVXZWY', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('XY,xWzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('XY,xWzy,UyzVxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('XY,xWzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('XY,xWzy,UyzZxV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('XY,xWzy,UyzxVZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('XY,xWzy,UyzxZV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('XY,iWxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('XY,iWxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XY,iWix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('XY,iWix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('XY,xZzy,UWxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('XY,xZzy,UWxVzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/4 * einsum('XY,xZzy,UWxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('XY,xZzy,UWxyzV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('XY,xZzy,UWxzVy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('XY,xZzy,UWxzyV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('XY,iZxi,UWVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('XY,iZxi,UWxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('XY,iZix,UWVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('XY,iZix,UWxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('Zx,VW,XY,Ux->UVXZWY', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('Zx,VY,WX,Ux->UVXZWY', h_aa, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('xZzy,VW,XY,Uxyz->UVXZWY', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('xZzy,VY,WX,Uxyz->UVXZWY', v_aaaa, np.identity(ncas), np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/2 * einsum('iZxi,VW,XY,Ux->UVXZWY', v_caac, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= 1/2 * einsum('iZxi,VY,WX,Ux->UVXZWY', v_caac, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa -= einsum('iZix,VW,XY,Ux->UVXZWY', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)
    K22_baa_baa += einsum('iZix,VY,WX,Ux->UVXZWY', v_caca, np.identity(ncas), np.identity(ncas), rdm_ca, optimize = einsum_type)

    K22_bba_aaa =- 1/3 * einsum('WX,UYVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('WX,UYZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('Wx,UYxVXZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('Wx,UYxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('Wx,UYxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('Wx,UYxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('XY,UWVZ->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('XY,UWZV->UVXZWY', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('Yx,UWxVXZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('Yx,UWxVZX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('Yx,UWxXVZ->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('Yx,UWxZXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('Zx,UWYVXx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('Zx,UWYVxX->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('Zx,UWYXVx->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('Zx,UWYxXV->UVXZWY', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('XVWx,UYZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('XVWx,UYxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('XVYx,UWZx->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('XVYx,UWxZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('ZVyx,UWYXxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('ZVyx,UWYXyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/8 * einsum('ZVyx,UWYxXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/8 * einsum('ZVyx,UWYxyX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('ZVyx,UWYyXx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('ZVyx,UWYyxX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xVWy,UYxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xVWy,UYxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('xVWy,UYxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xVWy,UYxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xVYy,UWxXyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xVYy,UWxZXy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('xVYy,UWxyXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xVYy,UWxyZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('YWxX,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('YWxX,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('YWXx,UxVZ->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('YWXx,UxZV->UVXZWY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/8 * einsum('YWyx,UxyVXZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/8 * einsum('YWyx,UxyVZX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('YWyx,UxyXVZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('YWyx,UxyXZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('YWyx,UxyZVX->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('YWyx,UxyZXV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('xWyX,UYyVZx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('xWyX,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('xWXy,UYyVZx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xWXy,UYyVxZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xWXy,UYyZVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xWXy,UYyxZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 3/10 * einsum('xWzy,UYyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/10 * einsum('xWzy,UYyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/20 * einsum('xWzy,UYyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/10 * einsum('xWzy,UYyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 11/40 * einsum('xWzy,UYyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('xWzy,UYyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/15 * einsum('xWzy,UYyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/60 * einsum('xWzy,UYyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/15 * einsum('xWzy,UYyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xWzy,UYyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/8 * einsum('xWzy,UYyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('xWzy,UYyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 2/15 * einsum('xWzy,UYyzZXVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/30 * einsum('xWzy,UYyzZXxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/60 * einsum('xWzy,UYyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/60 * einsum('xWzy,UYyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/40 * einsum('xWzy,UYyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/8 * einsum('xWzy,UYyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/10 * einsum('xWzy,UYyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/20 * einsum('xWzy,UYyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 2/3 * einsum('iWiX,UYVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('iWiX,UYZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('iWXi,UYVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iWXi,UYZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iWxi,UYxVXZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('iWxi,UYxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('iWxi,UYxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('iWxi,UYxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('iWix,UYxVXZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iWix,UYxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iWix,UYxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iWix,UYxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/8 * einsum('ZXyx,UWYVxy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/8 * einsum('ZXyx,UWYVyx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('ZXyx,UWYxVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('ZXyx,UWYxyV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('ZXyx,UWYyVx->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('ZXyx,UWYyxV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('xXyY,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('xXyY,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('xXYy,UWxVZy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xXYy,UWxVyZ->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xXYy,UWxZVy->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('xXYy,UWxyZV->UVXZWY', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 2/3 * einsum('iXiY,UWVZ->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('iXiY,UWZV->UVXZWY', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('iXYi,UWVZ->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iXYi,UWZV->UVXZWY', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 3/10 * einsum('xYzy,UWyzVXZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/10 * einsum('xYzy,UWyzVXxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/20 * einsum('xYzy,UWyzVxXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/10 * einsum('xYzy,UWyzVxZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 11/40 * einsum('xYzy,UWyzXVZx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/24 * einsum('xYzy,UWyzXVxZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/15 * einsum('xYzy,UWyzXZVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/60 * einsum('xYzy,UWyzXZxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/15 * einsum('xYzy,UWyzXxVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('xYzy,UWyzXxZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/8 * einsum('xYzy,UWyzZVXx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('xYzy,UWyzZVxX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 2/15 * einsum('xYzy,UWyzZXVx->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/30 * einsum('xYzy,UWyzZXxV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/60 * einsum('xYzy,UWyzZxVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/60 * einsum('xYzy,UWyzZxXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/40 * einsum('xYzy,UWyzxVXZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/8 * einsum('xYzy,UWyzxVZX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/10 * einsum('xYzy,UWyzxXVZ->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/20 * einsum('xYzy,UWyzxXZV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iYxi,UWxVXZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('iYxi,UWxVZX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('iYxi,UWxXVZ->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('iYxi,UWxZXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('iYix,UWxVXZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iYix,UWxVZX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iYix,UWxXVZ->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iYix,UWxZXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 3/10 * einsum('xZzy,UWYxVXyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/10 * einsum('xZzy,UWYxVXzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/20 * einsum('xZzy,UWYxVzXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/10 * einsum('xZzy,UWYxVzyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 11/40 * einsum('xZzy,UWYxXVyz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/24 * einsum('xZzy,UWYxXVzy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 3/40 * einsum('xZzy,UWYxXyVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/40 * einsum('xZzy,UWYxXyzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 7/120 * einsum('xZzy,UWYxXzVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 3/40 * einsum('xZzy,UWYxXzyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 2/15 * einsum('xZzy,UWYxyVXz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/20 * einsum('xZzy,UWYxyVzX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 3/20 * einsum('xZzy,UWYxyXVz->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/30 * einsum('xZzy,UWYxyXzV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/30 * einsum('xZzy,UWYxyzVX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/60 * einsum('xZzy,UWYxyzXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/30 * einsum('xZzy,UWYxzVXy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 7/60 * einsum('xZzy,UWYxzVyX->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/10 * einsum('xZzy,UWYxzXVy->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/30 * einsum('xZzy,UWYxzXyV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/60 * einsum('xZzy,UWYxzyXV->UVXZWY', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iZxi,UWYVXx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('iZxi,UWYVxX->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('iZxi,UWYXVx->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('iZxi,UWYxXV->UVXZWY', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('iZix,UWYVXx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('iZix,UWYVxX->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iZix,UWYXVx->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('iZix,UWYxXV->UVXZWY', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('Wx,XY,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('Wx,XY,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('Yx,WX,UxVZ->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('Yx,WX,UxZV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('Zx,WX,UYVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('Zx,WX,UYxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('Zx,XY,UWVx->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('Zx,XY,UWxV->UVXZWY', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('WX,ZVyx,UYxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('WX,ZVyx,UYyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('WX,xVYy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('WX,xVYy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/4 * einsum('WX,xYzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('WX,xYzy,UyzVxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('WX,xYzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('WX,xYzy,UyzZxV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('WX,xYzy,UyzxVZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('WX,xYzy,UyzxZV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('WX,iYxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('WX,iYxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 2/3 * einsum('WX,iYix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('WX,iYix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/4 * einsum('WX,xZzy,UYxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('WX,xZzy,UYxVzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('WX,xZzy,UYxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('WX,xZzy,UYxyzV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('WX,xZzy,UYxzVy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('WX,xZzy,UYxzyV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('WX,iZxi,UYVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('WX,iZxi,UYxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 2/3 * einsum('WX,iZix,UYVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('WX,iZix,UYxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('XY,ZVyx,UWxy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('XY,ZVyx,UWyx->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('XY,xVWy,UxZy->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('XY,xVWy,UxyZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/4 * einsum('XY,xWzy,UyzVZx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('XY,xWzy,UyzVxZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('XY,xWzy,UyzZVx->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('XY,xWzy,UyzZxV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('XY,xWzy,UyzxVZ->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('XY,xWzy,UyzxZV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('XY,iWxi,UxVZ->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/6 * einsum('XY,iWxi,UxZV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 2/3 * einsum('XY,iWix,UxVZ->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('XY,iWix,UxZV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/4 * einsum('XY,xZzy,UWxVyz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('XY,xZzy,UWxVzy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa -= 1/12 * einsum('XY,xZzy,UWxyVz->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('XY,xZzy,UWxyzV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('XY,xZzy,UWxzVy->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/12 * einsum('XY,xZzy,UWxzyV->UVXZWY', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_bba_aaa += 1/3 * einsum('XY,iZxi,UWVx->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa += 1/6 * einsum('XY,iZxi,UWxV->UVXZWY', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 2/3 * einsum('XY,iZix,UWVx->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_bba_aaa -= 1/3 * einsum('XY,iZix,UWxV->UVXZWY', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)

    K22[::2,::2,::2,::2,::2,::2] = K22_aaa_aaa.copy()
    K22[1::2,1::2,1::2,1::2,1::2,1::2] = K22_aaa_aaa.copy()

    K22[::2,::2,::2,1::2,1::2,::2] = K22_aaa_bba.copy()
    K22[1::2,1::2,1::2,::2,::2,1::2] = K22_aaa_bba.copy()

    K22[::2,::2,::2,1::2,::2,1::2] = - K22_aaa_bba.transpose(0,1,2,3,5,4).copy()
    K22[1::2,1::2,1::2,::2,1::2,::2] = - K22_aaa_bba.transpose(0,1,2,3,5,4).copy()

    K22[::2,::2,1::2,::2,::2,1::2] = K22_aab_aab.copy()
    K22[1::2,1::2,::2,1::2,1::2,::2] = K22_aab_aab.copy()

    K22[::2,1::2,::2,::2,1::2,::2] = K22_aab_aab.transpose(0,2,1,3,5,4).copy()
    K22[1::2,::2,1::2,1::2,::2,1::2] = K22_aab_aab.transpose(0,2,1,3,5,4).copy()

    K22[::2,1::2,::2,::2,::2,1::2] = - K22_aab_aab.transpose(0,2,1,3,4,5).copy()
    K22[1::2,::2,1::2,1::2,1::2,::2] = - K22_aab_aab.transpose(0,2,1,3,4,5).copy()

    K22[::2,::2,1::2,::2,1::2,::2] = - K22_aab_aab.transpose(0,1,2,3,5,4).copy()
    K22[1::2,1::2,::2,1::2,::2,1::2] = - K22_aab_aab.transpose(0,1,2,3,5,4).copy()

    K22[1::2,1::2,::2,::2,::2,::2] = K22_bba_aaa.copy()
    K22[::2,::2,1::2,1::2,1::2,1::2] = K22_bba_aaa.copy()

    K22[1::2,::2,1::2,::2,::2,::2] = - K22_bba_aaa.transpose(0,2,1,3,4,5).copy()
    K22[::2,1::2,::2,1::2,1::2,1::2] = - K22_bba_aaa.transpose(0,2,1,3,4,5).copy()

    K22[1::2,::2,::2,1::2,::2,::2] = K22_baa_baa.copy()
    K22[::2,1::2,1::2,::2,1::2,1::2] = K22_baa_baa.copy()

    K12 = K12[:,:,aa_ind[0],aa_ind[1]]
    K22 = K22[:,:,:,:,aa_ind[0],aa_ind[1]]
    K22 = K22[:,aa_ind[0],aa_ind[1]]

    K_p1p = np.zeros((dim_act, dim_act))

    K_p1p[:n_x,:n_x] = K11.copy()
    K_p1p[:n_x,n_x:] = K12.reshape(n_x, n_xzw).copy()
    K_p1p[n_x:,:n_x] = K12.reshape(n_x, n_xzw).T.copy()
    K_p1p[n_x:,n_x:] = K22.reshape(n_xzw, n_xzw).copy()

    return K_p1p

def compute_K_m1p_sanity_check(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas

    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    n_x = ncas * 2
    n_xzw = ncas * 2 * ncas * 2 * (ncas * 2 - 1) // 2
    dim_act = n_x + n_xzw
    aa_ind = np.tril_indices(ncas * 2, k=-1)

    K11 = np.zeros((ncas * 2, ncas * 2))

    K11_a_a =- 1/2 * einsum('Yx,Xx->XY', h_aa, rdm_ca, optimize = einsum_type)
    K11_a_a -= 1/2 * einsum('xYzy,Xxyz->XY', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K11_a_a += 1/2 * einsum('iYxi,Xx->XY', v_caac, rdm_ca, optimize = einsum_type)
    K11_a_a -= einsum('iYix,Xx->XY', v_caca, rdm_ca, optimize = einsum_type)

    K11[::2,::2] = K11_a_a.copy()
    K11[1::2,1::2] = K11_a_a.copy()

    K12 = np.zeros((ncas * 2, ncas * 2, ncas * 2, ncas * 2))

    K12_a_aaa =- 1/6 * einsum('Wx,XZYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Wx,XZxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Yx,WxXZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('Yx,WxZX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('Zx,WYXx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('Zx,WYxX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('YWyx,XZxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('YWyx,XZyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xWzy,XZxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xWzy,XZxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iWxi,XZYx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iWxi,XZxY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iWix,XZYx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iWix,XZxY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xYzy,WyzXZx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xYzy,WyzZXx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iYxi,WxXZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iYxi,WxZX->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iYix,WxXZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iYix,WxZX->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('xZzy,WYxXyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('xZzy,WYxyXz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_aaa += 1/6 * einsum('iZxi,WYXx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/6 * einsum('iZxi,WYxX->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa -= 1/3 * einsum('iZix,WYXx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_aaa += 1/3 * einsum('iZix,WYxX->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)

    K12_a_abb =- 1/3 * einsum('Wx,XZYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/6 * einsum('Wx,XZxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/6 * einsum('Yx,WxXZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/3 * einsum('Yx,WxZX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/6 * einsum('Zx,WYXx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/3 * einsum('Zx,WYxX->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/6 * einsum('YWyx,XZxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/3 * einsum('YWyx,XZyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/4 * einsum('xWzy,XZxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xWzy,XZxYzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xWzy,XZxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xWzy,XZxyzY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xWzy,XZxzYy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xWzy,XZxzyY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/3 * einsum('iWxi,XZYx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/6 * einsum('iWxi,XZxY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 2/3 * einsum('iWix,XZYx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/3 * einsum('iWix,XZxY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xYzy,WyzXZx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xYzy,WyzXxZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/4 * einsum('xYzy,WyzZXx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xYzy,WyzZxX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xYzy,WyzxXZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xYzy,WyzxZX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/6 * einsum('iYxi,WxXZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/3 * einsum('iYxi,WxZX->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/3 * einsum('iYix,WxXZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 2/3 * einsum('iYix,WxZX->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/12 * einsum('xZzy,WYxXyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xZzy,WYxXzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb += 1/4 * einsum('xZzy,WYxyXz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xZzy,WYxyzX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xZzy,WYxzXy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/12 * einsum('xZzy,WYxzyX->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K12_a_abb -= 1/6 * einsum('iZxi,WYXx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb -= 1/3 * einsum('iZxi,WYxX->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 1/3 * einsum('iZix,WYXx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K12_a_abb += 2/3 * einsum('iZix,WYxX->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)

    K12[::2,::2,::2,::2] = K12_a_aaa.copy()
    K12[1::2,1::2,1::2,1::2] = K12_a_aaa.copy()

    K12[::2,::2,1::2,1::2] = K12_a_abb.copy()
    K12[1::2,1::2,::2,::2] = K12_a_abb.copy()

    K12[::2,1::2,::2,1::2] = - K12_a_abb.transpose(0,2,1,3).copy()
    K12[1::2,::2,1::2,::2] = - K12_a_abb.transpose(0,2,1,3).copy()

    K22 = np.zeros((ncas * 2, ncas * 2, ncas * 2, ncas * 2, ncas * 2, ncas * 2))

    K22_aaa_aaa  = 1/6 * einsum('VZ,UXWY->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,UXYW->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UXZVxY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UXZYVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Wx,UXZxYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UXZVxW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UXZWVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('Yx,UXZxWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UXxVYW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UXxWVY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('Zx,UXxYWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('WVyx,UXZYxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('WVyx,UXZYyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('WVyx,UXZxYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('WVyx,UXZxyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('WVyx,UXZyYx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('WVyx,UXZyxY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YVyx,UXZWxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YVyx,UXZWyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YVyx,UXZxWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YVyx,UXZxyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YVyx,UXZyWx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YVyx,UXZyxW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('xVyZ,UXxWYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('xVyZ,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVZy,UXxWyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVZy,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xVZy,UXxyYW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('iViZ,UXWY->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('iViZ,UXYW->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iVZi,UXWY->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iVZi,UXYW->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UXZVxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UXZVyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UXZxVy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UXZxyV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('YWyx,UXZyVx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('YWyx,UXZyxV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xWzy,UXZxVYyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xWzy,UXZxVYzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 5/24 * einsum('xWzy,UXZxVyYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/8 * einsum('xWzy,UXZxVyzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 17/120 * einsum('xWzy,UXZxVzYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('xWzy,UXZxVzyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xWzy,UXZxYVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xWzy,UXZxYVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xWzy,UXZxYyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xWzy,UXZxYyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xWzy,UXZxYzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xWzy,UXZxYzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UXZxyVYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UXZxyVzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UXZxyzVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xWzy,UXZxyzYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xWzy,UXZxzVYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/30 * einsum('xWzy,UXZxzVyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xWzy,UXZxzYyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/20 * einsum('xWzy,UXZxzyVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 2/15 * einsum('xWzy,UXZxzyYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UXZVxY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UXZYVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iWxi,UXZxYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UXZVxY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UXZYVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iWix,UXZxYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/40 * einsum('xYzy,UXZxVWyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 3/40 * einsum('xYzy,UXZxVWzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 5/24 * einsum('xYzy,UXZxVyWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/8 * einsum('xYzy,UXZxVyzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 17/120 * einsum('xYzy,UXZxVzWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('xYzy,UXZxVzyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xYzy,UXZxWVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xYzy,UXZxWVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xYzy,UXZxWyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 3/40 * einsum('xYzy,UXZxWyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xYzy,UXZxWzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xYzy,UXZxWzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UXZxyVWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UXZxyVzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UXZxyzVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/15 * einsum('xYzy,UXZxyzWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/15 * einsum('xYzy,UXZxzVWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/30 * einsum('xYzy,UXZxzVyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xYzy,UXZxzWyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/20 * einsum('xYzy,UXZxzyVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 2/15 * einsum('xYzy,UXZxzyWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UXZVxW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UXZWVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('iYxi,UXZxWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UXZVxW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UXZWVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('iYix,UXZxWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xZzy,UXyzVWYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xZzy,UXyzVWxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 5/24 * einsum('xZzy,UXyzVYWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 13/120 * einsum('xZzy,UXyzVYxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 19/120 * einsum('xZzy,UXyzVxWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/24 * einsum('xZzy,UXyzVxYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xZzy,UXyzWVYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/120 * einsum('xZzy,UXyzWVxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UXyzWYVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/15 * einsum('xZzy,UXyzWYxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/60 * einsum('xZzy,UXyzWxVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/120 * einsum('xZzy,UXyzYVWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/40 * einsum('xZzy,UXyzYVxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UXyzYxVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/12 * einsum('xZzy,UXyzYxWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 3/40 * einsum('xZzy,UXyzxVWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/24 * einsum('xZzy,UXyzxVYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/60 * einsum('xZzy,UXyzxWYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/30 * einsum('xZzy,UXyzxYVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa += 2/15 * einsum('xZzy,UXyzxYWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UXxVYW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UXxWVY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/12 * einsum('iZxi,UXxYWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UXxVYW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UXxWVY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('iZix,UXxYWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Wx,VZ,UXYx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Wx,VZ,UXxY->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('Yx,VZ,UXWx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('Yx,VZ,UXxW->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,YWyx,UXxy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VZ,YWyx,UXyx->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VZ,xWzy,UXxYyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,xWzy,UXxyYz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,iWxi,UXYx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VZ,iWxi,UXxY->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VZ,iWix,UXYx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VZ,iWix,UXxY->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,xYzy,UXxWyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VZ,xYzy,UXxyWz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_aaa += 1/6 * einsum('VZ,iYxi,UXWx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/6 * einsum('VZ,iYxi,UXxW->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa -= 1/3 * einsum('VZ,iYix,UXWx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aaa_aaa += 1/3 * einsum('VZ,iYix,UXxW->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)

    K22_aaa_abb =- 1/6 * einsum('Wx,UXZVYx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('Wx,UXZVxY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('Wx,UXZYVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('Wx,UXZxYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('Yx,UXZVxW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('Yx,UXZWVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('Yx,UXZxVW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('Yx,UXZxWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('Zx,UXxVYW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('Zx,UXxWVY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('Zx,UXxYVW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('Zx,UXxYWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/8 * einsum('WVyx,UXZYxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('WVyx,UXZYyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/8 * einsum('WVyx,UXZxYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('WVyx,UXZxyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('WVyx,UXZyYx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('WVyx,UXZyxY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('YVyx,UXZWxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('YVyx,UXZWyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('YVyx,UXZxWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/8 * einsum('YVyx,UXZxyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('YVyx,UXZyWx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/8 * einsum('YVyx,UXZyxW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('xVZy,UXxWyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('xVZy,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('xVZy,UXxYyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('xVZy,UXxyYW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('YWyx,UXZVxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/8 * einsum('YWyx,UXZVyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('YWyx,UXZxVy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/24 * einsum('YWyx,UXZxyV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/8 * einsum('YWyx,UXZyVx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('YWyx,UXZyxV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/10 * einsum('xWzy,UXZxVYyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 3/20 * einsum('xWzy,UXZxVYzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 7/40 * einsum('xWzy,UXZxVyzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('xWzy,UXZxVzYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 7/40 * einsum('xWzy,UXZxVzyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/120 * einsum('xWzy,UXZxYyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 3/40 * einsum('xWzy,UXZxYzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/15 * einsum('xWzy,UXZxyVYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/40 * einsum('xWzy,UXZxyVzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 11/120 * einsum('xWzy,UXZxyYVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/10 * einsum('xWzy,UXZxyzVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/60 * einsum('xWzy,UXZxyzYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/60 * einsum('xWzy,UXZxzVYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/40 * einsum('xWzy,UXZxzVyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 3/40 * einsum('xWzy,UXZxzYVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/10 * einsum('xWzy,UXZxzyVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/60 * einsum('xWzy,UXZxzyYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iWxi,UXZVYx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('iWxi,UXZVxY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('iWxi,UXZYVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('iWxi,UXZxYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/3 * einsum('iWix,UXZVYx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iWix,UXZVxY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iWix,UXZYVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iWix,UXZxYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/20 * einsum('xYzy,UXZxVWyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/10 * einsum('xYzy,UXZxVWzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/10 * einsum('xYzy,UXZxVyWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/30 * einsum('xYzy,UXZxVyzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/10 * einsum('xYzy,UXZxVzWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/30 * einsum('xYzy,UXZxVzyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 2/15 * einsum('xYzy,UXZxWVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/30 * einsum('xYzy,UXZxWVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 11/40 * einsum('xYzy,UXZxWyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 7/60 * einsum('xYzy,UXZxWyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/24 * einsum('xYzy,UXZxWzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/20 * einsum('xYzy,UXZxWzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/60 * einsum('xYzy,UXZxyVzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/40 * einsum('xYzy,UXZxyWVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/40 * einsum('xYzy,UXZxyzVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/20 * einsum('xYzy,UXZxzVWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/60 * einsum('xYzy,UXZxzVyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 7/120 * einsum('xYzy,UXZxzWVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/30 * einsum('xYzy,UXZxzWyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/40 * einsum('xYzy,UXZxzyVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/10 * einsum('xYzy,UXZxzyWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('iYxi,UXZVxW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('iYxi,UXZWVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iYxi,UXZxVW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('iYxi,UXZxWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iYix,UXZVxW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iYix,UXZWVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/3 * einsum('iYix,UXZxVW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iYix,UXZxWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/40 * einsum('xZzy,UXyzVWYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 9/40 * einsum('xZzy,UXyzVWxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/10 * einsum('xZzy,UXyzVYWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/20 * einsum('xZzy,UXyzVYxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/5 * einsum('xZzy,UXyzVxWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 7/60 * einsum('xZzy,UXyzVxYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/15 * einsum('xZzy,UXyzWVYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/10 * einsum('xZzy,UXyzWVxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/15 * einsum('xZzy,UXyzWYVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/20 * einsum('xZzy,UXyzWYxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 3/20 * einsum('xZzy,UXyzWxVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/60 * einsum('xZzy,UXyzWxYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/120 * einsum('xZzy,UXyzYWVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/40 * einsum('xZzy,UXyzYWxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/20 * einsum('xZzy,UXyzYxVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/40 * einsum('xZzy,UXyzxVWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 7/120 * einsum('xZzy,UXyzxVYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/10 * einsum('xZzy,UXyzxWVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/30 * einsum('xZzy,UXyzxWYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/40 * einsum('xZzy,UXyzxYVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb += 1/40 * einsum('xZzy,UXyzxYWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/12 * einsum('iZxi,UXxVYW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('iZxi,UXxWVY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iZxi,UXxYVW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/12 * einsum('iZxi,UXxYWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb += 1/6 * einsum('iZix,UXxVYW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iZix,UXxWVY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/3 * einsum('iZix,UXxYVW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aaa_abb -= 1/6 * einsum('iZix,UXxYWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)

    K22_aab_aab  = 1/6 * einsum('VZ,UXWY->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,UXYW->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Wx,UXZVxY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Wx,UXZYVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Wx,UXZYxV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Wx,UXZxYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Yx,UXZVxW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Yx,UXZWVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Yx,UXZWxV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Yx,UXZxWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Zx,UXxVYW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('Zx,UXxWVY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Zx,UXxWYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('Zx,UXxYWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('WVyx,UXZYxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('WVyx,UXZYyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('WVyx,UXZxYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('WVyx,UXZxyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('WVyx,UXZyYx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('WVyx,UXZyxY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YVyx,UXZWxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('YVyx,UXZWyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YVyx,UXZxWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YVyx,UXZxyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('YVyx,UXZyWx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YVyx,UXZyxW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('xVyZ,UXxWYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xVyZ,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('xVZy,UXxWYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xVZy,UXxWyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('xVZy,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('xVZy,UXxyYW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('iViZ,UXWY->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iViZ,UXYW->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iVZi,UXWY->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iVZi,UXYW->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YWyx,UXZVxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YWyx,UXZVyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('YWyx,UXZxVy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/8 * einsum('YWyx,UXZxyV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('YWyx,UXZyVx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/8 * einsum('YWyx,UXZyxV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 2/15 * einsum('xWzy,UXZxVYyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xWzy,UXZxVYzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 11/40 * einsum('xWzy,UXZxVyYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 7/60 * einsum('xWzy,UXZxVyzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/24 * einsum('xWzy,UXZxVzYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/20 * einsum('xWzy,UXZxVzyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 3/20 * einsum('xWzy,UXZxYVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xWzy,UXZxYVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 3/10 * einsum('xWzy,UXZxYyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xWzy,UXZxYyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xWzy,UXZxYzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xWzy,UXZxYzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 3/40 * einsum('xWzy,UXZxyVYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xWzy,UXZxyYzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xWzy,UXZxyzYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 7/120 * einsum('xWzy,UXZxzVYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xWzy,UXZxzVyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xWzy,UXZxzYVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/60 * einsum('xWzy,UXZxzYyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xWzy,UXZxzyVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 3/40 * einsum('xWzy,UXZxzyYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iWxi,UXZVxY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iWxi,UXZYVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iWxi,UXZYxV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iWxi,UXZxYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iWix,UXZVxY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iWix,UXZYVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iWix,UXZYxV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iWix,UXZxYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 2/15 * einsum('xYzy,UXZxVWyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xYzy,UXZxVWzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 11/40 * einsum('xYzy,UXZxVyWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 7/60 * einsum('xYzy,UXZxVyzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/24 * einsum('xYzy,UXZxVzWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xYzy,UXZxVzyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xYzy,UXZxWVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xYzy,UXZxWVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/10 * einsum('xYzy,UXZxWyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xYzy,UXZxWyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xYzy,UXZxWzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xYzy,UXZxWzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/40 * einsum('xYzy,UXZxyVWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/60 * einsum('xYzy,UXZxyWzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xYzy,UXZxyzWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 7/120 * einsum('xYzy,UXZxzVWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/30 * einsum('xYzy,UXZxzVyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/20 * einsum('xYzy,UXZxzWVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xYzy,UXZxzWyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xYzy,UXZxzyVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/40 * einsum('xYzy,UXZxzyWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iYxi,UXZVxW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iYxi,UXZWVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iYxi,UXZWxV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iYxi,UXZxWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iYix,UXZVxW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iYix,UXZWVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('iYix,UXZWxV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iYix,UXZxWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/15 * einsum('xZzy,UXyzVWYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xZzy,UXyzVWxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/15 * einsum('xZzy,UXyzVYWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xZzy,UXyzVYxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xZzy,UXyzVxWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/60 * einsum('xZzy,UXyzVxYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xZzy,UXyzWVYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 9/40 * einsum('xZzy,UXyzWVxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/10 * einsum('xZzy,UXyzWYVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 3/20 * einsum('xZzy,UXyzWYxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/5 * einsum('xZzy,UXyzWxVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 7/60 * einsum('xZzy,UXyzWxYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/120 * einsum('xZzy,UXyzYVWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xZzy,UXyzYVxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/20 * einsum('xZzy,UXyzYxWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/10 * einsum('xZzy,UXyzxVWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/30 * einsum('xZzy,UXyzxVYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xZzy,UXyzxWVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 7/120 * einsum('xZzy,UXyzxWYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab -= 1/40 * einsum('xZzy,UXyzxYVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/40 * einsum('xZzy,UXyzxYWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iZxi,UXxVYW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/12 * einsum('iZxi,UXxWVY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iZxi,UXxWYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/12 * einsum('iZxi,UXxYWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iZix,UXxVYW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('iZix,UXxWVY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('iZix,UXxWYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('iZix,UXxYWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Wx,VZ,UXYx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Wx,VZ,UXxY->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('Yx,VZ,UXWx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('Yx,VZ,UXxW->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,YWyx,UXxy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VZ,YWyx,UXyx->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VZ,xWzy,UXxYyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,xWzy,UXxyYz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,iWxi,UXYx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VZ,iWxi,UXxY->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('VZ,iWix,UXYx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VZ,iWix,UXxY->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,xYzy,UXxWyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VZ,xYzy,UXxyWz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_aab_aab += 1/6 * einsum('VZ,iYxi,UXWx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/6 * einsum('VZ,iYxi,UXxW->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab -= 1/3 * einsum('VZ,iYix,UXWx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_aab_aab += 1/3 * einsum('VZ,iYix,UXxW->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)

    K22_abb_aaa =- 1/6 * einsum('Wx,UXZVYx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('Wx,UXZVxY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('Wx,UXZYVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('Wx,UXZxYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('Yx,UXZVWx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('Yx,UXZVxW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('Yx,UXZWVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('Yx,UXZxWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('Zx,UXxVWY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('Zx,UXxVYW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('Zx,UXxWVY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('Zx,UXxYWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('WVyx,UXZYxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('WVyx,UXZYyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/8 * einsum('WVyx,UXZxYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/8 * einsum('WVyx,UXZxyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('WVyx,UXZyYx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('WVyx,UXZyxY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('YVyx,UXZWxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('YVyx,UXZWyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/8 * einsum('YVyx,UXZxWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/8 * einsum('YVyx,UXZxyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('YVyx,UXZyWx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('YVyx,UXZyxW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('xVZy,UXxWyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('xVZy,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('xVZy,UXxyWY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('xVZy,UXxyYW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/8 * einsum('YWyx,UXZVxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/8 * einsum('YWyx,UXZVyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('YWyx,UXZxVy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('YWyx,UXZxyV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('YWyx,UXZyVx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('YWyx,UXZyxV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 3/10 * einsum('xWzy,UXZxVYyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/10 * einsum('xWzy,UXZxVYzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/20 * einsum('xWzy,UXZxVzYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/10 * einsum('xWzy,UXZxVzyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 11/40 * einsum('xWzy,UXZxYVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('xWzy,UXZxYVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 3/40 * einsum('xWzy,UXZxYyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/40 * einsum('xWzy,UXZxYyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 7/120 * einsum('xWzy,UXZxYzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 3/40 * einsum('xWzy,UXZxYzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 2/15 * einsum('xWzy,UXZxyVYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/20 * einsum('xWzy,UXZxyVzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 3/20 * einsum('xWzy,UXZxyYVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/30 * einsum('xWzy,UXZxyYzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/30 * einsum('xWzy,UXZxyzVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/60 * einsum('xWzy,UXZxyzYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/30 * einsum('xWzy,UXZxzVYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 7/60 * einsum('xWzy,UXZxzVyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/10 * einsum('xWzy,UXZxzYVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/30 * einsum('xWzy,UXZxzYyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/60 * einsum('xWzy,UXZxzyYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iWxi,UXZVYx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('iWxi,UXZVxY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('iWxi,UXZYVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('iWxi,UXZxYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/3 * einsum('iWix,UXZVYx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iWix,UXZVxY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iWix,UXZYVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iWix,UXZxYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 3/10 * einsum('xYzy,UXZxVWyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/10 * einsum('xYzy,UXZxVWzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/20 * einsum('xYzy,UXZxVzWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/10 * einsum('xYzy,UXZxVzyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 11/40 * einsum('xYzy,UXZxWVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('xYzy,UXZxWVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 3/40 * einsum('xYzy,UXZxWyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/40 * einsum('xYzy,UXZxWyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 7/120 * einsum('xYzy,UXZxWzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 3/40 * einsum('xYzy,UXZxWzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 2/15 * einsum('xYzy,UXZxyVWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/20 * einsum('xYzy,UXZxyVzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 3/20 * einsum('xYzy,UXZxyWVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/30 * einsum('xYzy,UXZxyWzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/30 * einsum('xYzy,UXZxyzVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/60 * einsum('xYzy,UXZxyzWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/30 * einsum('xYzy,UXZxzVWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 7/60 * einsum('xYzy,UXZxzVyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/10 * einsum('xYzy,UXZxzWVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/30 * einsum('xYzy,UXZxzWyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/60 * einsum('xYzy,UXZxzyWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iYxi,UXZVWx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('iYxi,UXZVxW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('iYxi,UXZWVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('iYxi,UXZxWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/3 * einsum('iYix,UXZVWx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iYix,UXZVxW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iYix,UXZWVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iYix,UXZxWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 3/10 * einsum('xZzy,UXyzVWYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/10 * einsum('xZzy,UXyzVWxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/20 * einsum('xZzy,UXyzVxWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/10 * einsum('xZzy,UXyzVxYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 11/40 * einsum('xZzy,UXyzWVYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/24 * einsum('xZzy,UXyzWVxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/15 * einsum('xZzy,UXyzWYVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/60 * einsum('xZzy,UXyzWYxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/15 * einsum('xZzy,UXyzWxVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('xZzy,UXyzWxYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/8 * einsum('xZzy,UXyzYVWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/24 * einsum('xZzy,UXyzYVxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 2/15 * einsum('xZzy,UXyzYWVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/30 * einsum('xZzy,UXyzYWxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/60 * einsum('xZzy,UXyzYxVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/60 * einsum('xZzy,UXyzYxWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/40 * einsum('xZzy,UXyzxVWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/8 * einsum('xZzy,UXyzxVYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/10 * einsum('xZzy,UXyzxWVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/20 * einsum('xZzy,UXyzxWYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iZxi,UXxVWY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/12 * einsum('iZxi,UXxVYW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('iZxi,UXxWVY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/12 * einsum('iZxi,UXxYWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/3 * einsum('iZix,UXxVWY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa += 1/6 * einsum('iZix,UXxVYW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iZix,UXxWVY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_abb_aaa -= 1/6 * einsum('iZix,UXxYWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)

    K22_baa_baa  = 1/3 * einsum('VZ,UXWY->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VZ,UXYW->XUVYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Wx,UXZVYx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Wx,UXZVxY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Wx,UXZYVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Wx,UXZxYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Yx,UXZVxW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Yx,UXZWVx->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('Yx,UXZWxV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Yx,UXZxWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('Zx,UXxVYW->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Zx,UXxWVY->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Zx,UXxWYV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('Zx,UXxYWV->XUVYWZ', h_aa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('WVyx,UXZYxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('WVyx,UXZYyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('WVyx,UXZxYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('WVyx,UXZxyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('WVyx,UXZyYx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('WVyx,UXZyxY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YVyx,UXZWxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('YVyx,UXZWyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YVyx,UXZxWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('YVyx,UXZxyW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YVyx,UXZyWx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YVyx,UXZyxW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('xVyZ,UXxWYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xVyZ,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('xVZy,UXxWYy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xVZy,UXxWyY->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('xVZy,UXxYWy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xVZy,UXxyYW->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 2/3 * einsum('iViZ,UXWY->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iViZ,UXYW->XUVYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iVZi,UXWY->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iVZi,UXYW->XUVYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YWyx,UXZVxy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/8 * einsum('YWyx,UXZVyx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YWyx,UXZxVy->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('YWyx,UXZxyV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('YWyx,UXZyVx->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('YWyx,UXZyxV->XUVYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 3/10 * einsum('xWzy,UXZxVYyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xWzy,UXZxVYzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 3/20 * einsum('xWzy,UXZxVyYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/30 * einsum('xWzy,UXZxVyzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xWzy,UXZxVzYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/30 * einsum('xWzy,UXZxVzyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 11/40 * einsum('xWzy,UXZxYVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('xWzy,UXZxYVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 2/15 * einsum('xWzy,UXZxYyVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/20 * einsum('xWzy,UXZxYyzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/30 * einsum('xWzy,UXZxYzVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 7/60 * einsum('xWzy,UXZxYzyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 3/40 * einsum('xWzy,UXZxyVYz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xWzy,UXZxyVzY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xWzy,UXZxyzVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 7/120 * einsum('xWzy,UXZxzVYy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 3/40 * einsum('xWzy,UXZxzVyY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/20 * einsum('xWzy,UXZxzYVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xWzy,UXZxzYyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/60 * einsum('xWzy,UXZxzyVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/30 * einsum('xWzy,UXZxzyYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iWxi,UXZVYx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iWxi,UXZVxY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iWxi,UXZYVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iWxi,UXZxYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iWix,UXZVYx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iWix,UXZVxY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iWix,UXZYVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iWix,UXZxYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('xYzy,UXZxVWzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xYzy,UXZxVyWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 7/40 * einsum('xYzy,UXZxVyzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/20 * einsum('xYzy,UXZxVzWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 7/40 * einsum('xYzy,UXZxVzyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/120 * einsum('xYzy,UXZxWVyz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/40 * einsum('xYzy,UXZxWVzy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 11/120 * einsum('xYzy,UXZxyVWz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xYzy,UXZxyVzW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/15 * einsum('xYzy,UXZxyWVz->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xYzy,UXZxyWzV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xYzy,UXZxyzVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/40 * einsum('xYzy,UXZxzVWy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xYzy,UXZxzVyW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xYzy,UXZxzWVy->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xYzy,UXZxzWyV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/40 * einsum('xYzy,UXZxzyVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iYxi,UXZVxW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iYxi,UXZWVx->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iYxi,UXZWxV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iYxi,UXZxWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iYix,UXZVxW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iYix,UXZWVx->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('iYix,UXZWxV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iYix,UXZxWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 2/15 * einsum('xZzy,UXyzVWYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/30 * einsum('xZzy,UXyzVWxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 3/10 * einsum('xZzy,UXyzVYWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xZzy,UXyzVYxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/20 * einsum('xZzy,UXyzVxWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/10 * einsum('xZzy,UXyzVxYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/15 * einsum('xZzy,UXyzWVYx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/60 * einsum('xZzy,UXyzWVxY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 11/40 * einsum('xZzy,UXyzYVWx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/24 * einsum('xZzy,UXyzYVxW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('xZzy,UXyzYWVx->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/24 * einsum('xZzy,UXyzYWxV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/40 * einsum('xZzy,UXyzYxVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/8 * einsum('xZzy,UXyzYxWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('xZzy,UXyzxVWY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/15 * einsum('xZzy,UXyzxVYW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xZzy,UXyzxWVY->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/60 * einsum('xZzy,UXyzxWYV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/20 * einsum('xZzy,UXyzxYVW->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa += 1/10 * einsum('xZzy,UXyzxYWV->XUVYWZ', v_aaaa, rdm_ccccaaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('iZxi,UXxVYW->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iZxi,UXxWVY->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iZxi,UXxWYV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('iZxi,UXxYWV->XUVYWZ', v_caac, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('iZix,UXxVYW->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iZix,UXxWVY->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('iZix,UXxWYV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('iZix,UXxYWV->XUVYWZ', v_caca, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Wx,VZ,UXYx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Wx,VZ,UXxY->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('Yx,VZ,UXWx->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('Yx,VZ,UXxW->XUVYWZ', h_aa, np.identity(ncas), rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VZ,YWyx,UXxy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/6 * einsum('VZ,YWyx,UXyx->XUVYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VZ,xWzy,UXxYyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xWzy,UXxYzy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('VZ,xWzy,UXxyYz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xWzy,UXxyzY->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xWzy,UXxzYy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xWzy,UXxzyY->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VZ,iWxi,UXYx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VZ,iWxi,UXxY->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VZ,iWix,UXYx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('VZ,iWix,UXxY->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/4 * einsum('VZ,xYzy,UXxWyz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xYzy,UXxWzy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa -= 1/12 * einsum('VZ,xYzy,UXxyWz->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xYzy,UXxyzW->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xYzy,UXxzWy->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/12 * einsum('VZ,xYzy,UXxzyW->XUVYWZ', np.identity(ncas), v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K22_baa_baa += 1/3 * einsum('VZ,iYxi,UXWx->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa += 1/6 * einsum('VZ,iYxi,UXxW->XUVYWZ', np.identity(ncas), v_caac, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 2/3 * einsum('VZ,iYix,UXWx->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)
    K22_baa_baa -= 1/3 * einsum('VZ,iYix,UXxW->XUVYWZ', np.identity(ncas), v_caca, rdm_ccaa, optimize = einsum_type)

    K22[::2,::2,::2,::2,::2,::2] = K22_aaa_aaa.copy()
    K22[1::2,1::2,1::2,1::2,1::2,1::2] = K22_aaa_aaa.copy()

    K22[::2,::2,::2,::2,1::2,1::2] = K22_aaa_abb.copy()
    K22[1::2,1::2,1::2,1::2,::2,::2] = K22_aaa_abb.copy()

    K22[::2,::2,::2,1::2,::2,1::2] = - K22_aaa_abb.transpose(0,1,2,4,3,5).copy()
    K22[1::2,1::2,1::2,::2,1::2,::2] = - K22_aaa_abb.transpose(0,1,2,4,3,5).copy()

    K22[1::2,::2,::2,1::2,::2,::2] = K22_baa_baa.copy()
    K22[::2,1::2,1::2,::2,1::2,1::2] = K22_baa_baa.copy()

    K22[1::2,::2,::2,::2,1::2,::2] = - K22_baa_baa.transpose(0,1,2,4,3,5).copy()
    K22[::2,1::2,1::2,1::2,::2,1::2] = - K22_baa_baa.transpose(0,1,2,4,3,5).copy()

    K22[::2,1::2,::2,1::2,::2,::2] = - K22_baa_baa.transpose(1,0,2,3,4,5).copy()
    K22[1::2,::2,1::2,::2,1::2,1::2] = - K22_baa_baa.transpose(1,0,2,3,4,5).copy()

    K22[::2,1::2,::2,::2,1::2,::2] = K22_baa_baa.transpose(1,0,2,4,3,5).copy()
    K22[1::2,::2,1::2,1::2,::2,1::2] = K22_baa_baa.transpose(1,0,2,4,3,5).copy()

    K22[::2,1::2,1::2,::2,::2,::2] = K22_abb_aaa.copy()
    K22[1::2,::2,::2,1::2,1::2,1::2] = K22_abb_aaa.copy()

    K22[1::2,::2,1::2,::2,::2,::2] = - K22_abb_aaa.transpose(1,0,2,3,4,5).copy()
    K22[::2,1::2,::2,1::2,1::2,1::2] = - K22_abb_aaa.transpose(1,0,2,3,4,5).copy()

    K22[::2,::2,1::2,::2,::2,1::2] = K22_aab_aab.copy()
    K22[1::2,1::2,::2,1::2,1::2,::2] = K22_aab_aab.copy()

    K12 = K12[:,aa_ind[0],aa_ind[1]]
    K22 = K22[:,:,:,aa_ind[0],aa_ind[1]]
    K22 = K22[aa_ind[0],aa_ind[1]]

    K_m1p = np.zeros((dim_act, dim_act))

    K_m1p[:n_x,:n_x] = K11.copy()
    K_m1p[:n_x,n_x:] = K12.reshape(n_x, n_xzw).copy()
    K_m1p[n_x:,:n_x] = K12.reshape(n_x, n_xzw).T.copy()
    K_m1p[n_x:,n_x:] = K22.reshape(n_xzw, n_xzw).copy()

    return K_m1p

def compute_K_caca_sanity_check(mr_adc):

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas

    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    h_aa = mr_adc.h1e[mr_adc.ncore:mr_adc.nocc, mr_adc.ncore:mr_adc.nocc].copy()
    v_aaaa = mr_adc.v2e.aaaa
    v_caca = mr_adc.v2e.caca
    v_caac = mr_adc.v2e.caac

    K_caca = np.zeros((ncas * 2, ncas * 2, ncas * 2, ncas * 2))

    K_caca_aa_aa  = 1/2 * einsum('WY,XZ->XYWZ', h_aa, rdm_ca, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('Wx,XxYZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('Wx,XxZY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('Zx,WXYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('Zx,WXxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/2 * einsum('WxYy,XyZx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('WxyY,XyZx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('WxyY,XyxZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('Wxyz,XyzYZx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('Wxyz,XyzZYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_aa += einsum('iWiY,XZ->XYWZ', v_caca, rdm_ca, optimize = einsum_type)
    K_caca_aa_aa -= 1/2 * einsum('iWYi,XZ->XYWZ', v_caac, rdm_ca, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('iWxi,XxYZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('iWxi,XxZY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/3 * einsum('iWix,XxYZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/3 * einsum('iWix,XxZY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('YZxy,WXxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('YZxy,WXyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('Zxyz,WXxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('Zxyz,WXxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/6 * einsum('iZxi,WXYx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/6 * einsum('iZxi,WXxY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/3 * einsum('iZix,WXYx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/3 * einsum('iZix,WXxY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa -= 1/2 * einsum('Zx,WY,Xx->XYWZ', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K_caca_aa_aa -= 1/2 * einsum('WY,Zxyz,Xxyz->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_aa += 1/2 * einsum('WY,iZxi,Xx->XYWZ', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K_caca_aa_aa -= einsum('WY,iZix,Xx->XYWZ', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)

    K_caca_ab_ba  = 1/2 * einsum('WY,XZ->XYWZ', h_aa, rdm_ca, optimize = einsum_type)
    K_caca_ab_ba -= 1/6 * einsum('Wx,XxYZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/3 * einsum('Wx,XxZY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/3 * einsum('Zx,WXYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/6 * einsum('Zx,WXxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/2 * einsum('WxYy,XyZx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/3 * einsum('WxyY,XyZx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/6 * einsum('WxyY,XyxZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/12 * einsum('Wxyz,XyzYZx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += 1/12 * einsum('Wxyz,XyzYxZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/4 * einsum('Wxyz,XyzZYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += 1/12 * einsum('Wxyz,XyzZxY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += 1/12 * einsum('Wxyz,XyzxYZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += 1/12 * einsum('Wxyz,XyzxZY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += einsum('iWiY,XZ->XYWZ', v_caca, rdm_ca, optimize = einsum_type)
    K_caca_ab_ba -= 1/2 * einsum('iWYi,XZ->XYWZ', v_caac, rdm_ca, optimize = einsum_type)
    K_caca_ab_ba += 1/6 * einsum('iWxi,XxYZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/3 * einsum('iWxi,XxZY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/3 * einsum('iWix,XxYZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 2/3 * einsum('iWix,XxZY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/3 * einsum('YZxy,WXxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/6 * einsum('YZxy,WXyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/4 * einsum('Zxyz,WXxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/12 * einsum('Zxyz,WXxYzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba += 1/12 * einsum('Zxyz,WXxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/12 * einsum('Zxyz,WXxyzY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/12 * einsum('Zxyz,WXxzYy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/12 * einsum('Zxyz,WXxzyY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/3 * einsum('iZxi,WXYx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/6 * einsum('iZxi,WXxY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 2/3 * einsum('iZix,WXYx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/3 * einsum('iZix,WXxY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba -= 1/2 * einsum('Zx,WY,Xx->XYWZ', h_aa, np.identity(ncas), rdm_ca, optimize = einsum_type)
    K_caca_ab_ba -= 1/2 * einsum('WY,Zxyz,Xxyz->XYWZ', np.identity(ncas), v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_ab_ba += 1/2 * einsum('WY,iZxi,Xx->XYWZ', np.identity(ncas), v_caac, rdm_ca, optimize = einsum_type)
    K_caca_ab_ba -= einsum('WY,iZix,Xx->XYWZ', np.identity(ncas), v_caca, rdm_ca, optimize = einsum_type)

    K_caca_aa_bb  = 1/3 * einsum('Wx,XxYZ->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/6 * einsum('Wx,XxZY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/6 * einsum('Zx,WXYx->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/3 * einsum('Zx,WXxY->XYWZ', h_aa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/6 * einsum('WxyY,XyZx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/3 * einsum('WxyY,XyxZ->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/4 * einsum('Wxyz,XyzYZx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/12 * einsum('Wxyz,XyzYxZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/12 * einsum('Wxyz,XyzZYx->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/12 * einsum('Wxyz,XyzZxY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/12 * einsum('Wxyz,XyzxYZ->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/12 * einsum('Wxyz,XyzxZY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/3 * einsum('iWxi,XxYZ->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/6 * einsum('iWxi,XxZY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 2/3 * einsum('iWix,XxYZ->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/3 * einsum('iWix,XxZY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/6 * einsum('YZxy,WXxy->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/3 * einsum('YZxy,WXyx->XYWZ', v_aaaa, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/12 * einsum('Zxyz,WXxYyz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/12 * einsum('Zxyz,WXxYzy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/4 * einsum('Zxyz,WXxyYz->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/12 * einsum('Zxyz,WXxyzY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/12 * einsum('Zxyz,WXxzYy->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/12 * einsum('Zxyz,WXxzyY->XYWZ', v_aaaa, rdm_cccaaa, optimize = einsum_type)
    K_caca_aa_bb += 1/6 * einsum('iZxi,WXYx->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb += 1/3 * einsum('iZxi,WXxY->XYWZ', v_caac, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 1/3 * einsum('iZix,WXYx->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)
    K_caca_aa_bb -= 2/3 * einsum('iZix,WXxY->XYWZ', v_caca, rdm_ccaa, optimize = einsum_type)

    K_caca[::2,::2,::2,::2] = K_caca_aa_aa.copy()
    K_caca[1::2,1::2,1::2,1::2] = K_caca_aa_aa.copy()

    K_caca[::2,1::2,1::2,::2] = K_caca_ab_ba.copy()
    K_caca[1::2,::2,::2,1::2] = K_caca_ab_ba.copy()

    K_caca[::2,::2,1::2,1::2] = K_caca_aa_bb.copy()
    K_caca[1::2,1::2,::2,::2] = K_caca_aa_bb.copy()

    return K_caca
